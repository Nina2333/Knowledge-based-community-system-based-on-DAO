(function (root, factory) {(typeof module === 'object' && module.exports) ? module.exports = factory() : root.Libp2PPeerRecord = factory()}(typeof self !== 'undefined' ? self : this, function () {
"use strict";var Libp2PPeerRecord=(()=>{var Ic=Object.create;var yn=Object.defineProperty;var _c=Object.getOwnPropertyDescriptor;var Rc=Object.getOwnPropertyNames;var Nc=Object.getPrototypeOf,Dc=Object.prototype.hasOwnProperty;var P=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),Bt=(e,t)=>{for(var r in t)yn(e,r,{get:t[r],enumerable:!0})},aa=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of Rc(t))!Dc.call(e,i)&&i!==r&&yn(e,i,{get:()=>t[i],enumerable:!(n=_c(t,i))||n.enumerable});return e};var st=(e,t,r)=>(r=e!=null?Ic(Nc(e)):{},aa(t||!e||!e.__esModule?yn(r,"default",{value:e,enumerable:!0}):r,e)),Lc=e=>aa(yn({},"__esModule",{value:!0}),e);var Ia=P((h1,Ta)=>{"use strict";Ta.exports=Mu;function Mu(e,t){for(var r=new Array(arguments.length-1),n=0,i=2,s=!0;i<arguments.length;)r[n++]=arguments[i++];return new Promise(function(o,f){r[n]=function(u){if(s)if(s=!1,u)f(u);else{for(var h=new Array(arguments.length-1),l=0;l<h.length;)h[l++]=arguments[l];o.apply(null,h)}};try{e.apply(t||null,r)}catch(c){s&&(s=!1,f(c))}})}});var Da=P(Na=>{"use strict";var vn=Na;vn.length=function(t){var r=t.length;if(!r)return 0;for(var n=0;--r%4>1&&t.charAt(r)==="=";)++n;return Math.ceil(t.length*3)/4-n};var hr=new Array(64),Ra=new Array(123);for(Ht=0;Ht<64;)Ra[hr[Ht]=Ht<26?Ht+65:Ht<52?Ht+71:Ht<62?Ht-4:Ht-59|43]=Ht++;var Ht;vn.encode=function(t,r,n){for(var i=null,s=[],a=0,o=0,f;r<n;){var c=t[r++];switch(o){case 0:s[a++]=hr[c>>2],f=(c&3)<<4,o=1;break;case 1:s[a++]=hr[f|c>>4],f=(c&15)<<2,o=2;break;case 2:s[a++]=hr[f|c>>6],s[a++]=hr[c&63],o=0;break}a>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,s)),a=0)}return o&&(s[a++]=hr[f],s[a++]=61,o===1&&(s[a++]=61)),i?(a&&i.push(String.fromCharCode.apply(String,s.slice(0,a))),i.join("")):String.fromCharCode.apply(String,s.slice(0,a))};var _a="invalid encoding";vn.decode=function(t,r,n){for(var i=n,s=0,a,o=0;o<t.length;){var f=t.charCodeAt(o++);if(f===61&&s>1)break;if((f=Ra[f])===void 0)throw Error(_a);switch(s){case 0:a=f,s=1;break;case 1:r[n++]=a<<2|(f&48)>>4,a=f,s=2;break;case 2:r[n++]=(a&15)<<4|(f&60)>>2,a=f,s=3;break;case 3:r[n++]=(a&3)<<6|f,s=0;break}}if(s===1)throw Error(_a);return n-i};vn.test=function(t){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(t)}});var ka=P((p1,La)=>{"use strict";La.exports=bn;function bn(){this._listeners={}}bn.prototype.on=function(t,r,n){return(this._listeners[t]||(this._listeners[t]=[])).push({fn:r,ctx:n||this}),this};bn.prototype.off=function(t,r){if(t===void 0)this._listeners={};else if(r===void 0)this._listeners[t]=[];else for(var n=this._listeners[t],i=0;i<n.length;)n[i].fn===r?n.splice(i,1):++i;return this};bn.prototype.emit=function(t){var r=this._listeners[t];if(r){for(var n=[],i=1;i<arguments.length;)n.push(arguments[i++]);for(i=0;i<r.length;)r[i].fn.apply(r[i++].ctx,n)}return this}});var Va=P((d1,Fa)=>{"use strict";Fa.exports=Pa(Pa);function Pa(e){return typeof Float32Array<"u"?function(){var t=new Float32Array([-0]),r=new Uint8Array(t.buffer),n=r[3]===128;function i(f,c,u){t[0]=f,c[u]=r[0],c[u+1]=r[1],c[u+2]=r[2],c[u+3]=r[3]}function s(f,c,u){t[0]=f,c[u]=r[3],c[u+1]=r[2],c[u+2]=r[1],c[u+3]=r[0]}e.writeFloatLE=n?i:s,e.writeFloatBE=n?s:i;function a(f,c){return r[0]=f[c],r[1]=f[c+1],r[2]=f[c+2],r[3]=f[c+3],t[0]}function o(f,c){return r[3]=f[c],r[2]=f[c+1],r[1]=f[c+2],r[0]=f[c+3],t[0]}e.readFloatLE=n?a:o,e.readFloatBE=n?o:a}():function(){function t(n,i,s,a){var o=i<0?1:0;if(o&&(i=-i),i===0)n(1/i>0?0:2147483648,s,a);else if(isNaN(i))n(2143289344,s,a);else if(i>34028234663852886e22)n((o<<31|2139095040)>>>0,s,a);else if(i<11754943508222875e-54)n((o<<31|Math.round(i/1401298464324817e-60))>>>0,s,a);else{var f=Math.floor(Math.log(i)/Math.LN2),c=Math.round(i*Math.pow(2,-f)*8388608)&8388607;n((o<<31|f+127<<23|c)>>>0,s,a)}}e.writeFloatLE=t.bind(null,Ua),e.writeFloatBE=t.bind(null,Ka);function r(n,i,s){var a=n(i,s),o=(a>>31)*2+1,f=a>>>23&255,c=a&8388607;return f===255?c?NaN:o*(1/0):f===0?o*1401298464324817e-60*c:o*Math.pow(2,f-150)*(c+8388608)}e.readFloatLE=r.bind(null,Oa),e.readFloatBE=r.bind(null,Ma)}(),typeof Float64Array<"u"?function(){var t=new Float64Array([-0]),r=new Uint8Array(t.buffer),n=r[7]===128;function i(f,c,u){t[0]=f,c[u]=r[0],c[u+1]=r[1],c[u+2]=r[2],c[u+3]=r[3],c[u+4]=r[4],c[u+5]=r[5],c[u+6]=r[6],c[u+7]=r[7]}function s(f,c,u){t[0]=f,c[u]=r[7],c[u+1]=r[6],c[u+2]=r[5],c[u+3]=r[4],c[u+4]=r[3],c[u+5]=r[2],c[u+6]=r[1],c[u+7]=r[0]}e.writeDoubleLE=n?i:s,e.writeDoubleBE=n?s:i;function a(f,c){return r[0]=f[c],r[1]=f[c+1],r[2]=f[c+2],r[3]=f[c+3],r[4]=f[c+4],r[5]=f[c+5],r[6]=f[c+6],r[7]=f[c+7],t[0]}function o(f,c){return r[7]=f[c],r[6]=f[c+1],r[5]=f[c+2],r[4]=f[c+3],r[3]=f[c+4],r[2]=f[c+5],r[1]=f[c+6],r[0]=f[c+7],t[0]}e.readDoubleLE=n?a:o,e.readDoubleBE=n?o:a}():function(){function t(n,i,s,a,o,f){var c=a<0?1:0;if(c&&(a=-a),a===0)n(0,o,f+i),n(1/a>0?0:2147483648,o,f+s);else if(isNaN(a))n(0,o,f+i),n(2146959360,o,f+s);else if(a>17976931348623157e292)n(0,o,f+i),n((c<<31|2146435072)>>>0,o,f+s);else{var u;if(a<22250738585072014e-324)u=a/5e-324,n(u>>>0,o,f+i),n((c<<31|u/4294967296)>>>0,o,f+s);else{var h=Math.floor(Math.log(a)/Math.LN2);h===1024&&(h=1023),u=a*Math.pow(2,-h),n(u*4503599627370496>>>0,o,f+i),n((c<<31|h+1023<<20|u*1048576&1048575)>>>0,o,f+s)}}}e.writeDoubleLE=t.bind(null,Ua,0,4),e.writeDoubleBE=t.bind(null,Ka,4,0);function r(n,i,s,a,o){var f=n(a,o+i),c=n(a,o+s),u=(c>>31)*2+1,h=c>>>20&2047,l=4294967296*(c&1048575)+f;return h===2047?l?NaN:u*(1/0):h===0?u*5e-324*l:u*Math.pow(2,h-1075)*(l+4503599627370496)}e.readDoubleLE=r.bind(null,Oa,0,4),e.readDoubleBE=r.bind(null,Ma,4,0)}(),e}function Ua(e,t,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24}function Ka(e,t,r){t[r]=e>>>24,t[r+1]=e>>>16&255,t[r+2]=e>>>8&255,t[r+3]=e&255}function Oa(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function Ma(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}});var qa=P((exports,module)=>{"use strict";module.exports=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}});var Ha=P(za=>{"use strict";var ki=za;ki.length=function(t){for(var r=0,n=0,i=0;i<t.length;++i)n=t.charCodeAt(i),n<128?r+=1:n<2048?r+=2:(n&64512)===55296&&(t.charCodeAt(i+1)&64512)===56320?(++i,r+=4):r+=3;return r};ki.read=function(t,r,n){var i=n-r;if(i<1)return"";for(var s=null,a=[],o=0,f;r<n;)f=t[r++],f<128?a[o++]=f:f>191&&f<224?a[o++]=(f&31)<<6|t[r++]&63:f>239&&f<365?(f=((f&7)<<18|(t[r++]&63)<<12|(t[r++]&63)<<6|t[r++]&63)-65536,a[o++]=55296+(f>>10),a[o++]=56320+(f&1023)):a[o++]=(f&15)<<12|(t[r++]&63)<<6|t[r++]&63,o>8191&&((s||(s=[])).push(String.fromCharCode.apply(String,a)),o=0);return s?(o&&s.push(String.fromCharCode.apply(String,a.slice(0,o))),s.join("")):String.fromCharCode.apply(String,a.slice(0,o))};ki.write=function(t,r,n){for(var i=n,s,a,o=0;o<t.length;++o)s=t.charCodeAt(o),s<128?r[n++]=s:s<2048?(r[n++]=s>>6|192,r[n++]=s&63|128):(s&64512)===55296&&((a=t.charCodeAt(o+1))&64512)===56320?(s=65536+((s&1023)<<10)+(a&1023),++o,r[n++]=s>>18|240,r[n++]=s>>12&63|128,r[n++]=s>>6&63|128,r[n++]=s&63|128):(r[n++]=s>>12|224,r[n++]=s>>6&63|128,r[n++]=s&63|128);return n-i}});var Wa=P((g1,Ga)=>{"use strict";Ga.exports=Fu;function Fu(e,t,r){var n=r||8192,i=n>>>1,s=null,a=n;return function(f){if(f<1||f>i)return e(f);a+f>n&&(s=e(n),a=0);var c=t.call(s,a,a+=f);return a&7&&(a=(a|7)+1),c}}});var Za=P((m1,$a)=>{"use strict";$a.exports=xt;var Kr=$e();function xt(e,t){this.lo=e>>>0,this.hi=t>>>0}var We=xt.zero=new xt(0,0);We.toNumber=function(){return 0};We.zzEncode=We.zzDecode=function(){return this};We.length=function(){return 1};var Vu=xt.zeroHash="\0\0\0\0\0\0\0\0";xt.fromNumber=function(t){if(t===0)return We;var r=t<0;r&&(t=-t);var n=t>>>0,i=(t-n)/4294967296>>>0;return r&&(i=~i>>>0,n=~n>>>0,++n>4294967295&&(n=0,++i>4294967295&&(i=0))),new xt(n,i)};xt.from=function(t){if(typeof t=="number")return xt.fromNumber(t);if(Kr.isString(t))if(Kr.Long)t=Kr.Long.fromString(t);else return xt.fromNumber(parseInt(t,10));return t.low||t.high?new xt(t.low>>>0,t.high>>>0):We};xt.prototype.toNumber=function(t){if(!t&&this.hi>>>31){var r=~this.lo+1>>>0,n=~this.hi>>>0;return r||(n=n+1>>>0),-(r+n*4294967296)}return this.lo+this.hi*4294967296};xt.prototype.toLong=function(t){return Kr.Long?new Kr.Long(this.lo|0,this.hi|0,!!t):{low:this.lo|0,high:this.hi|0,unsigned:!!t}};var Ie=String.prototype.charCodeAt;xt.fromHash=function(t){return t===Vu?We:new xt((Ie.call(t,0)|Ie.call(t,1)<<8|Ie.call(t,2)<<16|Ie.call(t,3)<<24)>>>0,(Ie.call(t,4)|Ie.call(t,5)<<8|Ie.call(t,6)<<16|Ie.call(t,7)<<24)>>>0)};xt.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)};xt.prototype.zzEncode=function(){var t=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^t)>>>0,this.lo=(this.lo<<1^t)>>>0,this};xt.prototype.zzDecode=function(){var t=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^t)>>>0,this.hi=(this.hi>>>1^t)>>>0,this};xt.prototype.length=function(){var t=this.lo,r=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return n===0?r===0?t<16384?t<128?1:2:t<2097152?3:4:r<16384?r<128?5:6:r<2097152?7:8:n<128?9:10}});var $e=P(Pi=>{"use strict";var N=Pi;N.asPromise=Ia();N.base64=Da();N.EventEmitter=ka();N.float=Va();N.inquire=qa();N.utf8=Ha();N.pool=Wa();N.LongBits=Za();N.isNode=!!(typeof globalThis<"u"&&globalThis&&globalThis.process&&globalThis.process.versions&&globalThis.process.versions.node);N.global=N.isNode&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||Pi;N.emptyArray=Object.freeze?Object.freeze([]):[];N.emptyObject=Object.freeze?Object.freeze({}):{};N.isInteger=Number.isInteger||function(t){return typeof t=="number"&&isFinite(t)&&Math.floor(t)===t};N.isString=function(t){return typeof t=="string"||t instanceof String};N.isObject=function(t){return t&&typeof t=="object"};N.isset=N.isSet=function(t,r){var n=t[r];return n!=null&&t.hasOwnProperty(r)?typeof n!="object"||(Array.isArray(n)?n.length:Object.keys(n).length)>0:!1};N.Buffer=function(){try{var e=N.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch{return null}}();N._Buffer_from=null;N._Buffer_allocUnsafe=null;N.newBuffer=function(t){return typeof t=="number"?N.Buffer?N._Buffer_allocUnsafe(t):new N.Array(t):N.Buffer?N._Buffer_from(t):typeof Uint8Array>"u"?t:new Uint8Array(t)};N.Array=typeof Uint8Array<"u"?Uint8Array:Array;N.Long=N.global.dcodeIO&&N.global.dcodeIO.Long||N.global.Long||N.inquire("long");N.key2Re=/^true|false|0|1$/;N.key32Re=/^-?(?:0|[1-9][0-9]*)$/;N.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/;N.longToHash=function(t){return t?N.LongBits.from(t).toHash():N.LongBits.zeroHash};N.longFromHash=function(t,r){var n=N.LongBits.fromHash(t);return N.Long?N.Long.fromBits(n.lo,n.hi,r):n.toNumber(!!r)};function Ya(e,t,r){for(var n=Object.keys(t),i=0;i<n.length;++i)(e[n[i]]===void 0||!r)&&(e[n[i]]=t[n[i]]);return e}N.merge=Ya;N.lcFirst=function(t){return t.charAt(0).toLowerCase()+t.substring(1)};function Qa(e){function t(r,n){if(!(this instanceof t))return new t(r,n);Object.defineProperty(this,"message",{get:function(){return r}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:new Error().stack||""}),n&&Ya(this,n)}return t.prototype=Object.create(Error.prototype,{constructor:{value:t,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return e},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),t}N.newError=Qa;N.ProtocolError=Qa("ProtocolError");N.oneOfGetter=function(t){for(var r={},n=0;n<t.length;++n)r[t[n]]=1;return function(){for(var i=Object.keys(this),s=i.length-1;s>-1;--s)if(r[i[s]]===1&&this[i[s]]!==void 0&&this[i[s]]!==null)return i[s]}};N.oneOfSetter=function(t){return function(r){for(var n=0;n<t.length;++n)t[n]!==r&&delete this[t[n]]}};N.toJSONOptions={longs:String,enums:String,bytes:String,json:!0};N._configure=function(){var e=N.Buffer;if(!e){N._Buffer_from=N._Buffer_allocUnsafe=null;return}N._Buffer_from=e.from!==Uint8Array.from&&e.from||function(r,n){return new e(r,n)},N._Buffer_allocUnsafe=e.allocUnsafe||function(r){return new e(r)}}});var Oi=P((v1,eo)=>{"use strict";eo.exports=lt;var jt=$e(),Ki,ja=jt.LongBits,qu=jt.utf8;function Gt(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function lt(e){this.buf=e,this.pos=0,this.len=e.length}var Xa=typeof Uint8Array<"u"?function(t){if(t instanceof Uint8Array||Array.isArray(t))return new lt(t);throw Error("illegal buffer")}:function(t){if(Array.isArray(t))return new lt(t);throw Error("illegal buffer")},to=function(){return jt.Buffer?function(r){return(lt.create=function(i){return jt.Buffer.isBuffer(i)?new Ki(i):Xa(i)})(r)}:Xa};lt.create=to();lt.prototype._slice=jt.Array.prototype.subarray||jt.Array.prototype.slice;lt.prototype.uint32=function(){var t=4294967295;return function(){if(t=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(t=(t|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(t=(t|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(t=(t|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(t=(t|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return t;if((this.pos+=5)>this.len)throw this.pos=this.len,Gt(this,10);return t}}();lt.prototype.int32=function(){return this.uint32()|0};lt.prototype.sint32=function(){var t=this.uint32();return t>>>1^-(t&1)|0};function Ui(){var e=new ja(0,0),t=0;if(this.len-this.pos>4){for(;t<4;++t)if(e.lo=(e.lo|(this.buf[this.pos]&127)<<t*7)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(this.buf[this.pos]&127)<<28)>>>0,e.hi=(e.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return e;t=0}else{for(;t<3;++t){if(this.pos>=this.len)throw Gt(this);if(e.lo=(e.lo|(this.buf[this.pos]&127)<<t*7)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(this.buf[this.pos++]&127)<<t*7)>>>0,e}if(this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(this.buf[this.pos]&127)<<t*7+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw Gt(this);if(e.hi=(e.hi|(this.buf[this.pos]&127)<<t*7+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}lt.prototype.bool=function(){return this.uint32()!==0};function wn(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}lt.prototype.fixed32=function(){if(this.pos+4>this.len)throw Gt(this,4);return wn(this.buf,this.pos+=4)};lt.prototype.sfixed32=function(){if(this.pos+4>this.len)throw Gt(this,4);return wn(this.buf,this.pos+=4)|0};function Ja(){if(this.pos+8>this.len)throw Gt(this,8);return new ja(wn(this.buf,this.pos+=4),wn(this.buf,this.pos+=4))}lt.prototype.float=function(){if(this.pos+4>this.len)throw Gt(this,4);var t=jt.float.readFloatLE(this.buf,this.pos);return this.pos+=4,t};lt.prototype.double=function(){if(this.pos+8>this.len)throw Gt(this,4);var t=jt.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,t};lt.prototype.bytes=function(){var t=this.uint32(),r=this.pos,n=this.pos+t;if(n>this.len)throw Gt(this,t);return this.pos+=t,Array.isArray(this.buf)?this.buf.slice(r,n):r===n?new this.buf.constructor(0):this._slice.call(this.buf,r,n)};lt.prototype.string=function(){var t=this.bytes();return qu.read(t,0,t.length)};lt.prototype.skip=function(t){if(typeof t=="number"){if(this.pos+t>this.len)throw Gt(this,t);this.pos+=t}else do if(this.pos>=this.len)throw Gt(this);while(this.buf[this.pos++]&128);return this};lt.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(e=this.uint32()&7)!==4;)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this};lt._configure=function(e){Ki=e,lt.create=to(),Ki._configure();var t=jt.Long?"toLong":"toNumber";jt.merge(lt.prototype,{int64:function(){return Ui.call(this)[t](!1)},uint64:function(){return Ui.call(this)[t](!0)},sint64:function(){return Ui.call(this).zzDecode()[t](!1)},fixed64:function(){return Ja.call(this)[t](!0)},sfixed64:function(){return Ja.call(this)[t](!1)}})}});var so=P((b1,io)=>{"use strict";io.exports=Ze;var no=Oi();(Ze.prototype=Object.create(no.prototype)).constructor=Ze;var ro=$e();function Ze(e){no.call(this,e)}Ze._configure=function(){ro.Buffer&&(Ze.prototype._slice=ro.Buffer.prototype.slice)};Ze.prototype.string=function(){var t=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+t,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+t,this.len))};Ze._configure()});var Gi=P((w1,co)=>{"use strict";co.exports=H;var Ot=$e(),Mi,Sn=Ot.LongBits,ao=Ot.base64,oo=Ot.utf8;function Or(e,t,r){this.fn=e,this.len=t,this.next=void 0,this.val=r}function Vi(){}function zu(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function H(){this.len=0,this.head=new Or(Vi,0,0),this.tail=this.head,this.states=null}var fo=function(){return Ot.Buffer?function(){return(H.create=function(){return new Mi})()}:function(){return new H}};H.create=fo();H.alloc=function(t){return new Ot.Array(t)};Ot.Array!==Array&&(H.alloc=Ot.pool(H.alloc,Ot.Array.prototype.subarray));H.prototype._push=function(t,r,n){return this.tail=this.tail.next=new Or(t,r,n),this.len+=r,this};function qi(e,t,r){t[r]=e&255}function Hu(e,t,r){for(;e>127;)t[r++]=e&127|128,e>>>=7;t[r]=e}function zi(e,t){this.len=e,this.next=void 0,this.val=t}zi.prototype=Object.create(Or.prototype);zi.prototype.fn=Hu;H.prototype.uint32=function(t){return this.len+=(this.tail=this.tail.next=new zi((t=t>>>0)<128?1:t<16384?2:t<2097152?3:t<268435456?4:5,t)).len,this};H.prototype.int32=function(t){return t<0?this._push(Hi,10,Sn.fromNumber(t)):this.uint32(t)};H.prototype.sint32=function(t){return this.uint32((t<<1^t>>31)>>>0)};function Hi(e,t,r){for(;e.hi;)t[r++]=e.lo&127|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[r++]=e.lo&127|128,e.lo=e.lo>>>7;t[r++]=e.lo}H.prototype.uint64=function(t){var r=Sn.from(t);return this._push(Hi,r.length(),r)};H.prototype.int64=H.prototype.uint64;H.prototype.sint64=function(t){var r=Sn.from(t).zzEncode();return this._push(Hi,r.length(),r)};H.prototype.bool=function(t){return this._push(qi,1,t?1:0)};function Fi(e,t,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24}H.prototype.fixed32=function(t){return this._push(Fi,4,t>>>0)};H.prototype.sfixed32=H.prototype.fixed32;H.prototype.fixed64=function(t){var r=Sn.from(t);return this._push(Fi,4,r.lo)._push(Fi,4,r.hi)};H.prototype.sfixed64=H.prototype.fixed64;H.prototype.float=function(t){return this._push(Ot.float.writeFloatLE,4,t)};H.prototype.double=function(t){return this._push(Ot.float.writeDoubleLE,8,t)};var Gu=Ot.Array.prototype.set?function(t,r,n){r.set(t,n)}:function(t,r,n){for(var i=0;i<t.length;++i)r[n+i]=t[i]};H.prototype.bytes=function(t){var r=t.length>>>0;if(!r)return this._push(qi,1,0);if(Ot.isString(t)){var n=H.alloc(r=ao.length(t));ao.decode(t,n,0),t=n}return this.uint32(r)._push(Gu,r,t)};H.prototype.string=function(t){var r=oo.length(t);return r?this.uint32(r)._push(oo.write,r,t):this._push(qi,1,0)};H.prototype.fork=function(){return this.states=new zu(this),this.head=this.tail=new Or(Vi,0,0),this.len=0,this};H.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Or(Vi,0,0),this.len=0),this};H.prototype.ldelim=function(){var t=this.head,r=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=t.next,this.tail=r,this.len+=n),this};H.prototype.finish=function(){for(var t=this.head.next,r=this.constructor.alloc(this.len),n=0;t;)t.fn(t.val,r,n),n+=t.len,t=t.next;return r};H._configure=function(e){Mi=e,H.create=fo(),Mi._configure()}});var lo=P((S1,ho)=>{"use strict";ho.exports=te;var uo=Gi();(te.prototype=Object.create(uo.prototype)).constructor=te;var _e=$e();function te(){uo.call(this)}te._configure=function(){te.alloc=_e._Buffer_allocUnsafe,te.writeBytesBuffer=_e.Buffer&&_e.Buffer.prototype instanceof Uint8Array&&_e.Buffer.prototype.set.name==="set"?function(t,r,n){r.set(t,n)}:function(t,r,n){if(t.copy)t.copy(r,n,0,t.length);else for(var i=0;i<t.length;)r[n++]=t[i++]}};te.prototype.bytes=function(t){_e.isString(t)&&(t=_e._Buffer_from(t,"base64"));var r=t.length>>>0;return this.uint32(r),r&&this._push(te.writeBytesBuffer,r,t),this};function Wu(e,t,r){e.length<40?_e.utf8.write(e,t,r):t.utf8Write?t.utf8Write(e,r):t.write(e,r)}te.prototype.string=function(t){var r=_e.Buffer.byteLength(t);return this.uint32(r),r&&this._push(Wu,r,t),this};te._configure()});var X=P((F1,xo)=>{xo.exports={options:{usePureJavaScript:!1}}});var wo=P((V1,bo)=>{var Ji={};bo.exports=Ji;var vo={};Ji.encode=function(e,t,r){if(typeof t!="string")throw new TypeError('"alphabet" must be a string.');if(r!==void 0&&typeof r!="number")throw new TypeError('"maxline" must be a number.');var n="";if(!(e instanceof Uint8Array))n=Qu(e,t);else{var i=0,s=t.length,a=t.charAt(0),o=[0];for(i=0;i<e.length;++i){for(var f=0,c=e[i];f<o.length;++f)c+=o[f]<<8,o[f]=c%s,c=c/s|0;for(;c>0;)o.push(c%s),c=c/s|0}for(i=0;e[i]===0&&i<e.length-1;++i)n+=a;for(i=o.length-1;i>=0;--i)n+=t[o[i]]}if(r){var u=new RegExp(".{1,"+r+"}","g");n=n.match(u).join(`\r
`)}return n};Ji.decode=function(e,t){if(typeof e!="string")throw new TypeError('"input" must be a string.');if(typeof t!="string")throw new TypeError('"alphabet" must be a string.');var r=vo[t];if(!r){r=vo[t]=[];for(var n=0;n<t.length;++n)r[t.charCodeAt(n)]=n}e=e.replace(/\s/g,"");for(var i=t.length,s=t.charAt(0),a=[0],n=0;n<e.length;n++){var o=r[e.charCodeAt(n)];if(o===void 0)return;for(var f=0,c=o;f<a.length;++f)c+=a[f]*i,a[f]=c&255,c>>=8;for(;c>0;)a.push(c&255),c>>=8}for(var u=0;e[u]===s&&u<e.length-1;++u)a.push(0);return typeof Buffer<"u"?Buffer.from(a.reverse()):new Uint8Array(a.reverse())};function Qu(e,t){var r=0,n=t.length,i=t.charAt(0),s=[0];for(r=0;r<e.length();++r){for(var a=0,o=e.at(r);a<s.length;++a)o+=s[a]<<8,s[a]=o%n,o=o/n|0;for(;o>0;)s.push(o%n),o=o/n|0}var f="";for(r=0;e.at(r)===0&&r<e.length()-1;++r)f+=i;for(r=s.length-1;r>=0;--r)f+=t[s[r]];return f}});var dt=P((q1,Ao)=>{var So=X(),Eo=wo(),y=Ao.exports=So.util=So.util||{};(function(){if(typeof process<"u"&&process.nextTick&&!process.browser){y.nextTick=process.nextTick,typeof setImmediate=="function"?y.setImmediate=setImmediate:y.setImmediate=y.nextTick;return}if(typeof setImmediate=="function"){y.setImmediate=function(){return setImmediate.apply(void 0,arguments)},y.nextTick=function(o){return setImmediate(o)};return}if(y.setImmediate=function(o){setTimeout(o,0)},typeof window<"u"&&typeof window.postMessage=="function"){let o=function(f){if(f.source===window&&f.data===e){f.stopPropagation();var c=t.slice();t.length=0,c.forEach(function(u){u()})}};var a=o,e="forge.setImmediate",t=[];y.setImmediate=function(f){t.push(f),t.length===1&&window.postMessage(e,"*")},window.addEventListener("message",o,!0)}if(typeof MutationObserver<"u"){var r=Date.now(),n=!0,i=document.createElement("div"),t=[];new MutationObserver(function(){var f=t.slice();t.length=0,f.forEach(function(c){c()})}).observe(i,{attributes:!0});var s=y.setImmediate;y.setImmediate=function(f){Date.now()-r>15?(r=Date.now(),s(f)):(t.push(f),t.length===1&&i.setAttribute("a",n=!n))}}y.nextTick=y.setImmediate})();y.isNodejs=typeof process<"u"&&process.versions&&process.versions.node;y.globalScope=function(){return y.isNodejs?globalThis:typeof self>"u"?window:self}();y.isArray=Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"};y.isArrayBuffer=function(e){return typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer};y.isArrayBufferView=function(e){return e&&y.isArrayBuffer(e.buffer)&&e.byteLength!==void 0};function Mr(e){if(!(e===8||e===16||e===24||e===32))throw new Error("Only 8, 16, 24, or 32 bits supported: "+e)}y.ByteBuffer=ji;function ji(e){if(this.data="",this.read=0,typeof e=="string")this.data=e;else if(y.isArrayBuffer(e)||y.isArrayBufferView(e))if(typeof Buffer<"u"&&e instanceof Buffer)this.data=e.toString("binary");else{var t=new Uint8Array(e);try{this.data=String.fromCharCode.apply(null,t)}catch{for(var r=0;r<t.length;++r)this.putByte(t[r])}}else(e instanceof ji||typeof e=="object"&&typeof e.data=="string"&&typeof e.read=="number")&&(this.data=e.data,this.read=e.read);this._constructedStringLength=0}y.ByteStringBuffer=ji;var Xu=4096;y.ByteStringBuffer.prototype._optimizeConstructedString=function(e){this._constructedStringLength+=e,this._constructedStringLength>Xu&&(this.data.substr(0,1),this._constructedStringLength=0)};y.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read};y.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0};y.ByteStringBuffer.prototype.putByte=function(e){return this.putBytes(String.fromCharCode(e))};y.ByteStringBuffer.prototype.fillWithByte=function(e,t){e=String.fromCharCode(e);for(var r=this.data;t>0;)t&1&&(r+=e),t>>>=1,t>0&&(e+=e);return this.data=r,this._optimizeConstructedString(t),this};y.ByteStringBuffer.prototype.putBytes=function(e){return this.data+=e,this._optimizeConstructedString(e.length),this};y.ByteStringBuffer.prototype.putString=function(e){return this.putBytes(y.encodeUtf8(e))};y.ByteStringBuffer.prototype.putInt16=function(e){return this.putBytes(String.fromCharCode(e>>8&255)+String.fromCharCode(e&255))};y.ByteStringBuffer.prototype.putInt24=function(e){return this.putBytes(String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e&255))};y.ByteStringBuffer.prototype.putInt32=function(e){return this.putBytes(String.fromCharCode(e>>24&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e&255))};y.ByteStringBuffer.prototype.putInt16Le=function(e){return this.putBytes(String.fromCharCode(e&255)+String.fromCharCode(e>>8&255))};y.ByteStringBuffer.prototype.putInt24Le=function(e){return this.putBytes(String.fromCharCode(e&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e>>16&255))};y.ByteStringBuffer.prototype.putInt32Le=function(e){return this.putBytes(String.fromCharCode(e&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>24&255))};y.ByteStringBuffer.prototype.putInt=function(e,t){Mr(t);var r="";do t-=8,r+=String.fromCharCode(e>>t&255);while(t>0);return this.putBytes(r)};y.ByteStringBuffer.prototype.putSignedInt=function(e,t){return e<0&&(e+=2<<t-1),this.putInt(e,t)};y.ByteStringBuffer.prototype.putBuffer=function(e){return this.putBytes(e.getBytes())};y.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)};y.ByteStringBuffer.prototype.getInt16=function(){var e=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,e};y.ByteStringBuffer.prototype.getInt24=function(){var e=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,e};y.ByteStringBuffer.prototype.getInt32=function(){var e=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,e};y.ByteStringBuffer.prototype.getInt16Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,e};y.ByteStringBuffer.prototype.getInt24Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,e};y.ByteStringBuffer.prototype.getInt32Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,e};y.ByteStringBuffer.prototype.getInt=function(e){Mr(e);var t=0;do t=(t<<8)+this.data.charCodeAt(this.read++),e-=8;while(e>0);return t};y.ByteStringBuffer.prototype.getSignedInt=function(e){var t=this.getInt(e),r=2<<e-2;return t>=r&&(t-=r<<1),t};y.ByteStringBuffer.prototype.getBytes=function(e){var t;return e?(e=Math.min(this.length(),e),t=this.data.slice(this.read,this.read+e),this.read+=e):e===0?t="":(t=this.read===0?this.data:this.data.slice(this.read),this.clear()),t};y.ByteStringBuffer.prototype.bytes=function(e){return typeof e>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+e)};y.ByteStringBuffer.prototype.at=function(e){return this.data.charCodeAt(this.read+e)};y.ByteStringBuffer.prototype.setAt=function(e,t){return this.data=this.data.substr(0,this.read+e)+String.fromCharCode(t)+this.data.substr(this.read+e+1),this};y.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)};y.ByteStringBuffer.prototype.copy=function(){var e=y.createBuffer(this.data);return e.read=this.read,e};y.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this};y.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this};y.ByteStringBuffer.prototype.truncate=function(e){var t=Math.max(0,this.length()-e);return this.data=this.data.substr(this.read,t),this.read=0,this};y.ByteStringBuffer.prototype.toHex=function(){for(var e="",t=this.read;t<this.data.length;++t){var r=this.data.charCodeAt(t);r<16&&(e+="0"),e+=r.toString(16)}return e};y.ByteStringBuffer.prototype.toString=function(){return y.decodeUtf8(this.bytes())};function Ju(e,t){t=t||{},this.read=t.readOffset||0,this.growSize=t.growSize||1024;var r=y.isArrayBuffer(e),n=y.isArrayBufferView(e);if(r||n){r?this.data=new DataView(e):this.data=new DataView(e.buffer,e.byteOffset,e.byteLength),this.write="writeOffset"in t?t.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0)),this.write=0,e!=null&&this.putBytes(e),"writeOffset"in t&&(this.write=t.writeOffset)}y.DataBuffer=Ju;y.DataBuffer.prototype.length=function(){return this.write-this.read};y.DataBuffer.prototype.isEmpty=function(){return this.length()<=0};y.DataBuffer.prototype.accommodate=function(e,t){if(this.length()>=e)return this;t=Math.max(t||this.growSize,e);var r=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),n=new Uint8Array(this.length()+t);return n.set(r),this.data=new DataView(n.buffer),this};y.DataBuffer.prototype.putByte=function(e){return this.accommodate(1),this.data.setUint8(this.write++,e),this};y.DataBuffer.prototype.fillWithByte=function(e,t){this.accommodate(t);for(var r=0;r<t;++r)this.data.setUint8(e);return this};y.DataBuffer.prototype.putBytes=function(e,t){if(y.isArrayBufferView(e)){var r=new Uint8Array(e.buffer,e.byteOffset,e.byteLength),n=r.byteLength-r.byteOffset;this.accommodate(n);var i=new Uint8Array(this.data.buffer,this.write);return i.set(r),this.write+=n,this}if(y.isArrayBuffer(e)){var r=new Uint8Array(e);this.accommodate(r.byteLength);var i=new Uint8Array(this.data.buffer);return i.set(r,this.write),this.write+=r.byteLength,this}if(e instanceof y.DataBuffer||typeof e=="object"&&typeof e.read=="number"&&typeof e.write=="number"&&y.isArrayBufferView(e.data)){var r=new Uint8Array(e.data.byteLength,e.read,e.length());this.accommodate(r.byteLength);var i=new Uint8Array(e.data.byteLength,this.write);return i.set(r),this.write+=r.byteLength,this}if(e instanceof y.ByteStringBuffer&&(e=e.data,t="binary"),t=t||"binary",typeof e=="string"){var s;if(t==="hex")return this.accommodate(Math.ceil(e.length/2)),s=new Uint8Array(this.data.buffer,this.write),this.write+=y.binary.hex.decode(e,s,this.write),this;if(t==="base64")return this.accommodate(Math.ceil(e.length/4)*3),s=new Uint8Array(this.data.buffer,this.write),this.write+=y.binary.base64.decode(e,s,this.write),this;if(t==="utf8"&&(e=y.encodeUtf8(e),t="binary"),t==="binary"||t==="raw")return this.accommodate(e.length),s=new Uint8Array(this.data.buffer,this.write),this.write+=y.binary.raw.decode(s),this;if(t==="utf16")return this.accommodate(e.length*2),s=new Uint16Array(this.data.buffer,this.write),this.write+=y.text.utf16.encode(s),this;throw new Error("Invalid encoding: "+t)}throw Error("Invalid parameter: "+e)};y.DataBuffer.prototype.putBuffer=function(e){return this.putBytes(e),e.clear(),this};y.DataBuffer.prototype.putString=function(e){return this.putBytes(e,"utf16")};y.DataBuffer.prototype.putInt16=function(e){return this.accommodate(2),this.data.setInt16(this.write,e),this.write+=2,this};y.DataBuffer.prototype.putInt24=function(e){return this.accommodate(3),this.data.setInt16(this.write,e>>8&65535),this.data.setInt8(this.write,e>>16&255),this.write+=3,this};y.DataBuffer.prototype.putInt32=function(e){return this.accommodate(4),this.data.setInt32(this.write,e),this.write+=4,this};y.DataBuffer.prototype.putInt16Le=function(e){return this.accommodate(2),this.data.setInt16(this.write,e,!0),this.write+=2,this};y.DataBuffer.prototype.putInt24Le=function(e){return this.accommodate(3),this.data.setInt8(this.write,e>>16&255),this.data.setInt16(this.write,e>>8&65535,!0),this.write+=3,this};y.DataBuffer.prototype.putInt32Le=function(e){return this.accommodate(4),this.data.setInt32(this.write,e,!0),this.write+=4,this};y.DataBuffer.prototype.putInt=function(e,t){Mr(t),this.accommodate(t/8);do t-=8,this.data.setInt8(this.write++,e>>t&255);while(t>0);return this};y.DataBuffer.prototype.putSignedInt=function(e,t){return Mr(t),this.accommodate(t/8),e<0&&(e+=2<<t-1),this.putInt(e,t)};y.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)};y.DataBuffer.prototype.getInt16=function(){var e=this.data.getInt16(this.read);return this.read+=2,e};y.DataBuffer.prototype.getInt24=function(){var e=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,e};y.DataBuffer.prototype.getInt32=function(){var e=this.data.getInt32(this.read);return this.read+=4,e};y.DataBuffer.prototype.getInt16Le=function(){var e=this.data.getInt16(this.read,!0);return this.read+=2,e};y.DataBuffer.prototype.getInt24Le=function(){var e=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,e};y.DataBuffer.prototype.getInt32Le=function(){var e=this.data.getInt32(this.read,!0);return this.read+=4,e};y.DataBuffer.prototype.getInt=function(e){Mr(e);var t=0;do t=(t<<8)+this.data.getInt8(this.read++),e-=8;while(e>0);return t};y.DataBuffer.prototype.getSignedInt=function(e){var t=this.getInt(e),r=2<<e-2;return t>=r&&(t-=r<<1),t};y.DataBuffer.prototype.getBytes=function(e){var t;return e?(e=Math.min(this.length(),e),t=this.data.slice(this.read,this.read+e),this.read+=e):e===0?t="":(t=this.read===0?this.data:this.data.slice(this.read),this.clear()),t};y.DataBuffer.prototype.bytes=function(e){return typeof e>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+e)};y.DataBuffer.prototype.at=function(e){return this.data.getUint8(this.read+e)};y.DataBuffer.prototype.setAt=function(e,t){return this.data.setUint8(e,t),this};y.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)};y.DataBuffer.prototype.copy=function(){return new y.DataBuffer(this)};y.DataBuffer.prototype.compact=function(){if(this.read>0){var e=new Uint8Array(this.data.buffer,this.read),t=new Uint8Array(e.byteLength);t.set(e),this.data=new DataView(t),this.write-=this.read,this.read=0}return this};y.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this};y.DataBuffer.prototype.truncate=function(e){return this.write=Math.max(0,this.length()-e),this.read=Math.min(this.read,this.write),this};y.DataBuffer.prototype.toHex=function(){for(var e="",t=this.read;t<this.data.byteLength;++t){var r=this.data.getUint8(t);r<16&&(e+="0"),e+=r.toString(16)}return e};y.DataBuffer.prototype.toString=function(e){var t=new Uint8Array(this.data,this.read,this.length());if(e=e||"utf8",e==="binary"||e==="raw")return y.binary.raw.encode(t);if(e==="hex")return y.binary.hex.encode(t);if(e==="base64")return y.binary.base64.encode(t);if(e==="utf8")return y.text.utf8.decode(t);if(e==="utf16")return y.text.utf16.decode(t);throw new Error("Invalid encoding: "+e)};y.createBuffer=function(e,t){return t=t||"raw",e!==void 0&&t==="utf8"&&(e=y.encodeUtf8(e)),new y.ByteBuffer(e)};y.fillString=function(e,t){for(var r="";t>0;)t&1&&(r+=e),t>>>=1,t>0&&(e+=e);return r};y.xorBytes=function(e,t,r){for(var n="",i="",s="",a=0,o=0;r>0;--r,++a)i=e.charCodeAt(a)^t.charCodeAt(a),o>=10&&(n+=s,s="",o=0),s+=String.fromCharCode(i),++o;return n+=s,n};y.hexToBytes=function(e){var t="",r=0;for(e.length&!0&&(r=1,t+=String.fromCharCode(parseInt(e[0],16)));r<e.length;r+=2)t+=String.fromCharCode(parseInt(e.substr(r,2),16));return t};y.bytesToHex=function(e){return y.createBuffer(e).toHex()};y.int32ToBytes=function(e){return String.fromCharCode(e>>24&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e&255)};var Re="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Ne=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],Bo="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";y.encode64=function(e,t){for(var r="",n="",i,s,a,o=0;o<e.length;)i=e.charCodeAt(o++),s=e.charCodeAt(o++),a=e.charCodeAt(o++),r+=Re.charAt(i>>2),r+=Re.charAt((i&3)<<4|s>>4),isNaN(s)?r+="==":(r+=Re.charAt((s&15)<<2|a>>6),r+=isNaN(a)?"=":Re.charAt(a&63)),t&&r.length>t&&(n+=r.substr(0,t)+`\r
`,r=r.substr(t));return n+=r,n};y.decode64=function(e){e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var t="",r,n,i,s,a=0;a<e.length;)r=Ne[e.charCodeAt(a++)-43],n=Ne[e.charCodeAt(a++)-43],i=Ne[e.charCodeAt(a++)-43],s=Ne[e.charCodeAt(a++)-43],t+=String.fromCharCode(r<<2|n>>4),i!==64&&(t+=String.fromCharCode((n&15)<<4|i>>2),s!==64&&(t+=String.fromCharCode((i&3)<<6|s)));return t};y.encodeUtf8=function(e){return unescape(encodeURIComponent(e))};y.decodeUtf8=function(e){return decodeURIComponent(escape(e))};y.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:Eo.encode,decode:Eo.decode}};y.binary.raw.encode=function(e){return String.fromCharCode.apply(null,e)};y.binary.raw.decode=function(e,t,r){var n=t;n||(n=new Uint8Array(e.length)),r=r||0;for(var i=r,s=0;s<e.length;++s)n[i++]=e.charCodeAt(s);return t?i-r:n};y.binary.hex.encode=y.bytesToHex;y.binary.hex.decode=function(e,t,r){var n=t;n||(n=new Uint8Array(Math.ceil(e.length/2))),r=r||0;var i=0,s=r;for(e.length&1&&(i=1,n[s++]=parseInt(e[0],16));i<e.length;i+=2)n[s++]=parseInt(e.substr(i,2),16);return t?s-r:n};y.binary.base64.encode=function(e,t){for(var r="",n="",i,s,a,o=0;o<e.byteLength;)i=e[o++],s=e[o++],a=e[o++],r+=Re.charAt(i>>2),r+=Re.charAt((i&3)<<4|s>>4),isNaN(s)?r+="==":(r+=Re.charAt((s&15)<<2|a>>6),r+=isNaN(a)?"=":Re.charAt(a&63)),t&&r.length>t&&(n+=r.substr(0,t)+`\r
`,r=r.substr(t));return n+=r,n};y.binary.base64.decode=function(e,t,r){var n=t;n||(n=new Uint8Array(Math.ceil(e.length/4)*3)),e=e.replace(/[^A-Za-z0-9\+\/\=]/g,""),r=r||0;for(var i,s,a,o,f=0,c=r;f<e.length;)i=Ne[e.charCodeAt(f++)-43],s=Ne[e.charCodeAt(f++)-43],a=Ne[e.charCodeAt(f++)-43],o=Ne[e.charCodeAt(f++)-43],n[c++]=i<<2|s>>4,a!==64&&(n[c++]=(s&15)<<4|a>>2,o!==64&&(n[c++]=(a&3)<<6|o));return t?c-r:n.subarray(0,c)};y.binary.base58.encode=function(e,t){return y.binary.baseN.encode(e,Bo,t)};y.binary.base58.decode=function(e,t){return y.binary.baseN.decode(e,Bo,t)};y.text={utf8:{},utf16:{}};y.text.utf8.encode=function(e,t,r){e=y.encodeUtf8(e);var n=t;n||(n=new Uint8Array(e.length)),r=r||0;for(var i=r,s=0;s<e.length;++s)n[i++]=e.charCodeAt(s);return t?i-r:n};y.text.utf8.decode=function(e){return y.decodeUtf8(String.fromCharCode.apply(null,e))};y.text.utf16.encode=function(e,t,r){var n=t;n||(n=new Uint8Array(e.length*2));var i=new Uint16Array(n.buffer);r=r||0;for(var s=r,a=r,o=0;o<e.length;++o)i[a++]=e.charCodeAt(o),s+=2;return t?s-r:n};y.text.utf16.decode=function(e){return String.fromCharCode.apply(null,new Uint16Array(e.buffer))};y.deflate=function(e,t,r){if(t=y.decode64(e.deflate(y.encode64(t)).rval),r){var n=2,i=t.charCodeAt(1);i&32&&(n=6),t=t.substring(n,t.length-4)}return t};y.inflate=function(e,t,r){var n=e.inflate(y.encode64(t)).rval;return n===null?null:y.decode64(n)};var ts=function(e,t,r){if(!e)throw new Error("WebStorage not available.");var n;if(r===null?n=e.removeItem(t):(r=y.encode64(JSON.stringify(r)),n=e.setItem(t,r)),typeof n<"u"&&n.rval!==!0){var i=new Error(n.error.message);throw i.id=n.error.id,i.name=n.error.name,i}},es=function(e,t){if(!e)throw new Error("WebStorage not available.");var r=e.getItem(t);if(e.init)if(r.rval===null){if(r.error){var n=new Error(r.error.message);throw n.id=r.error.id,n.name=r.error.name,n}r=null}else r=r.rval;return r!==null&&(r=JSON.parse(y.decode64(r))),r},ju=function(e,t,r,n){var i=es(e,t);i===null&&(i={}),i[r]=n,ts(e,t,i)},th=function(e,t,r){var n=es(e,t);return n!==null&&(n=r in n?n[r]:null),n},eh=function(e,t,r){var n=es(e,t);if(n!==null&&r in n){delete n[r];var i=!0;for(var s in n){i=!1;break}i&&(n=null),ts(e,t,n)}},rh=function(e,t){ts(e,t,null)},An=function(e,t,r){var n=null;typeof r>"u"&&(r=["web","flash"]);var i,s=!1,a=null;for(var o in r){i=r[o];try{if(i==="flash"||i==="both"){if(t[0]===null)throw new Error("Flash local storage not available.");n=e.apply(this,t),s=i==="flash"}(i==="web"||i==="both")&&(t[0]=localStorage,n=e.apply(this,t),s=!0)}catch(f){a=f}if(s)break}if(!s)throw a;return n};y.setItem=function(e,t,r,n,i){An(ju,arguments,i)};y.getItem=function(e,t,r,n){return An(th,arguments,n)};y.removeItem=function(e,t,r,n){An(eh,arguments,n)};y.clearItems=function(e,t,r){An(rh,arguments,r)};y.isEmpty=function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0};y.format=function(e){for(var t=/%./g,r,n,i=0,s=[],a=0;r=t.exec(e);){n=e.substring(a,t.lastIndex-2),n.length>0&&s.push(n),a=t.lastIndex;var o=r[0][1];switch(o){case"s":case"o":i<arguments.length?s.push(arguments[i+++1]):s.push("<?>");break;case"%":s.push("%");break;default:s.push("<%"+o+"?>")}}return s.push(e.substring(a)),s.join("")};y.formatNumber=function(e,t,r,n){var i=e,s=isNaN(t=Math.abs(t))?2:t,a=r===void 0?",":r,o=n===void 0?".":n,f=i<0?"-":"",c=parseInt(i=Math.abs(+i||0).toFixed(s),10)+"",u=c.length>3?c.length%3:0;return f+(u?c.substr(0,u)+o:"")+c.substr(u).replace(/(\d{3})(?=\d)/g,"$1"+o)+(s?a+Math.abs(i-c).toFixed(s).slice(2):"")};y.formatSize=function(e){return e>=1073741824?e=y.formatNumber(e/1073741824,2,".","")+" GiB":e>=1048576?e=y.formatNumber(e/1048576,2,".","")+" MiB":e>=1024?e=y.formatNumber(e/1024,0)+" KiB":e=y.formatNumber(e,0)+" bytes",e};y.bytesFromIP=function(e){return e.indexOf(".")!==-1?y.bytesFromIPv4(e):e.indexOf(":")!==-1?y.bytesFromIPv6(e):null};y.bytesFromIPv4=function(e){if(e=e.split("."),e.length!==4)return null;for(var t=y.createBuffer(),r=0;r<e.length;++r){var n=parseInt(e[r],10);if(isNaN(n))return null;t.putByte(n)}return t.getBytes()};y.bytesFromIPv6=function(e){var t=0;e=e.split(":").filter(function(a){return a.length===0&&++t,!0});for(var r=(8-e.length+t)*2,n=y.createBuffer(),i=0;i<8;++i){if(!e[i]||e[i].length===0){n.fillWithByte(0,r),r=0;continue}var s=y.hexToBytes(e[i]);s.length<2&&n.putByte(0),n.putBytes(s)}return n.getBytes()};y.bytesToIP=function(e){return e.length===4?y.bytesToIPv4(e):e.length===16?y.bytesToIPv6(e):null};y.bytesToIPv4=function(e){if(e.length!==4)return null;for(var t=[],r=0;r<e.length;++r)t.push(e.charCodeAt(r));return t.join(".")};y.bytesToIPv6=function(e){if(e.length!==16)return null;for(var t=[],r=[],n=0,i=0;i<e.length;i+=2){for(var s=y.bytesToHex(e[i]+e[i+1]);s[0]==="0"&&s!=="0";)s=s.substr(1);if(s==="0"){var a=r[r.length-1],o=t.length;!a||o!==a.end+1?r.push({start:o,end:o}):(a.end=o,a.end-a.start>r[n].end-r[n].start&&(n=r.length-1))}t.push(s)}if(r.length>0){var f=r[n];f.end-f.start>0&&(t.splice(f.start,f.end-f.start+1,""),f.start===0&&t.unshift(""),f.end===7&&t.push(""))}return t.join(":")};y.estimateCores=function(e,t){if(typeof e=="function"&&(t=e,e={}),e=e||{},"cores"in y&&!e.update)return t(null,y.cores);if(typeof navigator<"u"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return y.cores=navigator.hardwareConcurrency,t(null,y.cores);if(typeof Worker>"u")return y.cores=1,t(null,y.cores);if(typeof Blob>"u")return y.cores=2,t(null,y.cores);var r=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(a){for(var o=Date.now(),f=o+4;Date.now()<f;);self.postMessage({st:o,et:f})})}.toString(),")()"],{type:"application/javascript"}));n([],5,16);function n(a,o,f){if(o===0){var c=Math.floor(a.reduce(function(u,h){return u+h},0)/a.length);return y.cores=Math.max(1,c),URL.revokeObjectURL(r),t(null,y.cores)}i(f,function(u,h){a.push(s(f,h)),n(a,o-1,f)})}function i(a,o){for(var f=[],c=[],u=0;u<a;++u){var h=new Worker(r);h.addEventListener("message",function(l){if(c.push(l.data),c.length===a){for(var d=0;d<a;++d)f[d].terminate();o(null,c)}}),f.push(h)}for(var u=0;u<a;++u)f[u].postMessage(u)}function s(a,o){for(var f=[],c=0;c<a;++c)for(var u=o[c],h=f[c]=[],l=0;l<a;++l)if(c!==l){var d=o[l];(u.st>d.st&&u.st<d.et||d.st>u.st&&d.st<u.et)&&h.push(l)}return f.reduce(function(p,g){return Math.max(p,g.length)},0)}}});var Cn=P((z1,Co)=>{var Fr=X();Fr.pki=Fr.pki||{};var rs=Co.exports=Fr.pki.oids=Fr.oids=Fr.oids||{};function E(e,t){rs[e]=t,rs[t]=e}function Q(e,t){rs[e]=t}E("1.2.840.113549.1.1.1","rsaEncryption");E("1.2.840.113549.1.1.4","md5WithRSAEncryption");E("1.2.840.113549.1.1.5","sha1WithRSAEncryption");E("1.2.840.113549.1.1.7","RSAES-OAEP");E("1.2.840.113549.1.1.8","mgf1");E("1.2.840.113549.1.1.9","pSpecified");E("1.2.840.113549.1.1.10","RSASSA-PSS");E("1.2.840.113549.1.1.11","sha256WithRSAEncryption");E("1.2.840.113549.1.1.12","sha384WithRSAEncryption");E("1.2.840.113549.1.1.13","sha512WithRSAEncryption");E("1.3.101.112","EdDSA25519");E("1.2.840.10040.4.3","dsa-with-sha1");E("1.3.14.3.2.7","desCBC");E("1.3.14.3.2.26","sha1");E("1.3.14.3.2.29","sha1WithRSASignature");E("2.16.840.1.101.3.4.2.1","sha256");E("2.16.840.1.101.3.4.2.2","sha384");E("2.16.840.1.101.3.4.2.3","sha512");E("2.16.840.1.101.3.4.2.4","sha224");E("2.16.840.1.101.3.4.2.5","sha512-224");E("2.16.840.1.101.3.4.2.6","sha512-256");E("1.2.840.113549.2.2","md2");E("1.2.840.113549.2.5","md5");E("1.2.840.113549.1.7.1","data");E("1.2.840.113549.1.7.2","signedData");E("1.2.840.113549.1.7.3","envelopedData");E("1.2.840.113549.1.7.4","signedAndEnvelopedData");E("1.2.840.113549.1.7.5","digestedData");E("1.2.840.113549.1.7.6","encryptedData");E("1.2.840.113549.1.9.1","emailAddress");E("1.2.840.113549.1.9.2","unstructuredName");E("1.2.840.113549.1.9.3","contentType");E("1.2.840.113549.1.9.4","messageDigest");E("1.2.840.113549.1.9.5","signingTime");E("1.2.840.113549.1.9.6","counterSignature");E("1.2.840.113549.1.9.7","challengePassword");E("1.2.840.113549.1.9.8","unstructuredAddress");E("1.2.840.113549.1.9.14","extensionRequest");E("1.2.840.113549.1.9.20","friendlyName");E("1.2.840.113549.1.9.21","localKeyId");E("1.2.840.113549.1.9.22.1","x509Certificate");E("1.2.840.113549.1.12.10.1.1","keyBag");E("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag");E("1.2.840.113549.1.12.10.1.3","certBag");E("1.2.840.113549.1.12.10.1.4","crlBag");E("1.2.840.113549.1.12.10.1.5","secretBag");E("1.2.840.113549.1.12.10.1.6","safeContentsBag");E("1.2.840.113549.1.5.13","pkcs5PBES2");E("1.2.840.113549.1.5.12","pkcs5PBKDF2");E("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4");E("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4");E("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC");E("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC");E("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC");E("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC");E("1.2.840.113549.2.7","hmacWithSHA1");E("1.2.840.113549.2.8","hmacWithSHA224");E("1.2.840.113549.2.9","hmacWithSHA256");E("1.2.840.113549.2.10","hmacWithSHA384");E("1.2.840.113549.2.11","hmacWithSHA512");E("1.2.840.113549.3.7","des-EDE3-CBC");E("2.16.840.1.101.3.4.1.2","aes128-CBC");E("2.16.840.1.101.3.4.1.22","aes192-CBC");E("2.16.840.1.101.3.4.1.42","aes256-CBC");E("2.5.4.3","commonName");E("2.5.4.4","surname");E("2.5.4.5","serialNumber");E("2.5.4.6","countryName");E("2.5.4.7","localityName");E("2.5.4.8","stateOrProvinceName");E("2.5.4.9","streetAddress");E("2.5.4.10","organizationName");E("2.5.4.11","organizationalUnitName");E("2.5.4.12","title");E("2.5.4.13","description");E("2.5.4.15","businessCategory");E("2.5.4.17","postalCode");E("2.5.4.42","givenName");E("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName");E("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName");E("2.16.840.1.113730.1.1","nsCertType");E("2.16.840.1.113730.1.13","nsComment");Q("2.5.29.1","authorityKeyIdentifier");Q("2.5.29.2","keyAttributes");Q("2.5.29.3","certificatePolicies");Q("2.5.29.4","keyUsageRestriction");Q("2.5.29.5","policyMapping");Q("2.5.29.6","subtreesConstraint");Q("2.5.29.7","subjectAltName");Q("2.5.29.8","issuerAltName");Q("2.5.29.9","subjectDirectoryAttributes");Q("2.5.29.10","basicConstraints");Q("2.5.29.11","nameConstraints");Q("2.5.29.12","policyConstraints");Q("2.5.29.13","basicConstraints");E("2.5.29.14","subjectKeyIdentifier");E("2.5.29.15","keyUsage");Q("2.5.29.16","privateKeyUsagePeriod");E("2.5.29.17","subjectAltName");E("2.5.29.18","issuerAltName");E("2.5.29.19","basicConstraints");Q("2.5.29.20","cRLNumber");Q("2.5.29.21","cRLReason");Q("2.5.29.22","expirationDate");Q("2.5.29.23","instructionCode");Q("2.5.29.24","invalidityDate");Q("2.5.29.25","cRLDistributionPoints");Q("2.5.29.26","issuingDistributionPoint");Q("2.5.29.27","deltaCRLIndicator");Q("2.5.29.28","issuingDistributionPoint");Q("2.5.29.29","certificateIssuer");Q("2.5.29.30","nameConstraints");E("2.5.29.31","cRLDistributionPoints");E("2.5.29.32","certificatePolicies");Q("2.5.29.33","policyMappings");Q("2.5.29.34","policyConstraints");E("2.5.29.35","authorityKeyIdentifier");Q("2.5.29.36","policyConstraints");E("2.5.29.37","extKeyUsage");Q("2.5.29.46","freshestCRL");Q("2.5.29.54","inhibitAnyPolicy");E("1.3.6.1.4.1.11129.2.4.2","timestampList");E("1.3.6.1.5.5.7.1.1","authorityInfoAccess");E("1.3.6.1.5.5.7.3.1","serverAuth");E("1.3.6.1.5.5.7.3.2","clientAuth");E("1.3.6.1.5.5.7.3.3","codeSigning");E("1.3.6.1.5.5.7.3.4","emailProtection");E("1.3.6.1.5.5.7.3.8","timeStamping")});var qr=P((H1,Io)=>{var et=X();dt();Cn();var C=Io.exports=et.asn1=et.asn1||{};C.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192};C.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30};C.create=function(e,t,r,n,i){if(et.util.isArray(n)){for(var s=[],a=0;a<n.length;++a)n[a]!==void 0&&s.push(n[a]);n=s}var o={tagClass:e,type:t,constructed:r,composed:r||et.util.isArray(n),value:n};return i&&"bitStringContents"in i&&(o.bitStringContents=i.bitStringContents,o.original=C.copy(o)),o};C.copy=function(e,t){var r;if(et.util.isArray(e)){r=[];for(var n=0;n<e.length;++n)r.push(C.copy(e[n],t));return r}return typeof e=="string"?e:(r={tagClass:e.tagClass,type:e.type,constructed:e.constructed,composed:e.composed,value:C.copy(e.value,t)},t&&!t.excludeBitStringContents&&(r.bitStringContents=e.bitStringContents),r)};C.equals=function(e,t,r){if(et.util.isArray(e)){if(!et.util.isArray(t)||e.length!==t.length)return!1;for(var n=0;n<e.length;++n)if(!C.equals(e[n],t[n]))return!1;return!0}if(typeof e!=typeof t)return!1;if(typeof e=="string")return e===t;var i=e.tagClass===t.tagClass&&e.type===t.type&&e.constructed===t.constructed&&e.composed===t.composed&&C.equals(e.value,t.value);return r&&r.includeBitStringContents&&(i=i&&e.bitStringContents===t.bitStringContents),i};C.getBerValueLength=function(e){var t=e.getByte();if(t!==128){var r,n=t&128;return n?r=e.getInt((t&127)<<3):r=t,r}};function Vr(e,t,r){if(r>t){var n=new Error("Too few bytes to parse DER.");throw n.available=e.length(),n.remaining=t,n.requested=r,n}}var nh=function(e,t){var r=e.getByte();if(t--,r!==128){var n,i=r&128;if(!i)n=r;else{var s=r&127;Vr(e,t,s),n=e.getInt(s<<3)}if(n<0)throw new Error("Negative length: "+n);return n}};C.fromDer=function(e,t){t===void 0&&(t={strict:!0,parseAllBytes:!0,decodeBitStrings:!0}),typeof t=="boolean"&&(t={strict:t,parseAllBytes:!0,decodeBitStrings:!0}),"strict"in t||(t.strict=!0),"parseAllBytes"in t||(t.parseAllBytes=!0),"decodeBitStrings"in t||(t.decodeBitStrings=!0),typeof e=="string"&&(e=et.util.createBuffer(e));var r=e.length(),n=Tn(e,e.length(),0,t);if(t.parseAllBytes&&e.length()!==0){var i=new Error("Unparsed DER bytes remain after ASN.1 parsing.");throw i.byteCount=r,i.remaining=e.length(),i}return n};function Tn(e,t,r,n){var i;Vr(e,t,2);var s=e.getByte();t--;var a=s&192,o=s&31;i=e.length();var f=nh(e,t);if(t-=i-e.length(),f!==void 0&&f>t){if(n.strict){var c=new Error("Too few bytes to read ASN.1 value.");throw c.available=e.length(),c.remaining=t,c.requested=f,c}f=t}var u,h,l=(s&32)===32;if(l)if(u=[],f===void 0)for(;;){if(Vr(e,t,2),e.bytes(2)===String.fromCharCode(0,0)){e.getBytes(2),t-=2;break}i=e.length(),u.push(Tn(e,t,r+1,n)),t-=i-e.length()}else for(;f>0;)i=e.length(),u.push(Tn(e,f,r+1,n)),t-=i-e.length(),f-=i-e.length();if(u===void 0&&a===C.Class.UNIVERSAL&&o===C.Type.BITSTRING&&(h=e.bytes(f)),u===void 0&&n.decodeBitStrings&&a===C.Class.UNIVERSAL&&o===C.Type.BITSTRING&&f>1){var d=e.read,p=t,g=0;if(o===C.Type.BITSTRING&&(Vr(e,t,1),g=e.getByte(),t--),g===0)try{i=e.length();var x={strict:!0,decodeBitStrings:!0},v=Tn(e,t,r+1,x),B=i-e.length();t-=B,o==C.Type.BITSTRING&&B++;var A=v.tagClass;B===f&&(A===C.Class.UNIVERSAL||A===C.Class.CONTEXT_SPECIFIC)&&(u=[v])}catch{}u===void 0&&(e.read=d,t=p)}if(u===void 0){if(f===void 0){if(n.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");f=t}if(o===C.Type.BMPSTRING)for(u="";f>0;f-=2)Vr(e,t,2),u+=String.fromCharCode(e.getInt16()),t-=2;else u=e.getBytes(f),t-=f}var L=h===void 0?null:{bitStringContents:h};return C.create(a,o,l,u,L)}C.toDer=function(e){var t=et.util.createBuffer(),r=e.tagClass|e.type,n=et.util.createBuffer(),i=!1;if("bitStringContents"in e&&(i=!0,e.original&&(i=C.equals(e,e.original))),i)n.putBytes(e.bitStringContents);else if(e.composed){e.constructed?r|=32:n.putByte(0);for(var s=0;s<e.value.length;++s)e.value[s]!==void 0&&n.putBuffer(C.toDer(e.value[s]))}else if(e.type===C.Type.BMPSTRING)for(var s=0;s<e.value.length;++s)n.putInt16(e.value.charCodeAt(s));else e.type===C.Type.INTEGER&&e.value.length>1&&(e.value.charCodeAt(0)===0&&!(e.value.charCodeAt(1)&128)||e.value.charCodeAt(0)===255&&(e.value.charCodeAt(1)&128)===128)?n.putBytes(e.value.substr(1)):n.putBytes(e.value);if(t.putByte(r),n.length()<=127)t.putByte(n.length()&127);else{var a=n.length(),o="";do o+=String.fromCharCode(a&255),a=a>>>8;while(a>0);t.putByte(o.length|128);for(var s=o.length-1;s>=0;--s)t.putByte(o.charCodeAt(s))}return t.putBuffer(n),t};C.oidToDer=function(e){var t=e.split("."),r=et.util.createBuffer();r.putByte(40*parseInt(t[0],10)+parseInt(t[1],10));for(var n,i,s,a,o=2;o<t.length;++o){n=!0,i=[],s=parseInt(t[o],10);do a=s&127,s=s>>>7,n||(a|=128),i.push(a),n=!1;while(s>0);for(var f=i.length-1;f>=0;--f)r.putByte(i[f])}return r};C.derToOid=function(e){var t;typeof e=="string"&&(e=et.util.createBuffer(e));var r=e.getByte();t=Math.floor(r/40)+"."+r%40;for(var n=0;e.length()>0;)r=e.getByte(),n=n<<7,r&128?n+=r&127:(t+="."+(n+r),n=0);return t};C.utcTimeToDate=function(e){var t=new Date,r=parseInt(e.substr(0,2),10);r=r>=50?1900+r:2e3+r;var n=parseInt(e.substr(2,2),10)-1,i=parseInt(e.substr(4,2),10),s=parseInt(e.substr(6,2),10),a=parseInt(e.substr(8,2),10),o=0;if(e.length>11){var f=e.charAt(10),c=10;f!=="+"&&f!=="-"&&(o=parseInt(e.substr(10,2),10),c+=2)}if(t.setUTCFullYear(r,n,i),t.setUTCHours(s,a,o,0),c&&(f=e.charAt(c),f==="+"||f==="-")){var u=parseInt(e.substr(c+1,2),10),h=parseInt(e.substr(c+4,2),10),l=u*60+h;l*=6e4,f==="+"?t.setTime(+t-l):t.setTime(+t+l)}return t};C.generalizedTimeToDate=function(e){var t=new Date,r=parseInt(e.substr(0,4),10),n=parseInt(e.substr(4,2),10)-1,i=parseInt(e.substr(6,2),10),s=parseInt(e.substr(8,2),10),a=parseInt(e.substr(10,2),10),o=parseInt(e.substr(12,2),10),f=0,c=0,u=!1;e.charAt(e.length-1)==="Z"&&(u=!0);var h=e.length-5,l=e.charAt(h);if(l==="+"||l==="-"){var d=parseInt(e.substr(h+1,2),10),p=parseInt(e.substr(h+4,2),10);c=d*60+p,c*=6e4,l==="+"&&(c*=-1),u=!0}return e.charAt(14)==="."&&(f=parseFloat(e.substr(14),10)*1e3),u?(t.setUTCFullYear(r,n,i),t.setUTCHours(s,a,o,f),t.setTime(+t+c)):(t.setFullYear(r,n,i),t.setHours(s,a,o,f)),t};C.dateToUtcTime=function(e){if(typeof e=="string")return e;var t="",r=[];r.push((""+e.getUTCFullYear()).substr(2)),r.push(""+(e.getUTCMonth()+1)),r.push(""+e.getUTCDate()),r.push(""+e.getUTCHours()),r.push(""+e.getUTCMinutes()),r.push(""+e.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(t+="0"),t+=r[n];return t+="Z",t};C.dateToGeneralizedTime=function(e){if(typeof e=="string")return e;var t="",r=[];r.push(""+e.getUTCFullYear()),r.push(""+(e.getUTCMonth()+1)),r.push(""+e.getUTCDate()),r.push(""+e.getUTCHours()),r.push(""+e.getUTCMinutes()),r.push(""+e.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(t+="0"),t+=r[n];return t+="Z",t};C.integerToDer=function(e){var t=et.util.createBuffer();if(e>=-128&&e<128)return t.putSignedInt(e,8);if(e>=-32768&&e<32768)return t.putSignedInt(e,16);if(e>=-8388608&&e<8388608)return t.putSignedInt(e,24);if(e>=-2147483648&&e<2147483648)return t.putSignedInt(e,32);var r=new Error("Integer too large; max is 32-bits.");throw r.integer=e,r};C.derToInteger=function(e){typeof e=="string"&&(e=et.util.createBuffer(e));var t=e.length()*8;if(t>32)throw new Error("Integer too large; max is 32-bits.");return e.getSignedInt(t)};C.validate=function(e,t,r,n){var i=!1;if((e.tagClass===t.tagClass||typeof t.tagClass>"u")&&(e.type===t.type||typeof t.type>"u"))if(e.constructed===t.constructed||typeof t.constructed>"u"){if(i=!0,t.value&&et.util.isArray(t.value))for(var s=0,a=0;i&&a<t.value.length;++a)i=t.value[a].optional||!1,e.value[s]&&(i=C.validate(e.value[s],t.value[a],r,n),i?++s:t.value[a].optional&&(i=!0)),!i&&n&&n.push("["+t.name+'] Tag class "'+t.tagClass+'", type "'+t.type+'" expected value length "'+t.value.length+'", got "'+e.value.length+'"');if(i&&r&&(t.capture&&(r[t.capture]=e.value),t.captureAsn1&&(r[t.captureAsn1]=e),t.captureBitStringContents&&"bitStringContents"in e&&(r[t.captureBitStringContents]=e.bitStringContents),t.captureBitStringValue&&"bitStringContents"in e)){var o;if(e.bitStringContents.length<2)r[t.captureBitStringValue]="";else{var f=e.bitStringContents.charCodeAt(0);if(f!==0)throw new Error("captureBitStringValue only supported for zero unused bits");r[t.captureBitStringValue]=e.bitStringContents.slice(1)}}}else n&&n.push("["+t.name+'] Expected constructed "'+t.constructed+'", got "'+e.constructed+'"');else n&&(e.tagClass!==t.tagClass&&n.push("["+t.name+'] Expected tag class "'+t.tagClass+'", got "'+e.tagClass+'"'),e.type!==t.type&&n.push("["+t.name+'] Expected type "'+t.type+'", got "'+e.type+'"'));return i};var To=/[^\\u0000-\\u00ff]/;C.prettyPrint=function(e,t,r){var n="";t=t||0,r=r||2,t>0&&(n+=`
`);for(var i="",s=0;s<t*r;++s)i+=" ";switch(n+=i+"Tag: ",e.tagClass){case C.Class.UNIVERSAL:n+="Universal:";break;case C.Class.APPLICATION:n+="Application:";break;case C.Class.CONTEXT_SPECIFIC:n+="Context-Specific:";break;case C.Class.PRIVATE:n+="Private:";break}if(e.tagClass===C.Class.UNIVERSAL)switch(n+=e.type,e.type){case C.Type.NONE:n+=" (None)";break;case C.Type.BOOLEAN:n+=" (Boolean)";break;case C.Type.INTEGER:n+=" (Integer)";break;case C.Type.BITSTRING:n+=" (Bit string)";break;case C.Type.OCTETSTRING:n+=" (Octet string)";break;case C.Type.NULL:n+=" (Null)";break;case C.Type.OID:n+=" (Object Identifier)";break;case C.Type.ODESC:n+=" (Object Descriptor)";break;case C.Type.EXTERNAL:n+=" (External or Instance of)";break;case C.Type.REAL:n+=" (Real)";break;case C.Type.ENUMERATED:n+=" (Enumerated)";break;case C.Type.EMBEDDED:n+=" (Embedded PDV)";break;case C.Type.UTF8:n+=" (UTF8)";break;case C.Type.ROID:n+=" (Relative Object Identifier)";break;case C.Type.SEQUENCE:n+=" (Sequence)";break;case C.Type.SET:n+=" (Set)";break;case C.Type.PRINTABLESTRING:n+=" (Printable String)";break;case C.Type.IA5String:n+=" (IA5String (ASCII))";break;case C.Type.UTCTIME:n+=" (UTC time)";break;case C.Type.GENERALIZEDTIME:n+=" (Generalized time)";break;case C.Type.BMPSTRING:n+=" (BMP String)";break}else n+=e.type;if(n+=`
`,n+=i+"Constructed: "+e.constructed+`
`,e.composed){for(var a=0,o="",s=0;s<e.value.length;++s)e.value[s]!==void 0&&(a+=1,o+=C.prettyPrint(e.value[s],t+1,r),s+1<e.value.length&&(o+=","));n+=i+"Sub values: "+a+o}else{if(n+=i+"Value: ",e.type===C.Type.OID){var f=C.derToOid(e.value);n+=f,et.pki&&et.pki.oids&&f in et.pki.oids&&(n+=" ("+et.pki.oids[f]+") ")}if(e.type===C.Type.INTEGER)try{n+=C.derToInteger(e.value)}catch{n+="0x"+et.util.bytesToHex(e.value)}else if(e.type===C.Type.BITSTRING){if(e.value.length>1?n+="0x"+et.util.bytesToHex(e.value.slice(1)):n+="(none)",e.value.length>0){var c=e.value.charCodeAt(0);c==1?n+=" (1 unused bit shown)":c>1&&(n+=" ("+c+" unused bits shown)")}}else if(e.type===C.Type.OCTETSTRING)To.test(e.value)||(n+="("+e.value+") "),n+="0x"+et.util.bytesToHex(e.value);else if(e.type===C.Type.UTF8)try{n+=et.util.decodeUtf8(e.value)}catch(u){if(u.message==="URI malformed")n+="0x"+et.util.bytesToHex(e.value)+" (malformed UTF8)";else throw u}else e.type===C.Type.PRINTABLESTRING||e.type===C.Type.IA5String?n+=e.value:To.test(e.value)?n+="0x"+et.util.bytesToHex(e.value):e.value.length===0?n+="[null]":n+=e.value}return n}});var is=P((G1,_o)=>{var vt=X();dt();_o.exports=vt.cipher=vt.cipher||{};vt.cipher.algorithms=vt.cipher.algorithms||{};vt.cipher.createCipher=function(e,t){var r=e;if(typeof r=="string"&&(r=vt.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+e);return new vt.cipher.BlockCipher({algorithm:r,key:t,decrypt:!1})};vt.cipher.createDecipher=function(e,t){var r=e;if(typeof r=="string"&&(r=vt.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+e);return new vt.cipher.BlockCipher({algorithm:r,key:t,decrypt:!0})};vt.cipher.registerAlgorithm=function(e,t){e=e.toUpperCase(),vt.cipher.algorithms[e]=t};vt.cipher.getAlgorithm=function(e){return e=e.toUpperCase(),e in vt.cipher.algorithms?vt.cipher.algorithms[e]:null};var ns=vt.cipher.BlockCipher=function(e){this.algorithm=e.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=e.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=e.decrypt,this.algorithm.initialize(e)};ns.prototype.start=function(e){e=e||{};var t={};for(var r in e)t[r]=e[r];t.decrypt=this._decrypt,this._finish=!1,this._input=vt.util.createBuffer(),this.output=e.output||vt.util.createBuffer(),this.mode.start(t)};ns.prototype.update=function(e){for(e&&this._input.putBuffer(e);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()};ns.prototype.finish=function(e){e&&(this.mode.name==="ECB"||this.mode.name==="CBC")&&(this.mode.pad=function(r){return e(this.blockSize,r,!1)},this.mode.unpad=function(r){return e(this.blockSize,r,!0)});var t={};return t.decrypt=this._decrypt,t.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,t)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,t))||this.mode.afterFinish&&!this.mode.afterFinish(this.output,t))}});var as=P((W1,Ro)=>{var bt=X();dt();bt.cipher=bt.cipher||{};var O=Ro.exports=bt.cipher.modes=bt.cipher.modes||{};O.ecb=function(e){e=e||{},this.name="ECB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};O.ecb.prototype.start=function(e){};O.ecb.prototype.encrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=e.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)t.putInt32(this._outBlock[n])};O.ecb.prototype.decrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=e.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)t.putInt32(this._outBlock[n])};O.ecb.prototype.pad=function(e,t){var r=e.length()===this.blockSize?this.blockSize:this.blockSize-e.length();return e.fillWithByte(r,r),!0};O.ecb.prototype.unpad=function(e,t){if(t.overflow>0)return!1;var r=e.length(),n=e.at(r-1);return n>this.blockSize<<2?!1:(e.truncate(n),!0)};O.cbc=function(e){e=e||{},this.name="CBC",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};O.cbc.prototype.start=function(e){if(e.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if("iv"in e)this._iv=In(e.iv,this.blockSize),this._prev=this._iv.slice(0);else throw new Error("Invalid IV parameter.")};O.cbc.prototype.encrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=this._prev[n]^e.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)t.putInt32(this._outBlock[n]);this._prev=this._outBlock};O.cbc.prototype.decrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=e.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)t.putInt32(this._prev[n]^this._outBlock[n]);this._prev=this._inBlock.slice(0)};O.cbc.prototype.pad=function(e,t){var r=e.length()===this.blockSize?this.blockSize:this.blockSize-e.length();return e.fillWithByte(r,r),!0};O.cbc.prototype.unpad=function(e,t){if(t.overflow>0)return!1;var r=e.length(),n=e.at(r-1);return n>this.blockSize<<2?!1:(e.truncate(n),!0)};O.cfb=function(e){e=e||{},this.name="CFB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=bt.util.createBuffer(),this._partialBytes=0};O.cfb.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=In(e.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};O.cfb.prototype.encrypt=function(e,t,r){var n=e.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)this._inBlock[i]=e.getInt32()^this._outBlock[i],t.putInt32(this._inBlock[i]);return}var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=e.getInt32()^this._outBlock[i],this._partialOutput.putInt32(this._partialBlock[i]);if(s>0)e.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return t.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};O.cfb.prototype.decrypt=function(e,t,r){var n=e.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)this._inBlock[i]=e.getInt32(),t.putInt32(this._inBlock[i]^this._outBlock[i]);return}var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=e.getInt32(),this._partialOutput.putInt32(this._partialBlock[i]^this._outBlock[i]);if(s>0)e.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return t.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};O.ofb=function(e){e=e||{},this.name="OFB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=bt.util.createBuffer(),this._partialBytes=0};O.ofb.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=In(e.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};O.ofb.prototype.encrypt=function(e,t,r){var n=e.length();if(e.length()===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)t.putInt32(e.getInt32()^this._outBlock[i]),this._inBlock[i]=this._outBlock[i];return}var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(e.getInt32()^this._outBlock[i]);if(s>0)e.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._outBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return t.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};O.ofb.prototype.decrypt=O.ofb.prototype.encrypt;O.ctr=function(e){e=e||{},this.name="CTR",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=bt.util.createBuffer(),this._partialBytes=0};O.ctr.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=In(e.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};O.ctr.prototype.encrypt=function(e,t,r){var n=e.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize)for(var i=0;i<this._ints;++i)t.putInt32(e.getInt32()^this._outBlock[i]);else{var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(e.getInt32()^this._outBlock[i]);if(s>0&&(e.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return t.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}_n(this._inBlock)};O.ctr.prototype.decrypt=O.ctr.prototype.encrypt;O.gcm=function(e){e=e||{},this.name="GCM",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=bt.util.createBuffer(),this._partialBytes=0,this._R=3774873600};O.gcm.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");var t=bt.util.createBuffer(e.iv);this._cipherLength=0;var r;if("additionalData"in e?r=bt.util.createBuffer(e.additionalData):r=bt.util.createBuffer(),"tagLength"in e?this._tagLength=e.tagLength:this._tagLength=128,this._tag=null,e.decrypt&&(this._tag=bt.util.createBuffer(e.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var n=t.length();if(n===12)this._j0=[t.getInt32(),t.getInt32(),t.getInt32(),1];else{for(this._j0=[0,0,0,0];t.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[t.getInt32(),t.getInt32(),t.getInt32(),t.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(ss(n*8)))}this._inBlock=this._j0.slice(0),_n(this._inBlock),this._partialBytes=0,r=bt.util.createBuffer(r),this._aDataLength=ss(r.length()*8);var i=r.length()%this.blockSize;for(i&&r.fillWithByte(0,this.blockSize-i),this._s=[0,0,0,0];r.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[r.getInt32(),r.getInt32(),r.getInt32(),r.getInt32()])};O.gcm.prototype.encrypt=function(e,t,r){var n=e.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)t.putInt32(this._outBlock[i]^=e.getInt32());this._cipherLength+=this.blockSize}else{var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(e.getInt32()^this._outBlock[i]);if(s<=0||r){if(r){var a=n%this.blockSize;this._cipherLength+=a,this._partialOutput.truncate(this.blockSize-a)}else this._cipherLength+=this.blockSize;for(var i=0;i<this._ints;++i)this._outBlock[i]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.read-=this.blockSize,t.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),_n(this._inBlock)};O.gcm.prototype.decrypt=function(e,t,r){var n=e.length();if(n<this.blockSize&&!(r&&n>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),_n(this._inBlock),this._hashBlock[0]=e.getInt32(),this._hashBlock[1]=e.getInt32(),this._hashBlock[2]=e.getInt32(),this._hashBlock[3]=e.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var i=0;i<this._ints;++i)t.putInt32(this._outBlock[i]^this._hashBlock[i]);n<this.blockSize?this._cipherLength+=n%this.blockSize:this._cipherLength+=this.blockSize};O.gcm.prototype.afterFinish=function(e,t){var r=!0;t.decrypt&&t.overflow&&e.truncate(this.blockSize-t.overflow),this.tag=bt.util.createBuffer();var n=this._aDataLength.concat(ss(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,n);var i=[];this.cipher.encrypt(this._j0,i);for(var s=0;s<this._ints;++s)this.tag.putInt32(this._s[s]^i[s]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),t.decrypt&&this.tag.bytes()!==this._tag&&(r=!1),r};O.gcm.prototype.multiply=function(e,t){for(var r=[0,0,0,0],n=t.slice(0),i=0;i<128;++i){var s=e[i/32|0]&1<<31-i%32;s&&(r[0]^=n[0],r[1]^=n[1],r[2]^=n[2],r[3]^=n[3]),this.pow(n,n)}return r};O.gcm.prototype.pow=function(e,t){for(var r=e[3]&1,n=3;n>0;--n)t[n]=e[n]>>>1|(e[n-1]&1)<<31;t[0]=e[0]>>>1,r&&(t[0]^=this._R)};O.gcm.prototype.tableMultiply=function(e){for(var t=[0,0,0,0],r=0;r<32;++r){var n=r/8|0,i=e[n]>>>(7-r%8)*4&15,s=this._m[r][i];t[0]^=s[0],t[1]^=s[1],t[2]^=s[2],t[3]^=s[3]}return t};O.gcm.prototype.ghash=function(e,t,r){return t[0]^=r[0],t[1]^=r[1],t[2]^=r[2],t[3]^=r[3],this.tableMultiply(t)};O.gcm.prototype.generateHashTable=function(e,t){for(var r=8/t,n=4*r,i=16*r,s=new Array(i),a=0;a<i;++a){var o=[0,0,0,0],f=a/n|0,c=(n-1-a%n)*t;o[f]=1<<t-1<<c,s[a]=this.generateSubHashTable(this.multiply(o,e),t)}return s};O.gcm.prototype.generateSubHashTable=function(e,t){var r=1<<t,n=r>>>1,i=new Array(r);i[n]=e.slice(0);for(var s=n>>>1;s>0;)this.pow(i[2*s],i[s]=[]),s>>=1;for(s=2;s<n;){for(var a=1;a<s;++a){var o=i[s],f=i[a];i[s+a]=[o[0]^f[0],o[1]^f[1],o[2]^f[2],o[3]^f[3]]}s*=2}for(i[0]=[0,0,0,0],s=n+1;s<r;++s){var c=i[s^n];i[s]=[e[0]^c[0],e[1]^c[1],e[2]^c[2],e[3]^c[3]]}return i};function In(e,t){if(typeof e=="string"&&(e=bt.util.createBuffer(e)),bt.util.isArray(e)&&e.length>4){var r=e;e=bt.util.createBuffer();for(var n=0;n<r.length;++n)e.putByte(r[n])}if(e.length()<t)throw new Error("Invalid IV length; got "+e.length()+" bytes and expected "+t+" bytes.");if(!bt.util.isArray(e)){for(var i=[],s=t/4,n=0;n<s;++n)i.push(e.getInt32());e=i}return e}function _n(e){e[e.length-1]=e[e.length-1]+1&4294967295}function ss(e){return[e/4294967296|0,e&4294967295]}});var us=P(($1,ko)=>{var tt=X();is();as();dt();ko.exports=tt.aes=tt.aes||{};tt.aes.startEncrypting=function(e,t,r,n){var i=Rn({key:e,output:r,decrypt:!1,mode:n});return i.start(t),i};tt.aes.createEncryptionCipher=function(e,t){return Rn({key:e,output:null,decrypt:!1,mode:t})};tt.aes.startDecrypting=function(e,t,r,n){var i=Rn({key:e,output:r,decrypt:!0,mode:n});return i.start(t),i};tt.aes.createDecryptionCipher=function(e,t){return Rn({key:e,output:null,decrypt:!0,mode:t})};tt.aes.Algorithm=function(e,t){cs||Do();var r=this;r.name=e,r.mode=new t({blockSize:16,cipher:{encrypt:function(n,i){return fs(r._w,n,i,!1)},decrypt:function(n,i){return fs(r._w,n,i,!0)}}}),r._init=!1};tt.aes.Algorithm.prototype.initialize=function(e){if(!this._init){var t=e.key,r;if(typeof t=="string"&&(t.length===16||t.length===24||t.length===32))t=tt.util.createBuffer(t);else if(tt.util.isArray(t)&&(t.length===16||t.length===24||t.length===32)){r=t,t=tt.util.createBuffer();for(var n=0;n<r.length;++n)t.putByte(r[n])}if(!tt.util.isArray(t)){r=t,t=[];var i=r.length();if(i===16||i===24||i===32){i=i>>>2;for(var n=0;n<i;++n)t.push(r.getInt32())}}if(!tt.util.isArray(t)||!(t.length===4||t.length===6||t.length===8))throw new Error("Invalid key parameter.");var s=this.mode.name,a=["CFB","OFB","CTR","GCM"].indexOf(s)!==-1;this._w=Lo(t,e.decrypt&&!a),this._init=!0}};tt.aes._expandKey=function(e,t){return cs||Do(),Lo(e,t)};tt.aes._updateBlock=fs;dr("AES-ECB",tt.cipher.modes.ecb);dr("AES-CBC",tt.cipher.modes.cbc);dr("AES-CFB",tt.cipher.modes.cfb);dr("AES-OFB",tt.cipher.modes.ofb);dr("AES-CTR",tt.cipher.modes.ctr);dr("AES-GCM",tt.cipher.modes.gcm);function dr(e,t){var r=function(){return new tt.aes.Algorithm(e,t)};tt.cipher.registerAlgorithm(e,r)}var cs=!1,pr=4,It,os,No,Ye,Wt;function Do(){cs=!0,No=[0,1,2,4,8,16,32,64,128,27,54];for(var e=new Array(256),t=0;t<128;++t)e[t]=t<<1,e[t+128]=t+128<<1^283;It=new Array(256),os=new Array(256),Ye=new Array(4),Wt=new Array(4);for(var t=0;t<4;++t)Ye[t]=new Array(256),Wt[t]=new Array(256);for(var r=0,n=0,i,s,a,o,f,c,u,t=0;t<256;++t){o=n^n<<1^n<<2^n<<3^n<<4,o=o>>8^o&255^99,It[r]=o,os[o]=r,f=e[o],i=e[r],s=e[i],a=e[s],c=f<<24^o<<16^o<<8^(o^f),u=(i^s^a)<<24^(r^a)<<16^(r^s^a)<<8^(r^i^a);for(var h=0;h<4;++h)Ye[h][r]=c,Wt[h][o]=u,c=c<<24|c>>>8,u=u<<24|u>>>8;r===0?r=n=1:(r=i^e[e[e[i^a]]],n^=e[e[n]])}}function Lo(e,t){for(var r=e.slice(0),n,i=1,s=r.length,a=s+6+1,o=pr*a,f=s;f<o;++f)n=r[f-1],f%s===0?(n=It[n>>>16&255]<<24^It[n>>>8&255]<<16^It[n&255]<<8^It[n>>>24]^No[i]<<24,i++):s>6&&f%s===4&&(n=It[n>>>24]<<24^It[n>>>16&255]<<16^It[n>>>8&255]<<8^It[n&255]),r[f]=r[f-s]^n;if(t){var c,u=Wt[0],h=Wt[1],l=Wt[2],d=Wt[3],p=r.slice(0);o=r.length;for(var f=0,g=o-pr;f<o;f+=pr,g-=pr)if(f===0||f===o-pr)p[f]=r[g],p[f+1]=r[g+3],p[f+2]=r[g+2],p[f+3]=r[g+1];else for(var x=0;x<pr;++x)c=r[g+x],p[f+(3&-x)]=u[It[c>>>24]]^h[It[c>>>16&255]]^l[It[c>>>8&255]]^d[It[c&255]];r=p}return r}function fs(e,t,r,n){var i=e.length/4-1,s,a,o,f,c;n?(s=Wt[0],a=Wt[1],o=Wt[2],f=Wt[3],c=os):(s=Ye[0],a=Ye[1],o=Ye[2],f=Ye[3],c=It);var u,h,l,d,p,g,x;u=t[0]^e[0],h=t[n?3:1]^e[1],l=t[2]^e[2],d=t[n?1:3]^e[3];for(var v=3,B=1;B<i;++B)p=s[u>>>24]^a[h>>>16&255]^o[l>>>8&255]^f[d&255]^e[++v],g=s[h>>>24]^a[l>>>16&255]^o[d>>>8&255]^f[u&255]^e[++v],x=s[l>>>24]^a[d>>>16&255]^o[u>>>8&255]^f[h&255]^e[++v],d=s[d>>>24]^a[u>>>16&255]^o[h>>>8&255]^f[l&255]^e[++v],u=p,h=g,l=x;r[0]=c[u>>>24]<<24^c[h>>>16&255]<<16^c[l>>>8&255]<<8^c[d&255]^e[++v],r[n?3:1]=c[h>>>24]<<24^c[l>>>16&255]<<16^c[d>>>8&255]<<8^c[u&255]^e[++v],r[2]=c[l>>>24]<<24^c[d>>>16&255]<<16^c[u>>>8&255]<<8^c[h&255]^e[++v],r[n?1:3]=c[d>>>24]<<24^c[u>>>16&255]<<16^c[h>>>8&255]<<8^c[l&255]^e[++v]}function Rn(e){e=e||{};var t=(e.mode||"CBC").toUpperCase(),r="AES-"+t,n;e.decrypt?n=tt.cipher.createDecipher(r,e.key):n=tt.cipher.createCipher(r,e.key);var i=n.start;return n.start=function(s,a){var o=null;a instanceof tt.util.ByteBuffer&&(o=a,a={}),a=a||{},a.output=o,a.iv=s,i.call(n,a)},n}});var Ko=P((Z1,Uo)=>{var ot=X();is();as();dt();Uo.exports=ot.des=ot.des||{};ot.des.startEncrypting=function(e,t,r,n){var i=Nn({key:e,output:r,decrypt:!1,mode:n||(t===null?"ECB":"CBC")});return i.start(t),i};ot.des.createEncryptionCipher=function(e,t){return Nn({key:e,output:null,decrypt:!1,mode:t})};ot.des.startDecrypting=function(e,t,r,n){var i=Nn({key:e,output:r,decrypt:!0,mode:n||(t===null?"ECB":"CBC")});return i.start(t),i};ot.des.createDecryptionCipher=function(e,t){return Nn({key:e,output:null,decrypt:!0,mode:t})};ot.des.Algorithm=function(e,t){var r=this;r.name=e,r.mode=new t({blockSize:8,cipher:{encrypt:function(n,i){return Po(r._keys,n,i,!1)},decrypt:function(n,i){return Po(r._keys,n,i,!0)}}}),r._init=!1};ot.des.Algorithm.prototype.initialize=function(e){if(!this._init){var t=ot.util.createBuffer(e.key);if(this.name.indexOf("3DES")===0&&t.length()!==24)throw new Error("Invalid Triple-DES key size: "+t.length()*8);this._keys=lh(t),this._init=!0}};ne("DES-ECB",ot.cipher.modes.ecb);ne("DES-CBC",ot.cipher.modes.cbc);ne("DES-CFB",ot.cipher.modes.cfb);ne("DES-OFB",ot.cipher.modes.ofb);ne("DES-CTR",ot.cipher.modes.ctr);ne("3DES-ECB",ot.cipher.modes.ecb);ne("3DES-CBC",ot.cipher.modes.cbc);ne("3DES-CFB",ot.cipher.modes.cfb);ne("3DES-OFB",ot.cipher.modes.ofb);ne("3DES-CTR",ot.cipher.modes.ctr);function ne(e,t){var r=function(){return new ot.des.Algorithm(e,t)};ot.cipher.registerAlgorithm(e,r)}var ih=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],sh=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],ah=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],oh=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],fh=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],ch=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],uh=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],hh=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function lh(e){for(var t=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],r=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],n=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],i=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],s=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],a=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],o=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],f=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],c=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],u=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],h=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],l=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],d=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],p=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],g=e.length()>8?3:1,x=[],v=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],B=0,A,L=0;L<g;L++){var T=e.getInt32(),_=e.getInt32();A=(T>>>4^_)&252645135,_^=A,T^=A<<4,A=(_>>>-16^T)&65535,T^=A,_^=A<<-16,A=(T>>>2^_)&858993459,_^=A,T^=A<<2,A=(_>>>-16^T)&65535,T^=A,_^=A<<-16,A=(T>>>1^_)&1431655765,_^=A,T^=A<<1,A=(_>>>8^T)&16711935,T^=A,_^=A<<8,A=(T>>>1^_)&1431655765,_^=A,T^=A<<1,A=T<<8|_>>>20&240,T=_<<24|_<<8&16711680|_>>>8&65280|_>>>24&240,_=A;for(var F=0;F<v.length;++F){v[F]?(T=T<<2|T>>>26,_=_<<2|_>>>26):(T=T<<1|T>>>27,_=_<<1|_>>>27),T&=-15,_&=-15;var $=t[T>>>28]|r[T>>>24&15]|n[T>>>20&15]|i[T>>>16&15]|s[T>>>12&15]|a[T>>>8&15]|o[T>>>4&15],Et=f[_>>>28]|c[_>>>24&15]|u[_>>>20&15]|h[_>>>16&15]|l[_>>>12&15]|d[_>>>8&15]|p[_>>>4&15];A=(Et>>>16^$)&65535,x[B++]=$^A,x[B++]=Et^A<<16}}return x}function Po(e,t,r,n){var i=e.length===32?3:9,s;i===3?s=n?[30,-2,-2]:[0,32,2]:s=n?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var a,o=t[0],f=t[1];a=(o>>>4^f)&252645135,f^=a,o^=a<<4,a=(o>>>16^f)&65535,f^=a,o^=a<<16,a=(f>>>2^o)&858993459,o^=a,f^=a<<2,a=(f>>>8^o)&16711935,o^=a,f^=a<<8,a=(o>>>1^f)&1431655765,f^=a,o^=a<<1,o=o<<1|o>>>31,f=f<<1|f>>>31;for(var c=0;c<i;c+=3){for(var u=s[c+1],h=s[c+2],l=s[c];l!=u;l+=h){var d=f^e[l],p=(f>>>4|f<<28)^e[l+1];a=o,o=f,f=a^(sh[d>>>24&63]|oh[d>>>16&63]|ch[d>>>8&63]|hh[d&63]|ih[p>>>24&63]|ah[p>>>16&63]|fh[p>>>8&63]|uh[p&63])}a=o,o=f,f=a}o=o>>>1|o<<31,f=f>>>1|f<<31,a=(o>>>1^f)&1431655765,f^=a,o^=a<<1,a=(f>>>8^o)&16711935,o^=a,f^=a<<8,a=(f>>>2^o)&858993459,o^=a,f^=a<<2,a=(o>>>16^f)&65535,f^=a,o^=a<<16,a=(o>>>4^f)&252645135,f^=a,o^=a<<4,r[0]=o,r[1]=f}function Nn(e){e=e||{};var t=(e.mode||"CBC").toUpperCase(),r="DES-"+t,n;e.decrypt?n=ot.cipher.createDecipher(r,e.key):n=ot.cipher.createCipher(r,e.key);var i=n.start;return n.start=function(s,a){var o=null;a instanceof ot.util.ByteBuffer&&(o=a,a={}),a=a||{},a.output=o,a.iv=s,i.call(n,a)},n}});var Qe=P((Y1,Oo)=>{var Dn=X();Oo.exports=Dn.md=Dn.md||{};Dn.md.algorithms=Dn.md.algorithms||{}});var Fo=P((Q1,Mo)=>{var ve=X();Qe();dt();var ph=Mo.exports=ve.hmac=ve.hmac||{};ph.create=function(){var e=null,t=null,r=null,n=null,i={};return i.start=function(s,a){if(s!==null)if(typeof s=="string")if(s=s.toLowerCase(),s in ve.md.algorithms)t=ve.md.algorithms[s].create();else throw new Error('Unknown hash algorithm "'+s+'"');else t=s;if(a===null)a=e;else{if(typeof a=="string")a=ve.util.createBuffer(a);else if(ve.util.isArray(a)){var o=a;a=ve.util.createBuffer();for(var f=0;f<o.length;++f)a.putByte(o[f])}var c=a.length();c>t.blockLength&&(t.start(),t.update(a.bytes()),a=t.digest()),r=ve.util.createBuffer(),n=ve.util.createBuffer(),c=a.length();for(var f=0;f<c;++f){var o=a.at(f);r.putByte(54^o),n.putByte(92^o)}if(c<t.blockLength)for(var o=t.blockLength-c,f=0;f<o;++f)r.putByte(54),n.putByte(92);e=a,r=r.bytes(),n=n.bytes()}t.start(),t.update(r)},i.update=function(s){t.update(s)},i.getMac=function(){var s=t.digest().bytes();return t.start(),t.update(n),t.update(s),t.digest()},i.digest=i.getMac,i}});var yr=P(()=>{});var qo=P((j1,Vo)=>{var _t=X();Fo();Qe();dt();var dh=_t.pkcs5=_t.pkcs5||{},be;_t.util.isNodejs&&!_t.options.usePureJavaScript&&(be=yr());Vo.exports=_t.pbkdf2=dh.pbkdf2=function(e,t,r,n,i,s){if(typeof i=="function"&&(s=i,i=null),_t.util.isNodejs&&!_t.options.usePureJavaScript&&be.pbkdf2&&(i===null||typeof i!="object")&&(be.pbkdf2Sync.length>4||!i||i==="sha1"))return typeof i!="string"&&(i="sha1"),e=Buffer.from(e,"binary"),t=Buffer.from(t,"binary"),s?be.pbkdf2Sync.length===4?be.pbkdf2(e,t,r,n,function(A,L){if(A)return s(A);s(null,L.toString("binary"))}):be.pbkdf2(e,t,r,n,i,function(A,L){if(A)return s(A);s(null,L.toString("binary"))}):be.pbkdf2Sync.length===4?be.pbkdf2Sync(e,t,r,n).toString("binary"):be.pbkdf2Sync(e,t,r,n,i).toString("binary");if((typeof i>"u"||i===null)&&(i="sha1"),typeof i=="string"){if(!(i in _t.md.algorithms))throw new Error("Unknown hash algorithm: "+i);i=_t.md[i].create()}var a=i.digestLength;if(n>4294967295*a){var o=new Error("Derived key is too long.");if(s)return s(o);throw o}var f=Math.ceil(n/a),c=n-(f-1)*a,u=_t.hmac.create();u.start(i,e);var h="",l,d,p;if(!s){for(var g=1;g<=f;++g){u.start(null,null),u.update(t),u.update(_t.util.int32ToBytes(g)),l=p=u.digest().getBytes();for(var x=2;x<=r;++x)u.start(null,null),u.update(p),d=u.digest().getBytes(),l=_t.util.xorBytes(l,d,a),p=d;h+=g<f?l:l.substr(0,c)}return h}var g=1,x;function v(){if(g>f)return s(null,h);u.start(null,null),u.update(t),u.update(_t.util.int32ToBytes(g)),l=p=u.digest().getBytes(),x=2,B()}function B(){if(x<=r)return u.start(null,null),u.update(p),d=u.digest().getBytes(),l=_t.util.xorBytes(l,d,a),p=d,++x,_t.util.setImmediate(B);h+=g<f?l:l.substr(0,c),++g,v()}v()}});var Go=P((t2,Ho)=>{var kn=X();dt();var zo=Ho.exports=kn.pem=kn.pem||{};zo.encode=function(e,t){t=t||{};var r="-----BEGIN "+e.type+`-----\r
`,n;if(e.procType&&(n={name:"Proc-Type",values:[String(e.procType.version),e.procType.type]},r+=Ln(n)),e.contentDomain&&(n={name:"Content-Domain",values:[e.contentDomain]},r+=Ln(n)),e.dekInfo&&(n={name:"DEK-Info",values:[e.dekInfo.algorithm]},e.dekInfo.parameters&&n.values.push(e.dekInfo.parameters),r+=Ln(n)),e.headers)for(var i=0;i<e.headers.length;++i)r+=Ln(e.headers[i]);return e.procType&&(r+=`\r
`),r+=kn.util.encode64(e.body,t.maxline||64)+`\r
`,r+="-----END "+e.type+`-----\r
`,r};zo.decode=function(e){for(var t=[],r=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,n=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,i=/\r?\n/,s;s=r.exec(e),!!s;){var a=s[1];a==="NEW CERTIFICATE REQUEST"&&(a="CERTIFICATE REQUEST");var o={type:a,procType:null,contentDomain:null,dekInfo:null,headers:[],body:kn.util.decode64(s[3])};if(t.push(o),!!s[2]){for(var f=s[2].split(i),c=0;s&&c<f.length;){for(var u=f[c].replace(/\s+$/,""),h=c+1;h<f.length;++h){var l=f[h];if(!/\s/.test(l[0]))break;u+=l,c=h}if(s=u.match(n),s){for(var d={name:s[1],values:[]},p=s[2].split(","),g=0;g<p.length;++g)d.values.push(yh(p[g]));if(o.procType)if(!o.contentDomain&&d.name==="Content-Domain")o.contentDomain=p[0]||"";else if(!o.dekInfo&&d.name==="DEK-Info"){if(d.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');o.dekInfo={algorithm:p[0],parameters:p[1]||null}}else o.headers.push(d);else{if(d.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(d.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');o.procType={version:p[0],type:p[1]}}}++c}if(o.procType==="ENCRYPTED"&&!o.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(t.length===0)throw new Error("Invalid PEM formatted message.");return t};function Ln(e){for(var t=e.name+": ",r=[],n=function(f,c){return" "+c},i=0;i<e.values.length;++i)r.push(e.values[i].replace(/^(\S+\r\n)/,n));t+=r.join(",")+`\r
`;for(var s=0,a=-1,i=0;i<t.length;++i,++s)if(s>65&&a!==-1){var o=t[a];o===","?(++a,t=t.substr(0,a)+`\r
 `+t.substr(a)):t=t.substr(0,a)+`\r
`+o+t.substr(a+1),s=i-a-1,a=-1,++i}else(t[i]===" "||t[i]==="	"||t[i]===",")&&(a=i);return t}function yh(e){return e.replace(/^\s+/,"")}});var Xo=P((e2,Qo)=>{var ie=X();Qe();dt();var $o=Qo.exports=ie.sha256=ie.sha256||{};ie.md.sha256=ie.md.algorithms.sha256=$o;$o.create=function(){Zo||gh();var e=null,t=ie.util.createBuffer(),r=new Array(64),n={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var i=n.messageLengthSize/4,s=0;s<i;++s)n.fullMessageLength.push(0);return t=ie.util.createBuffer(),e={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},n},n.start(),n.update=function(i,s){s==="utf8"&&(i=ie.util.encodeUtf8(i));var a=i.length;n.messageLength+=a,a=[a/4294967296>>>0,a>>>0];for(var o=n.fullMessageLength.length-1;o>=0;--o)n.fullMessageLength[o]+=a[1],a[1]=a[0]+(n.fullMessageLength[o]/4294967296>>>0),n.fullMessageLength[o]=n.fullMessageLength[o]>>>0,a[0]=a[1]/4294967296>>>0;return t.putBytes(i),Wo(e,r,t),(t.read>2048||t.length()===0)&&t.compact(),n},n.digest=function(){var i=ie.util.createBuffer();i.putBytes(t.bytes());var s=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,a=s&n.blockLength-1;i.putBytes(hs.substr(0,n.blockLength-a));for(var o,f,c=n.fullMessageLength[0]*8,u=0;u<n.fullMessageLength.length-1;++u)o=n.fullMessageLength[u+1]*8,f=o/4294967296>>>0,c+=f,i.putInt32(c>>>0),c=o>>>0;i.putInt32(c);var h={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3,h4:e.h4,h5:e.h5,h6:e.h6,h7:e.h7};Wo(h,r,i);var l=ie.util.createBuffer();return l.putInt32(h.h0),l.putInt32(h.h1),l.putInt32(h.h2),l.putInt32(h.h3),l.putInt32(h.h4),l.putInt32(h.h5),l.putInt32(h.h6),l.putInt32(h.h7),l},n};var hs=null,Zo=!1,Yo=null;function gh(){hs=String.fromCharCode(128),hs+=ie.util.fillString(String.fromCharCode(0),64),Yo=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],Zo=!0}function Wo(e,t,r){for(var n,i,s,a,o,f,c,u,h,l,d,p,g,x,v,B=r.length();B>=64;){for(c=0;c<16;++c)t[c]=r.getInt32();for(;c<64;++c)n=t[c-2],n=(n>>>17|n<<15)^(n>>>19|n<<13)^n>>>10,i=t[c-15],i=(i>>>7|i<<25)^(i>>>18|i<<14)^i>>>3,t[c]=n+t[c-7]+i+t[c-16]|0;for(u=e.h0,h=e.h1,l=e.h2,d=e.h3,p=e.h4,g=e.h5,x=e.h6,v=e.h7,c=0;c<64;++c)a=(p>>>6|p<<26)^(p>>>11|p<<21)^(p>>>25|p<<7),o=x^p&(g^x),s=(u>>>2|u<<30)^(u>>>13|u<<19)^(u>>>22|u<<10),f=u&h|l&(u^h),n=v+a+o+Yo[c]+t[c],i=s+f,v=x,x=g,g=p,p=d+n>>>0,d=l,l=h,h=u,u=n+i>>>0;e.h0=e.h0+u|0,e.h1=e.h1+h|0,e.h2=e.h2+l|0,e.h3=e.h3+d|0,e.h4=e.h4+p|0,e.h5=e.h5+g|0,e.h6=e.h6+x|0,e.h7=e.h7+v|0,B-=64}}});var jo=P((r2,Jo)=>{var se=X();dt();var Pn=null;se.util.isNodejs&&!se.options.usePureJavaScript&&!process.versions["node-webkit"]&&(Pn=yr());var mh=Jo.exports=se.prng=se.prng||{};mh.create=function(e){for(var t={plugin:e,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},r=e.md,n=new Array(32),i=0;i<32;++i)n[i]=r.create();t.pools=n,t.pool=0,t.generate=function(c,u){if(!u)return t.generateSync(c);var h=t.plugin.cipher,l=t.plugin.increment,d=t.plugin.formatKey,p=t.plugin.formatSeed,g=se.util.createBuffer();t.key=null,x();function x(v){if(v)return u(v);if(g.length()>=c)return u(null,g.getBytes(c));if(t.generated>1048575&&(t.key=null),t.key===null)return se.util.nextTick(function(){s(x)});var B=h(t.key,t.seed);t.generated+=B.length,g.putBytes(B),t.key=d(h(t.key,l(t.seed))),t.seed=p(h(t.key,t.seed)),se.util.setImmediate(x)}},t.generateSync=function(c){var u=t.plugin.cipher,h=t.plugin.increment,l=t.plugin.formatKey,d=t.plugin.formatSeed;t.key=null;for(var p=se.util.createBuffer();p.length()<c;){t.generated>1048575&&(t.key=null),t.key===null&&a();var g=u(t.key,t.seed);t.generated+=g.length,p.putBytes(g),t.key=l(u(t.key,h(t.seed))),t.seed=d(u(t.key,t.seed))}return p.getBytes(c)};function s(c){if(t.pools[0].messageLength>=32)return o(),c();var u=32-t.pools[0].messageLength<<5;t.seedFile(u,function(h,l){if(h)return c(h);t.collect(l),o(),c()})}function a(){if(t.pools[0].messageLength>=32)return o();var c=32-t.pools[0].messageLength<<5;t.collect(t.seedFileSync(c)),o()}function o(){t.reseeds=t.reseeds===4294967295?0:t.reseeds+1;var c=t.plugin.md.create();c.update(t.keyBytes);for(var u=1,h=0;h<32;++h)t.reseeds%u===0&&(c.update(t.pools[h].digest().getBytes()),t.pools[h].start()),u=u<<1;t.keyBytes=c.digest().getBytes(),c.start(),c.update(t.keyBytes);var l=c.digest().getBytes();t.key=t.plugin.formatKey(t.keyBytes),t.seed=t.plugin.formatSeed(l),t.generated=0}function f(c){var u=null,h=se.util.globalScope,l=h.crypto||h.msCrypto;l&&l.getRandomValues&&(u=function(T){return l.getRandomValues(T)});var d=se.util.createBuffer();if(u)for(;d.length()<c;){var p=Math.max(1,Math.min(c-d.length(),65536)/4),g=new Uint32Array(Math.floor(p));try{u(g);for(var x=0;x<g.length;++x)d.putInt32(g[x])}catch(T){if(!(typeof QuotaExceededError<"u"&&T instanceof QuotaExceededError))throw T}}if(d.length()<c)for(var v,B,A,L=Math.floor(Math.random()*65536);d.length()<c;){B=16807*(L&65535),v=16807*(L>>16),B+=(v&32767)<<16,B+=v>>15,B=(B&2147483647)+(B>>31),L=B&4294967295;for(var x=0;x<3;++x)A=L>>>(x<<3),A^=Math.floor(Math.random()*256),d.putByte(A&255)}return d.getBytes(c)}return Pn?(t.seedFile=function(c,u){Pn.randomBytes(c,function(h,l){if(h)return u(h);u(null,l.toString())})},t.seedFileSync=function(c){return Pn.randomBytes(c).toString()}):(t.seedFile=function(c,u){try{u(null,f(c))}catch(h){u(h)}},t.seedFileSync=f),t.collect=function(c){for(var u=c.length,h=0;h<u;++h)t.pools[t.pool].update(c.substr(h,1)),t.pool=t.pool===31?0:t.pool+1},t.collectInt=function(c,u){for(var h="",l=0;l<u;l+=8)h+=String.fromCharCode(c>>l&255);t.collect(h)},t.registerWorker=function(c){if(c===self)t.seedFile=function(h,l){function d(p){var g=p.data;g.forge&&g.forge.prng&&(self.removeEventListener("message",d),l(g.forge.prng.err,g.forge.prng.bytes))}self.addEventListener("message",d),self.postMessage({forge:{prng:{needed:h}}})};else{var u=function(h){var l=h.data;l.forge&&l.forge.prng&&t.seedFile(l.forge.prng.needed,function(d,p){c.postMessage({forge:{prng:{err:d,bytes:p}}})})};c.addEventListener("message",u)}},t}});var zr=P((n2,ls)=>{var wt=X();us();Xo();jo();dt();(function(){if(wt.random&&wt.random.getBytes){ls.exports=wt.random;return}(function(e){var t={},r=new Array(4),n=wt.util.createBuffer();t.formatKey=function(h){var l=wt.util.createBuffer(h);return h=new Array(4),h[0]=l.getInt32(),h[1]=l.getInt32(),h[2]=l.getInt32(),h[3]=l.getInt32(),wt.aes._expandKey(h,!1)},t.formatSeed=function(h){var l=wt.util.createBuffer(h);return h=new Array(4),h[0]=l.getInt32(),h[1]=l.getInt32(),h[2]=l.getInt32(),h[3]=l.getInt32(),h},t.cipher=function(h,l){return wt.aes._updateBlock(h,l,r,!1),n.putInt32(r[0]),n.putInt32(r[1]),n.putInt32(r[2]),n.putInt32(r[3]),n.getBytes()},t.increment=function(h){return++h[3],h},t.md=wt.md.sha256;function i(){var h=wt.prng.create(t);return h.getBytes=function(l,d){return h.generate(l,d)},h.getBytesSync=function(l){return h.generate(l)},h}var s=i(),a=null,o=wt.util.globalScope,f=o.crypto||o.msCrypto;if(f&&f.getRandomValues&&(a=function(h){return f.getRandomValues(h)}),wt.options.usePureJavaScript||!wt.util.isNodejs&&!a){if(typeof window>"u"||window.document,s.collectInt(+new Date,32),typeof navigator<"u"){var c="";for(var u in navigator)try{typeof navigator[u]=="string"&&(c+=navigator[u])}catch{}s.collect(c),c=null}e&&(e().mousemove(function(h){s.collectInt(h.clientX,16),s.collectInt(h.clientY,16)}),e().keypress(function(h){s.collectInt(h.charCode,8)}))}if(!wt.random)wt.random=s;else for(var u in s)wt.random[u]=s[u];wt.random.createInstance=i,ls.exports=wt.random})(typeof jQuery<"u"?jQuery:null)})()});var n0=P((i2,r0)=>{var Nt=X();dt();var ps=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],t0=[1,2,3,5],xh=function(e,t){return e<<t&65535|(e&65535)>>16-t},vh=function(e,t){return(e&65535)>>t|e<<16-t&65535};r0.exports=Nt.rc2=Nt.rc2||{};Nt.rc2.expandKey=function(e,t){typeof e=="string"&&(e=Nt.util.createBuffer(e)),t=t||128;var r=e,n=e.length(),i=t,s=Math.ceil(i/8),a=255>>(i&7),o;for(o=n;o<128;o++)r.putByte(ps[r.at(o-1)+r.at(o-n)&255]);for(r.setAt(128-s,ps[r.at(128-s)&a]),o=127-s;o>=0;o--)r.setAt(o,ps[r.at(o+1)^r.at(o+s)]);return r};var e0=function(e,t,r){var n=!1,i=null,s=null,a=null,o,f,c,u,h=[];for(e=Nt.rc2.expandKey(e,t),c=0;c<64;c++)h.push(e.getInt16Le());r?(o=function(p){for(c=0;c<4;c++)p[c]+=h[u]+(p[(c+3)%4]&p[(c+2)%4])+(~p[(c+3)%4]&p[(c+1)%4]),p[c]=xh(p[c],t0[c]),u++},f=function(p){for(c=0;c<4;c++)p[c]+=h[p[(c+3)%4]&63]}):(o=function(p){for(c=3;c>=0;c--)p[c]=vh(p[c],t0[c]),p[c]-=h[u]+(p[(c+3)%4]&p[(c+2)%4])+(~p[(c+3)%4]&p[(c+1)%4]),u--},f=function(p){for(c=3;c>=0;c--)p[c]-=h[p[(c+3)%4]&63]});var l=function(p){var g=[];for(c=0;c<4;c++){var x=i.getInt16Le();a!==null&&(r?x^=a.getInt16Le():a.putInt16Le(x)),g.push(x&65535)}u=r?0:63;for(var v=0;v<p.length;v++)for(var B=0;B<p[v][0];B++)p[v][1](g);for(c=0;c<4;c++)a!==null&&(r?a.putInt16Le(g[c]):g[c]^=a.getInt16Le()),s.putInt16Le(g[c])},d=null;return d={start:function(p,g){p&&typeof p=="string"&&(p=Nt.util.createBuffer(p)),n=!1,i=Nt.util.createBuffer(),s=g||new Nt.util.createBuffer,a=p,d.output=s},update:function(p){for(n||i.putBuffer(p);i.length()>=8;)l([[5,o],[1,f],[6,o],[1,f],[5,o]])},finish:function(p){var g=!0;if(r)if(p)g=p(8,i,!r);else{var x=i.length()===8?8:8-i.length();i.fillWithByte(x,x)}if(g&&(n=!0,d.update()),!r&&(g=i.length()===0,g))if(p)g=p(8,s,!r);else{var v=s.length(),B=s.at(v-1);B>v?g=!1:s.truncate(B)}return g}},d};Nt.rc2.startEncrypting=function(e,t,r){var n=Nt.rc2.createEncryptionCipher(e,128);return n.start(t,r),n};Nt.rc2.createEncryptionCipher=function(e,t){return e0(e,t,!0)};Nt.rc2.startDecrypting=function(e,t,r){var n=Nt.rc2.createDecryptionCipher(e,128);return n.start(t,r),n};Nt.rc2.createDecryptionCipher=function(e,t){return e0(e,t,!1)}});var On=P((s2,h0)=>{var ds=X();h0.exports=ds.jsbn=ds.jsbn||{};var we,bh=0xdeadbeefcafe,i0=(bh&16777215)==15715070;function w(e,t,r){this.data=[],e!=null&&(typeof e=="number"?this.fromNumber(e,t,r):t==null&&typeof e!="string"?this.fromString(e,256):this.fromString(e,t))}ds.jsbn.BigInteger=w;function G(){return new w(null)}function wh(e,t,r,n,i,s){for(;--s>=0;){var a=t*this.data[e++]+r.data[n]+i;i=Math.floor(a/67108864),r.data[n++]=a&67108863}return i}function Sh(e,t,r,n,i,s){for(var a=t&32767,o=t>>15;--s>=0;){var f=this.data[e]&32767,c=this.data[e++]>>15,u=o*f+c*a;f=a*f+((u&32767)<<15)+r.data[n]+(i&1073741823),i=(f>>>30)+(u>>>15)+o*c+(i>>>30),r.data[n++]=f&1073741823}return i}function s0(e,t,r,n,i,s){for(var a=t&16383,o=t>>14;--s>=0;){var f=this.data[e]&16383,c=this.data[e++]>>14,u=o*f+c*a;f=a*f+((u&16383)<<14)+r.data[n]+i,i=(f>>28)+(u>>14)+o*c,r.data[n++]=f&268435455}return i}typeof navigator>"u"?(w.prototype.am=s0,we=28):i0&&navigator.appName=="Microsoft Internet Explorer"?(w.prototype.am=Sh,we=30):i0&&navigator.appName!="Netscape"?(w.prototype.am=wh,we=26):(w.prototype.am=s0,we=28);w.prototype.DB=we;w.prototype.DM=(1<<we)-1;w.prototype.DV=1<<we;var ys=52;w.prototype.FV=Math.pow(2,ys);w.prototype.F1=ys-we;w.prototype.F2=2*we-ys;var Eh="0123456789abcdefghijklmnopqrstuvwxyz",Un=new Array,gr,Mt;gr="0".charCodeAt(0);for(Mt=0;Mt<=9;++Mt)Un[gr++]=Mt;gr="a".charCodeAt(0);for(Mt=10;Mt<36;++Mt)Un[gr++]=Mt;gr="A".charCodeAt(0);for(Mt=10;Mt<36;++Mt)Un[gr++]=Mt;function a0(e){return Eh.charAt(e)}function o0(e,t){var r=Un[e.charCodeAt(t)];return r??-1}function Bh(e){for(var t=this.t-1;t>=0;--t)e.data[t]=this.data[t];e.t=this.t,e.s=this.s}function Ah(e){this.t=1,this.s=e<0?-1:0,e>0?this.data[0]=e:e<-1?this.data[0]=e+this.DV:this.t=0}function De(e){var t=G();return t.fromInt(e),t}function Ch(e,t){var r;if(t==16)r=4;else if(t==8)r=3;else if(t==256)r=8;else if(t==2)r=1;else if(t==32)r=5;else if(t==4)r=2;else{this.fromRadix(e,t);return}this.t=0,this.s=0;for(var n=e.length,i=!1,s=0;--n>=0;){var a=r==8?e[n]&255:o0(e,n);if(a<0){e.charAt(n)=="-"&&(i=!0);continue}i=!1,s==0?this.data[this.t++]=a:s+r>this.DB?(this.data[this.t-1]|=(a&(1<<this.DB-s)-1)<<s,this.data[this.t++]=a>>this.DB-s):this.data[this.t-1]|=a<<s,s+=r,s>=this.DB&&(s-=this.DB)}r==8&&e[0]&128&&(this.s=-1,s>0&&(this.data[this.t-1]|=(1<<this.DB-s)-1<<s)),this.clamp(),i&&w.ZERO.subTo(this,this)}function Th(){for(var e=this.s&this.DM;this.t>0&&this.data[this.t-1]==e;)--this.t}function Ih(e){if(this.s<0)return"-"+this.negate().toString(e);var t;if(e==16)t=4;else if(e==8)t=3;else if(e==2)t=1;else if(e==32)t=5;else if(e==4)t=2;else return this.toRadix(e);var r=(1<<t)-1,n,i=!1,s="",a=this.t,o=this.DB-a*this.DB%t;if(a-- >0)for(o<this.DB&&(n=this.data[a]>>o)>0&&(i=!0,s=a0(n));a>=0;)o<t?(n=(this.data[a]&(1<<o)-1)<<t-o,n|=this.data[--a]>>(o+=this.DB-t)):(n=this.data[a]>>(o-=t)&r,o<=0&&(o+=this.DB,--a)),n>0&&(i=!0),i&&(s+=a0(n));return i?s:"0"}function _h(){var e=G();return w.ZERO.subTo(this,e),e}function Rh(){return this.s<0?this.negate():this}function Nh(e){var t=this.s-e.s;if(t!=0)return t;var r=this.t;if(t=r-e.t,t!=0)return this.s<0?-t:t;for(;--r>=0;)if((t=this.data[r]-e.data[r])!=0)return t;return 0}function Kn(e){var t=1,r;return(r=e>>>16)!=0&&(e=r,t+=16),(r=e>>8)!=0&&(e=r,t+=8),(r=e>>4)!=0&&(e=r,t+=4),(r=e>>2)!=0&&(e=r,t+=2),(r=e>>1)!=0&&(e=r,t+=1),t}function Dh(){return this.t<=0?0:this.DB*(this.t-1)+Kn(this.data[this.t-1]^this.s&this.DM)}function Lh(e,t){var r;for(r=this.t-1;r>=0;--r)t.data[r+e]=this.data[r];for(r=e-1;r>=0;--r)t.data[r]=0;t.t=this.t+e,t.s=this.s}function kh(e,t){for(var r=e;r<this.t;++r)t.data[r-e]=this.data[r];t.t=Math.max(this.t-e,0),t.s=this.s}function Ph(e,t){var r=e%this.DB,n=this.DB-r,i=(1<<n)-1,s=Math.floor(e/this.DB),a=this.s<<r&this.DM,o;for(o=this.t-1;o>=0;--o)t.data[o+s+1]=this.data[o]>>n|a,a=(this.data[o]&i)<<r;for(o=s-1;o>=0;--o)t.data[o]=0;t.data[s]=a,t.t=this.t+s+1,t.s=this.s,t.clamp()}function Uh(e,t){t.s=this.s;var r=Math.floor(e/this.DB);if(r>=this.t){t.t=0;return}var n=e%this.DB,i=this.DB-n,s=(1<<n)-1;t.data[0]=this.data[r]>>n;for(var a=r+1;a<this.t;++a)t.data[a-r-1]|=(this.data[a]&s)<<i,t.data[a-r]=this.data[a]>>n;n>0&&(t.data[this.t-r-1]|=(this.s&s)<<i),t.t=this.t-r,t.clamp()}function Kh(e,t){for(var r=0,n=0,i=Math.min(e.t,this.t);r<i;)n+=this.data[r]-e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n-=e.s;r<this.t;)n+=this.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n-=e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n-=e.s}t.s=n<0?-1:0,n<-1?t.data[r++]=this.DV+n:n>0&&(t.data[r++]=n),t.t=r,t.clamp()}function Oh(e,t){var r=this.abs(),n=e.abs(),i=r.t;for(t.t=i+n.t;--i>=0;)t.data[i]=0;for(i=0;i<n.t;++i)t.data[i+r.t]=r.am(0,n.data[i],t,i,0,r.t);t.s=0,t.clamp(),this.s!=e.s&&w.ZERO.subTo(t,t)}function Mh(e){for(var t=this.abs(),r=e.t=2*t.t;--r>=0;)e.data[r]=0;for(r=0;r<t.t-1;++r){var n=t.am(r,t.data[r],e,2*r,0,1);(e.data[r+t.t]+=t.am(r+1,2*t.data[r],e,2*r+1,n,t.t-r-1))>=t.DV&&(e.data[r+t.t]-=t.DV,e.data[r+t.t+1]=1)}e.t>0&&(e.data[e.t-1]+=t.am(r,t.data[r],e,2*r,0,1)),e.s=0,e.clamp()}function Fh(e,t,r){var n=e.abs();if(!(n.t<=0)){var i=this.abs();if(i.t<n.t){t?.fromInt(0),r!=null&&this.copyTo(r);return}r==null&&(r=G());var s=G(),a=this.s,o=e.s,f=this.DB-Kn(n.data[n.t-1]);f>0?(n.lShiftTo(f,s),i.lShiftTo(f,r)):(n.copyTo(s),i.copyTo(r));var c=s.t,u=s.data[c-1];if(u!=0){var h=u*(1<<this.F1)+(c>1?s.data[c-2]>>this.F2:0),l=this.FV/h,d=(1<<this.F1)/h,p=1<<this.F2,g=r.t,x=g-c,v=t??G();for(s.dlShiftTo(x,v),r.compareTo(v)>=0&&(r.data[r.t++]=1,r.subTo(v,r)),w.ONE.dlShiftTo(c,v),v.subTo(s,s);s.t<c;)s.data[s.t++]=0;for(;--x>=0;){var B=r.data[--g]==u?this.DM:Math.floor(r.data[g]*l+(r.data[g-1]+p)*d);if((r.data[g]+=s.am(0,B,r,x,0,c))<B)for(s.dlShiftTo(x,v),r.subTo(v,r);r.data[g]<--B;)r.subTo(v,r)}t!=null&&(r.drShiftTo(c,t),a!=o&&w.ZERO.subTo(t,t)),r.t=c,r.clamp(),f>0&&r.rShiftTo(f,r),a<0&&w.ZERO.subTo(r,r)}}}function Vh(e){var t=G();return this.abs().divRemTo(e,null,t),this.s<0&&t.compareTo(w.ZERO)>0&&e.subTo(t,t),t}function Xe(e){this.m=e}function qh(e){return e.s<0||e.compareTo(this.m)>=0?e.mod(this.m):e}function zh(e){return e}function Hh(e){e.divRemTo(this.m,null,e)}function Gh(e,t,r){e.multiplyTo(t,r),this.reduce(r)}function Wh(e,t){e.squareTo(t),this.reduce(t)}Xe.prototype.convert=qh;Xe.prototype.revert=zh;Xe.prototype.reduce=Hh;Xe.prototype.mulTo=Gh;Xe.prototype.sqrTo=Wh;function $h(){if(this.t<1)return 0;var e=this.data[0];if(!(e&1))return 0;var t=e&3;return t=t*(2-(e&15)*t)&15,t=t*(2-(e&255)*t)&255,t=t*(2-((e&65535)*t&65535))&65535,t=t*(2-e*t%this.DV)%this.DV,t>0?this.DV-t:-t}function Je(e){this.m=e,this.mp=e.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<e.DB-15)-1,this.mt2=2*e.t}function Zh(e){var t=G();return e.abs().dlShiftTo(this.m.t,t),t.divRemTo(this.m,null,t),e.s<0&&t.compareTo(w.ZERO)>0&&this.m.subTo(t,t),t}function Yh(e){var t=G();return e.copyTo(t),this.reduce(t),t}function Qh(e){for(;e.t<=this.mt2;)e.data[e.t++]=0;for(var t=0;t<this.m.t;++t){var r=e.data[t]&32767,n=r*this.mpl+((r*this.mph+(e.data[t]>>15)*this.mpl&this.um)<<15)&e.DM;for(r=t+this.m.t,e.data[r]+=this.m.am(0,n,e,t,0,this.m.t);e.data[r]>=e.DV;)e.data[r]-=e.DV,e.data[++r]++}e.clamp(),e.drShiftTo(this.m.t,e),e.compareTo(this.m)>=0&&e.subTo(this.m,e)}function Xh(e,t){e.squareTo(t),this.reduce(t)}function Jh(e,t,r){e.multiplyTo(t,r),this.reduce(r)}Je.prototype.convert=Zh;Je.prototype.revert=Yh;Je.prototype.reduce=Qh;Je.prototype.mulTo=Jh;Je.prototype.sqrTo=Xh;function jh(){return(this.t>0?this.data[0]&1:this.s)==0}function tl(e,t){if(e>4294967295||e<1)return w.ONE;var r=G(),n=G(),i=t.convert(this),s=Kn(e)-1;for(i.copyTo(r);--s>=0;)if(t.sqrTo(r,n),(e&1<<s)>0)t.mulTo(n,i,r);else{var a=r;r=n,n=a}return t.revert(r)}function el(e,t){var r;return e<256||t.isEven()?r=new Xe(t):r=new Je(t),this.exp(e,r)}w.prototype.copyTo=Bh;w.prototype.fromInt=Ah;w.prototype.fromString=Ch;w.prototype.clamp=Th;w.prototype.dlShiftTo=Lh;w.prototype.drShiftTo=kh;w.prototype.lShiftTo=Ph;w.prototype.rShiftTo=Uh;w.prototype.subTo=Kh;w.prototype.multiplyTo=Oh;w.prototype.squareTo=Mh;w.prototype.divRemTo=Fh;w.prototype.invDigit=$h;w.prototype.isEven=jh;w.prototype.exp=tl;w.prototype.toString=Ih;w.prototype.negate=_h;w.prototype.abs=Rh;w.prototype.compareTo=Nh;w.prototype.bitLength=Dh;w.prototype.mod=Vh;w.prototype.modPowInt=el;w.ZERO=De(0);w.ONE=De(1);function rl(){var e=G();return this.copyTo(e),e}function nl(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this.data[0];if(this.t==0)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function il(){return this.t==0?this.s:this.data[0]<<24>>24}function sl(){return this.t==0?this.s:this.data[0]<<16>>16}function al(e){return Math.floor(Math.LN2*this.DB/Math.log(e))}function ol(){return this.s<0?-1:this.t<=0||this.t==1&&this.data[0]<=0?0:1}function fl(e){if(e==null&&(e=10),this.signum()==0||e<2||e>36)return"0";var t=this.chunkSize(e),r=Math.pow(e,t),n=De(r),i=G(),s=G(),a="";for(this.divRemTo(n,i,s);i.signum()>0;)a=(r+s.intValue()).toString(e).substr(1)+a,i.divRemTo(n,i,s);return s.intValue().toString(e)+a}function cl(e,t){this.fromInt(0),t==null&&(t=10);for(var r=this.chunkSize(t),n=Math.pow(t,r),i=!1,s=0,a=0,o=0;o<e.length;++o){var f=o0(e,o);if(f<0){e.charAt(o)=="-"&&this.signum()==0&&(i=!0);continue}a=t*a+f,++s>=r&&(this.dMultiply(n),this.dAddOffset(a,0),s=0,a=0)}s>0&&(this.dMultiply(Math.pow(t,s)),this.dAddOffset(a,0)),i&&w.ZERO.subTo(this,this)}function ul(e,t,r){if(typeof t=="number")if(e<2)this.fromInt(1);else for(this.fromNumber(e,r),this.testBit(e-1)||this.bitwiseTo(w.ONE.shiftLeft(e-1),gs,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(t);)this.dAddOffset(2,0),this.bitLength()>e&&this.subTo(w.ONE.shiftLeft(e-1),this);else{var n=new Array,i=e&7;n.length=(e>>3)+1,t.nextBytes(n),i>0?n[0]&=(1<<i)-1:n[0]=0,this.fromString(n,256)}}function hl(){var e=this.t,t=new Array;t[0]=this.s;var r=this.DB-e*this.DB%8,n,i=0;if(e-- >0)for(r<this.DB&&(n=this.data[e]>>r)!=(this.s&this.DM)>>r&&(t[i++]=n|this.s<<this.DB-r);e>=0;)r<8?(n=(this.data[e]&(1<<r)-1)<<8-r,n|=this.data[--e]>>(r+=this.DB-8)):(n=this.data[e]>>(r-=8)&255,r<=0&&(r+=this.DB,--e)),n&128&&(n|=-256),i==0&&(this.s&128)!=(n&128)&&++i,(i>0||n!=this.s)&&(t[i++]=n);return t}function ll(e){return this.compareTo(e)==0}function pl(e){return this.compareTo(e)<0?this:e}function dl(e){return this.compareTo(e)>0?this:e}function yl(e,t,r){var n,i,s=Math.min(e.t,this.t);for(n=0;n<s;++n)r.data[n]=t(this.data[n],e.data[n]);if(e.t<this.t){for(i=e.s&this.DM,n=s;n<this.t;++n)r.data[n]=t(this.data[n],i);r.t=this.t}else{for(i=this.s&this.DM,n=s;n<e.t;++n)r.data[n]=t(i,e.data[n]);r.t=e.t}r.s=t(this.s,e.s),r.clamp()}function gl(e,t){return e&t}function ml(e){var t=G();return this.bitwiseTo(e,gl,t),t}function gs(e,t){return e|t}function xl(e){var t=G();return this.bitwiseTo(e,gs,t),t}function f0(e,t){return e^t}function vl(e){var t=G();return this.bitwiseTo(e,f0,t),t}function c0(e,t){return e&~t}function bl(e){var t=G();return this.bitwiseTo(e,c0,t),t}function wl(){for(var e=G(),t=0;t<this.t;++t)e.data[t]=this.DM&~this.data[t];return e.t=this.t,e.s=~this.s,e}function Sl(e){var t=G();return e<0?this.rShiftTo(-e,t):this.lShiftTo(e,t),t}function El(e){var t=G();return e<0?this.lShiftTo(-e,t):this.rShiftTo(e,t),t}function Bl(e){if(e==0)return-1;var t=0;return e&65535||(e>>=16,t+=16),e&255||(e>>=8,t+=8),e&15||(e>>=4,t+=4),e&3||(e>>=2,t+=2),e&1||++t,t}function Al(){for(var e=0;e<this.t;++e)if(this.data[e]!=0)return e*this.DB+Bl(this.data[e]);return this.s<0?this.t*this.DB:-1}function Cl(e){for(var t=0;e!=0;)e&=e-1,++t;return t}function Tl(){for(var e=0,t=this.s&this.DM,r=0;r<this.t;++r)e+=Cl(this.data[r]^t);return e}function Il(e){var t=Math.floor(e/this.DB);return t>=this.t?this.s!=0:(this.data[t]&1<<e%this.DB)!=0}function _l(e,t){var r=w.ONE.shiftLeft(e);return this.bitwiseTo(r,t,r),r}function Rl(e){return this.changeBit(e,gs)}function Nl(e){return this.changeBit(e,c0)}function Dl(e){return this.changeBit(e,f0)}function Ll(e,t){for(var r=0,n=0,i=Math.min(e.t,this.t);r<i;)n+=this.data[r]+e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n+=e.s;r<this.t;)n+=this.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n+=e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n+=e.s}t.s=n<0?-1:0,n>0?t.data[r++]=n:n<-1&&(t.data[r++]=this.DV+n),t.t=r,t.clamp()}function kl(e){var t=G();return this.addTo(e,t),t}function Pl(e){var t=G();return this.subTo(e,t),t}function Ul(e){var t=G();return this.multiplyTo(e,t),t}function Kl(e){var t=G();return this.divRemTo(e,t,null),t}function Ol(e){var t=G();return this.divRemTo(e,null,t),t}function Ml(e){var t=G(),r=G();return this.divRemTo(e,t,r),new Array(t,r)}function Fl(e){this.data[this.t]=this.am(0,e-1,this,0,0,this.t),++this.t,this.clamp()}function Vl(e,t){if(e!=0){for(;this.t<=t;)this.data[this.t++]=0;for(this.data[t]+=e;this.data[t]>=this.DV;)this.data[t]-=this.DV,++t>=this.t&&(this.data[this.t++]=0),++this.data[t]}}function Hr(){}function u0(e){return e}function ql(e,t,r){e.multiplyTo(t,r)}function zl(e,t){e.squareTo(t)}Hr.prototype.convert=u0;Hr.prototype.revert=u0;Hr.prototype.mulTo=ql;Hr.prototype.sqrTo=zl;function Hl(e){return this.exp(e,new Hr)}function Gl(e,t,r){var n=Math.min(this.t+e.t,t);for(r.s=0,r.t=n;n>0;)r.data[--n]=0;var i;for(i=r.t-this.t;n<i;++n)r.data[n+this.t]=this.am(0,e.data[n],r,n,0,this.t);for(i=Math.min(e.t,t);n<i;++n)this.am(0,e.data[n],r,n,0,t-n);r.clamp()}function Wl(e,t,r){--t;var n=r.t=this.t+e.t-t;for(r.s=0;--n>=0;)r.data[n]=0;for(n=Math.max(t-this.t,0);n<e.t;++n)r.data[this.t+n-t]=this.am(t-n,e.data[n],r,0,0,this.t+n-t);r.clamp(),r.drShiftTo(1,r)}function mr(e){this.r2=G(),this.q3=G(),w.ONE.dlShiftTo(2*e.t,this.r2),this.mu=this.r2.divide(e),this.m=e}function $l(e){if(e.s<0||e.t>2*this.m.t)return e.mod(this.m);if(e.compareTo(this.m)<0)return e;var t=G();return e.copyTo(t),this.reduce(t),t}function Zl(e){return e}function Yl(e){for(e.drShiftTo(this.m.t-1,this.r2),e.t>this.m.t+1&&(e.t=this.m.t+1,e.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);e.compareTo(this.r2)<0;)e.dAddOffset(1,this.m.t+1);for(e.subTo(this.r2,e);e.compareTo(this.m)>=0;)e.subTo(this.m,e)}function Ql(e,t){e.squareTo(t),this.reduce(t)}function Xl(e,t,r){e.multiplyTo(t,r),this.reduce(r)}mr.prototype.convert=$l;mr.prototype.revert=Zl;mr.prototype.reduce=Yl;mr.prototype.mulTo=Xl;mr.prototype.sqrTo=Ql;function Jl(e,t){var r=e.bitLength(),n,i=De(1),s;if(r<=0)return i;r<18?n=1:r<48?n=3:r<144?n=4:r<768?n=5:n=6,r<8?s=new Xe(t):t.isEven()?s=new mr(t):s=new Je(t);var a=new Array,o=3,f=n-1,c=(1<<n)-1;if(a[1]=s.convert(this),n>1){var u=G();for(s.sqrTo(a[1],u);o<=c;)a[o]=G(),s.mulTo(u,a[o-2],a[o]),o+=2}var h=e.t-1,l,d=!0,p=G(),g;for(r=Kn(e.data[h])-1;h>=0;){for(r>=f?l=e.data[h]>>r-f&c:(l=(e.data[h]&(1<<r+1)-1)<<f-r,h>0&&(l|=e.data[h-1]>>this.DB+r-f)),o=n;!(l&1);)l>>=1,--o;if((r-=o)<0&&(r+=this.DB,--h),d)a[l].copyTo(i),d=!1;else{for(;o>1;)s.sqrTo(i,p),s.sqrTo(p,i),o-=2;o>0?s.sqrTo(i,p):(g=i,i=p,p=g),s.mulTo(p,a[l],i)}for(;h>=0&&!(e.data[h]&1<<r);)s.sqrTo(i,p),g=i,i=p,p=g,--r<0&&(r=this.DB-1,--h)}return s.revert(i)}function jl(e){var t=this.s<0?this.negate():this.clone(),r=e.s<0?e.negate():e.clone();if(t.compareTo(r)<0){var n=t;t=r,r=n}var i=t.getLowestSetBit(),s=r.getLowestSetBit();if(s<0)return t;for(i<s&&(s=i),s>0&&(t.rShiftTo(s,t),r.rShiftTo(s,r));t.signum()>0;)(i=t.getLowestSetBit())>0&&t.rShiftTo(i,t),(i=r.getLowestSetBit())>0&&r.rShiftTo(i,r),t.compareTo(r)>=0?(t.subTo(r,t),t.rShiftTo(1,t)):(r.subTo(t,r),r.rShiftTo(1,r));return s>0&&r.lShiftTo(s,r),r}function tp(e){if(e<=0)return 0;var t=this.DV%e,r=this.s<0?e-1:0;if(this.t>0)if(t==0)r=this.data[0]%e;else for(var n=this.t-1;n>=0;--n)r=(t*r+this.data[n])%e;return r}function ep(e){var t=e.isEven();if(this.isEven()&&t||e.signum()==0)return w.ZERO;for(var r=e.clone(),n=this.clone(),i=De(1),s=De(0),a=De(0),o=De(1);r.signum()!=0;){for(;r.isEven();)r.rShiftTo(1,r),t?((!i.isEven()||!s.isEven())&&(i.addTo(this,i),s.subTo(e,s)),i.rShiftTo(1,i)):s.isEven()||s.subTo(e,s),s.rShiftTo(1,s);for(;n.isEven();)n.rShiftTo(1,n),t?((!a.isEven()||!o.isEven())&&(a.addTo(this,a),o.subTo(e,o)),a.rShiftTo(1,a)):o.isEven()||o.subTo(e,o),o.rShiftTo(1,o);r.compareTo(n)>=0?(r.subTo(n,r),t&&i.subTo(a,i),s.subTo(o,s)):(n.subTo(r,n),t&&a.subTo(i,a),o.subTo(s,o))}if(n.compareTo(w.ONE)!=0)return w.ZERO;if(o.compareTo(e)>=0)return o.subtract(e);if(o.signum()<0)o.addTo(e,o);else return o;return o.signum()<0?o.add(e):o}var $t=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],rp=(1<<26)/$t[$t.length-1];function np(e){var t,r=this.abs();if(r.t==1&&r.data[0]<=$t[$t.length-1]){for(t=0;t<$t.length;++t)if(r.data[0]==$t[t])return!0;return!1}if(r.isEven())return!1;for(t=1;t<$t.length;){for(var n=$t[t],i=t+1;i<$t.length&&n<rp;)n*=$t[i++];for(n=r.modInt(n);t<i;)if(n%$t[t++]==0)return!1}return r.millerRabin(e)}function ip(e){var t=this.subtract(w.ONE),r=t.getLowestSetBit();if(r<=0)return!1;for(var n=t.shiftRight(r),i=sp(),s,a=0;a<e;++a){do s=new w(this.bitLength(),i);while(s.compareTo(w.ONE)<=0||s.compareTo(t)>=0);var o=s.modPow(n,this);if(o.compareTo(w.ONE)!=0&&o.compareTo(t)!=0){for(var f=1;f++<r&&o.compareTo(t)!=0;)if(o=o.modPowInt(2,this),o.compareTo(w.ONE)==0)return!1;if(o.compareTo(t)!=0)return!1}}return!0}function sp(){return{nextBytes:function(e){for(var t=0;t<e.length;++t)e[t]=Math.floor(Math.random()*256)}}}w.prototype.chunkSize=al;w.prototype.toRadix=fl;w.prototype.fromRadix=cl;w.prototype.fromNumber=ul;w.prototype.bitwiseTo=yl;w.prototype.changeBit=_l;w.prototype.addTo=Ll;w.prototype.dMultiply=Fl;w.prototype.dAddOffset=Vl;w.prototype.multiplyLowerTo=Gl;w.prototype.multiplyUpperTo=Wl;w.prototype.modInt=tp;w.prototype.millerRabin=ip;w.prototype.clone=rl;w.prototype.intValue=nl;w.prototype.byteValue=il;w.prototype.shortValue=sl;w.prototype.signum=ol;w.prototype.toByteArray=hl;w.prototype.equals=ll;w.prototype.min=pl;w.prototype.max=dl;w.prototype.and=ml;w.prototype.or=xl;w.prototype.xor=vl;w.prototype.andNot=bl;w.prototype.not=wl;w.prototype.shiftLeft=Sl;w.prototype.shiftRight=El;w.prototype.getLowestSetBit=Al;w.prototype.bitCount=Tl;w.prototype.testBit=Il;w.prototype.setBit=Rl;w.prototype.clearBit=Nl;w.prototype.flipBit=Dl;w.prototype.add=kl;w.prototype.subtract=Pl;w.prototype.multiply=Ul;w.prototype.divide=Kl;w.prototype.remainder=Ol;w.prototype.divideAndRemainder=Ml;w.prototype.modPow=Jl;w.prototype.modInverse=ep;w.prototype.pow=Hl;w.prototype.gcd=jl;w.prototype.isProbablePrime=np});var g0=P((a2,y0)=>{var ae=X();Qe();dt();var p0=y0.exports=ae.sha1=ae.sha1||{};ae.md.sha1=ae.md.algorithms.sha1=p0;p0.create=function(){d0||ap();var e=null,t=ae.util.createBuffer(),r=new Array(80),n={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var i=n.messageLengthSize/4,s=0;s<i;++s)n.fullMessageLength.push(0);return t=ae.util.createBuffer(),e={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},n},n.start(),n.update=function(i,s){s==="utf8"&&(i=ae.util.encodeUtf8(i));var a=i.length;n.messageLength+=a,a=[a/4294967296>>>0,a>>>0];for(var o=n.fullMessageLength.length-1;o>=0;--o)n.fullMessageLength[o]+=a[1],a[1]=a[0]+(n.fullMessageLength[o]/4294967296>>>0),n.fullMessageLength[o]=n.fullMessageLength[o]>>>0,a[0]=a[1]/4294967296>>>0;return t.putBytes(i),l0(e,r,t),(t.read>2048||t.length()===0)&&t.compact(),n},n.digest=function(){var i=ae.util.createBuffer();i.putBytes(t.bytes());var s=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,a=s&n.blockLength-1;i.putBytes(ms.substr(0,n.blockLength-a));for(var o,f,c=n.fullMessageLength[0]*8,u=0;u<n.fullMessageLength.length-1;++u)o=n.fullMessageLength[u+1]*8,f=o/4294967296>>>0,c+=f,i.putInt32(c>>>0),c=o>>>0;i.putInt32(c);var h={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3,h4:e.h4};l0(h,r,i);var l=ae.util.createBuffer();return l.putInt32(h.h0),l.putInt32(h.h1),l.putInt32(h.h2),l.putInt32(h.h3),l.putInt32(h.h4),l},n};var ms=null,d0=!1;function ap(){ms=String.fromCharCode(128),ms+=ae.util.fillString(String.fromCharCode(0),64),d0=!0}function l0(e,t,r){for(var n,i,s,a,o,f,c,u,h=r.length();h>=64;){for(i=e.h0,s=e.h1,a=e.h2,o=e.h3,f=e.h4,u=0;u<16;++u)n=r.getInt32(),t[u]=n,c=o^s&(a^o),n=(i<<5|i>>>27)+c+f+1518500249+n,f=o,o=a,a=(s<<30|s>>>2)>>>0,s=i,i=n;for(;u<20;++u)n=t[u-3]^t[u-8]^t[u-14]^t[u-16],n=n<<1|n>>>31,t[u]=n,c=o^s&(a^o),n=(i<<5|i>>>27)+c+f+1518500249+n,f=o,o=a,a=(s<<30|s>>>2)>>>0,s=i,i=n;for(;u<32;++u)n=t[u-3]^t[u-8]^t[u-14]^t[u-16],n=n<<1|n>>>31,t[u]=n,c=s^a^o,n=(i<<5|i>>>27)+c+f+1859775393+n,f=o,o=a,a=(s<<30|s>>>2)>>>0,s=i,i=n;for(;u<40;++u)n=t[u-6]^t[u-16]^t[u-28]^t[u-32],n=n<<2|n>>>30,t[u]=n,c=s^a^o,n=(i<<5|i>>>27)+c+f+1859775393+n,f=o,o=a,a=(s<<30|s>>>2)>>>0,s=i,i=n;for(;u<60;++u)n=t[u-6]^t[u-16]^t[u-28]^t[u-32],n=n<<2|n>>>30,t[u]=n,c=s&a|o&(s^a),n=(i<<5|i>>>27)+c+f+2400959708+n,f=o,o=a,a=(s<<30|s>>>2)>>>0,s=i,i=n;for(;u<80;++u)n=t[u-6]^t[u-16]^t[u-28]^t[u-32],n=n<<2|n>>>30,t[u]=n,c=s^a^o,n=(i<<5|i>>>27)+c+f+3395469782+n,f=o,o=a,a=(s<<30|s>>>2)>>>0,s=i,i=n;e.h0=e.h0+i|0,e.h1=e.h1+s|0,e.h2=e.h2+a|0,e.h3=e.h3+o|0,e.h4=e.h4+f|0,h-=64}}});var v0=P((o2,x0)=>{var oe=X();dt();zr();g0();var m0=x0.exports=oe.pkcs1=oe.pkcs1||{};m0.encode_rsa_oaep=function(e,t,r){var n,i,s,a;typeof r=="string"?(n=r,i=arguments[3]||void 0,s=arguments[4]||void 0):r&&(n=r.label||void 0,i=r.seed||void 0,s=r.md||void 0,r.mgf1&&r.mgf1.md&&(a=r.mgf1.md)),s?s.start():s=oe.md.sha1.create(),a||(a=s);var o=Math.ceil(e.n.bitLength()/8),f=o-2*s.digestLength-2;if(t.length>f){var c=new Error("RSAES-OAEP input message length is too long.");throw c.length=t.length,c.maxLength=f,c}n||(n=""),s.update(n,"raw");for(var u=s.digest(),h="",l=f-t.length,d=0;d<l;d++)h+="\0";var p=u.getBytes()+h+""+t;if(!i)i=oe.random.getBytes(s.digestLength);else if(i.length!==s.digestLength){var c=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw c.seedLength=i.length,c.digestLength=s.digestLength,c}var g=Mn(i,o-s.digestLength-1,a),x=oe.util.xorBytes(p,g,p.length),v=Mn(x,s.digestLength,a),B=oe.util.xorBytes(i,v,i.length);return"\0"+B+x};m0.decode_rsa_oaep=function(e,t,r){var n,i,s;typeof r=="string"?(n=r,i=arguments[3]||void 0):r&&(n=r.label||void 0,i=r.md||void 0,r.mgf1&&r.mgf1.md&&(s=r.mgf1.md));var a=Math.ceil(e.n.bitLength()/8);if(t.length!==a){var x=new Error("RSAES-OAEP encoded message length is invalid.");throw x.length=t.length,x.expectedLength=a,x}if(i===void 0?i=oe.md.sha1.create():i.start(),s||(s=i),a<2*i.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");n||(n=""),i.update(n,"raw");for(var o=i.digest().getBytes(),f=t.charAt(0),c=t.substring(1,i.digestLength+1),u=t.substring(1+i.digestLength),h=Mn(u,i.digestLength,s),l=oe.util.xorBytes(c,h,c.length),d=Mn(l,a-i.digestLength-1,s),p=oe.util.xorBytes(u,d,u.length),g=p.substring(0,i.digestLength),x=f!=="\0",v=0;v<i.digestLength;++v)x|=o.charAt(v)!==g.charAt(v);for(var B=1,A=i.digestLength,L=i.digestLength;L<p.length;L++){var T=p.charCodeAt(L),_=T&1^1,F=B?65534:0;x|=T&F,B=B&_,A+=B}if(x||p.charCodeAt(A)!==1)throw new Error("Invalid RSAES-OAEP padding.");return p.substring(A+1)};function Mn(e,t,r){r||(r=oe.md.sha1.create());for(var n="",i=Math.ceil(t/r.digestLength),s=0;s<i;++s){var a=String.fromCharCode(s>>24&255,s>>16&255,s>>8&255,s&255);r.start(),r.update(e+a),n+=r.digest().getBytes()}return n.substring(0,t)}});var b0=P((f2,xs)=>{var Le=X();dt();On();zr();(function(){if(Le.prime){xs.exports=Le.prime;return}var e=xs.exports=Le.prime=Le.prime||{},t=Le.jsbn.BigInteger,r=[6,4,2,4,2,4,6,2],n=new t(null);n.fromInt(30);var i=function(h,l){return h|l};e.generateProbablePrime=function(h,l,d){typeof l=="function"&&(d=l,l={}),l=l||{};var p=l.algorithm||"PRIMEINC";typeof p=="string"&&(p={name:p}),p.options=p.options||{};var g=l.prng||Le.random,x={nextBytes:function(v){for(var B=g.getBytesSync(v.length),A=0;A<v.length;++A)v[A]=B.charCodeAt(A)}};if(p.name==="PRIMEINC")return s(h,x,p.options,d);throw new Error("Invalid prime generation algorithm: "+p.name)};function s(h,l,d,p){return"workers"in d?f(h,l,d,p):a(h,l,d,p)}function a(h,l,d,p){var g=c(h,l),x=0,v=u(g.bitLength());"millerRabinTests"in d&&(v=d.millerRabinTests);var B=10;"maxBlockTime"in d&&(B=d.maxBlockTime),o(g,h,l,x,v,B,p)}function o(h,l,d,p,g,x,v){var B=+new Date;do{if(h.bitLength()>l&&(h=c(l,d)),h.isProbablePrime(g))return v(null,h);h.dAddOffset(r[p++%8],0)}while(x<0||+new Date-B<x);Le.util.setImmediate(function(){o(h,l,d,p,g,x,v)})}function f(h,l,d,p){if(typeof Worker>"u")return a(h,l,d,p);var g=c(h,l),x=d.workers,v=d.workLoad||100,B=v*30/8,A=d.workerScript||"forge/prime.worker.js";if(x===-1)return Le.util.estimateCores(function(T,_){T&&(_=2),x=_-1,L()});L();function L(){x=Math.max(1,x);for(var T=[],_=0;_<x;++_)T[_]=new Worker(A);for(var F=x,_=0;_<x;++_)T[_].addEventListener("message",Et);var $=!1;function Et(zt){if(!$){--F;var kt=zt.data;if(kt.found){for(var Tt=0;Tt<T.length;++Tt)T[Tt].terminate();return $=!0,p(null,new t(kt.prime,16))}g.bitLength()>h&&(g=c(h,l));var ar=g.toString(16);zt.target.postMessage({hex:ar,workLoad:v}),g.dAddOffset(B,0)}}}}function c(h,l){var d=new t(h,l),p=h-1;return d.testBit(p)||d.bitwiseTo(t.ONE.shiftLeft(p),i,d),d.dAddOffset(31-d.mod(n).byteValue(),0),d}function u(h){return h<=100?27:h<=150?18:h<=200?15:h<=250?12:h<=300?9:h<=350?8:h<=400?7:h<=500?6:h<=600?5:h<=800?4:h<=1250?3:2}})()});var Vn=P((c2,T0)=>{var D=X();qr();On();Cn();v0();b0();zr();dt();typeof V>"u"&&(V=D.jsbn.BigInteger);var V,vs=D.util.isNodejs?yr():null,m=D.asn1,Ft=D.util;D.pki=D.pki||{};T0.exports=D.pki.rsa=D.rsa=D.rsa||{};var U=D.pki,op=[6,4,2,4,2,4,6,2],fp={name:"PrivateKeyInfo",tagClass:m.Class.UNIVERSAL,type:m.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:m.Class.UNIVERSAL,type:m.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:m.Class.UNIVERSAL,type:m.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:m.Class.UNIVERSAL,type:m.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:m.Class.UNIVERSAL,type:m.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},cp={name:"RSAPrivateKey",tagClass:m.Class.UNIVERSAL,type:m.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:m.Class.UNIVERSAL,type:m.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:m.Class.UNIVERSAL,type:m.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:m.Class.UNIVERSAL,type:m.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:m.Class.UNIVERSAL,type:m.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:m.Class.UNIVERSAL,type:m.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:m.Class.UNIVERSAL,type:m.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:m.Class.UNIVERSAL,type:m.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:m.Class.UNIVERSAL,type:m.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:m.Class.UNIVERSAL,type:m.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},up={name:"RSAPublicKey",tagClass:m.Class.UNIVERSAL,type:m.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:m.Class.UNIVERSAL,type:m.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:m.Class.UNIVERSAL,type:m.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},hp=D.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:m.Class.UNIVERSAL,type:m.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:m.Class.UNIVERSAL,type:m.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:m.Class.UNIVERSAL,type:m.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:m.Class.UNIVERSAL,type:m.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:m.Class.UNIVERSAL,type:m.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},lp={name:"DigestInfo",tagClass:m.Class.UNIVERSAL,type:m.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm",tagClass:m.Class.UNIVERSAL,type:m.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm.algorithmIdentifier",tagClass:m.Class.UNIVERSAL,type:m.Type.OID,constructed:!1,capture:"algorithmIdentifier"},{name:"DigestInfo.DigestAlgorithm.parameters",tagClass:m.Class.UNIVERSAL,type:m.Type.NULL,capture:"parameters",optional:!0,constructed:!1}]},{name:"DigestInfo.digest",tagClass:m.Class.UNIVERSAL,type:m.Type.OCTETSTRING,constructed:!1,capture:"digest"}]},pp=function(e){var t;if(e.algorithm in U.oids)t=U.oids[e.algorithm];else{var r=new Error("Unknown message digest algorithm.");throw r.algorithm=e.algorithm,r}var n=m.oidToDer(t).getBytes(),i=m.create(m.Class.UNIVERSAL,m.Type.SEQUENCE,!0,[]),s=m.create(m.Class.UNIVERSAL,m.Type.SEQUENCE,!0,[]);s.value.push(m.create(m.Class.UNIVERSAL,m.Type.OID,!1,n)),s.value.push(m.create(m.Class.UNIVERSAL,m.Type.NULL,!1,""));var a=m.create(m.Class.UNIVERSAL,m.Type.OCTETSTRING,!1,e.digest().getBytes());return i.value.push(s),i.value.push(a),m.toDer(i).getBytes()},A0=function(e,t,r){if(r)return e.modPow(t.e,t.n);if(!t.p||!t.q)return e.modPow(t.d,t.n);t.dP||(t.dP=t.d.mod(t.p.subtract(V.ONE))),t.dQ||(t.dQ=t.d.mod(t.q.subtract(V.ONE))),t.qInv||(t.qInv=t.q.modInverse(t.p));var n;do n=new V(D.util.bytesToHex(D.random.getBytes(t.n.bitLength()/8)),16);while(n.compareTo(t.n)>=0||!n.gcd(t.n).equals(V.ONE));e=e.multiply(n.modPow(t.e,t.n)).mod(t.n);for(var i=e.mod(t.p).modPow(t.dP,t.p),s=e.mod(t.q).modPow(t.dQ,t.q);i.compareTo(s)<0;)i=i.add(t.p);var a=i.subtract(s).multiply(t.qInv).mod(t.p).multiply(t.q).add(s);return a=a.multiply(n.modInverse(t.n)).mod(t.n),a};U.rsa.encrypt=function(e,t,r){var n=r,i,s=Math.ceil(t.n.bitLength()/8);r!==!1&&r!==!0?(n=r===2,i=C0(e,t,r)):(i=D.util.createBuffer(),i.putBytes(e));for(var a=new V(i.toHex(),16),o=A0(a,t,n),f=o.toString(16),c=D.util.createBuffer(),u=s-Math.ceil(f.length/2);u>0;)c.putByte(0),--u;return c.putBytes(D.util.hexToBytes(f)),c.getBytes()};U.rsa.decrypt=function(e,t,r,n){var i=Math.ceil(t.n.bitLength()/8);if(e.length!==i){var s=new Error("Encrypted message length is invalid.");throw s.length=e.length,s.expected=i,s}var a=new V(D.util.createBuffer(e).toHex(),16);if(a.compareTo(t.n)>=0)throw new Error("Encrypted message is invalid.");for(var o=A0(a,t,r),f=o.toString(16),c=D.util.createBuffer(),u=i-Math.ceil(f.length/2);u>0;)c.putByte(0),--u;return c.putBytes(D.util.hexToBytes(f)),n!==!1?Fn(c.getBytes(),t,r):c.getBytes()};U.rsa.createKeyPairGenerationState=function(e,t,r){typeof e=="string"&&(e=parseInt(e,10)),e=e||2048,r=r||{};var n=r.prng||D.random,i={nextBytes:function(o){for(var f=n.getBytesSync(o.length),c=0;c<o.length;++c)o[c]=f.charCodeAt(c)}},s=r.algorithm||"PRIMEINC",a;if(s==="PRIMEINC")a={algorithm:s,state:0,bits:e,rng:i,eInt:t||65537,e:new V(null),p:null,q:null,qBits:e>>1,pBits:e-(e>>1),pqState:0,num:null,keys:null},a.e.fromInt(a.eInt);else throw new Error("Invalid key generation algorithm: "+s);return a};U.rsa.stepKeyPairGenerationState=function(e,t){"algorithm"in e||(e.algorithm="PRIMEINC");var r=new V(null);r.fromInt(30);for(var n=0,i=function(h,l){return h|l},s=+new Date,a,o=0;e.keys===null&&(t<=0||o<t);){if(e.state===0){var f=e.p===null?e.pBits:e.qBits,c=f-1;e.pqState===0?(e.num=new V(f,e.rng),e.num.testBit(c)||e.num.bitwiseTo(V.ONE.shiftLeft(c),i,e.num),e.num.dAddOffset(31-e.num.mod(r).byteValue(),0),n=0,++e.pqState):e.pqState===1?e.num.bitLength()>f?e.pqState=0:e.num.isProbablePrime(yp(e.num.bitLength()))?++e.pqState:e.num.dAddOffset(op[n++%8],0):e.pqState===2?e.pqState=e.num.subtract(V.ONE).gcd(e.e).compareTo(V.ONE)===0?3:0:e.pqState===3&&(e.pqState=0,e.p===null?e.p=e.num:e.q=e.num,e.p!==null&&e.q!==null&&++e.state,e.num=null)}else if(e.state===1)e.p.compareTo(e.q)<0&&(e.num=e.p,e.p=e.q,e.q=e.num),++e.state;else if(e.state===2)e.p1=e.p.subtract(V.ONE),e.q1=e.q.subtract(V.ONE),e.phi=e.p1.multiply(e.q1),++e.state;else if(e.state===3)e.phi.gcd(e.e).compareTo(V.ONE)===0?++e.state:(e.p=null,e.q=null,e.state=0);else if(e.state===4)e.n=e.p.multiply(e.q),e.n.bitLength()===e.bits?++e.state:(e.q=null,e.state=0);else if(e.state===5){var u=e.e.modInverse(e.phi);e.keys={privateKey:U.rsa.setPrivateKey(e.n,e.e,u,e.p,e.q,u.mod(e.p1),u.mod(e.q1),e.q.modInverse(e.p)),publicKey:U.rsa.setPublicKey(e.n,e.e)}}a=+new Date,o+=a-s,s=a}return e.keys!==null};U.rsa.generateKeyPair=function(e,t,r,n){if(arguments.length===1?typeof e=="object"?(r=e,e=void 0):typeof e=="function"&&(n=e,e=void 0):arguments.length===2?typeof e=="number"?typeof t=="function"?(n=t,t=void 0):typeof t!="number"&&(r=t,t=void 0):(r=e,n=t,e=void 0,t=void 0):arguments.length===3&&(typeof t=="number"?typeof r=="function"&&(n=r,r=void 0):(n=r,r=t,t=void 0)),r=r||{},e===void 0&&(e=r.bits||2048),t===void 0&&(t=r.e||65537),!D.options.usePureJavaScript&&!r.prng&&e>=256&&e<=16384&&(t===65537||t===3)){if(n){if(w0("generateKeyPair"))return vs.generateKeyPair("rsa",{modulusLength:e,publicExponent:t,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(o,f,c){if(o)return n(o);n(null,{privateKey:U.privateKeyFromPem(c),publicKey:U.publicKeyFromPem(f)})});if(S0("generateKey")&&S0("exportKey"))return Ft.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:B0(t),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(o){return Ft.globalScope.crypto.subtle.exportKey("pkcs8",o.privateKey)}).then(void 0,function(o){n(o)}).then(function(o){if(o){var f=U.privateKeyFromAsn1(m.fromDer(D.util.createBuffer(o)));n(null,{privateKey:f,publicKey:U.setRsaPublicKey(f.n,f.e)})}});if(E0("generateKey")&&E0("exportKey")){var i=Ft.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:B0(t),hash:{name:"SHA-256"}},!0,["sign","verify"]);i.oncomplete=function(o){var f=o.target.result,c=Ft.globalScope.msCrypto.subtle.exportKey("pkcs8",f.privateKey);c.oncomplete=function(u){var h=u.target.result,l=U.privateKeyFromAsn1(m.fromDer(D.util.createBuffer(h)));n(null,{privateKey:l,publicKey:U.setRsaPublicKey(l.n,l.e)})},c.onerror=function(u){n(u)}},i.onerror=function(o){n(o)};return}}else if(w0("generateKeyPairSync")){var s=vs.generateKeyPairSync("rsa",{modulusLength:e,publicExponent:t,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:U.privateKeyFromPem(s.privateKey),publicKey:U.publicKeyFromPem(s.publicKey)}}}var a=U.rsa.createKeyPairGenerationState(e,t,r);if(!n)return U.rsa.stepKeyPairGenerationState(a,0),a.keys;dp(a,r,n)};U.setRsaPublicKey=U.rsa.setPublicKey=function(e,t){var r={n:e,e:t};return r.encrypt=function(n,i,s){if(typeof i=="string"?i=i.toUpperCase():i===void 0&&(i="RSAES-PKCS1-V1_5"),i==="RSAES-PKCS1-V1_5")i={encode:function(o,f,c){return C0(o,f,2).getBytes()}};else if(i==="RSA-OAEP"||i==="RSAES-OAEP")i={encode:function(o,f){return D.pkcs1.encode_rsa_oaep(f,o,s)}};else if(["RAW","NONE","NULL",null].indexOf(i)!==-1)i={encode:function(o){return o}};else if(typeof i=="string")throw new Error('Unsupported encryption scheme: "'+i+'".');var a=i.encode(n,r,!0);return U.rsa.encrypt(a,r,!0)},r.verify=function(n,i,s,a){typeof s=="string"?s=s.toUpperCase():s===void 0&&(s="RSASSA-PKCS1-V1_5"),a===void 0&&(a={_parseAllDigestBytes:!0}),"_parseAllDigestBytes"in a||(a._parseAllDigestBytes=!0),s==="RSASSA-PKCS1-V1_5"?s={verify:function(f,c){c=Fn(c,r,!0);var u=m.fromDer(c,{parseAllBytes:a._parseAllDigestBytes}),h={},l=[];if(!m.validate(u,lp,h,l)){var d=new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value.");throw d.errors=l,d}var p=m.derToOid(h.algorithmIdentifier);if(!(p===D.oids.md2||p===D.oids.md5||p===D.oids.sha1||p===D.oids.sha224||p===D.oids.sha256||p===D.oids.sha384||p===D.oids.sha512||p===D.oids["sha512-224"]||p===D.oids["sha512-256"])){var d=new Error("Unknown RSASSA-PKCS1-v1_5 DigestAlgorithm identifier.");throw d.oid=p,d}if((p===D.oids.md2||p===D.oids.md5)&&!("parameters"in h))throw new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value. Missing algorithm identifer NULL parameters.");return f===h.digest}}:(s==="NONE"||s==="NULL"||s===null)&&(s={verify:function(f,c){return c=Fn(c,r,!0),f===c}});var o=U.rsa.decrypt(i,r,!0,!1);return s.verify(n,o,r.n.bitLength())},r};U.setRsaPrivateKey=U.rsa.setPrivateKey=function(e,t,r,n,i,s,a,o){var f={n:e,e:t,d:r,p:n,q:i,dP:s,dQ:a,qInv:o};return f.decrypt=function(c,u,h){typeof u=="string"?u=u.toUpperCase():u===void 0&&(u="RSAES-PKCS1-V1_5");var l=U.rsa.decrypt(c,f,!1,!1);if(u==="RSAES-PKCS1-V1_5")u={decode:Fn};else if(u==="RSA-OAEP"||u==="RSAES-OAEP")u={decode:function(d,p){return D.pkcs1.decode_rsa_oaep(p,d,h)}};else if(["RAW","NONE","NULL",null].indexOf(u)!==-1)u={decode:function(d){return d}};else throw new Error('Unsupported encryption scheme: "'+u+'".');return u.decode(l,f,!1)},f.sign=function(c,u){var h=!1;typeof u=="string"&&(u=u.toUpperCase()),u===void 0||u==="RSASSA-PKCS1-V1_5"?(u={encode:pp},h=1):(u==="NONE"||u==="NULL"||u===null)&&(u={encode:function(){return c}},h=1);var l=u.encode(c,f.n.bitLength());return U.rsa.encrypt(l,f,h)},f};U.wrapRsaPrivateKey=function(e){return m.create(m.Class.UNIVERSAL,m.Type.SEQUENCE,!0,[m.create(m.Class.UNIVERSAL,m.Type.INTEGER,!1,m.integerToDer(0).getBytes()),m.create(m.Class.UNIVERSAL,m.Type.SEQUENCE,!0,[m.create(m.Class.UNIVERSAL,m.Type.OID,!1,m.oidToDer(U.oids.rsaEncryption).getBytes()),m.create(m.Class.UNIVERSAL,m.Type.NULL,!1,"")]),m.create(m.Class.UNIVERSAL,m.Type.OCTETSTRING,!1,m.toDer(e).getBytes())])};U.privateKeyFromAsn1=function(e){var t={},r=[];if(m.validate(e,fp,t,r)&&(e=m.fromDer(D.util.createBuffer(t.privateKey))),t={},r=[],!m.validate(e,cp,t,r)){var n=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw n.errors=r,n}var i,s,a,o,f,c,u,h;return i=D.util.createBuffer(t.privateKeyModulus).toHex(),s=D.util.createBuffer(t.privateKeyPublicExponent).toHex(),a=D.util.createBuffer(t.privateKeyPrivateExponent).toHex(),o=D.util.createBuffer(t.privateKeyPrime1).toHex(),f=D.util.createBuffer(t.privateKeyPrime2).toHex(),c=D.util.createBuffer(t.privateKeyExponent1).toHex(),u=D.util.createBuffer(t.privateKeyExponent2).toHex(),h=D.util.createBuffer(t.privateKeyCoefficient).toHex(),U.setRsaPrivateKey(new V(i,16),new V(s,16),new V(a,16),new V(o,16),new V(f,16),new V(c,16),new V(u,16),new V(h,16))};U.privateKeyToAsn1=U.privateKeyToRSAPrivateKey=function(e){return m.create(m.Class.UNIVERSAL,m.Type.SEQUENCE,!0,[m.create(m.Class.UNIVERSAL,m.Type.INTEGER,!1,m.integerToDer(0).getBytes()),m.create(m.Class.UNIVERSAL,m.Type.INTEGER,!1,fe(e.n)),m.create(m.Class.UNIVERSAL,m.Type.INTEGER,!1,fe(e.e)),m.create(m.Class.UNIVERSAL,m.Type.INTEGER,!1,fe(e.d)),m.create(m.Class.UNIVERSAL,m.Type.INTEGER,!1,fe(e.p)),m.create(m.Class.UNIVERSAL,m.Type.INTEGER,!1,fe(e.q)),m.create(m.Class.UNIVERSAL,m.Type.INTEGER,!1,fe(e.dP)),m.create(m.Class.UNIVERSAL,m.Type.INTEGER,!1,fe(e.dQ)),m.create(m.Class.UNIVERSAL,m.Type.INTEGER,!1,fe(e.qInv))])};U.publicKeyFromAsn1=function(e){var t={},r=[];if(m.validate(e,hp,t,r)){var n=m.derToOid(t.publicKeyOid);if(n!==U.oids.rsaEncryption){var i=new Error("Cannot read public key. Unknown OID.");throw i.oid=n,i}e=t.rsaPublicKey}if(r=[],!m.validate(e,up,t,r)){var i=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw i.errors=r,i}var s=D.util.createBuffer(t.publicKeyModulus).toHex(),a=D.util.createBuffer(t.publicKeyExponent).toHex();return U.setRsaPublicKey(new V(s,16),new V(a,16))};U.publicKeyToAsn1=U.publicKeyToSubjectPublicKeyInfo=function(e){return m.create(m.Class.UNIVERSAL,m.Type.SEQUENCE,!0,[m.create(m.Class.UNIVERSAL,m.Type.SEQUENCE,!0,[m.create(m.Class.UNIVERSAL,m.Type.OID,!1,m.oidToDer(U.oids.rsaEncryption).getBytes()),m.create(m.Class.UNIVERSAL,m.Type.NULL,!1,"")]),m.create(m.Class.UNIVERSAL,m.Type.BITSTRING,!1,[U.publicKeyToRSAPublicKey(e)])])};U.publicKeyToRSAPublicKey=function(e){return m.create(m.Class.UNIVERSAL,m.Type.SEQUENCE,!0,[m.create(m.Class.UNIVERSAL,m.Type.INTEGER,!1,fe(e.n)),m.create(m.Class.UNIVERSAL,m.Type.INTEGER,!1,fe(e.e))])};function C0(e,t,r){var n=D.util.createBuffer(),i=Math.ceil(t.n.bitLength()/8);if(e.length>i-11){var s=new Error("Message is too long for PKCS#1 v1.5 padding.");throw s.length=e.length,s.max=i-11,s}n.putByte(0),n.putByte(r);var a=i-3-e.length,o;if(r===0||r===1){o=r===0?0:255;for(var f=0;f<a;++f)n.putByte(o)}else for(;a>0;){for(var c=0,u=D.random.getBytes(a),f=0;f<a;++f)o=u.charCodeAt(f),o===0?++c:n.putByte(o);a=c}return n.putByte(0),n.putBytes(e),n}function Fn(e,t,r,n){var i=Math.ceil(t.n.bitLength()/8),s=D.util.createBuffer(e),a=s.getByte(),o=s.getByte();if(a!==0||r&&o!==0&&o!==1||!r&&o!=2||r&&o===0&&typeof n>"u")throw new Error("Encryption block is invalid.");var f=0;if(o===0){f=i-3-n;for(var c=0;c<f;++c)if(s.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(o===1)for(f=0;s.length()>1;){if(s.getByte()!==255){--s.read;break}++f}else if(o===2)for(f=0;s.length()>1;){if(s.getByte()===0){--s.read;break}++f}var u=s.getByte();if(u!==0||f!==i-3-s.length())throw new Error("Encryption block is invalid.");return s.getBytes()}function dp(e,t,r){typeof t=="function"&&(r=t,t={}),t=t||{};var n={algorithm:{name:t.algorithm||"PRIMEINC",options:{workers:t.workers||2,workLoad:t.workLoad||100,workerScript:t.workerScript}}};"prng"in t&&(n.prng=t.prng),i();function i(){s(e.pBits,function(o,f){if(o)return r(o);if(e.p=f,e.q!==null)return a(o,e.q);s(e.qBits,a)})}function s(o,f){D.prime.generateProbablePrime(o,n,f)}function a(o,f){if(o)return r(o);if(e.q=f,e.p.compareTo(e.q)<0){var c=e.p;e.p=e.q,e.q=c}if(e.p.subtract(V.ONE).gcd(e.e).compareTo(V.ONE)!==0){e.p=null,i();return}if(e.q.subtract(V.ONE).gcd(e.e).compareTo(V.ONE)!==0){e.q=null,s(e.qBits,a);return}if(e.p1=e.p.subtract(V.ONE),e.q1=e.q.subtract(V.ONE),e.phi=e.p1.multiply(e.q1),e.phi.gcd(e.e).compareTo(V.ONE)!==0){e.p=e.q=null,i();return}if(e.n=e.p.multiply(e.q),e.n.bitLength()!==e.bits){e.q=null,s(e.qBits,a);return}var u=e.e.modInverse(e.phi);e.keys={privateKey:U.rsa.setPrivateKey(e.n,e.e,u,e.p,e.q,u.mod(e.p1),u.mod(e.q1),e.q.modInverse(e.p)),publicKey:U.rsa.setPublicKey(e.n,e.e)},r(null,e.keys)}}function fe(e){var t=e.toString(16);t[0]>="8"&&(t="00"+t);var r=D.util.hexToBytes(t);return r.length>1&&(r.charCodeAt(0)===0&&!(r.charCodeAt(1)&128)||r.charCodeAt(0)===255&&(r.charCodeAt(1)&128)===128)?r.substr(1):r}function yp(e){return e<=100?27:e<=150?18:e<=200?15:e<=250?12:e<=300?9:e<=350?8:e<=400?7:e<=500?6:e<=600?5:e<=800?4:e<=1250?3:2}function w0(e){return D.util.isNodejs&&typeof vs[e]=="function"}function S0(e){return typeof Ft.globalScope<"u"&&typeof Ft.globalScope.crypto=="object"&&typeof Ft.globalScope.crypto.subtle=="object"&&typeof Ft.globalScope.crypto.subtle[e]=="function"}function E0(e){return typeof Ft.globalScope<"u"&&typeof Ft.globalScope.msCrypto=="object"&&typeof Ft.globalScope.msCrypto.subtle=="object"&&typeof Ft.globalScope.msCrypto.subtle[e]=="function"}function B0(e){for(var t=D.util.hexToBytes(e.toString(16)),r=new Uint8Array(t.length),n=0;n<t.length;++n)r[n]=t.charCodeAt(n);return r}});var L0=P((u2,D0)=>{var I=X();us();qr();Ko();Qe();Cn();qo();Go();zr();n0();Vn();dt();typeof I0>"u"&&(I0=I.jsbn.BigInteger);var I0,b=I.asn1,K=I.pki=I.pki||{};D0.exports=K.pbe=I.pbe=I.pbe||{};var je=K.oids,gp={name:"EncryptedPrivateKeyInfo",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:b.Class.UNIVERSAL,type:b.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:b.Class.UNIVERSAL,type:b.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},mp={name:"PBES2Algorithms",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:b.Class.UNIVERSAL,type:b.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:b.Class.UNIVERSAL,type:b.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:b.Class.UNIVERSAL,type:b.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:b.Class.UNIVERSAL,type:b.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:b.Class.UNIVERSAL,type:b.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},xp={name:"pkcs-12PbeParams",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:b.Class.UNIVERSAL,type:b.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"iterations"}]};K.encryptPrivateKeyInfo=function(e,t,r){r=r||{},r.saltSize=r.saltSize||8,r.count=r.count||2048,r.algorithm=r.algorithm||"aes128",r.prfAlgorithm=r.prfAlgorithm||"sha1";var n=I.random.getBytesSync(r.saltSize),i=r.count,s=b.integerToDer(i),a,o,f;if(r.algorithm.indexOf("aes")===0||r.algorithm==="des"){var c,u,h;switch(r.algorithm){case"aes128":a=16,c=16,u=je["aes128-CBC"],h=I.aes.createEncryptionCipher;break;case"aes192":a=24,c=16,u=je["aes192-CBC"],h=I.aes.createEncryptionCipher;break;case"aes256":a=32,c=16,u=je["aes256-CBC"],h=I.aes.createEncryptionCipher;break;case"des":a=8,c=8,u=je.desCBC,h=I.des.createEncryptionCipher;break;default:var l=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw l.algorithm=r.algorithm,l}var d="hmacWith"+r.prfAlgorithm.toUpperCase(),p=N0(d),g=I.pkcs5.pbkdf2(t,n,i,a,p),x=I.random.getBytesSync(c),v=h(g);v.start(x),v.update(b.toDer(e)),v.finish(),f=v.output.getBytes();var B=vp(n,s,a,d);o=b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(je.pkcs5PBES2).getBytes()),b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(je.pkcs5PBKDF2).getBytes()),B]),b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(u).getBytes()),b.create(b.Class.UNIVERSAL,b.Type.OCTETSTRING,!1,x)])])])}else if(r.algorithm==="3des"){a=24;var A=new I.util.ByteBuffer(n),g=K.pbe.generatePkcs12Key(t,A,1,i,a),x=K.pbe.generatePkcs12Key(t,A,2,i,a),v=I.des.createEncryptionCipher(g);v.start(x),v.update(b.toDer(e)),v.finish(),f=v.output.getBytes(),o=b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(je["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OCTETSTRING,!1,n),b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,s.getBytes())])])}else{var l=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw l.algorithm=r.algorithm,l}var L=b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[o,b.create(b.Class.UNIVERSAL,b.Type.OCTETSTRING,!1,f)]);return L};K.decryptPrivateKeyInfo=function(e,t){var r=null,n={},i=[];if(!b.validate(e,gp,n,i)){var s=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=i,s}var a=b.derToOid(n.encryptionOid),o=K.pbe.getCipher(a,n.encryptionParams,t),f=I.util.createBuffer(n.encryptedData);return o.update(f),o.finish()&&(r=b.fromDer(o.output)),r};K.encryptedPrivateKeyToPem=function(e,t){var r={type:"ENCRYPTED PRIVATE KEY",body:b.toDer(e).getBytes()};return I.pem.encode(r,{maxline:t})};K.encryptedPrivateKeyFromPem=function(e){var t=I.pem.decode(e)[0];if(t.type!=="ENCRYPTED PRIVATE KEY"){var r=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw r.headerType=t.type,r}if(t.procType&&t.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return b.fromDer(t.body)};K.encryptRsaPrivateKey=function(e,t,r){if(r=r||{},!r.legacy){var n=K.wrapRsaPrivateKey(K.privateKeyToAsn1(e));return n=K.encryptPrivateKeyInfo(n,t,r),K.encryptedPrivateKeyToPem(n)}var i,s,a,o;switch(r.algorithm){case"aes128":i="AES-128-CBC",a=16,s=I.random.getBytesSync(16),o=I.aes.createEncryptionCipher;break;case"aes192":i="AES-192-CBC",a=24,s=I.random.getBytesSync(16),o=I.aes.createEncryptionCipher;break;case"aes256":i="AES-256-CBC",a=32,s=I.random.getBytesSync(16),o=I.aes.createEncryptionCipher;break;case"3des":i="DES-EDE3-CBC",a=24,s=I.random.getBytesSync(8),o=I.des.createEncryptionCipher;break;case"des":i="DES-CBC",a=8,s=I.random.getBytesSync(8),o=I.des.createEncryptionCipher;break;default:var f=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+r.algorithm+'".');throw f.algorithm=r.algorithm,f}var c=I.pbe.opensslDeriveBytes(t,s.substr(0,8),a),u=o(c);u.start(s),u.update(b.toDer(K.privateKeyToAsn1(e))),u.finish();var h={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:i,parameters:I.util.bytesToHex(s).toUpperCase()},body:u.output.getBytes()};return I.pem.encode(h)};K.decryptRsaPrivateKey=function(e,t){var r=null,n=I.pem.decode(e)[0];if(n.type!=="ENCRYPTED PRIVATE KEY"&&n.type!=="PRIVATE KEY"&&n.type!=="RSA PRIVATE KEY"){var i=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw i.headerType=i,i}if(n.procType&&n.procType.type==="ENCRYPTED"){var s,a;switch(n.dekInfo.algorithm){case"DES-CBC":s=8,a=I.des.createDecryptionCipher;break;case"DES-EDE3-CBC":s=24,a=I.des.createDecryptionCipher;break;case"AES-128-CBC":s=16,a=I.aes.createDecryptionCipher;break;case"AES-192-CBC":s=24,a=I.aes.createDecryptionCipher;break;case"AES-256-CBC":s=32,a=I.aes.createDecryptionCipher;break;case"RC2-40-CBC":s=5,a=function(h){return I.rc2.createDecryptionCipher(h,40)};break;case"RC2-64-CBC":s=8,a=function(h){return I.rc2.createDecryptionCipher(h,64)};break;case"RC2-128-CBC":s=16,a=function(h){return I.rc2.createDecryptionCipher(h,128)};break;default:var i=new Error('Could not decrypt private key; unsupported encryption algorithm "'+n.dekInfo.algorithm+'".');throw i.algorithm=n.dekInfo.algorithm,i}var o=I.util.hexToBytes(n.dekInfo.parameters),f=I.pbe.opensslDeriveBytes(t,o.substr(0,8),s),c=a(f);if(c.start(o),c.update(I.util.createBuffer(n.body)),c.finish())r=c.output.getBytes();else return r}else r=n.body;return n.type==="ENCRYPTED PRIVATE KEY"?r=K.decryptPrivateKeyInfo(b.fromDer(r),t):r=b.fromDer(r),r!==null&&(r=K.privateKeyFromAsn1(r)),r};K.pbe.generatePkcs12Key=function(e,t,r,n,i,s){var a,o;if(typeof s>"u"||s===null){if(!("sha1"in I.md))throw new Error('"sha1" hash algorithm unavailable.');s=I.md.sha1.create()}var f=s.digestLength,c=s.blockLength,u=new I.util.ByteBuffer,h=new I.util.ByteBuffer;if(e!=null){for(o=0;o<e.length;o++)h.putInt16(e.charCodeAt(o));h.putInt16(0)}var l=h.length(),d=t.length(),p=new I.util.ByteBuffer;p.fillWithByte(r,c);var g=c*Math.ceil(d/c),x=new I.util.ByteBuffer;for(o=0;o<g;o++)x.putByte(t.at(o%d));var v=c*Math.ceil(l/c),B=new I.util.ByteBuffer;for(o=0;o<v;o++)B.putByte(h.at(o%l));var A=x;A.putBuffer(B);for(var L=Math.ceil(i/f),T=1;T<=L;T++){var _=new I.util.ByteBuffer;_.putBytes(p.bytes()),_.putBytes(A.bytes());for(var F=0;F<n;F++)s.start(),s.update(_.getBytes()),_=s.digest();var $=new I.util.ByteBuffer;for(o=0;o<c;o++)$.putByte(_.at(o%f));var Et=Math.ceil(d/c)+Math.ceil(l/c),zt=new I.util.ByteBuffer;for(a=0;a<Et;a++){var kt=new I.util.ByteBuffer(A.getBytes(c)),Tt=511;for(o=$.length()-1;o>=0;o--)Tt=Tt>>8,Tt+=$.at(o)+kt.at(o),kt.setAt(o,Tt&255);zt.putBuffer(kt)}A=zt,u.putBuffer(_)}return u.truncate(u.length()-i),u};K.pbe.getCipher=function(e,t,r){switch(e){case K.oids.pkcs5PBES2:return K.pbe.getCipherForPBES2(e,t,r);case K.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case K.oids["pbewithSHAAnd40BitRC2-CBC"]:return K.pbe.getCipherForPKCS12PBE(e,t,r);default:var n=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw n.oid=e,n.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],n}};K.pbe.getCipherForPBES2=function(e,t,r){var n={},i=[];if(!b.validate(t,mp,n,i)){var s=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=i,s}if(e=b.derToOid(n.kdfOid),e!==K.oids.pkcs5PBKDF2){var s=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw s.oid=e,s.supportedOids=["pkcs5PBKDF2"],s}if(e=b.derToOid(n.encOid),e!==K.oids["aes128-CBC"]&&e!==K.oids["aes192-CBC"]&&e!==K.oids["aes256-CBC"]&&e!==K.oids["des-EDE3-CBC"]&&e!==K.oids.desCBC){var s=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw s.oid=e,s.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],s}var a=n.kdfSalt,o=I.util.createBuffer(n.kdfIterationCount);o=o.getInt(o.length()<<3);var f,c;switch(K.oids[e]){case"aes128-CBC":f=16,c=I.aes.createDecryptionCipher;break;case"aes192-CBC":f=24,c=I.aes.createDecryptionCipher;break;case"aes256-CBC":f=32,c=I.aes.createDecryptionCipher;break;case"des-EDE3-CBC":f=24,c=I.des.createDecryptionCipher;break;case"desCBC":f=8,c=I.des.createDecryptionCipher;break}var u=R0(n.prfOid),h=I.pkcs5.pbkdf2(r,a,o,f,u),l=n.encIv,d=c(h);return d.start(l),d};K.pbe.getCipherForPKCS12PBE=function(e,t,r){var n={},i=[];if(!b.validate(t,xp,n,i)){var s=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=i,s}var a=I.util.createBuffer(n.salt),o=I.util.createBuffer(n.iterations);o=o.getInt(o.length()<<3);var f,c,u;switch(e){case K.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:f=24,c=8,u=I.des.startDecrypting;break;case K.oids["pbewithSHAAnd40BitRC2-CBC"]:f=5,c=8,u=function(g,x){var v=I.rc2.createDecryptionCipher(g,40);return v.start(x,null),v};break;default:var s=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw s.oid=e,s}var h=R0(n.prfOid),l=K.pbe.generatePkcs12Key(r,a,1,o,f,h);h.start();var d=K.pbe.generatePkcs12Key(r,a,2,o,c,h);return u(l,d)};K.pbe.opensslDeriveBytes=function(e,t,r,n){if(typeof n>"u"||n===null){if(!("md5"in I.md))throw new Error('"md5" hash algorithm unavailable.');n=I.md.md5.create()}t===null&&(t="");for(var i=[_0(n,e+t)],s=16,a=1;s<r;++a,s+=16)i.push(_0(n,i[a-1]+e+t));return i.join("").substr(0,r)};function _0(e,t){return e.start().update(t).digest().getBytes()}function R0(e){var t;if(!e)t="hmacWithSHA1";else if(t=K.oids[b.derToOid(e)],!t){var r=new Error("Unsupported PRF OID.");throw r.oid=e,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}return N0(t)}function N0(e){var t=I.md;switch(e){case"hmacWithSHA224":t=I.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":e=e.substr(8).toLowerCase();break;default:var r=new Error("Unsupported PRF algorithm.");throw r.algorithm=e,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}if(!t||!(e in t))throw new Error("Unknown hash algorithm: "+e);return t[e].create()}function vp(e,t,r,n){var i=b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OCTETSTRING,!1,e),b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,t.getBytes())]);return n!=="hmacWithSHA1"&&i.value.push(b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,I.util.hexToBytes(r.toString(16))),b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(K.oids[n]).getBytes()),b.create(b.Class.UNIVERSAL,b.Type.NULL,!1,"")])),i}});var V0=P((Z2,F0)=>{var rt=X();Qe();dt();var Gr=F0.exports=rt.sha512=rt.sha512||{};rt.md.sha512=rt.md.algorithms.sha512=Gr;var O0=rt.sha384=rt.sha512.sha384=rt.sha512.sha384||{};O0.create=function(){return Gr.create("SHA-384")};rt.md.sha384=rt.md.algorithms.sha384=O0;rt.sha512.sha256=rt.sha512.sha256||{create:function(){return Gr.create("SHA-512/256")}};rt.md["sha512/256"]=rt.md.algorithms["sha512/256"]=rt.sha512.sha256;rt.sha512.sha224=rt.sha512.sha224||{create:function(){return Gr.create("SHA-512/224")}};rt.md["sha512/224"]=rt.md.algorithms["sha512/224"]=rt.sha512.sha224;Gr.create=function(e){if(M0||Ep(),typeof e>"u"&&(e="SHA-512"),!(e in tr))throw new Error("Invalid SHA-512 algorithm: "+e);for(var t=tr[e],r=null,n=rt.util.createBuffer(),i=new Array(80),s=0;s<80;++s)i[s]=new Array(2);var a=64;switch(e){case"SHA-384":a=48;break;case"SHA-512/256":a=32;break;case"SHA-512/224":a=28;break}var o={algorithm:e.replace("-","").toLowerCase(),blockLength:128,digestLength:a,messageLength:0,fullMessageLength:null,messageLengthSize:16};return o.start=function(){o.messageLength=0,o.fullMessageLength=o.messageLength128=[];for(var f=o.messageLengthSize/4,c=0;c<f;++c)o.fullMessageLength.push(0);n=rt.util.createBuffer(),r=new Array(t.length);for(var c=0;c<t.length;++c)r[c]=t[c].slice(0);return o},o.start(),o.update=function(f,c){c==="utf8"&&(f=rt.util.encodeUtf8(f));var u=f.length;o.messageLength+=u,u=[u/4294967296>>>0,u>>>0];for(var h=o.fullMessageLength.length-1;h>=0;--h)o.fullMessageLength[h]+=u[1],u[1]=u[0]+(o.fullMessageLength[h]/4294967296>>>0),o.fullMessageLength[h]=o.fullMessageLength[h]>>>0,u[0]=u[1]/4294967296>>>0;return n.putBytes(f),K0(r,i,n),(n.read>2048||n.length()===0)&&n.compact(),o},o.digest=function(){var f=rt.util.createBuffer();f.putBytes(n.bytes());var c=o.fullMessageLength[o.fullMessageLength.length-1]+o.messageLengthSize,u=c&o.blockLength-1;f.putBytes(ws.substr(0,o.blockLength-u));for(var h,l,d=o.fullMessageLength[0]*8,p=0;p<o.fullMessageLength.length-1;++p)h=o.fullMessageLength[p+1]*8,l=h/4294967296>>>0,d+=l,f.putInt32(d>>>0),d=h>>>0;f.putInt32(d);for(var g=new Array(r.length),p=0;p<r.length;++p)g[p]=r[p].slice(0);K0(g,i,f);var x=rt.util.createBuffer(),v;e==="SHA-512"?v=g.length:e==="SHA-384"?v=g.length-2:v=g.length-4;for(var p=0;p<v;++p)x.putInt32(g[p][0]),(p!==v-1||e!=="SHA-512/224")&&x.putInt32(g[p][1]);return x},o};var ws=null,M0=!1,Ss=null,tr=null;function Ep(){ws=String.fromCharCode(128),ws+=rt.util.fillString(String.fromCharCode(0),128),Ss=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],tr={},tr["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],tr["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],tr["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],tr["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],M0=!0}function K0(e,t,r){for(var n,i,s,a,o,f,c,u,h,l,d,p,g,x,v,B,A,L,T,_,F,$,Et,zt,kt,Tt,ar,dn,pt,Rt,k,ci,ui,hi,li,sa=r.length();sa>=128;){for(pt=0;pt<16;++pt)t[pt][0]=r.getInt32()>>>0,t[pt][1]=r.getInt32()>>>0;for(;pt<80;++pt)ci=t[pt-2],Rt=ci[0],k=ci[1],n=((Rt>>>19|k<<13)^(k>>>29|Rt<<3)^Rt>>>6)>>>0,i=((Rt<<13|k>>>19)^(k<<3|Rt>>>29)^(Rt<<26|k>>>6))>>>0,hi=t[pt-15],Rt=hi[0],k=hi[1],s=((Rt>>>1|k<<31)^(Rt>>>8|k<<24)^Rt>>>7)>>>0,a=((Rt<<31|k>>>1)^(Rt<<24|k>>>8)^(Rt<<25|k>>>7))>>>0,ui=t[pt-7],li=t[pt-16],k=i+ui[1]+a+li[1],t[pt][0]=n+ui[0]+s+li[0]+(k/4294967296>>>0)>>>0,t[pt][1]=k>>>0;for(g=e[0][0],x=e[0][1],v=e[1][0],B=e[1][1],A=e[2][0],L=e[2][1],T=e[3][0],_=e[3][1],F=e[4][0],$=e[4][1],Et=e[5][0],zt=e[5][1],kt=e[6][0],Tt=e[6][1],ar=e[7][0],dn=e[7][1],pt=0;pt<80;++pt)c=((F>>>14|$<<18)^(F>>>18|$<<14)^($>>>9|F<<23))>>>0,u=((F<<18|$>>>14)^(F<<14|$>>>18)^($<<23|F>>>9))>>>0,h=(kt^F&(Et^kt))>>>0,l=(Tt^$&(zt^Tt))>>>0,o=((g>>>28|x<<4)^(x>>>2|g<<30)^(x>>>7|g<<25))>>>0,f=((g<<4|x>>>28)^(x<<30|g>>>2)^(x<<25|g>>>7))>>>0,d=(g&v|A&(g^v))>>>0,p=(x&B|L&(x^B))>>>0,k=dn+u+l+Ss[pt][1]+t[pt][1],n=ar+c+h+Ss[pt][0]+t[pt][0]+(k/4294967296>>>0)>>>0,i=k>>>0,k=f+p,s=o+d+(k/4294967296>>>0)>>>0,a=k>>>0,ar=kt,dn=Tt,kt=Et,Tt=zt,Et=F,zt=$,k=_+i,F=T+n+(k/4294967296>>>0)>>>0,$=k>>>0,T=A,_=L,A=v,L=B,v=g,B=x,k=i+a,g=n+s+(k/4294967296>>>0)>>>0,x=k>>>0;k=e[0][1]+x,e[0][0]=e[0][0]+g+(k/4294967296>>>0)>>>0,e[0][1]=k>>>0,k=e[1][1]+B,e[1][0]=e[1][0]+v+(k/4294967296>>>0)>>>0,e[1][1]=k>>>0,k=e[2][1]+L,e[2][0]=e[2][0]+A+(k/4294967296>>>0)>>>0,e[2][1]=k>>>0,k=e[3][1]+_,e[3][0]=e[3][0]+T+(k/4294967296>>>0)>>>0,e[3][1]=k>>>0,k=e[4][1]+$,e[4][0]=e[4][0]+F+(k/4294967296>>>0)>>>0,e[4][1]=k>>>0,k=e[5][1]+zt,e[5][0]=e[5][0]+Et+(k/4294967296>>>0)>>>0,e[5][1]=k>>>0,k=e[6][1]+Tt,e[6][0]=e[6][0]+kt+(k/4294967296>>>0)>>>0,e[6][1]=k>>>0,k=e[7][1]+dn,e[7][0]=e[7][0]+ar+(k/4294967296>>>0)>>>0,e[7][1]=k>>>0,sa-=128}}});var rc=P((km,ec)=>{ec.exports=Zs;var tc=128,Md=127,Fd=~Md,Vd=Math.pow(2,31);function Zs(e,t,r){if(Number.MAX_SAFE_INTEGER&&e>Number.MAX_SAFE_INTEGER)throw Zs.bytes=0,new RangeError("Could not encode varint");t=t||[],r=r||0;for(var n=r;e>=Vd;)t[r++]=e&255|tc,e/=128;for(;e&Fd;)t[r++]=e&255|tc,e>>>=7;return t[r]=e|0,Zs.bytes=r-n+1,t}});var sc=P((Pm,ic)=>{ic.exports=Ys;var qd=128,nc=127;function Ys(e,n){var r=0,n=n||0,i=0,s=n,a,o=e.length;do{if(s>=o||i>49)throw Ys.bytes=0,new RangeError("Could not decode varint");a=e[s++],r+=i<28?(a&nc)<<i:(a&nc)*Math.pow(2,i),i+=7}while(a>=qd);return Ys.bytes=s-n,r}});var oc=P((Um,ac)=>{var zd=Math.pow(2,7),Hd=Math.pow(2,14),Gd=Math.pow(2,21),Wd=Math.pow(2,28),$d=Math.pow(2,35),Zd=Math.pow(2,42),Yd=Math.pow(2,49),Qd=Math.pow(2,56),Xd=Math.pow(2,63);ac.exports=function(e){return e<zd?1:e<Hd?2:e<Gd?3:e<Wd?4:e<$d?5:e<Zd?6:e<Yd?7:e<Qd?8:e<Xd?9:10}});var si=P((Km,fc)=>{fc.exports={encode:rc(),decode:sc(),encodingLength:oc()}});var bc=P((Xm,vc)=>{"use strict";function xc(e,t){for(let r in t)Object.defineProperty(e,r,{value:t[r],enumerable:!0,configurable:!0});return e}function ly(e,t,r){if(!e||typeof e=="string")throw new TypeError("Please pass an Error to err-code");r||(r={}),typeof t=="object"&&(r=t,t=""),t&&(r.code=t);try{return xc(e,r)}catch{r.message=e.message,r.stack=e.stack;let i=function(){};return i.prototype=Object.create(Object.getPrototypeOf(e)),xc(new i,r)}}vc.exports=ly});var my={};Bt(my,{PeerRecord:()=>qt,RecordEnvelope:()=>Xt});var Y=class extends Error{constructor(t,r,n){super(t),this.code=r,this.name=n?.name??"CodeError",this.props=n??{}}};var mi={};Bt(mi,{identity:()=>Mc});function kc(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<e.length;i++){var s=e.charAt(i),a=s.charCodeAt(0);if(r[a]!==255)throw new TypeError(s+" is ambiguous");r[a]=i}var o=e.length,f=e.charAt(0),c=Math.log(o)/Math.log(256),u=Math.log(256)/Math.log(o);function h(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var g=0,x=0,v=0,B=p.length;v!==B&&p[v]===0;)v++,g++;for(var A=(B-v)*u+1>>>0,L=new Uint8Array(A);v!==B;){for(var T=p[v],_=0,F=A-1;(T!==0||_<x)&&F!==-1;F--,_++)T+=256*L[F]>>>0,L[F]=T%o>>>0,T=T/o>>>0;if(T!==0)throw new Error("Non-zero carry");x=_,v++}for(var $=A-x;$!==A&&L[$]===0;)$++;for(var Et=f.repeat(g);$<A;++$)Et+=e.charAt(L[$]);return Et}function l(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;var g=0;if(p[g]!==" "){for(var x=0,v=0;p[g]===f;)x++,g++;for(var B=(p.length-g)*c+1>>>0,A=new Uint8Array(B);p[g];){var L=r[p.charCodeAt(g)];if(L===255)return;for(var T=0,_=B-1;(L!==0||T<v)&&_!==-1;_--,T++)L+=o*A[_]>>>0,A[_]=L%256>>>0,L=L/256>>>0;if(L!==0)throw new Error("Non-zero carry");v=T,g++}if(p[g]!==" "){for(var F=B-v;F!==B&&A[F]===0;)F++;for(var $=new Uint8Array(x+(B-F)),Et=x;F!==B;)$[Et++]=A[F++];return $}}}function d(p){var g=l(p);if(g)return g;throw new Error(`Non-${t} character`)}return{encode:h,decodeUnsafe:l,decode:d}}var Pc=kc,Uc=Pc,oa=Uc;var wy=new Uint8Array(0);var fa=(e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0},le=e=>{if(e instanceof Uint8Array&&e.constructor.name==="Uint8Array")return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")};var ca=e=>new TextEncoder().encode(e),ua=e=>new TextDecoder().decode(e);var pi=class{constructor(t,r,n){this.name=t,this.prefix=r,this.baseEncode=n}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}},di=class{constructor(t,r,n){if(this.name=t,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return la(this,t)}},yi=class{constructor(t){this.decoders=t}or(t){return la(this,t)}decode(t){let r=t[0],n=this.decoders[r];if(n)return n.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},la=(e,t)=>new yi({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}}),gi=class{constructor(t,r,n,i){this.name=t,this.prefix=r,this.baseEncode=n,this.baseDecode=i,this.encoder=new pi(t,r,n),this.decoder=new di(t,r,i)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}},or=({name:e,prefix:t,encode:r,decode:n})=>new gi(e,t,r,n),Ae=({prefix:e,name:t,alphabet:r})=>{let{encode:n,decode:i}=oa(r,t);return or({prefix:e,name:t,encode:n,decode:s=>le(i(s))})},Kc=(e,t,r,n)=>{let i={};for(let u=0;u<t.length;++u)i[t[u]]=u;let s=e.length;for(;e[s-1]==="=";)--s;let a=new Uint8Array(s*r/8|0),o=0,f=0,c=0;for(let u=0;u<s;++u){let h=i[e[u]];if(h===void 0)throw new SyntaxError(`Non-${n} character`);f=f<<r|h,o+=r,o>=8&&(o-=8,a[c++]=255&f>>o)}if(o>=r||255&f<<8-o)throw new SyntaxError("Unexpected end of data");return a},Oc=(e,t,r)=>{let n=t[t.length-1]==="=",i=(1<<r)-1,s="",a=0,o=0;for(let f=0;f<e.length;++f)for(o=o<<8|e[f],a+=8;a>r;)a-=r,s+=t[i&o>>a];if(a&&(s+=t[i&o<<r-a]),n)for(;s.length*r&7;)s+="=";return s},ut=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>or({prefix:t,name:e,encode(i){return Oc(i,n,r)},decode(i){return Kc(i,n,r,e)}});var Mc=or({prefix:"\0",name:"identity",encode:e=>ua(e),decode:e=>ca(e)});var xi={};Bt(xi,{base2:()=>Fc});var Fc=ut({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var vi={};Bt(vi,{base8:()=>Vc});var Vc=ut({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var bi={};Bt(bi,{base10:()=>qc});var qc=Ae({prefix:"9",name:"base10",alphabet:"0123456789"});var wi={};Bt(wi,{base16:()=>zc,base16upper:()=>Hc});var zc=ut({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Hc=ut({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var Si={};Bt(Si,{base32:()=>pe,base32hex:()=>Zc,base32hexpad:()=>Qc,base32hexpadupper:()=>Xc,base32hexupper:()=>Yc,base32pad:()=>Wc,base32padupper:()=>$c,base32upper:()=>Gc,base32z:()=>Jc});var pe=ut({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Gc=ut({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Wc=ut({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),$c=ut({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Zc=ut({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Yc=ut({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Qc=ut({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Xc=ut({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Jc=ut({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Ei={};Bt(Ei,{base36:()=>jc,base36upper:()=>tu});var jc=Ae({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),tu=Ae({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Bi={};Bt(Bi,{base58btc:()=>yt,base58flickr:()=>eu});var yt=Ae({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),eu=Ae({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Ai={};Bt(Ai,{base64:()=>gn,base64pad:()=>ru,base64url:()=>nu,base64urlpad:()=>iu});var gn=ut({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),ru=ut({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),nu=ut({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),iu=ut({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var Ci={};Bt(Ci,{base256emoji:()=>cu});var pa=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),su=pa.reduce((e,t,r)=>(e[r]=t,e),[]),au=pa.reduce((e,t,r)=>(e[t.codePointAt(0)]=r,e),[]);function ou(e){return e.reduce((t,r)=>(t+=su[r],t),"")}function fu(e){let t=[];for(let r of e){let n=au[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);t.push(n)}return new Uint8Array(t)}var cu=or({prefix:"\u{1F680}",name:"base256emoji",encode:ou,decode:fu});var Ri={};Bt(Ri,{sha256:()=>At,sha512:()=>Iu});var uu=ga,da=128,hu=127,lu=~hu,pu=Math.pow(2,31);function ga(e,t,r){t=t||[],r=r||0;for(var n=r;e>=pu;)t[r++]=e&255|da,e/=128;for(;e&lu;)t[r++]=e&255|da,e>>>=7;return t[r]=e|0,ga.bytes=r-n+1,t}var du=Ti,yu=128,ya=127;function Ti(e,n){var r=0,n=n||0,i=0,s=n,a,o=e.length;do{if(s>=o)throw Ti.bytes=0,new RangeError("Could not decode varint");a=e[s++],r+=i<28?(a&ya)<<i:(a&ya)*Math.pow(2,i),i+=7}while(a>=yu);return Ti.bytes=s-n,r}var gu=Math.pow(2,7),mu=Math.pow(2,14),xu=Math.pow(2,21),vu=Math.pow(2,28),bu=Math.pow(2,35),wu=Math.pow(2,42),Su=Math.pow(2,49),Eu=Math.pow(2,56),Bu=Math.pow(2,63),Au=function(e){return e<gu?1:e<mu?2:e<xu?3:e<vu?4:e<bu?5:e<wu?6:e<Su?7:e<Eu?8:e<Bu?9:10},Cu={encode:uu,decode:du,encodingLength:Au},Tu=Cu,kr=Tu;var Pr=(e,t=0)=>[kr.decode(e,t),kr.decode.bytes],fr=(e,t,r=0)=>(kr.encode(e,t,r),t),cr=e=>kr.encodingLength(e);var Jt=(e,t)=>{let r=t.byteLength,n=cr(e),i=n+cr(r),s=new Uint8Array(i+r);return fr(e,s,0),fr(r,s,n),s.set(t,i),new ur(e,r,t,s)},ze=e=>{let t=le(e),[r,n]=Pr(t),[i,s]=Pr(t.subarray(n)),a=t.subarray(n+s);if(a.byteLength!==i)throw new Error("Incorrect length");return new ur(r,i,a,t)},ma=(e,t)=>{if(e===t)return!0;{let r=t;return e.code===r.code&&e.size===r.size&&r.bytes instanceof Uint8Array&&fa(e.bytes,r.bytes)}},ur=class{constructor(t,r,n,i){this.code=t,this.size=r,this.digest=n,this.bytes=i}};var _i=({name:e,code:t,encode:r})=>new Ii(e,t,r),Ii=class{constructor(t,r,n){this.name=t,this.code=r,this.encode=n}digest(t){if(t instanceof Uint8Array){let r=this.encode(t);return r instanceof Uint8Array?Jt(this.code,r):r.then(n=>Jt(this.code,n))}else throw Error("Unknown type, must be binary type")}};var va=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),At=_i({name:"sha2-256",code:18,encode:va("SHA-256")}),Iu=_i({name:"sha2-512",code:19,encode:va("SHA-512")});var Ni={};Bt(Ni,{identity:()=>Ce});var ba=0,_u="identity",wa=le,Ru=e=>Jt(ba,wa(e)),Ce={code:ba,name:_u,encode:wa,digest:Ru};var qy=new TextEncoder,zy=new TextDecoder;var Sa=(e,t)=>{let{bytes:r,version:n}=e;switch(n){case 0:return ku(r,Di(e),t||yt.encoder);default:return Pu(r,Di(e),t||pe.encoder)}};var Ea=new WeakMap,Di=e=>{let t=Ea.get(e);if(t==null){let r=new Map;return Ea.set(e,r),r}return t},J=class{constructor(t,r,n,i){this.code=r,this.version=t,this.multihash=n,this.bytes=i,this["/"]=i}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{let{code:t,multihash:r}=this;if(t!==Ur)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==Uu)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return J.createV0(r)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{let{code:t,digest:r}=this.multihash,n=Jt(t,r);return J.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(t){return J.equals(this,t)}static equals(t,r){let n=r;return n&&t.code===n.code&&t.version===n.version&&ma(t.multihash,n.multihash)}toString(t){return Sa(this,t)}toJSON(){return{"/":Sa(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(t){if(t==null)return null;let r=t;if(r instanceof J)return r;if(r["/"]!=null&&r["/"]===r.bytes||r.asCID===r){let{version:n,code:i,multihash:s,bytes:a}=r;return new J(n,i,s,a||Ba(n,i,s.bytes))}else if(r[Ku]===!0){let{version:n,multihash:i,code:s}=r,a=ze(i);return J.create(n,s,a)}else return null}static create(t,r,n){if(typeof r!="number")throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(t){case 0:{if(r!==Ur)throw new Error(`Version 0 CID must use dag-pb (code: ${Ur}) block encoding`);return new J(t,r,n,n.bytes)}case 1:{let i=Ba(t,r,n.bytes);return new J(t,r,n,i)}default:throw new Error("Invalid version")}}static createV0(t){return J.create(0,Ur,t)}static createV1(t,r){return J.create(1,t,r)}static decode(t){let[r,n]=J.decodeFirst(t);if(n.length)throw new Error("Incorrect length");return r}static decodeFirst(t){let r=J.inspectBytes(t),n=r.size-r.multihashSize,i=le(t.subarray(n,n+r.multihashSize));if(i.byteLength!==r.multihashSize)throw new Error("Incorrect length");let s=i.subarray(r.multihashSize-r.digestSize),a=new ur(r.multihashCode,r.digestSize,s,i);return[r.version===0?J.createV0(a):J.createV1(r.codec,a),t.subarray(r.size)]}static inspectBytes(t){let r=0,n=()=>{let[h,l]=Pr(t.subarray(r));return r+=l,h},i=n(),s=Ur;if(i===18?(i=0,r=0):s=n(),i!==0&&i!==1)throw new RangeError(`Invalid CID version ${i}`);let a=r,o=n(),f=n(),c=r+f,u=c-a;return{version:i,codec:s,multihashCode:o,digestSize:f,multihashSize:u,size:c}}static parse(t,r){let[n,i]=Lu(t,r),s=J.decode(i);if(s.version===0&&t[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return Di(s).set(n,t),s}},Lu=(e,t)=>{switch(e[0]){case"Q":{let r=t||yt;return[yt.prefix,r.decode(`${yt.prefix}${e}`)]}case yt.prefix:{let r=t||yt;return[yt.prefix,r.decode(e)]}case pe.prefix:{let r=t||pe;return[pe.prefix,r.decode(e)]}default:{if(t==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}}},ku=(e,t,r)=>{let{prefix:n}=r;if(n!==yt.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);let i=t.get(n);if(i==null){let s=r.encode(e).slice(1);return t.set(n,s),s}else return i},Pu=(e,t,r)=>{let{prefix:n}=r,i=t.get(n);if(i==null){let s=r.encode(e);return t.set(n,s),s}else return i},Ur=112,Uu=18,Ba=(e,t,r)=>{let n=cr(e),i=n+cr(t),s=new Uint8Array(i+r.byteLength);return fr(e,s,0),fr(t,s,n),s.set(r,i),s},Ku=Symbol.for("@ipld/js-cid/CID");var Te={...mi,...xi,...vi,...bi,...wi,...Si,...Ei,...Bi,...Ai,...Ci},jy={...Ri,...Ni};function Ge(e){return globalThis.Buffer!=null?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function de(e=0){return globalThis.Buffer?.alloc!=null?Ge(globalThis.Buffer.alloc(e)):new Uint8Array(e)}function ye(e=0){return globalThis.Buffer?.allocUnsafe!=null?Ge(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}function Ca(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}var Aa=Ca("utf8","u",e=>"u"+new TextDecoder("utf8").decode(e),e=>new TextEncoder().encode(e.substring(1))),Li=Ca("ascii","a",e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t},e=>{e=e.substring(1);let t=ye(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}),Ou={utf8:Aa,"utf-8":Aa,hex:Te.base16,latin1:Li,ascii:Li,binary:Li,...Te},xn=Ou;function Ct(e,t="utf8"){let r=xn[t];if(r==null)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Ge(globalThis.Buffer.from(e,"utf-8")):r.decoder.decode(`${r.prefix}${e}`)}function gt(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0}var Wi=st(Oi(),1),po=st(so(),1),yo=st($e(),1),$i=st(Gi(),1),go=st(lo(),1);function $u(){yo.default._configure(),Wi.default._configure(po.default),$i.default._configure(go.default)}$u();var mo=["uint64","int64","sint64","fixed64","sfixed64"];function Zu(e){for(let t of mo){if(e[t]==null)continue;let r=e[t];e[t]=function(){return BigInt(r.call(this).toString())}}return e}function Zi(e){return Zu(new Wi.default(e))}function Yu(e){for(let t of mo){if(e[t]==null)continue;let r=e[t];e[t]=function(n){return r.call(this,n.toString())}}return e}function Yi(){return Yu($i.default.create())}function ge(e,t){let r=Zi(e instanceof Uint8Array?e:e.subarray());return t.decode(r)}function me(e,t){let r=Yi();return t.encode(e,r,{lengthDelimited:!1}),r.finish()}var lr;(function(e){e[e.VARINT=0]="VARINT",e[e.BIT64=1]="BIT64",e[e.LENGTH_DELIMITED=2]="LENGTH_DELIMITED",e[e.START_GROUP=3]="START_GROUP",e[e.END_GROUP=4]="END_GROUP",e[e.BIT32=5]="BIT32"})(lr||(lr={}));function En(e,t,r,n){return{name:e,type:t,encode:r,decode:n}}function Qi(e){function t(i){if(e[i.toString()]==null)throw new Error("Invalid enum value");return e[i]}let r=function(s,a){let o=t(s);a.int32(o)},n=function(s){let a=s.int32();return t(a)};return En("enum",lr.VARINT,r,n)}function xe(e,t){return En("message",lr.LENGTH_DELIMITED,e,t)}var at;(function(e){e.RSA="RSA",e.Ed25519="Ed25519",e.Secp256k1="Secp256k1"})(at||(at={}));var Xi;(function(e){e[e.RSA=0]="RSA",e[e.Ed25519=1]="Ed25519",e[e.Secp256k1=2]="Secp256k1"})(Xi||(Xi={}));(function(e){e.codec=()=>Qi(Xi)})(at||(at={}));var ee;(function(e){let t;e.codec=()=>(t==null&&(t=xe((r,n,i={})=>{i.lengthDelimited!==!1&&n.fork(),r.Type!=null&&(n.uint32(8),at.codec().encode(r.Type,n)),r.Data!=null&&(n.uint32(18),n.bytes(r.Data)),i.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let i={},s=n==null?r.len:r.pos+n;for(;r.pos<s;){let a=r.uint32();switch(a>>>3){case 1:i.Type=at.codec().decode(r);break;case 2:i.Data=r.bytes();break;default:r.skipType(a&7);break}}return i})),t),e.encode=r=>me(r,e.codec()),e.decode=r=>ge(r,e.codec())})(ee||(ee={}));var re;(function(e){let t;e.codec=()=>(t==null&&(t=xe((r,n,i={})=>{i.lengthDelimited!==!1&&n.fork(),r.Type!=null&&(n.uint32(8),at.codec().encode(r.Type,n)),r.Data!=null&&(n.uint32(18),n.bytes(r.Data)),i.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let i={},s=n==null?r.len:r.pos+n;for(;r.pos<s;){let a=r.uint32();switch(a>>>3){case 1:i.Type=at.codec().decode(r);break;case 2:i.Data=r.bytes();break;default:r.skipType(a&7);break}}return i})),t),e.encode=r=>me(r,e.codec()),e.decode=r=>ge(r,e.codec())})(re||(re={}));var Og=st(qr(),1),Mg=st(L0(),1),bd=st(X(),1);function mt(e,t){t==null&&(t=e.reduce((i,s)=>i+s.length,0));let r=ye(t),n=0;for(let i of e)r.set(i,n),n+=i.length;return Ge(r)}var Dt={get(e=globalThis){let t=e.crypto;if(t==null||t.subtle==null)throw Object.assign(new Error("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p-crypto/blob/master/README.md#web-crypto-api"),{code:"ERR_MISSING_WEB_CRYPTO"});return t}};var C2=st(dt(),1),T2=st(On(),1),k0=st(X(),1);function j(e,t="utf8"){let r=xn[t];if(r==null)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8"):r.encoder.encode(e).substring(1)}function Zt(e,t){let r=Uint8Array.from(e.abs().toByteArray());if(r=r[0]===0?r.subarray(1):r,t!=null){if(r.length>t)throw new Error("byte array longer than desired length");r=mt([new Uint8Array(t-r.length),r])}return j(r,"base64url")}function Pt(e){let t=P0(e);return new k0.default.jsbn.BigInteger(j(t,"base16"),16)}function P0(e,t){let r=Ct(e,"base64urlpad");if(t!=null){if(r.length>t)throw new Error("byte array longer than desired length");r=mt([new Uint8Array(t-r.length),r])}return r}var wp={"P-256":256,"P-384":384,"P-521":521},Sp=Object.keys(wp),O2=Sp.join(" / ");function bs(e){let t=e?.algorithm??"AES-GCM",r=e?.keyLength??16,n=e?.nonceLength??12,i=e?.digest??"SHA-256",s=e?.saltLength??16,a=e?.iterations??32767,o=Dt.get();r*=8;async function f(h,l){let d=o.getRandomValues(new Uint8Array(s)),p=o.getRandomValues(new Uint8Array(n)),g={name:t,iv:p};typeof l=="string"&&(l=Ct(l));let x={name:"PBKDF2",salt:d,iterations:a,hash:{name:i}},v=await o.subtle.importKey("raw",l,{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),B=await o.subtle.deriveKey(x,v,{name:t,length:r},!0,["encrypt"]),A=await o.subtle.encrypt(g,B,h);return mt([d,g.iv,new Uint8Array(A)])}async function c(h,l){let d=h.subarray(0,s),p=h.subarray(s,s+n),g=h.subarray(s+n),x={name:t,iv:p};typeof l=="string"&&(l=Ct(l));let v={name:"PBKDF2",salt:d,iterations:a,hash:{name:i}},B=await o.subtle.importKey("raw",l,{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),A=await o.subtle.deriveKey(v,B,{name:t,length:r},!0,["decrypt"]),L=await o.subtle.decrypt(x,A,g);return new Uint8Array(L)}return{encrypt:f,decrypt:c}}var Ns={};Bt(Ns,{RsaPrivateKey:()=>Ar,RsaPublicKey:()=>Xr,fromJwk:()=>$p,generateKeyPair:()=>Zp,unmarshalRsaPrivateKey:()=>Gp,unmarshalRsaPublicKey:()=>Wp});var vg=st(V0(),1),Qr=st(X(),1);var Bp=st(yr(),1);var q=BigInt(0),nt=BigInt(1),Pe=BigInt(2),$r=BigInt(3),q0=BigInt(8),ht=Object.freeze({a:q,b:BigInt(7),P:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),n:BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h:nt,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee")}),z0=(e,t)=>(e+t/Pe)/t,qn={beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar(e){let{n:t}=ht,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-nt*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),s=r,a=BigInt("0x100000000000000000000000000000000"),o=z0(s*e,t),f=z0(-n*e,t),c=R(e-o*r-f*i,t),u=R(-o*n-f*s,t),h=c>a,l=u>a;if(h&&(c=t-c),l&&(u=t-u),c>a||u>a)throw new Error("splitScalarEndo: Endomorphism failed, k="+e);return{k1neg:h,k1:c,k2neg:l,k2:u}}},Yt=32,br=32,Ap=32,H0=Yt+1,G0=2*Yt+1;function W0(e){let{a:t,b:r}=ht,n=R(e*e),i=R(n*e);return R(i+t*e+r)}var zn=ht.a===q,Wn=class extends Error{constructor(t){super(t)}};function $0(e){if(!(e instanceof W))throw new TypeError("JacobianPoint expected")}var W=class{constructor(t,r,n){this.x=t,this.y=r,this.z=n}static fromAffine(t){if(!(t instanceof Z))throw new TypeError("JacobianPoint#fromAffine: expected Point");return t.equals(Z.ZERO)?W.ZERO:new W(t.x,t.y,nt)}static toAffineBatch(t){let r=Rp(t.map(n=>n.z));return t.map((n,i)=>n.toAffine(r[i]))}static normalizeZ(t){return W.toAffineBatch(t).map(W.fromAffine)}equals(t){$0(t);let{x:r,y:n,z:i}=this,{x:s,y:a,z:o}=t,f=R(i*i),c=R(o*o),u=R(r*c),h=R(s*f),l=R(R(n*o)*c),d=R(R(a*i)*f);return u===h&&l===d}negate(){return new W(this.x,R(-this.y),this.z)}double(){let{x:t,y:r,z:n}=this,i=R(t*t),s=R(r*r),a=R(s*s),o=t+s,f=R(Pe*(R(o*o)-i-a)),c=R($r*i),u=R(c*c),h=R(u-Pe*f),l=R(c*(f-h)-q0*a),d=R(Pe*r*n);return new W(h,l,d)}add(t){$0(t);let{x:r,y:n,z:i}=this,{x:s,y:a,z:o}=t;if(s===q||a===q)return this;if(r===q||n===q)return t;let f=R(i*i),c=R(o*o),u=R(r*c),h=R(s*f),l=R(R(n*o)*c),d=R(R(a*i)*f),p=R(h-u),g=R(d-l);if(p===q)return g===q?this.double():W.ZERO;let x=R(p*p),v=R(p*x),B=R(u*x),A=R(g*g-v-Pe*B),L=R(g*(B-A)-l*v),T=R(i*o*p);return new W(A,L,T)}subtract(t){return this.add(t.negate())}multiplyUnsafe(t){let r=W.ZERO;if(typeof t=="bigint"&&t===q)return r;let n=Q0(t);if(n===nt)return this;if(!zn){let h=r,l=this;for(;n>q;)n&nt&&(h=h.add(l)),l=l.double(),n>>=nt;return h}let{k1neg:i,k1:s,k2neg:a,k2:o}=qn.splitScalar(n),f=r,c=r,u=this;for(;s>q||o>q;)s&nt&&(f=f.add(u)),o&nt&&(c=c.add(u)),u=u.double(),s>>=nt,o>>=nt;return i&&(f=f.negate()),a&&(c=c.negate()),c=new W(R(c.x*qn.beta),c.y,c.z),f.add(c)}precomputeWindow(t){let r=zn?128/t+1:256/t+1,n=[],i=this,s=i;for(let a=0;a<r;a++){s=i,n.push(s);for(let o=1;o<2**(t-1);o++)s=s.add(i),n.push(s);i=s.double()}return n}wNAF(t,r){!r&&this.equals(W.BASE)&&(r=Z.BASE);let n=r&&r._WINDOW_SIZE||1;if(256%n)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let i=r&&Bs.get(r);i||(i=this.precomputeWindow(n),r&&n!==1&&(i=W.normalizeZ(i),Bs.set(r,i)));let s=W.ZERO,a=W.BASE,o=1+(zn?128/n:256/n),f=2**(n-1),c=BigInt(2**n-1),u=2**n,h=BigInt(n);for(let l=0;l<o;l++){let d=l*f,p=Number(t&c);t>>=h,p>f&&(p-=u,t+=nt);let g=d,x=d+Math.abs(p)-1,v=l%2!==0,B=p<0;p===0?a=a.add(Hn(v,i[g])):s=s.add(Hn(B,i[x]))}return{p:s,f:a}}multiply(t,r){let n=Q0(t),i,s;if(zn){let{k1neg:a,k1:o,k2neg:f,k2:c}=qn.splitScalar(n),{p:u,f:h}=this.wNAF(o,r),{p:l,f:d}=this.wNAF(c,r);u=Hn(a,u),l=Hn(f,l),l=new W(R(l.x*qn.beta),l.y,l.z),i=u.add(l),s=h.add(d)}else{let{p:a,f:o}=this.wNAF(n,r);i=a,s=o}return W.normalizeZ([i,s])[0]}toAffine(t){let{x:r,y:n,z:i}=this,s=this.equals(W.ZERO);t==null&&(t=s?q0:Er(i));let a=t,o=R(a*a),f=R(o*a),c=R(r*o),u=R(n*f),h=R(i*a);if(s)return Z.ZERO;if(h!==nt)throw new Error("invZ was invalid");return new Z(c,u)}};W.BASE=new W(ht.Gx,ht.Gy,nt);W.ZERO=new W(q,nt,q);function Hn(e,t){let r=t.negate();return e?r:t}var Bs=new WeakMap,Z=class{constructor(t,r){this.x=t,this.y=r}_setWindowSize(t){this._WINDOW_SIZE=t,Bs.delete(this)}hasEvenY(){return this.y%Pe===q}static fromCompressedHex(t){let r=t.length===32,n=Ue(r?t:t.subarray(1));if(!Es(n))throw new Error("Point is not on curve");let i=W0(n),s=_p(i),a=(s&nt)===nt;r?a&&(s=R(-s)):(t[0]&1)===1!==a&&(s=R(-s));let o=new Z(n,s);return o.assertValidity(),o}static fromUncompressedHex(t){let r=Ue(t.subarray(1,Yt+1)),n=Ue(t.subarray(Yt+1,Yt*2+1)),i=new Z(r,n);return i.assertValidity(),i}static fromHex(t){let r=Sr(t),n=r.length,i=r[0];if(n===Yt)return this.fromCompressedHex(r);if(n===H0&&(i===2||i===3))return this.fromCompressedHex(r);if(n===G0&&i===4)return this.fromUncompressedHex(r);throw new Error(`Point.fromHex: received invalid point. Expected 32-${H0} compressed bytes or ${G0} uncompressed bytes, not ${n}`)}static fromPrivateKey(t){return Z.BASE.multiply(Zn(t))}static fromSignature(t,r,n){let{r:i,s}=X0(r);if(![0,1,2,3].includes(n))throw new Error("Cannot recover: invalid recovery bit");let a=Ts(Sr(t)),{n:o}=ht,f=n===2||n===3?i+o:i,c=Er(f,o),u=R(-a*c,o),h=R(s*c,o),l=n&1?"03":"02",d=Z.fromHex(l+xr(f)),p=Z.BASE.multiplyAndAddUnsafe(d,u,h);if(!p)throw new Error("Cannot recover signature: point at infinify");return p.assertValidity(),p}toRawBytes(t=!1){return er(this.toHex(t))}toHex(t=!1){let r=xr(this.x);return t?`${this.hasEvenY()?"02":"03"}${r}`:`04${r}${xr(this.y)}`}toHexX(){return this.toHex(!0).slice(2)}toRawX(){return this.toRawBytes(!0).slice(1)}assertValidity(){let t="Point is not on elliptic curve",{x:r,y:n}=this;if(!Es(r)||!Es(n))throw new Error(t);let i=R(n*n),s=W0(r);if(R(i-s)!==q)throw new Error(t)}equals(t){return this.x===t.x&&this.y===t.y}negate(){return new Z(this.x,R(-this.y))}double(){return W.fromAffine(this).double().toAffine()}add(t){return W.fromAffine(this).add(W.fromAffine(t)).toAffine()}subtract(t){return this.add(t.negate())}multiply(t){return W.fromAffine(this).multiply(t,this).toAffine()}multiplyAndAddUnsafe(t,r,n){let i=W.fromAffine(this),s=r===q||r===nt||this!==Z.BASE?i.multiplyUnsafe(r):i.multiply(r),a=W.fromAffine(t).multiplyUnsafe(n),o=s.add(a);return o.equals(W.ZERO)?void 0:o.toAffine()}};Z.BASE=new Z(ht.Gx,ht.Gy);Z.ZERO=new Z(q,q);function Z0(e){return Number.parseInt(e[0],16)>=8?"00"+e:e}function Y0(e){if(e.length<2||e[0]!==2)throw new Error(`Invalid signature integer tag: ${wr(e)}`);let t=e[1],r=e.subarray(2,t+2);if(!t||r.length!==t)throw new Error("Invalid signature integer: wrong length");if(r[0]===0&&r[1]<=127)throw new Error("Invalid signature integer: trailing length");return{data:Ue(r),left:e.subarray(t+2)}}function Cp(e){if(e.length<2||e[0]!=48)throw new Error(`Invalid signature tag: ${wr(e)}`);if(e[1]!==e.length-2)throw new Error("Invalid signature: incorrect length");let{data:t,left:r}=Y0(e.subarray(2)),{data:n,left:i}=Y0(r);if(i.length)throw new Error(`Invalid signature: left bytes after parsing: ${wr(i)}`);return{r:t,s:n}}var ce=class{constructor(t,r){this.r=t,this.s=r,this.assertValidity()}static fromCompact(t){let r=t instanceof Uint8Array,n="Signature.fromCompact";if(typeof t!="string"&&!r)throw new TypeError(`${n}: Expected string or Uint8Array`);let i=r?wr(t):t;if(i.length!==128)throw new Error(`${n}: Expected 64-byte hex`);return new ce($n(i.slice(0,64)),$n(i.slice(64,128)))}static fromDER(t){let r=t instanceof Uint8Array;if(typeof t!="string"&&!r)throw new TypeError("Signature.fromDER: Expected string or Uint8Array");let{r:n,s:i}=Cp(r?t:er(t));return new ce(n,i)}static fromHex(t){return this.fromDER(t)}assertValidity(){let{r:t,s:r}=this;if(!Yr(t))throw new Error("Invalid Signature: r must be 0 < r < n");if(!Yr(r))throw new Error("Invalid Signature: s must be 0 < s < n")}hasHighS(){let t=ht.n>>nt;return this.s>t}normalizeS(){return this.hasHighS()?new ce(this.r,R(-this.s,ht.n)):this}toDERRawBytes(){return er(this.toDERHex())}toDERHex(){let t=Z0(Wr(this.s)),r=Z0(Wr(this.r)),n=t.length/2,i=r.length/2,s=Wr(n),a=Wr(i);return`30${Wr(i+n+4)}02${a}${r}02${s}${t}`}toRawBytes(){return this.toDERRawBytes()}toHex(){return this.toDERHex()}toCompactRawBytes(){return er(this.toCompactHex())}toCompactHex(){return xr(this.r)+xr(this.s)}};function ke(...e){if(!e.every(n=>n instanceof Uint8Array))throw new Error("Uint8Array list expected");if(e.length===1)return e[0];let t=e.reduce((n,i)=>n+i.length,0),r=new Uint8Array(t);for(let n=0,i=0;n<e.length;n++){let s=e[n];r.set(s,i),i+=s.length}return r}var Tp=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function wr(e){if(!(e instanceof Uint8Array))throw new Error("Expected Uint8Array");let t="";for(let r=0;r<e.length;r++)t+=Tp[e[r]];return t}var Ip=BigInt("0x10000000000000000000000000000000000000000000000000000000000000000");function xr(e){if(typeof e!="bigint")throw new Error("Expected bigint");if(!(q<=e&&e<Ip))throw new Error("Expected number 0 <= n < 2^256");return e.toString(16).padStart(64,"0")}function As(e){let t=er(xr(e));if(t.length!==32)throw new Error("Error: expected 32 bytes");return t}function Wr(e){let t=e.toString(16);return t.length&1?`0${t}`:t}function $n(e){if(typeof e!="string")throw new TypeError("hexToNumber: expected string, got "+typeof e);return BigInt(`0x${e}`)}function er(e){if(typeof e!="string")throw new TypeError("hexToBytes: expected string, got "+typeof e);if(e.length%2)throw new Error("hexToBytes: received invalid unpadded hex"+e.length);let t=new Uint8Array(e.length/2);for(let r=0;r<t.length;r++){let n=r*2,i=e.slice(n,n+2),s=Number.parseInt(i,16);if(Number.isNaN(s)||s<0)throw new Error("Invalid byte sequence");t[r]=s}return t}function Ue(e){return $n(wr(e))}function Sr(e){return e instanceof Uint8Array?Uint8Array.from(e):er(e)}function Q0(e){if(typeof e=="number"&&Number.isSafeInteger(e)&&e>0)return BigInt(e);if(typeof e=="bigint"&&Yr(e))return e;throw new TypeError("Expected valid private scalar: 0 < scalar < curve.n")}function R(e,t=ht.P){let r=e%t;return r>=q?r:t+r}function Vt(e,t){let{P:r}=ht,n=e;for(;t-- >q;)n*=n,n%=r;return n}function _p(e){let{P:t}=ht,r=BigInt(6),n=BigInt(11),i=BigInt(22),s=BigInt(23),a=BigInt(44),o=BigInt(88),f=e*e*e%t,c=f*f*e%t,u=Vt(c,$r)*c%t,h=Vt(u,$r)*c%t,l=Vt(h,Pe)*f%t,d=Vt(l,n)*l%t,p=Vt(d,i)*d%t,g=Vt(p,a)*p%t,x=Vt(g,o)*g%t,v=Vt(x,a)*p%t,B=Vt(v,$r)*c%t,A=Vt(B,s)*d%t,L=Vt(A,r)*f%t,T=Vt(L,Pe);if(T*T%t!==e)throw new Error("Cannot find square root");return T}function Er(e,t=ht.P){if(e===q||t<=q)throw new Error(`invert: expected positive integers, got n=${e} mod=${t}`);let r=R(e,t),n=t,i=q,s=nt,a=nt,o=q;for(;r!==q;){let c=n/r,u=n%r,h=i-a*c,l=s-o*c;n=r,r=u,i=a,s=o,a=h,o=l}if(n!==nt)throw new Error("invert: does not exist");return R(i,t)}function Rp(e,t=ht.P){let r=new Array(e.length),n=e.reduce((s,a,o)=>a===q?s:(r[o]=s,R(s*a,t)),nt),i=Er(n,t);return e.reduceRight((s,a,o)=>a===q?s:(r[o]=R(s*r[o],t),R(s*a,t)),i),r}function Np(e){let t=e.length*8-br*8,r=Ue(e);return t>0?r>>BigInt(t):r}function Ts(e,t=!1){let r=Np(e);if(t)return r;let{n}=ht;return r>=n?r-n:r}var vr,Zr,Cs=class{constructor(t,r){if(this.hashLen=t,this.qByteLen=r,typeof t!="number"||t<2)throw new Error("hashLen must be a number");if(typeof r!="number"||r<2)throw new Error("qByteLen must be a number");this.v=new Uint8Array(t).fill(1),this.k=new Uint8Array(t).fill(0),this.counter=0}hmac(...t){return Qt.hmacSha256(this.k,...t)}hmacSync(...t){return Zr(this.k,...t)}checkSync(){if(typeof Zr!="function")throw new Wn("hmacSha256Sync needs to be set")}incr(){if(this.counter>=1e3)throw new Error("Tried 1,000 k values for sign(), all were invalid");this.counter+=1}async reseed(t=new Uint8Array){this.k=await this.hmac(this.v,Uint8Array.from([0]),t),this.v=await this.hmac(this.v),t.length!==0&&(this.k=await this.hmac(this.v,Uint8Array.from([1]),t),this.v=await this.hmac(this.v))}reseedSync(t=new Uint8Array){this.checkSync(),this.k=this.hmacSync(this.v,Uint8Array.from([0]),t),this.v=this.hmacSync(this.v),t.length!==0&&(this.k=this.hmacSync(this.v,Uint8Array.from([1]),t),this.v=this.hmacSync(this.v))}async generate(){this.incr();let t=0,r=[];for(;t<this.qByteLen;){this.v=await this.hmac(this.v);let n=this.v.slice();r.push(n),t+=this.v.length}return ke(...r)}generateSync(){this.checkSync(),this.incr();let t=0,r=[];for(;t<this.qByteLen;){this.v=this.hmacSync(this.v);let n=this.v.slice();r.push(n),t+=this.v.length}return ke(...r)}};function Yr(e){return q<e&&e<ht.n}function Es(e){return q<e&&e<ht.P}function Dp(e,t,r,n=!0){let{n:i}=ht,s=Ts(e,!0);if(!Yr(s))return;let a=Er(s,i),o=Z.BASE.multiply(s),f=R(o.x,i);if(f===q)return;let c=R(a*R(t+r*f,i),i);if(c===q)return;let u=new ce(f,c),h=(o.x===u.r?0:2)|Number(o.y&nt);return n&&u.hasHighS()&&(u=u.normalizeS(),h^=1),{sig:u,recovery:h}}function Zn(e){let t;if(typeof e=="bigint")t=e;else if(typeof e=="number"&&Number.isSafeInteger(e)&&e>0)t=BigInt(e);else if(typeof e=="string"){if(e.length!==2*br)throw new Error("Expected 32 bytes of private key");t=$n(e)}else if(e instanceof Uint8Array){if(e.length!==br)throw new Error("Expected 32 bytes of private key");t=Ue(e)}else throw new TypeError("Expected valid private key");if(!Yr(t))throw new Error("Expected private key: 0 < key < n");return t}function Lp(e){return e instanceof Z?(e.assertValidity(),e):Z.fromHex(e)}function X0(e){if(e instanceof ce)return e.assertValidity(),e;try{return ce.fromDER(e)}catch{return ce.fromCompact(e)}}function Is(e,t=!1){return Z.fromPrivateKey(e).toRawBytes(t)}function J0(e){let t=e.length>Yt?e.slice(0,Yt):e;return Ue(t)}function kp(e){let t=J0(e),r=R(t,ht.n);return j0(r<q?t:r)}function j0(e){return As(e)}function Pp(e,t,r){if(e==null)throw new Error(`sign: expected valid message hash, not "${e}"`);let n=Sr(e),i=Zn(t),s=[j0(i),kp(n)];if(r!=null){r===!0&&(r=Qt.randomBytes(Yt));let f=Sr(r);if(f.length!==Yt)throw new Error(`sign: Expected ${Yt} bytes of extra data`);s.push(f)}let a=ke(...s),o=J0(n);return{seed:a,m:o,d:i}}function Up(e,t){let{sig:r,recovery:n}=e,{der:i,recovered:s}=Object.assign({canonical:!0,der:!0},t),a=i?r.toDERRawBytes():r.toCompactRawBytes();return s?[a,n]:a}async function tf(e,t,r={}){let{seed:n,m:i,d:s}=Pp(e,t,r.extraEntropy),a=new Cs(Ap,br);await a.reseed(n);let o;for(;!(o=Dp(await a.generate(),i,s,r.canonical));)await a.reseed();return Up(o,r)}var Kp={strict:!0};function ef(e,t,r,n=Kp){let i;try{i=X0(e),t=Sr(t)}catch{return!1}let{r:s,s:a}=i;if(n.strict&&i.hasHighS())return!1;let o=Ts(t),f;try{f=Lp(r)}catch{return!1}let{n:c}=ht,u=Er(a,c),h=R(o*u,c),l=R(s*u,c),d=Z.BASE.multiplyAndAddUnsafe(f,h,l);return d?R(d.x,c)===s:!1}Z.BASE._setWindowSize(8);var Ut={node:Bp,web:typeof self=="object"&&"crypto"in self?self.crypto:void 0};var Gn={},Qt={bytesToHex:wr,hexToBytes:er,concatBytes:ke,mod:R,invert:Er,isValidPrivateKey(e){try{return Zn(e),!0}catch{return!1}},_bigintTo32Bytes:As,_normalizePrivateKey:Zn,hashToPrivateKey:e=>{e=Sr(e);let t=br+8;if(e.length<t||e.length>1024)throw new Error("Expected valid bytes of private key as per FIPS 186");let r=R(Ue(e),ht.n-nt)+nt;return As(r)},randomBytes:(e=32)=>{if(Ut.web)return Ut.web.getRandomValues(new Uint8Array(e));if(Ut.node){let{randomBytes:t}=Ut.node;return Uint8Array.from(t(e))}else throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>Qt.hashToPrivateKey(Qt.randomBytes(br+8)),precompute(e=8,t=Z.BASE){let r=t===Z.BASE?t:new Z(t.x,t.y);return r._setWindowSize(e),r.multiply($r),r},sha256:async(...e)=>{if(Ut.web){let t=await Ut.web.subtle.digest("SHA-256",ke(...e));return new Uint8Array(t)}else if(Ut.node){let{createHash:t}=Ut.node,r=t("sha256");return e.forEach(n=>r.update(n)),Uint8Array.from(r.digest())}else throw new Error("The environment doesn't have sha256 function")},hmacSha256:async(e,...t)=>{if(Ut.web){let r=await Ut.web.subtle.importKey("raw",e,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),n=ke(...t),i=await Ut.web.subtle.sign("HMAC",r,n);return new Uint8Array(i)}else if(Ut.node){let{createHmac:r}=Ut.node,n=r("sha256",e);return t.forEach(i=>n.update(i)),Uint8Array.from(n.digest())}else throw new Error("The environment doesn't have hmac-sha256 function")},sha256Sync:void 0,hmacSha256Sync:void 0,taggedHash:async(e,...t)=>{let r=Gn[e];if(r===void 0){let n=await Qt.sha256(Uint8Array.from(e,i=>i.charCodeAt(0)));r=ke(n,n),Gn[e]=r}return Qt.sha256(r,...t)},taggedHashSync:(e,...t)=>{if(typeof vr!="function")throw new Wn("sha256Sync is undefined, you need to set it");let r=Gn[e];if(r===void 0){let n=vr(Uint8Array.from(e,i=>i.charCodeAt(0)));r=ke(n,n),Gn[e]=r}return vr(r,...t)},_JacobianPoint:W};Object.defineProperties(Qt,{sha256Sync:{configurable:!1,get(){return vr},set(e){vr||(vr=e)}},hmacSha256Sync:{configurable:!1,get(){return Zr},set(e){Zr||(Zr=e)}}});function Yn(e){if(isNaN(e)||e<=0)throw new Y("random bytes length must be a Number bigger than 0","ERR_INVALID_LENGTH");return Qt.randomBytes(e)}var rr={};Bt(rr,{jwkToPkcs1:()=>Fp,jwkToPkix:()=>qp,pkcs1ToJwk:()=>Mp,pkixToJwk:()=>Vp});var J2=st(qr(),1),j2=st(Vn(),1),Se=st(X(),1);function Mp(e){let t=Se.default.asn1.fromDer(j(e,"ascii")),r=Se.default.pki.privateKeyFromAsn1(t);return{kty:"RSA",n:Zt(r.n),e:Zt(r.e),d:Zt(r.d),p:Zt(r.p),q:Zt(r.q),dp:Zt(r.dP),dq:Zt(r.dQ),qi:Zt(r.qInv),alg:"RS256"}}function Fp(e){if(e.n==null||e.e==null||e.d==null||e.p==null||e.q==null||e.dp==null||e.dq==null||e.qi==null)throw new Y("JWK was missing components","ERR_INVALID_PARAMETERS");let t=Se.default.pki.privateKeyToAsn1({n:Pt(e.n),e:Pt(e.e),d:Pt(e.d),p:Pt(e.p),q:Pt(e.q),dP:Pt(e.dp),dQ:Pt(e.dq),qInv:Pt(e.qi)});return Ct(Se.default.asn1.toDer(t).getBytes(),"ascii")}function Vp(e){let t=Se.default.asn1.fromDer(j(e,"ascii")),r=Se.default.pki.publicKeyFromAsn1(t);return{kty:"RSA",n:Zt(r.n),e:Zt(r.e)}}function qp(e){if(e.n==null||e.e==null)throw new Y("JWK was missing components","ERR_INVALID_PARAMETERS");let t=Se.default.pki.publicKeyToAsn1({n:Pt(e.n),e:Pt(e.e)});return Ct(Se.default.asn1.toDer(t).getBytes(),"ascii")}var ig=st(Vn(),1),_s=st(X(),1);function rf(e,t){return t.map(r=>Pt(e[r]))}function nf(e){return _s.default.pki.setRsaPrivateKey(...rf(e,["n","e","d","p","q","dp","dq","qi"]))}function sf(e){return _s.default.pki.setRsaPublicKey(...rf(e,["n","e"]))}async function af(e){let t=await Dt.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),r=await cf(t);return{privateKey:r[0],publicKey:r[1]}}async function Rs(e){let r=[await Dt.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["sign"]),await zp(e)],n=await cf({privateKey:r[0],publicKey:r[1]});return{privateKey:n[0],publicKey:n[1]}}async function of(e,t){let r=await Dt.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),n=await Dt.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},r,Uint8Array.from(t));return new Uint8Array(n,0,n.byteLength)}async function ff(e,t,r){let n=await Dt.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return await Dt.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},n,t,r)}async function cf(e){if(e.privateKey==null||e.publicKey==null)throw new Y("Private and public key are required","ERR_INVALID_PARAMETERS");return await Promise.all([Dt.get().subtle.exportKey("jwk",e.privateKey),Dt.get().subtle.exportKey("jwk",e.publicKey)])}async function zp(e){return await Dt.get().subtle.importKey("jwk",{kty:e.kty,n:e.n,e:e.e},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["verify"])}function uf(e,t,r,n){let i=t?sf(e):nf(e),s=j(Uint8Array.from(r),"ascii"),a=n(s,i);return Ct(a,"ascii")}function hf(e,t){return uf(e,!0,t,(r,n)=>n.encrypt(r))}function lf(e,t){return uf(e,!1,t,(r,n)=>n.decrypt(r))}async function Br(e,t){let n=await bs().encrypt(e,t);return gn.encode(n)}var Xr=class{constructor(t){this._key=t}async verify(t,r){return await ff(this._key,r,t)}marshal(){return rr.jwkToPkix(this._key)}get bytes(){return ee.encode({Type:at.RSA,Data:this.marshal()}).subarray()}encrypt(t){return hf(this._key,t)}equals(t){return gt(this.bytes,t.bytes)}async hash(){let{bytes:t}=await At.digest(this.bytes);return t}},Ar=class{constructor(t,r){this._key=t,this._publicKey=r}genSecret(){return Yn(16)}async sign(t){return await of(this._key,t)}get public(){if(this._publicKey==null)throw new Y("public key not provided","ERR_PUBKEY_NOT_PROVIDED");return new Xr(this._publicKey)}decrypt(t){return lf(this._key,t)}marshal(){return rr.jwkToPkcs1(this._key)}get bytes(){return re.encode({Type:at.RSA,Data:this.marshal()}).subarray()}equals(t){return gt(this.bytes,t.bytes)}async hash(){let{bytes:t}=await At.digest(this.bytes);return t}async id(){let t=await this.public.hash();return j(t,"base58btc")}async export(t,r="pkcs-8"){if(r==="pkcs-8"){let n=new Qr.default.util.ByteBuffer(this.marshal()),i=Qr.default.asn1.fromDer(n),s=Qr.default.pki.privateKeyFromAsn1(i),a={algorithm:"aes256",count:1e4,saltSize:128/8,prfAlgorithm:"sha512"};return Qr.default.pki.encryptRsaPrivateKey(s,t,a)}else{if(r==="libp2p-key")return await Br(this.bytes,t);throw new Y(`export format '${r}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}}};async function Gp(e){let t=rr.pkcs1ToJwk(e),r=await Rs(t);return new Ar(r.privateKey,r.publicKey)}function Wp(e){let t=rr.pkixToJwk(e);return new Xr(t)}async function $p(e){let t=await Rs(e);return new Ar(t.privateKey,t.publicKey)}async function Zp(e){let t=await af(e);return new Ar(t.privateKey,t.publicKey)}var Fs={};Bt(Fs,{Ed25519PrivateKey:()=>ir,Ed25519PublicKey:()=>rn,generateKeyPair:()=>yd,generateKeyPairFromSeed:()=>Tf,unmarshalEd25519PrivateKey:()=>pd,unmarshalEd25519PublicKey:()=>dd});var Yp=st(yr(),1);var St=BigInt(0),z=BigInt(1),Me=BigInt(2),Qp=BigInt(8),pf=BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),it=Object.freeze({a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),P:BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),l:pf,n:pf,h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960")});var xf=BigInt("0x10000000000000000000000000000000000000000000000000000000000000000"),Jr=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),wg=BigInt("6853475219497561581579357271197624642482790079785650197046958215289687604742"),Xp=BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),Jp=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),jp=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),td=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952"),M=class{constructor(t,r,n,i){this.x=t,this.y=r,this.z=n,this.t=i}static fromAffine(t){if(!(t instanceof ft))throw new TypeError("ExtendedPoint#fromAffine: expected Point");return t.equals(ft.ZERO)?M.ZERO:new M(t.x,t.y,z,S(t.x*t.y))}static toAffineBatch(t){let r=nd(t.map(n=>n.z));return t.map((n,i)=>n.toAffine(r[i]))}static normalizeZ(t){return this.toAffineBatch(t).map(this.fromAffine)}equals(t){yf(t);let{x:r,y:n,z:i}=this,{x:s,y:a,z:o}=t,f=S(r*o),c=S(s*i),u=S(n*o),h=S(a*i);return f===c&&u===h}negate(){return new M(S(-this.x),this.y,this.z,S(-this.t))}double(){let{x:t,y:r,z:n}=this,{a:i}=it,s=S(t*t),a=S(r*r),o=S(Me*S(n*n)),f=S(i*s),c=t+r,u=S(S(c*c)-s-a),h=f+a,l=h-o,d=f-a,p=S(u*l),g=S(h*d),x=S(u*d),v=S(l*h);return new M(p,g,v,x)}add(t){yf(t);let{x:r,y:n,z:i,t:s}=this,{x:a,y:o,z:f,t:c}=t,u=S((n-r)*(o+a)),h=S((n+r)*(o-a)),l=S(h-u);if(l===St)return this.double();let d=S(i*Me*c),p=S(s*Me*f),g=p+d,x=h+u,v=p-d,B=S(g*l),A=S(x*v),L=S(g*v),T=S(l*x);return new M(B,A,T,L)}subtract(t){return this.add(t.negate())}precomputeWindow(t){let r=1+256/t,n=[],i=this,s=i;for(let a=0;a<r;a++){s=i,n.push(s);for(let o=1;o<2**(t-1);o++)s=s.add(i),n.push(s);i=s.double()}return n}wNAF(t,r){!r&&this.equals(M.BASE)&&(r=ft.BASE);let n=r&&r._WINDOW_SIZE||1;if(256%n)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let i=r&&Us.get(r);i||(i=this.precomputeWindow(n),r&&n!==1&&(i=M.normalizeZ(i),Us.set(r,i)));let s=M.ZERO,a=M.BASE,o=1+256/n,f=2**(n-1),c=BigInt(2**n-1),u=2**n,h=BigInt(n);for(let l=0;l<o;l++){let d=l*f,p=Number(t&c);t>>=h,p>f&&(p-=u,t+=z);let g=d,x=d+Math.abs(p)-1,v=l%2!==0,B=p<0;p===0?a=a.add(df(v,i[g])):s=s.add(df(B,i[x]))}return M.normalizeZ([s,a])[0]}multiply(t,r){return this.wNAF(Xn(t,it.l),r)}multiplyUnsafe(t){let r=Xn(t,it.l,!1),n=M.BASE,i=M.ZERO;if(r===St)return i;if(this.equals(i)||r===z)return this;if(this.equals(n))return this.wNAF(r);let s=i,a=this;for(;r>St;)r&z&&(s=s.add(a)),a=a.double(),r>>=z;return s}isSmallOrder(){return this.multiplyUnsafe(it.h).equals(M.ZERO)}isTorsionFree(){let t=this.multiplyUnsafe(it.l/Me).double();return it.l%Me&&(t=t.add(this)),t.equals(M.ZERO)}toAffine(t){let{x:r,y:n,z:i}=this,s=this.equals(M.ZERO);t==null&&(t=s?Qp:Jn(i));let a=S(r*t),o=S(n*t),f=S(i*t);if(s)return ft.ZERO;if(f!==z)throw new Error("invZ was invalid");return new ft(a,o)}fromRistrettoBytes(){Ls()}toRistrettoBytes(){Ls()}fromRistrettoHash(){Ls()}};M.BASE=new M(it.Gx,it.Gy,z,S(it.Gx*it.Gy));M.ZERO=new M(St,z,z,St);function df(e,t){let r=t.negate();return e?r:t}function yf(e){if(!(e instanceof M))throw new TypeError("ExtendedPoint expected")}function Ds(e){if(!(e instanceof Lt))throw new TypeError("RistrettoPoint expected")}function Ls(){throw new Error("Legacy method: switch to RistrettoPoint")}var Lt=class{constructor(t){this.ep=t}static calcElligatorRistrettoMap(t){let{d:r}=it,n=S(Jr*t*t),i=S((n+z)*jp),s=BigInt(-1),a=S((s-r*n)*S(n+r)),{isValid:o,value:f}=Os(i,a),c=S(f*t);Oe(c)||(c=S(-c)),o||(f=c),o||(s=n);let u=S(s*(n-z)*td-a),h=f*f,l=S((f+f)*a),d=S(u*Xp),p=S(z-h),g=S(z+h);return new M(S(l*g),S(p*d),S(d*g),S(l*p))}static hashToCurve(t){t=Fe(t,64);let r=ks(t.slice(0,32)),n=this.calcElligatorRistrettoMap(r),i=ks(t.slice(32,64)),s=this.calcElligatorRistrettoMap(i);return new Lt(n.add(s))}static fromHex(t){t=Fe(t,32);let{a:r,d:n}=it,i="RistrettoPoint.fromHex: the hex is not valid encoding of RistrettoPoint",s=ks(t);if(!sd(jr(s),t)||Oe(s))throw new Error(i);let a=S(s*s),o=S(z+r*a),f=S(z-r*a),c=S(o*o),u=S(f*f),h=S(r*n*c-u),{isValid:l,value:d}=mf(S(h*u)),p=S(d*f),g=S(d*p*h),x=S((s+s)*p);Oe(x)&&(x=S(-x));let v=S(o*g),B=S(x*v);if(!l||Oe(B)||v===St)throw new Error(i);return new Lt(new M(x,v,z,B))}toRawBytes(){let{x:t,y:r,z:n,t:i}=this.ep,s=S(S(n+r)*S(n-r)),a=S(t*r),o=S(a*a),{value:f}=mf(S(s*o)),c=S(f*s),u=S(f*a),h=S(c*u*i),l;if(Oe(i*h)){let p=S(r*Jr),g=S(t*Jr);t=p,r=g,l=S(c*Jp)}else l=u;Oe(t*h)&&(r=S(-r));let d=S((n-r)*l);return Oe(d)&&(d=S(-d)),jr(d)}toHex(){return tn(this.toRawBytes())}toString(){return this.toHex()}equals(t){Ds(t);let r=this.ep,n=t.ep,i=S(r.x*n.y)===S(r.y*n.x),s=S(r.y*n.y)===S(r.x*n.x);return i||s}add(t){return Ds(t),new Lt(this.ep.add(t.ep))}subtract(t){return Ds(t),new Lt(this.ep.subtract(t.ep))}multiply(t){return new Lt(this.ep.multiply(t))}multiplyUnsafe(t){return new Lt(this.ep.multiplyUnsafe(t))}};Lt.BASE=new Lt(M.BASE);Lt.ZERO=new Lt(M.ZERO);var Us=new WeakMap,ft=class{constructor(t,r){this.x=t,this.y=r}_setWindowSize(t){this._WINDOW_SIZE=t,Us.delete(this)}static fromHex(t,r=!0){let{d:n,P:i}=it;t=Fe(t,32);let s=t.slice();s[31]=t[31]&-129;let a=en(s);if(r&&a>=i)throw new Error("Expected 0 < hex < P");if(!r&&a>=xf)throw new Error("Expected 0 < hex < 2**256");let o=S(a*a),f=S(o-z),c=S(n*o+z),{isValid:u,value:h}=Os(f,c);if(!u)throw new Error("Point.fromHex: invalid y coordinate");let l=(h&z)===z;return(t[31]&128)!==0!==l&&(h=S(-h)),new ft(h,a)}static async fromPrivateKey(t){return(await jn(t)).point}toRawBytes(){let t=jr(this.y);return t[31]|=this.x&z?128:0,t}toHex(){return tn(this.toRawBytes())}toX25519(){let{y:t}=this,r=S((z+t)*Jn(z-t));return jr(r)}isTorsionFree(){return M.fromAffine(this).isTorsionFree()}equals(t){return this.x===t.x&&this.y===t.y}negate(){return new ft(S(-this.x),this.y)}add(t){return M.fromAffine(this).add(M.fromAffine(t)).toAffine()}subtract(t){return this.add(t.negate())}multiply(t){return M.fromAffine(this).multiply(t,this).toAffine()}};ft.BASE=new ft(it.Gx,it.Gy);ft.ZERO=new ft(St,z);var nr=class{constructor(t,r){this.r=t,this.s=r,this.assertValidity()}static fromHex(t){let r=Fe(t,64),n=ft.fromHex(r.slice(0,32),!1),i=en(r.slice(32,64));return new nr(n,i)}assertValidity(){let{r:t,s:r}=this;if(!(t instanceof ft))throw new Error("Expected Point instance");return Xn(r,it.l,!1),this}toRawBytes(){let t=new Uint8Array(64);return t.set(this.r.toRawBytes()),t.set(jr(this.s),32),t}toHex(){return tn(this.toRawBytes())}};function gf(...e){if(!e.every(n=>n instanceof Uint8Array))throw new Error("Expected Uint8Array list");if(e.length===1)return e[0];let t=e.reduce((n,i)=>n+i.length,0),r=new Uint8Array(t);for(let n=0,i=0;n<e.length;n++){let s=e[n];r.set(s,i),i+=s.length}return r}var ed=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function tn(e){if(!(e instanceof Uint8Array))throw new Error("Uint8Array expected");let t="";for(let r=0;r<e.length;r++)t+=ed[e[r]];return t}function Ks(e){if(typeof e!="string")throw new TypeError("hexToBytes: expected string, got "+typeof e);if(e.length%2)throw new Error("hexToBytes: received invalid unpadded hex");let t=new Uint8Array(e.length/2);for(let r=0;r<t.length;r++){let n=r*2,i=e.slice(n,n+2),s=Number.parseInt(i,16);if(Number.isNaN(s)||s<0)throw new Error("Invalid byte sequence");t[r]=s}return t}function vf(e){let r=e.toString(16).padStart(64,"0");return Ks(r)}function jr(e){return vf(e).reverse()}function Oe(e){return(S(e)&z)===z}function en(e){if(!(e instanceof Uint8Array))throw new Error("Expected Uint8Array");return BigInt("0x"+tn(Uint8Array.from(e).reverse()))}var rd=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");function ks(e){return S(en(e)&rd)}function S(e,t=it.P){let r=e%t;return r>=St?r:t+r}function Jn(e,t=it.P){if(e===St||t<=St)throw new Error(`invert: expected positive integers, got n=${e} mod=${t}`);let r=S(e,t),n=t,i=St,s=z,a=z,o=St;for(;r!==St;){let c=n/r,u=n%r,h=i-a*c,l=s-o*c;n=r,r=u,i=a,s=o,a=h,o=l}if(n!==z)throw new Error("invert: does not exist");return S(i,t)}function nd(e,t=it.P){let r=new Array(e.length),n=e.reduce((s,a,o)=>a===St?s:(r[o]=s,S(s*a,t)),z),i=Jn(n,t);return e.reduceRight((s,a,o)=>a===St?s:(r[o]=S(s*r[o],t),S(s*a,t)),i),r}function ue(e,t){let{P:r}=it,n=e;for(;t-- >St;)n*=n,n%=r;return n}function id(e){let{P:t}=it,r=BigInt(5),n=BigInt(10),i=BigInt(20),s=BigInt(40),a=BigInt(80),f=e*e%t*e%t,c=ue(f,Me)*f%t,u=ue(c,z)*e%t,h=ue(u,r)*u%t,l=ue(h,n)*h%t,d=ue(l,i)*l%t,p=ue(d,s)*d%t,g=ue(p,a)*p%t,x=ue(g,a)*p%t,v=ue(x,n)*h%t;return{pow_p_5_8:ue(v,Me)*e%t,b2:f}}function Os(e,t){let r=S(t*t*t),n=S(r*r*t),i=id(e*n).pow_p_5_8,s=S(e*r*i),a=S(t*s*s),o=s,f=S(s*Jr),c=a===e,u=a===S(-e),h=a===S(-e*Jr);return c&&(s=o),(u||h)&&(s=f),Oe(s)&&(s=S(-s)),{isValid:c||u,value:s}}function mf(e){return Os(z,e)}function Qn(e){return S(en(e),it.l)}function sd(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function Fe(e,t){let r=e instanceof Uint8Array?Uint8Array.from(e):Ks(e);if(typeof t=="number"&&r.length!==t)throw new Error(`Expected ${t} bytes`);return r}function Xn(e,t,r=!0){if(!t)throw new TypeError("Specify max value");if(typeof e=="number"&&Number.isSafeInteger(e)&&(e=BigInt(e)),typeof e=="bigint"&&e<t){if(r){if(St<e)return e}else if(St<=e)return e}throw new TypeError("Expected valid scalar: 0 < scalar < max")}function ad(e){return e[0]&=248,e[31]&=127,e[31]|=64,e}function od(e){if(e=typeof e=="bigint"||typeof e=="number"?vf(Xn(e,xf)):Fe(e),e.length!==32)throw new Error("Expected 32 bytes");return e}function fd(e){let t=ad(e.slice(0,32)),r=e.slice(32,64),n=Qn(t),i=ft.BASE.multiply(n),s=i.toRawBytes();return{head:t,prefix:r,scalar:n,point:i,pointBytes:s}}var Ps;async function jn(e){return fd(await Ve.sha512(od(e)))}async function Ms(e){return(await jn(e)).pointBytes}async function bf(e,t){e=Fe(e);let{prefix:r,scalar:n,pointBytes:i}=await jn(t),s=Qn(await Ve.sha512(r,e)),a=ft.BASE.multiply(s),o=Qn(await Ve.sha512(a.toRawBytes(),i,e)),f=S(s+o*n,it.l);return new nr(a,f).toRawBytes()}function cd(e,t,r){t=Fe(t),r instanceof ft||(r=ft.fromHex(r,!1));let{r:n,s:i}=e instanceof nr?e.assertValidity():nr.fromHex(e),s=M.BASE.multiplyUnsafe(i);return{r:n,s:i,SB:s,pub:r,msg:t}}function ud(e,t,r,n){let i=Qn(n),s=M.fromAffine(e).multiplyUnsafe(i);return M.fromAffine(t).add(s).subtract(r).multiplyUnsafe(it.h).equals(M.ZERO)}async function wf(e,t,r){let{r:n,SB:i,msg:s,pub:a}=cd(e,t,r),o=await Ve.sha512(n.toRawBytes(),a.toRawBytes(),s);return ud(a,n,i,o)}ft.BASE._setWindowSize(8);var Ke={node:Yp,web:typeof self=="object"&&"crypto"in self?self.crypto:void 0},Ve={bytesToHex:tn,hexToBytes:Ks,concatBytes:gf,getExtendedPublicKey:jn,mod:S,invert:Jn,TORSION_SUBGROUP:["0100000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac037a","0000000000000000000000000000000000000000000000000000000000000080","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc05","ecffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff7f","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc85","0000000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac03fa"],hashToPrivateScalar:e=>{if(e=Fe(e),e.length<40||e.length>1024)throw new Error("Expected 40-1024 bytes of private key as per FIPS 186");return S(en(e),it.l-z)+z},randomBytes:(e=32)=>{if(Ke.web)return Ke.web.getRandomValues(new Uint8Array(e));if(Ke.node){let{randomBytes:t}=Ke.node;return new Uint8Array(t(e).buffer)}else throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>Ve.randomBytes(32),sha512:async(...e)=>{let t=gf(...e);if(Ke.web){let r=await Ke.web.subtle.digest("SHA-512",t.buffer);return new Uint8Array(r)}else{if(Ke.node)return Uint8Array.from(Ke.node.createHash("sha512").update(t).digest());throw new Error("The environment doesn't have sha512 function")}},precompute(e=8,t=ft.BASE){let r=t.equals(ft.BASE)?t:new ft(t.x,t.y);return r._setWindowSize(e),r.multiply(Me),r},sha512Sync:void 0};Object.defineProperties(Ve,{sha512Sync:{configurable:!1,get(){return Ps},set(e){Ps||(Ps=e)}}});var Cr=32,Ee=64,ti=32;async function Sf(){let e=Ve.randomPrivateKey(),t=await Ms(e);return{privateKey:Cf(e,t),publicKey:t}}async function Ef(e){if(e.length!==ti)throw new TypeError('"seed" must be 32 bytes in length.');if(!(e instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, or Uint8Array.');let t=e,r=await Ms(t);return{privateKey:Cf(t,r),publicKey:r}}async function Bf(e,t){let r=e.subarray(0,ti);return await bf(t,r)}async function Af(e,t,r){return await wf(t,r,e)}function Cf(e,t){let r=new Uint8Array(Ee);for(let n=0;n<ti;n++)r[n]=e[n],r[ti+n]=t[n];return r}var rn=class{constructor(t){this._key=Tr(t,Cr)}async verify(t,r){return await Af(this._key,r,t)}marshal(){return this._key}get bytes(){return ee.encode({Type:at.Ed25519,Data:this.marshal()}).subarray()}equals(t){return gt(this.bytes,t.bytes)}async hash(){let{bytes:t}=await At.digest(this.bytes);return t}},ir=class{constructor(t,r){this._key=Tr(t,Ee),this._publicKey=Tr(r,Cr)}async sign(t){return await Bf(this._key,t)}get public(){return new rn(this._publicKey)}marshal(){return this._key}get bytes(){return re.encode({Type:at.Ed25519,Data:this.marshal()}).subarray()}equals(t){return gt(this.bytes,t.bytes)}async hash(){let{bytes:t}=await At.digest(this.bytes);return t}async id(){let t=Ce.digest(this.public.bytes);return yt.encode(t.bytes).substring(1)}async export(t,r="libp2p-key"){if(r==="libp2p-key")return await Br(this.bytes,t);throw new Y(`export format '${r}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}};function pd(e){if(e.length>Ee){e=Tr(e,Ee+Cr);let n=e.subarray(0,Ee),i=e.subarray(Ee,e.length);return new ir(n,i)}e=Tr(e,Ee);let t=e.subarray(0,Ee),r=e.subarray(Cr);return new ir(t,r)}function dd(e){return e=Tr(e,Cr),new rn(e)}async function yd(){let{privateKey:e,publicKey:t}=await Sf();return new ir(e,t)}async function Tf(e){let{privateKey:t,publicKey:r}=await Ef(e);return new ir(t,r)}function Tr(e,t){if(e=Uint8Array.from(e??[]),e.length!==t)throw new Y(`Key must be a Uint8Array of length ${t}, got ${e.length}`,"ERR_INVALID_KEY_TYPE");return e}var qs={};Bt(qs,{Secp256k1PrivateKey:()=>sn,Secp256k1PublicKey:()=>nn,generateKeyPair:()=>vd,unmarshalSecp256k1PrivateKey:()=>md,unmarshalSecp256k1PublicKey:()=>xd});function If(){return Qt.randomPrivateKey()}async function _f(e,t){let{digest:r}=await At.digest(t);try{return await tf(r,e)}catch(n){throw new Y(String(n),"ERR_INVALID_INPUT")}}async function Rf(e,t,r){try{let{digest:n}=await At.digest(r);return ef(t,n,e)}catch(n){throw new Y(String(n),"ERR_INVALID_INPUT")}}function Nf(e){return Z.fromHex(e).toRawBytes(!0)}function Df(e){try{Is(e,!0)}catch(t){throw new Y(String(t),"ERR_INVALID_PRIVATE_KEY")}}function Vs(e){try{Z.fromHex(e)}catch(t){throw new Y(String(t),"ERR_INVALID_PUBLIC_KEY")}}function Lf(e){try{return Is(e,!0)}catch(t){throw new Y(String(t),"ERR_INVALID_PRIVATE_KEY")}}var nn=class{constructor(t){Vs(t),this._key=t}async verify(t,r){return await Rf(this._key,r,t)}marshal(){return Nf(this._key)}get bytes(){return ee.encode({Type:at.Secp256k1,Data:this.marshal()}).subarray()}equals(t){return gt(this.bytes,t.bytes)}async hash(){let{bytes:t}=await At.digest(this.bytes);return t}},sn=class{constructor(t,r){this._key=t,this._publicKey=r??Lf(t),Df(this._key),Vs(this._publicKey)}async sign(t){return await _f(this._key,t)}get public(){return new nn(this._publicKey)}marshal(){return this._key}get bytes(){return re.encode({Type:at.Secp256k1,Data:this.marshal()}).subarray()}equals(t){return gt(this.bytes,t.bytes)}async hash(){let{bytes:t}=await At.digest(this.bytes);return t}async id(){let t=await this.public.hash();return j(t,"base58btc")}async export(t,r="libp2p-key"){if(r==="libp2p-key")return await Br(this.bytes,t);throw new Y(`export format '${r}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}};function md(e){return new sn(e)}function xd(e){return new nn(e)}async function vd(){let e=If();return new sn(e)}var sr={rsa:Ns,ed25519:Fs,secp256k1:qs};function kf(e){let t=Object.keys(sr).join(" / ");return new Y(`invalid or unsupported key type ${e}. Must be ${t}`,"ERR_UNSUPPORTED_KEY_TYPE")}function Pf(e){let t=ee.decode(e),r=t.Data??new Uint8Array;switch(t.Type){case at.RSA:return sr.rsa.unmarshalRsaPublicKey(r);case at.Ed25519:return sr.ed25519.unmarshalEd25519PublicKey(r);case at.Secp256k1:return sr.secp256k1.unmarshalSecp256k1PublicKey(r);default:throw kf(t.Type??"RSA")}}async function Uf(e){let t=re.decode(e),r=t.Data??new Uint8Array;switch(t.Type){case at.RSA:return await sr.rsa.unmarshalRsaPrivateKey(r);case at.Ed25519:return sr.ed25519.unmarshalEd25519PrivateKey(r);case at.Secp256k1:return sr.secp256k1.unmarshalSecp256k1PrivateKey(r);default:throw kf(t.Type??"RSA")}}var Kf={ERR_SIGNATURE_NOT_VALID:"ERR_SIGNATURE_NOT_VALID"};var an;(function(e){let t;e.codec=()=>(t==null&&(t=xe((r,n,i={})=>{i.lengthDelimited!==!1&&n.fork(),r.publicKey!=null&&r.publicKey.byteLength>0&&(n.uint32(10),n.bytes(r.publicKey)),r.payloadType!=null&&r.payloadType.byteLength>0&&(n.uint32(18),n.bytes(r.payloadType)),r.payload!=null&&r.payload.byteLength>0&&(n.uint32(26),n.bytes(r.payload)),r.signature!=null&&r.signature.byteLength>0&&(n.uint32(42),n.bytes(r.signature)),i.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let i={publicKey:new Uint8Array(0),payloadType:new Uint8Array(0),payload:new Uint8Array(0),signature:new Uint8Array(0)},s=n==null?r.len:r.pos+n;for(;r.pos<s;){let a=r.uint32();switch(a>>>3){case 1:i.publicKey=r.bytes();break;case 2:i.payloadType=r.bytes();break;case 3:i.payload=r.bytes();break;case 5:i.signature=r.bytes();break;default:r.skipType(a&7);break}}return i})),t),e.encode=r=>me(r,e.codec()),e.decode=r=>ge(r,e.codec())})(an||(an={}));var Of=Symbol.for("@libp2p/peer-id");var wd=Symbol.for("nodejs.util.inspect.custom"),Mf=Object.values(Te).map(e=>e.decoder).reduce((e,t)=>e.or(t),Te.identity.decoder),Ff=114,zs=36,Hs=37,on=class{constructor(t){this.type=t.type,this.multihash=t.multihash,this.privateKey=t.privateKey,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return`PeerId(${this.toString()})`}get[Of](){return!0}toString(){return this.string==null&&(this.string=yt.encode(this.multihash.bytes).slice(1)),this.string}toCID(){return J.createV1(Ff,this.multihash)}toBytes(){return this.multihash.bytes}toJSON(){return this.toString()}equals(t){if(t instanceof Uint8Array)return gt(this.multihash.bytes,t);if(typeof t=="string")return Sd(t).equals(this);if(t?.multihash?.bytes!=null)return gt(this.multihash.bytes,t.multihash.bytes);throw new Error("not valid Id")}[wd](){return`PeerId(${this.toString()})`}},Ir=class extends on{constructor(t){super({...t,type:"RSA"}),this.type="RSA",this.publicKey=t.publicKey}},_r=class extends on{constructor(t){super({...t,type:"Ed25519"}),this.type="Ed25519",this.publicKey=t.multihash.digest}},Rr=class extends on{constructor(t){super({...t,type:"secp256k1"}),this.type="secp256k1",this.publicKey=t.multihash.digest}};function Sd(e,t){if(t=t??Mf,e.charAt(0)==="1"||e.charAt(0)==="Q"){let r=ze(yt.decode(`z${e}`));return e.startsWith("12D")?new _r({multihash:r}):e.startsWith("16U")?new Rr({multihash:r}):new Ir({multihash:r})}return Gs(Mf.decode(e))}function Gs(e){try{let t=ze(e);if(t.code===Ce.code){if(t.digest.length===zs)return new _r({multihash:t});if(t.digest.length===Hs)return new Rr({multihash:t})}if(t.code===At.code)return new Ir({multihash:t})}catch{return Ed(J.decode(e))}throw new Error("Supplied PeerID CID is invalid")}function Ed(e){if(e==null||e.multihash==null||e.version==null||e.version===1&&e.code!==Ff)throw new Error("Supplied PeerID CID is invalid");let t=e.multihash;if(t.code===At.code)return new Ir({multihash:e.multihash});if(t.code===Ce.code){if(t.digest.length===zs)return new _r({multihash:e.multihash});if(t.digest.length===Hs)return new Rr({multihash:e.multihash})}throw new Error("Supplied PeerID CID is invalid")}async function Vf(e,t){return e.length===zs?new _r({multihash:Jt(Ce.code,e),privateKey:t}):e.length===Hs?new Rr({multihash:Jt(Ce.code,e),privateKey:t}):new Ir({multihash:await At.digest(e),publicKey:e,privateKey:t})}var zf=Symbol.for("@achingbrain/uint8arraylist");function qf(e,t){if(t==null||t<0)throw new RangeError("index is out of bounds");let r=0;for(let n of e){let i=r+n.byteLength;if(t<i)return{buf:n,index:t-r};r=i}throw new RangeError("index is out of bounds")}function ei(e){return!!e?.[zf]}var qe=class{constructor(...t){Object.defineProperty(this,zf,{value:!0}),this.bufs=[],this.length=0,t.length>0&&this.appendAll(t)}*[Symbol.iterator](){yield*this.bufs}get byteLength(){return this.length}append(...t){this.appendAll(t)}appendAll(t){let r=0;for(let n of t)if(n instanceof Uint8Array)r+=n.byteLength,this.bufs.push(n);else if(ei(n))r+=n.byteLength,this.bufs.push(...n.bufs);else throw new Error("Could not append value, must be an Uint8Array or a Uint8ArrayList");this.length+=r}prepend(...t){this.prependAll(t)}prependAll(t){let r=0;for(let n of t.reverse())if(n instanceof Uint8Array)r+=n.byteLength,this.bufs.unshift(n);else if(ei(n))r+=n.byteLength,this.bufs.unshift(...n.bufs);else throw new Error("Could not prepend value, must be an Uint8Array or a Uint8ArrayList");this.length+=r}get(t){let r=qf(this.bufs,t);return r.buf[r.index]}set(t,r){let n=qf(this.bufs,t);n.buf[n.index]=r}write(t,r=0){if(t instanceof Uint8Array)for(let n=0;n<t.length;n++)this.set(r+n,t[n]);else if(ei(t))for(let n=0;n<t.length;n++)this.set(r+n,t.get(n));else throw new Error("Could not write value, must be an Uint8Array or a Uint8ArrayList")}consume(t){if(t=Math.trunc(t),!(Number.isNaN(t)||t<=0)){if(t===this.byteLength){this.bufs=[],this.length=0;return}for(;this.bufs.length>0;)if(t>=this.bufs[0].byteLength)t-=this.bufs[0].byteLength,this.length-=this.bufs[0].byteLength,this.bufs.shift();else{this.bufs[0]=this.bufs[0].subarray(t),this.length-=t;break}}}slice(t,r){let{bufs:n,length:i}=this._subList(t,r);return mt(n,i)}subarray(t,r){let{bufs:n,length:i}=this._subList(t,r);return n.length===1?n[0]:mt(n,i)}sublist(t,r){let{bufs:n,length:i}=this._subList(t,r),s=new qe;return s.length=i,s.bufs=n,s}_subList(t,r){if(t=t??0,r=r??this.length,t<0&&(t=this.length+t),r<0&&(r=this.length+r),t<0||r>this.length)throw new RangeError("index is out of bounds");if(t===r)return{bufs:[],length:0};if(t===0&&r===this.length)return{bufs:[...this.bufs],length:this.length};let n=[],i=0;for(let s=0;s<this.bufs.length;s++){let a=this.bufs[s],o=i,f=o+a.byteLength;if(i=f,t>=f)continue;let c=t>=o&&t<f,u=r>o&&r<=f;if(c&&u){if(t===o&&r===f){n.push(a);break}let h=t-o;n.push(a.subarray(h,h+(r-t)));break}if(c){if(t===0){n.push(a);continue}n.push(a.subarray(t-o));continue}if(u){if(r===f){n.push(a);break}n.push(a.subarray(0,r-o));break}n.push(a)}return{bufs:n,length:r-t}}indexOf(t,r=0){if(!ei(t)&&!(t instanceof Uint8Array))throw new TypeError('The "value" argument must be a Uint8ArrayList or Uint8Array');let n=t instanceof Uint8Array?t:t.subarray();if(r=Number(r??0),isNaN(r)&&(r=0),r<0&&(r=this.length+r),r<0&&(r=0),t.length===0)return r>this.length?this.length:r;let i=n.byteLength;if(i===0)throw new TypeError("search must be at least 1 byte long");let s=256,a=new Int32Array(s);for(let h=0;h<s;h++)a[h]=-1;for(let h=0;h<i;h++)a[n[h]]=h;let o=a,f=this.byteLength-n.byteLength,c=n.byteLength-1,u;for(let h=r;h<=f;h+=u){u=0;for(let l=c;l>=0;l--){let d=this.get(h+l);if(n[l]!==d){u=Math.max(1,l-o[d]);break}}if(u===0)return h}return-1}getInt8(t){let r=this.subarray(t,t+1);return new DataView(r.buffer,r.byteOffset,r.byteLength).getInt8(0)}setInt8(t,r){let n=ye(1);new DataView(n.buffer,n.byteOffset,n.byteLength).setInt8(0,r),this.write(n,t)}getInt16(t,r){let n=this.subarray(t,t+2);return new DataView(n.buffer,n.byteOffset,n.byteLength).getInt16(0,r)}setInt16(t,r,n){let i=de(2);new DataView(i.buffer,i.byteOffset,i.byteLength).setInt16(0,r,n),this.write(i,t)}getInt32(t,r){let n=this.subarray(t,t+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getInt32(0,r)}setInt32(t,r,n){let i=de(4);new DataView(i.buffer,i.byteOffset,i.byteLength).setInt32(0,r,n),this.write(i,t)}getBigInt64(t,r){let n=this.subarray(t,t+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getBigInt64(0,r)}setBigInt64(t,r,n){let i=de(8);new DataView(i.buffer,i.byteOffset,i.byteLength).setBigInt64(0,r,n),this.write(i,t)}getUint8(t){let r=this.subarray(t,t+1);return new DataView(r.buffer,r.byteOffset,r.byteLength).getUint8(0)}setUint8(t,r){let n=ye(1);new DataView(n.buffer,n.byteOffset,n.byteLength).setUint8(0,r),this.write(n,t)}getUint16(t,r){let n=this.subarray(t,t+2);return new DataView(n.buffer,n.byteOffset,n.byteLength).getUint16(0,r)}setUint16(t,r,n){let i=de(2);new DataView(i.buffer,i.byteOffset,i.byteLength).setUint16(0,r,n),this.write(i,t)}getUint32(t,r){let n=this.subarray(t,t+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getUint32(0,r)}setUint32(t,r,n){let i=de(4);new DataView(i.buffer,i.byteOffset,i.byteLength).setUint32(0,r,n),this.write(i,t)}getBigUint64(t,r){let n=this.subarray(t,t+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getBigUint64(0,r)}setBigUint64(t,r,n){let i=de(8);new DataView(i.buffer,i.byteOffset,i.byteLength).setBigUint64(0,r,n),this.write(i,t)}getFloat32(t,r){let n=this.subarray(t,t+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getFloat32(0,r)}setFloat32(t,r,n){let i=de(4);new DataView(i.buffer,i.byteOffset,i.byteLength).setFloat32(0,r,n),this.write(i,t)}getFloat64(t,r){let n=this.subarray(t,t+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getFloat64(0,r)}setFloat64(t,r,n){let i=de(8);new DataView(i.buffer,i.byteOffset,i.byteLength).setFloat64(0,r,n),this.write(i,t)}equals(t){if(t==null||!(t instanceof qe)||t.bufs.length!==this.bufs.length)return!1;for(let r=0;r<this.bufs.length;r++)if(!gt(this.bufs[r],t.bufs[r]))return!1;return!0}static fromUint8Arrays(t,r){let n=new qe;return n.bufs=t,r==null&&(r=t.reduce((i,s)=>i+s.byteLength,0)),n.length=r,n}};function ri(e){return e instanceof Uint8Array?{get(t){return e[t]},set(t,r){e[t]=r}}:{get(t){return e.get(t)},set(t,r){e.set(t,r)}}}var Hf=4294967296,Kt=class{constructor(t=0,r=0){this.hi=t,this.lo=r}toBigInt(t){if(t===!0)return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n);if(this.hi>>>31){let r=~this.lo+1>>>0,n=~this.hi>>>0;return r===0&&(n=n+1>>>0),-(BigInt(r)+(BigInt(n)<<32n))}return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n)}toNumber(t){return Number(this.toBigInt(t))}zzDecode(){let t=-(this.lo&1),r=((this.lo>>>1|this.hi<<31)^t)>>>0,n=(this.hi>>>1^t)>>>0;return new Kt(n,r)}zzEncode(){let t=this.hi>>31,r=((this.hi<<1|this.lo>>>31)^t)>>>0,n=(this.lo<<1^t)>>>0;return new Kt(r,n)}toBytes(t,r=0){let n=ri(t);for(;this.hi>0;)n.set(r++,this.lo&127|128),this.lo=(this.lo>>>7|this.hi<<25)>>>0,this.hi>>>=7;for(;this.lo>127;)n.set(r++,this.lo&127|128),this.lo=this.lo>>>7;n.set(r++,this.lo)}static fromBigInt(t){if(t===0n)return new Kt;let r=t<0;r&&(t=-t);let n=Number(t>>32n)|0,i=Number(t-(BigInt(n)<<32n))|0;return r&&(n=~n>>>0,i=~i>>>0,++i>Hf&&(i=0,++n>Hf&&(n=0))),new Kt(n,i)}static fromNumber(t){if(t===0)return new Kt;let r=t<0;r&&(t=-t);let n=t>>>0,i=(t-n)/4294967296>>>0;return r&&(i=~i>>>0,n=~n>>>0,++n>4294967295&&(n=0,++i>4294967295&&(i=0))),new Kt(i,n)}static fromBytes(t,r=0){let n=ri(t),i=new Kt,s=0;if(t.length-r>4){for(;s<4;++s)if(i.lo=(i.lo|(n.get(r)&127)<<s*7)>>>0,n.get(r++)<128)return i;if(i.lo=(i.lo|(n.get(r)&127)<<28)>>>0,i.hi=(i.hi|(n.get(r)&127)>>4)>>>0,n.get(r++)<128)return i;s=0}else for(;s<4;++s){if(r>=t.length)throw RangeError(`index out of range: ${r} > ${t.length}`);if(i.lo=(i.lo|(n.get(r)&127)<<s*7)>>>0,n.get(r++)<128)return i}if(t.length-r>4){for(;s<5;++s)if(i.hi=(i.hi|(n.get(r)&127)<<s*7+3)>>>0,n.get(r++)<128)return i}else if(r<t.byteLength)for(;s<5;++s){if(r>=t.length)throw RangeError(`index out of range: ${r} > ${t.length}`);if(i.hi=(i.hi|(n.get(r)&127)<<s*7+3)>>>0,n.get(r++)<128)return i}throw RangeError("invalid varint encoding")}};var Bd=Math.pow(2,7),Ad=Math.pow(2,14),Cd=Math.pow(2,21),Td=Math.pow(2,28),Id=Math.pow(2,35),_d=Math.pow(2,42),Rd=Math.pow(2,49),Nd=Math.pow(2,56),Dd=Math.pow(2,63),fn={encodingLength(e){return e<Bd?1:e<Ad?2:e<Cd?3:e<Td?4:e<Id?5:e<_d?6:e<Rd?7:e<Nd?8:e<Dd?9:10},encode(e,t,r=0){if(Number.MAX_SAFE_INTEGER!=null&&e>Number.MAX_SAFE_INTEGER)throw new RangeError("Could not encode varint");return t==null&&(t=ye(fn.encodingLength(e))),Kt.fromNumber(e).toBytes(t,r),t},decode(e,t=0){return Kt.fromBytes(e,t).toNumber(!0)}};var Ld,Xt=class{constructor(t){let{peerId:r,payloadType:n,payload:i,signature:s}=t;this.peerId=r,this.payloadType=n,this.payload=i,this.signature=s}marshal(){if(this.peerId.publicKey==null)throw new Error("Missing public key");return this.marshaled==null&&(this.marshaled=an.encode({publicKey:this.peerId.publicKey,payloadType:this.payloadType,payload:this.payload.subarray(),signature:this.signature})),this.marshaled}equals(t){return gt(this.marshal(),t.marshal())}async validate(t){let r=Gf(t,this.payloadType,this.payload);if(this.peerId.publicKey==null)throw new Error("Missing public key");return await Pf(this.peerId.publicKey).verify(r.subarray(),this.signature)}};Ld=Xt;Xt.createFromProtobuf=async e=>{let t=an.decode(e),r=await Vf(t.publicKey);return new Xt({peerId:r,payloadType:t.payloadType,payload:t.payload,signature:t.signature})};Xt.seal=async(e,t)=>{if(t.privateKey==null)throw new Error("Missing private key");let r=e.domain,n=e.codec,i=e.marshal(),s=Gf(r,n,i),o=await(await Uf(t.privateKey)).sign(s.subarray());return new Xt({peerId:t,payloadType:n,payload:i,signature:o})};Xt.openAndCertify=async(e,t)=>{let r=await Xt.createFromProtobuf(e);if(!await r.validate(t))throw new Y("envelope signature is not valid for the given domain",Kf.ERR_SIGNATURE_NOT_VALID);return r};var Gf=(e,t,r)=>{let n=Ct(e),i=fn.encode(n.byteLength),s=fn.encode(t.length),a=fn.encode(r.length);return new qe(i,n,s,t,a,r)};var ni=class{index=0;input="";new(t){return this.index=0,this.input=t,this}readAtomically(t){let r=this.index,n=t();return n===void 0&&(this.index=r),n}parseWith(t){let r=t();if(this.index===this.input.length)return r}peekChar(){if(!(this.index>=this.input.length))return this.input[this.index]}readChar(){if(!(this.index>=this.input.length))return this.input[this.index++]}readGivenChar(t){return this.readAtomically(()=>{let r=this.readChar();if(r===t)return r})}readSeparator(t,r,n){return this.readAtomically(()=>{if(!(r>0&&this.readGivenChar(t)===void 0))return n()})}readNumber(t,r,n,i){return this.readAtomically(()=>{let s=0,a=0,o=this.peekChar();if(o===void 0)return;let f=o==="0",c=2**(8*i)-1;for(;;){let u=this.readAtomically(()=>{let h=this.readChar();if(h===void 0)return;let l=Number.parseInt(h,t);if(!Number.isNaN(l))return l});if(u===void 0)break;if(s*=t,s+=u,s>c||(a+=1,r!==void 0&&a>r))return}if(a!==0)return!n&&f&&a>1?void 0:s})}readIPv4Addr(){return this.readAtomically(()=>{let t=new Uint8Array(4);for(let r=0;r<t.length;r++){let n=this.readSeparator(".",r,()=>this.readNumber(10,3,!1,1));if(n===void 0)return;t[r]=n}return t})}readIPv6Addr(){let t=r=>{for(let n=0;n<r.length/2;n++){let i=n*2;if(n<r.length-3){let a=this.readSeparator(":",n,()=>this.readIPv4Addr());if(a!==void 0)return r[i]=a[0],r[i+1]=a[1],r[i+2]=a[2],r[i+3]=a[3],[i+4,!0]}let s=this.readSeparator(":",n,()=>this.readNumber(16,4,!0,2));if(s===void 0)return[i,!1];r[i]=s>>8,r[i+1]=s&255}return[r.length,!1]};return this.readAtomically(()=>{let r=new Uint8Array(16),[n,i]=t(r);if(n===16)return r;if(i||this.readGivenChar(":")===void 0||this.readGivenChar(":")===void 0)return;let s=new Uint8Array(14),a=16-(n+2),[o]=t(s.subarray(0,a));return r.set(s.subarray(0,o),16-o),r})}readIPAddr(){return this.readIPv4Addr()??this.readIPv6Addr()}};var Wf=45,kd=15,Nr=new ni;function $f(e){if(!(e.length>kd))return Nr.new(e).parseWith(()=>Nr.readIPv4Addr())}function Zf(e){if(!(e.length>Wf))return Nr.new(e).parseWith(()=>Nr.readIPv6Addr())}function Yf(e){if(!(e.length>Wf))return Nr.new(e).parseWith(()=>Nr.readIPAddr())}function Qf(e){return!!$f(e)}function Xf(e){return!!Zf(e)}function ii(e){return!!Yf(e)}var Jf=Qf,Pd=Xf,Ws=function(e){let t=0;if(e=e.toString().trim(),Jf(e)){let r=new Uint8Array(t+4);return e.split(/\./g).forEach(n=>{r[t++]=parseInt(n,10)&255}),r}if(Pd(e)){let r=e.split(":",8),n;for(n=0;n<r.length;n++){let s=Jf(r[n]),a;s&&(a=Ws(r[n]),r[n]=j(a.slice(0,2),"base16")),a!=null&&++n<8&&r.splice(n,0,j(a.slice(2,4),"base16"))}if(r[0]==="")for(;r.length<8;)r.unshift("0");else if(r[r.length-1]==="")for(;r.length<8;)r.push("0");else if(r.length<8){for(n=0;n<r.length&&r[n]!=="";n++);let s=[n,1];for(n=9-r.length;n>0;n--)s.push("0");r.splice.apply(r,s)}let i=new Uint8Array(t+16);for(n=0;n<r.length;n++){let s=parseInt(r[n],16);i[t++]=s>>8&255,i[t++]=s&255}return i}throw new Error("invalid ip address")},jf=function(e,t=0,r){t=~~t,r=r??e.length-t;let n=new DataView(e.buffer);if(r===4){let i=[];for(let s=0;s<r;s++)i.push(e[t+s]);return i.join(".")}if(r===16){let i=[];for(let s=0;s<r;s+=2)i.push(n.getUint16(t+s).toString(16));return i.join(":").replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3").replace(/:{3,4}/,"::")}return""};var cn={},$s={},Kd=[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,-1,"ip6zone"],[43,8,"ipcidr"],[53,-1,"dns",!0],[54,-1,"dns4",!0],[55,-1,"dns6",!0],[56,-1,"dnsaddr",!0],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[280,0,"webrtc-direct"],[281,0,"webrtc"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,-1,"unix",!1,!0],[421,-1,"ipfs"],[421,-1,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,-1,"garlic64"],[448,0,"tls"],[449,-1,"sni"],[460,0,"quic"],[461,0,"quic-v1"],[465,0,"webtransport"],[466,-1,"certhash"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[777,-1,"memory"]];Kd.forEach(e=>{let t=Od(...e);$s[t.code]=t,cn[t.name]=t});function Od(e,t,r,n,i){return{code:e,size:t,name:r,resolvable:!!n,path:!!i}}function ct(e){if(typeof e=="number"){if($s[e]!=null)return $s[e];throw new Error(`no protocol with code: ${e}`)}else if(typeof e=="string"){if(cn[e]!=null)return cn[e];throw new Error(`no protocol with name: ${e}`)}throw new Error(`invalid protocol id type: ${typeof e}`)}var he=st(si(),1);function pc(e,t){switch(ct(e).code){case 4:case 41:return jd(t);case 42:return hc(t);case 6:case 273:case 33:case 132:return yc(t).toString();case 53:case 54:case 55:case 56:case 400:case 449:case 777:return hc(t);case 421:return ny(t);case 444:return lc(t);case 445:return lc(t);case 466:return ry(t);default:return j(t,"base16")}}function dc(e,t){switch(ct(e).code){case 4:return cc(t);case 41:return cc(t);case 42:return uc(t);case 6:case 273:case 33:case 132:return Xs(parseInt(t,10));case 53:case 54:case 55:case 56:case 400:case 449:case 777:return uc(t);case 421:return ty(t);case 444:return iy(t);case 445:return sy(t);case 466:return ey(t);default:return Ct(t,"base16")}}var Qs=Object.values(Te).map(e=>e.decoder),Jd=function(){let e=Qs[0].or(Qs[1]);return Qs.slice(2).forEach(t=>e=e.or(t)),e}();function cc(e){if(!ii(e))throw new Error("invalid ip address");return Ws(e)}function jd(e){let t=jf(e,0,e.length);if(t==null)throw new Error("ipBuff is required");if(!ii(t))throw new Error("invalid ip address");return t}function Xs(e){let t=new ArrayBuffer(2);return new DataView(t).setUint16(0,e),new Uint8Array(t)}function yc(e){return new DataView(e.buffer).getUint16(e.byteOffset)}function uc(e){let t=Ct(e),r=Uint8Array.from(he.default.encode(t.length));return mt([r,t],r.length+t.length)}function hc(e){let t=he.default.decode(e);if(e=e.slice(he.default.decode.bytes),e.length!==t)throw new Error("inconsistent lengths");return j(e)}function ty(e){let t;e[0]==="Q"||e[0]==="1"?t=ze(yt.decode(`z${e}`)).bytes:t=J.parse(e).multihash.bytes;let r=Uint8Array.from(he.default.encode(t.length));return mt([r,t],r.length+t.length)}function ey(e){let t=Jd.decode(e),r=Uint8Array.from(he.default.encode(t.length));return mt([r,t],r.length+t.length)}function ry(e){let t=he.default.decode(e),r=e.slice(he.default.decode.bytes);if(r.length!==t)throw new Error("inconsistent lengths");return"u"+j(r,"base64url")}function ny(e){let t=he.default.decode(e),r=e.slice(he.default.decode.bytes);if(r.length!==t)throw new Error("inconsistent lengths");return j(r,"base58btc")}function iy(e){let t=e.split(":");if(t.length!==2)throw new Error(`failed to parse onion addr: ["'${t.join('", "')}'"]' does not contain a port number`);if(t[0].length!==16)throw new Error(`failed to parse onion addr: ${t[0]} not a Tor onion address.`);let r=pe.decode("b"+t[0]),n=parseInt(t[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");let i=Xs(n);return mt([r,i],r.length+i.length)}function sy(e){let t=e.split(":");if(t.length!==2)throw new Error(`failed to parse onion addr: ["'${t.join('", "')}'"]' does not contain a port number`);if(t[0].length!==56)throw new Error(`failed to parse onion addr: ${t[0]} not a Tor onion3 address.`);let r=pe.decode(`b${t[0]}`),n=parseInt(t[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");let i=Xs(n);return mt([r,i],r.length+i.length)}function lc(e){let t=e.slice(0,e.length-2),r=e.slice(e.length-2),n=j(t,"base32"),i=yc(r);return`${n}:${i}`}var Dr=st(si(),1);function ay(e){let t=[],r=e.split("/").slice(1);if(r.length===1&&r[0]==="")return[];for(let n=0;n<r.length;n++){let i=r[n],s=ct(i);if(s.size===0){t.push([i]);continue}if(n++,n>=r.length)throw mc("invalid address: "+e);if(s.path===!0){t.push([i,ra(r.slice(n).join("/"))]);break}t.push([i,r[n]])}return t}function oy(e){let t=[];return e.map(r=>{let n=fi(r);return t.push(n.name),r.length>1&&r[1]!=null&&t.push(r[1]),null}),ra(t.join("/"))}function fy(e){return e.map(t=>{Array.isArray(t)||(t=[t]);let r=fi(t);return t.length>1?[r.code,dc(r.code,t[1])]:[r.code]})}function Js(e){return e.map(t=>{let r=fi(t);return t[1]!=null?[r.code,pc(r.code,t[1])]:[r.code]})}function js(e){return oi(mt(e.map(t=>{let r=fi(t),n=Uint8Array.from(Dr.default.encode(r.code));return t.length>1&&t[1]!=null&&(n=mt([n,t[1]])),n})))}function ta(e,t){return e.size>0?e.size/8:e.size===0?0:Dr.default.decode(t)+(Dr.default.decode.bytes??0)}function ai(e){let t=[],r=0;for(;r<e.length;){let n=Dr.default.decode(e,r),i=Dr.default.decode.bytes??0,s=ct(n),a=ta(s,e.slice(r+i));if(a===0){t.push([n]),r+=i;continue}let o=e.slice(r+i,r+i+a);if(r+=a+i,r>e.length)throw mc("Invalid address Uint8Array: "+j(e,"base16"));t.push([n,o])}return t}function ea(e){let t=ai(e),r=Js(t);return oy(r)}function cy(e){e=ra(e);let t=ay(e),r=fy(t);return js(r)}function gc(e){return cy(e)}function oi(e){let t=uy(e);if(t!=null)throw t;return Uint8Array.from(e)}function uy(e){try{ai(e)}catch(t){return t}}function ra(e){return"/"+e.trim().split("/").filter(t=>t).join("/")}function mc(e){return new Error("Error parsing address: "+e)}function fi(e){return ct(e[0])}var ia=st(si(),1);var Sc=st(bc(),1);var Lr=function(e,t,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(e):n?n.value:t.get(e)},na=function(e,t,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(e,r):i?i.value=r:t.set(e,r),r},un,hn,ln,wc,py=Symbol.for("nodejs.util.inspect.custom"),dy=[ct("dns").code,ct("dns4").code,ct("dns6").code,ct("dnsaddr").code],yy=new Map,Ec=Symbol.for("@multiformats/js-multiaddr/multiaddr");function gy(e){return!!e?.[Ec]}var Be=class{constructor(t){if(un.set(this,void 0),hn.set(this,void 0),ln.set(this,void 0),this[wc]=!0,t==null&&(t=""),t instanceof Uint8Array)this.bytes=oi(t);else if(typeof t=="string"){if(t.length>0&&t.charAt(0)!=="/")throw new Error(`multiaddr "${t}" must start with a "/"`);this.bytes=gc(t)}else if(gy(t))this.bytes=oi(t.bytes);else throw new Error("addr must be a string, Buffer, or another Multiaddr")}toString(){return Lr(this,un,"f")==null&&na(this,un,ea(this.bytes),"f"),Lr(this,un,"f")}toJSON(){return this.toString()}toOptions(){let t,r,n,i,s="",a=ct("tcp"),o=ct("udp"),f=ct("ip4"),c=ct("ip6"),u=ct("dns6"),h=ct("ip6zone");for(let[d,p]of this.stringTuples())d===h.code&&(s=`%${p??""}`),dy.includes(d)&&(r=a.name,i=443,n=`${p??""}${s}`,t=d===u.code?6:4),(d===a.code||d===o.code)&&(r=ct(d).name,i=parseInt(p??"")),(d===f.code||d===c.code)&&(r=ct(d).name,n=`${p??""}${s}`,t=d===c.code?6:4);if(t==null||r==null||n==null||i==null)throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6, dnsaddr}/{address}/{tcp, udp}/{port}".');return{family:t,host:n,transport:r,port:i}}protos(){return this.protoCodes().map(t=>Object.assign({},ct(t)))}protoCodes(){let t=[],r=this.bytes,n=0;for(;n<r.length;){let i=ia.default.decode(r,n),s=ia.default.decode.bytes??0,a=ct(i),o=ta(a,r.slice(n+s));n+=o+s,t.push(i)}return t}protoNames(){return this.protos().map(t=>t.name)}tuples(){return Lr(this,hn,"f")==null&&na(this,hn,ai(this.bytes),"f"),Lr(this,hn,"f")}stringTuples(){return Lr(this,ln,"f")==null&&na(this,ln,Js(this.tuples()),"f"),Lr(this,ln,"f")}encapsulate(t){return t=new Be(t),new Be(this.toString()+t.toString())}decapsulate(t){let r=t.toString(),n=this.toString(),i=n.lastIndexOf(r);if(i<0)throw new Error(`Address ${this.toString()} does not contain subaddress: ${t.toString()}`);return new Be(n.slice(0,i))}decapsulateCode(t){let r=this.tuples();for(let n=r.length-1;n>=0;n--)if(r[n][0]===t)return new Be(js(r.slice(0,n)));return this}getPeerId(){try{let r=this.stringTuples().filter(n=>n[0]===cn.ipfs.code).pop();if(r?.[1]!=null){let n=r[1];return n[0]==="Q"||n[0]==="1"?j(yt.decode(`z${n}`),"base58btc"):j(J.parse(n).multihash.bytes,"base58btc")}return null}catch{return null}}getPath(){let t=null;try{t=this.stringTuples().filter(r=>ct(r[0]).path===!0)[0][1],t==null&&(t=null)}catch{t=null}return t}equals(t){return gt(this.bytes,t.bytes)}async resolve(t){let r=this.protos().find(s=>s.resolvable);if(r==null)return[this];let n=yy.get(r.name);if(n==null)throw(0,Sc.default)(new Error(`no available resolver for ${r.name}`),"ERR_NO_AVAILABLE_RESOLVER");return(await n(this,t)).map(s=>new Be(s))}nodeAddress(){let t=this.toOptions();if(t.transport!=="tcp"&&t.transport!=="udp")throw new Error(`multiaddr must have a valid format - no protocol with name: "${t.transport}". Must have a valid transport protocol: "{tcp, udp}"`);return{family:t.family,address:t.host,port:t.port}}isThinWaistAddress(t){let r=(t??this).protos();return!(r.length!==2||r[0].code!==4&&r[0].code!==41||r[1].code!==6&&r[1].code!==273)}[(un=new WeakMap,hn=new WeakMap,ln=new WeakMap,wc=Ec,py)](){return`Multiaddr(${ea(this.bytes)})`}};function Bc(e){return new Be(e)}function Ac(e,t){let r=(n,i)=>n.toString().localeCompare(i.toString());return e.length!==t.length?!1:(t.sort(r),e.sort(r).every((n,i)=>t[i].equals(n)))}var pn;(function(e){let t;(function(n){let i;n.codec=()=>(i==null&&(i=xe((s,a,o={})=>{o.lengthDelimited!==!1&&a.fork(),s.multiaddr!=null&&s.multiaddr.byteLength>0&&(a.uint32(10),a.bytes(s.multiaddr)),o.lengthDelimited!==!1&&a.ldelim()},(s,a)=>{let o={multiaddr:new Uint8Array(0)},f=a==null?s.len:s.pos+a;for(;s.pos<f;){let c=s.uint32();switch(c>>>3){case 1:o.multiaddr=s.bytes();break;default:s.skipType(c&7);break}}return o})),i),n.encode=s=>me(s,n.codec()),n.decode=s=>ge(s,n.codec())})(t=e.AddressInfo||(e.AddressInfo={}));let r;e.codec=()=>(r==null&&(r=xe((n,i,s={})=>{if(s.lengthDelimited!==!1&&i.fork(),n.peerId!=null&&n.peerId.byteLength>0&&(i.uint32(10),i.bytes(n.peerId)),n.seq!=null&&n.seq!==0n&&(i.uint32(16),i.uint64(n.seq)),n.addresses!=null)for(let a of n.addresses)i.uint32(26),e.AddressInfo.codec().encode(a,i);s.lengthDelimited!==!1&&i.ldelim()},(n,i)=>{let s={peerId:new Uint8Array(0),seq:0n,addresses:[]},a=i==null?n.len:n.pos+i;for(;n.pos<a;){let o=n.uint32();switch(o>>>3){case 1:s.peerId=n.bytes();break;case 2:s.seq=n.uint64();break;case 3:s.addresses.push(e.AddressInfo.codec().decode(n,n.uint32()));break;default:n.skipType(o&7);break}}return s})),r),e.encode=n=>me(n,e.codec()),e.decode=n=>ge(n,e.codec())})(pn||(pn={}));var Cc="libp2p-peer-record",Tc=Uint8Array.from([3,1]);var qt=class{constructor(t){this.domain=qt.DOMAIN,this.codec=qt.CODEC;let{peerId:r,multiaddrs:n,seqNumber:i}=t;this.peerId=r,this.multiaddrs=n??[],this.seqNumber=i??BigInt(Date.now())}marshal(){return this.marshaled==null&&(this.marshaled=pn.encode({peerId:this.peerId.toBytes(),seq:BigInt(this.seqNumber),addresses:this.multiaddrs.map(t=>({multiaddr:t.bytes}))})),this.marshaled}equals(t){return!(!(t instanceof qt)||!this.peerId.equals(t.peerId)||this.seqNumber!==t.seqNumber||!Ac(this.multiaddrs,t.multiaddrs))}};qt.createFromProtobuf=e=>{let t=pn.decode(e),r=Gs(t.peerId),n=(t.addresses??[]).map(s=>Bc(s.multiaddr)),i=t.seq;return new qt({peerId:r,multiaddrs:n,seqNumber:i})};qt.DOMAIN=Cc;qt.CODEC=Tc;return Lc(my);})();
/*! Bundled license information:

@noble/secp256k1/lib/esm/index.js:
  (*! noble-secp256k1 - MIT License (c) 2019 Paul Miller (paulmillr.com) *)

@noble/ed25519/lib/esm/index.js:
  (*! noble-ed25519 - MIT License (c) 2019 Paul Miller (paulmillr.com) *)
*/
return Libp2PPeerRecord}));
