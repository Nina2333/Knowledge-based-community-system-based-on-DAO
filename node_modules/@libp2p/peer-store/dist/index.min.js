(function (root, factory) {(typeof module === 'object' && module.exports) ? module.exports = factory() : root.Libp2PPeerStore = factory()}(typeof self !== 'undefined' ? self : this, function () {
"use strict";var Libp2PPeerStore=(()=>{var lh=Object.create;var mi=Object.defineProperty;var hh=Object.getOwnPropertyDescriptor;var dh=Object.getOwnPropertyNames;var ph=Object.getPrototypeOf,yh=Object.prototype.hasOwnProperty;var U=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),Dt=(e,t)=>{for(var r in t)mi(e,r,{get:t[r],enumerable:!0})},p0=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of dh(t))!yh.call(e,i)&&i!==r&&mi(e,i,{get:()=>t[i],enumerable:!(n=hh(t,i))||n.enumerable});return e};var V=(e,t,r)=>(r=e!=null?lh(ph(e)):{},p0(t||!e||!e.__esModule?mi(r,"default",{value:e,enumerable:!0}):r,e)),gh=e=>p0(mi({},"__esModule",{value:!0}),e);var g0=U((_m,y0)=>{var qr=1e3,zr=qr*60,Hr=zr*60,xr=Hr*24,mh=xr*7,xh=xr*365.25;y0.exports=function(e,t){t=t||{};var r=typeof e;if(r==="string"&&e.length>0)return vh(e);if(r==="number"&&isFinite(e))return t.long?bh(e):wh(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))};function vh(e){if(e=String(e),!(e.length>100)){var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(t){var r=parseFloat(t[1]),n=(t[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return r*xh;case"weeks":case"week":case"w":return r*mh;case"days":case"day":case"d":return r*xr;case"hours":case"hour":case"hrs":case"hr":case"h":return r*Hr;case"minutes":case"minute":case"mins":case"min":case"m":return r*zr;case"seconds":case"second":case"secs":case"sec":case"s":return r*qr;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}function wh(e){var t=Math.abs(e);return t>=xr?Math.round(e/xr)+"d":t>=Hr?Math.round(e/Hr)+"h":t>=zr?Math.round(e/zr)+"m":t>=qr?Math.round(e/qr)+"s":e+"ms"}function bh(e){var t=Math.abs(e);return t>=xr?xi(e,t,xr,"day"):t>=Hr?xi(e,t,Hr,"hour"):t>=zr?xi(e,t,zr,"minute"):t>=qr?xi(e,t,qr,"second"):e+" ms"}function xi(e,t,r,n){var i=t>=r*1.5;return Math.round(e/r)+" "+n+(i?"s":"")}});var x0=U((Im,m0)=>{function Eh(e){r.debug=r,r.default=r,r.coerce=c,r.disable=s,r.enable=i,r.enabled=a,r.humanize=g0(),r.destroy=u,Object.keys(e).forEach(f=>{r[f]=e[f]}),r.names=[],r.skips=[],r.formatters={};function t(f){let l=0;for(let h=0;h<f.length;h++)l=(l<<5)-l+f.charCodeAt(h),l|=0;return r.colors[Math.abs(l)%r.colors.length]}r.selectColor=t;function r(f){let l,h=null,p,d;function g(...x){if(!g.enabled)return;let v=g,S=Number(new Date),B=S-(l||S);v.diff=B,v.prev=l,v.curr=S,l=S,x[0]=r.coerce(x[0]),typeof x[0]!="string"&&x.unshift("%O");let L=0;x[0]=x[0].replace(/%([a-zA-Z%])/g,(_,z)=>{if(_==="%%")return"%";L++;let G=r.formatters[z];if(typeof G=="function"){let Ct=x[L];_=G.call(v,Ct),x.splice(L,1),L--}return _}),r.formatArgs.call(v,x),(v.log||r.log).apply(v,x)}return g.namespace=f,g.useColors=r.useColors(),g.color=r.selectColor(f),g.extend=n,g.destroy=r.destroy,Object.defineProperty(g,"enabled",{enumerable:!0,configurable:!1,get:()=>h!==null?h:(p!==r.namespaces&&(p=r.namespaces,d=r.enabled(f)),d),set:x=>{h=x}}),typeof r.init=="function"&&r.init(g),g}function n(f,l){let h=r(this.namespace+(typeof l>"u"?":":l)+f);return h.log=this.log,h}function i(f){r.save(f),r.namespaces=f,r.names=[],r.skips=[];let l,h=(typeof f=="string"?f:"").split(/[\s,]+/),p=h.length;for(l=0;l<p;l++)h[l]&&(f=h[l].replace(/\*/g,".*?"),f[0]==="-"?r.skips.push(new RegExp("^"+f.slice(1)+"$")):r.names.push(new RegExp("^"+f+"$")))}function s(){let f=[...r.names.map(o),...r.skips.map(o).map(l=>"-"+l)].join(",");return r.enable(""),f}function a(f){if(f[f.length-1]==="*")return!0;let l,h;for(l=0,h=r.skips.length;l<h;l++)if(r.skips[l].test(f))return!1;for(l=0,h=r.names.length;l<h;l++)if(r.names[l].test(f))return!0;return!1}function o(f){return f.toString().substring(2,f.toString().length-2).replace(/\.\*\?$/,"*")}function c(f){return f instanceof Error?f.stack||f.message:f}function u(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return r.enable(r.load()),r}m0.exports=Eh});var v0=U((Qt,vi)=>{Qt.formatArgs=Ah;Qt.save=Bh;Qt.load=Ch;Qt.useColors=Sh;Qt.storage=Th();Qt.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();Qt.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function Sh(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function Ah(e){if(e[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" ")+"+"+vi.exports.humanize(this.diff),!this.useColors)return;let t="color: "+this.color;e.splice(1,0,t,"color: inherit");let r=0,n=0;e[0].replace(/%[a-zA-Z%]/g,i=>{i!=="%%"&&(r++,i==="%c"&&(n=r))}),e.splice(n,0,t)}Qt.log=console.debug||console.log||(()=>{});function Bh(e){try{e?Qt.storage.setItem("debug",e):Qt.storage.removeItem("debug")}catch{}}function Ch(){let e;try{e=Qt.storage.getItem("debug")}catch{}return!e&&typeof process<"u"&&"env"in process&&(e=process.env.DEBUG),e}function Th(){try{return localStorage}catch{}}vi.exports=x0()(Qt);var{formatters:_h}=vi.exports;_h.j=function(e){try{return JSON.stringify(e)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}});var Y0=U((D2,Z0)=>{Z0.exports=pa;var Q0=128,Od=127,Md=~Od,Vd=Math.pow(2,31);function pa(e,t,r){if(Number.MAX_SAFE_INTEGER&&e>Number.MAX_SAFE_INTEGER)throw pa.bytes=0,new RangeError("Could not encode varint");t=t||[],r=r||0;for(var n=r;e>=Vd;)t[r++]=e&255|Q0,e/=128;for(;e&Md;)t[r++]=e&255|Q0,e>>>=7;return t[r]=e|0,pa.bytes=r-n+1,t}});var j0=U((P2,J0)=>{J0.exports=ya;var qd=128,X0=127;function ya(e,n){var r=0,n=n||0,i=0,s=n,a,o=e.length;do{if(s>=o||i>49)throw ya.bytes=0,new RangeError("Could not decode varint");a=e[s++],r+=i<28?(a&X0)<<i:(a&X0)*Math.pow(2,i),i+=7}while(a>=qd);return ya.bytes=s-n,r}});var ec=U((U2,tc)=>{var zd=Math.pow(2,7),Hd=Math.pow(2,14),Gd=Math.pow(2,21),Wd=Math.pow(2,28),$d=Math.pow(2,35),Qd=Math.pow(2,42),Zd=Math.pow(2,49),Yd=Math.pow(2,56),Xd=Math.pow(2,63);tc.exports=function(e){return e<zd?1:e<Hd?2:e<Gd?3:e<Wd?4:e<$d?5:e<Qd?6:e<Zd?7:e<Yd?8:e<Xd?9:10}});var Bi=U((K2,rc)=>{rc.exports={encode:Y0(),decode:j0(),encodingLength:ec()}});var Sa=U((nx,dc)=>{"use strict";function hc(e,t){for(let r in t)Object.defineProperty(e,r,{value:t[r],enumerable:!0,configurable:!0});return e}function hp(e,t,r){if(!e||typeof e=="string")throw new TypeError("Please pass an Error to err-code");r||(r={}),typeof t=="object"&&(r=t,t=""),t&&(r.code=t);try{return hc(e,r)}catch{r.message=e.message,r.stack=e.stack;let i=function(){};return i.prototype=Object.create(Object.getPrototypeOf(e)),hc(new i,r)}}dc.exports=hp});var xc=U((hx,mc)=>{"use strict";mc.exports=gp;function gp(e,t){for(var r=new Array(arguments.length-1),n=0,i=2,s=!0;i<arguments.length;)r[n++]=arguments[i++];return new Promise(function(o,c){r[n]=function(f){if(s)if(s=!1,f)c(f);else{for(var l=new Array(arguments.length-1),h=0;h<l.length;)l[h++]=arguments[h];o.apply(null,l)}};try{e.apply(t||null,r)}catch(u){s&&(s=!1,c(u))}})}});var Ec=U(bc=>{"use strict";var Ii=bc;Ii.length=function(t){var r=t.length;if(!r)return 0;for(var n=0;--r%4>1&&t.charAt(r)==="=";)++n;return Math.ceil(t.length*3)/4-n};var jr=new Array(64),wc=new Array(123);for(ue=0;ue<64;)wc[jr[ue]=ue<26?ue+65:ue<52?ue+71:ue<62?ue-4:ue-59|43]=ue++;var ue;Ii.encode=function(t,r,n){for(var i=null,s=[],a=0,o=0,c;r<n;){var u=t[r++];switch(o){case 0:s[a++]=jr[u>>2],c=(u&3)<<4,o=1;break;case 1:s[a++]=jr[c|u>>4],c=(u&15)<<2,o=2;break;case 2:s[a++]=jr[c|u>>6],s[a++]=jr[u&63],o=0;break}a>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,s)),a=0)}return o&&(s[a++]=jr[c],s[a++]=61,o===1&&(s[a++]=61)),i?(a&&i.push(String.fromCharCode.apply(String,s.slice(0,a))),i.join("")):String.fromCharCode.apply(String,s.slice(0,a))};var vc="invalid encoding";Ii.decode=function(t,r,n){for(var i=n,s=0,a,o=0;o<t.length;){var c=t.charCodeAt(o++);if(c===61&&s>1)break;if((c=wc[c])===void 0)throw Error(vc);switch(s){case 0:a=c,s=1;break;case 1:r[n++]=a<<2|(c&48)>>4,a=c,s=2;break;case 2:r[n++]=(a&15)<<4|(c&60)>>2,a=c,s=3;break;case 3:r[n++]=(a&3)<<6|c,s=0;break}}if(s===1)throw Error(vc);return n-i};Ii.test=function(t){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(t)}});var Ac=U((px,Sc)=>{"use strict";Sc.exports=Ri;function Ri(){this._listeners={}}Ri.prototype.on=function(t,r,n){return(this._listeners[t]||(this._listeners[t]=[])).push({fn:r,ctx:n||this}),this};Ri.prototype.off=function(t,r){if(t===void 0)this._listeners={};else if(r===void 0)this._listeners[t]=[];else for(var n=this._listeners[t],i=0;i<n.length;)n[i].fn===r?n.splice(i,1):++i;return this};Ri.prototype.emit=function(t){var r=this._listeners[t];if(r){for(var n=[],i=1;i<arguments.length;)n.push(arguments[i++]);for(i=0;i<r.length;)r[i].fn.apply(r[i++].ctx,n)}return this}});var kc=U((yx,Rc)=>{"use strict";Rc.exports=Bc(Bc);function Bc(e){return typeof Float32Array<"u"?function(){var t=new Float32Array([-0]),r=new Uint8Array(t.buffer),n=r[3]===128;function i(c,u,f){t[0]=c,u[f]=r[0],u[f+1]=r[1],u[f+2]=r[2],u[f+3]=r[3]}function s(c,u,f){t[0]=c,u[f]=r[3],u[f+1]=r[2],u[f+2]=r[1],u[f+3]=r[0]}e.writeFloatLE=n?i:s,e.writeFloatBE=n?s:i;function a(c,u){return r[0]=c[u],r[1]=c[u+1],r[2]=c[u+2],r[3]=c[u+3],t[0]}function o(c,u){return r[3]=c[u],r[2]=c[u+1],r[1]=c[u+2],r[0]=c[u+3],t[0]}e.readFloatLE=n?a:o,e.readFloatBE=n?o:a}():function(){function t(n,i,s,a){var o=i<0?1:0;if(o&&(i=-i),i===0)n(1/i>0?0:2147483648,s,a);else if(isNaN(i))n(2143289344,s,a);else if(i>34028234663852886e22)n((o<<31|2139095040)>>>0,s,a);else if(i<11754943508222875e-54)n((o<<31|Math.round(i/1401298464324817e-60))>>>0,s,a);else{var c=Math.floor(Math.log(i)/Math.LN2),u=Math.round(i*Math.pow(2,-c)*8388608)&8388607;n((o<<31|c+127<<23|u)>>>0,s,a)}}e.writeFloatLE=t.bind(null,Cc),e.writeFloatBE=t.bind(null,Tc);function r(n,i,s){var a=n(i,s),o=(a>>31)*2+1,c=a>>>23&255,u=a&8388607;return c===255?u?NaN:o*(1/0):c===0?o*1401298464324817e-60*u:o*Math.pow(2,c-150)*(u+8388608)}e.readFloatLE=r.bind(null,_c),e.readFloatBE=r.bind(null,Ic)}(),typeof Float64Array<"u"?function(){var t=new Float64Array([-0]),r=new Uint8Array(t.buffer),n=r[7]===128;function i(c,u,f){t[0]=c,u[f]=r[0],u[f+1]=r[1],u[f+2]=r[2],u[f+3]=r[3],u[f+4]=r[4],u[f+5]=r[5],u[f+6]=r[6],u[f+7]=r[7]}function s(c,u,f){t[0]=c,u[f]=r[7],u[f+1]=r[6],u[f+2]=r[5],u[f+3]=r[4],u[f+4]=r[3],u[f+5]=r[2],u[f+6]=r[1],u[f+7]=r[0]}e.writeDoubleLE=n?i:s,e.writeDoubleBE=n?s:i;function a(c,u){return r[0]=c[u],r[1]=c[u+1],r[2]=c[u+2],r[3]=c[u+3],r[4]=c[u+4],r[5]=c[u+5],r[6]=c[u+6],r[7]=c[u+7],t[0]}function o(c,u){return r[7]=c[u],r[6]=c[u+1],r[5]=c[u+2],r[4]=c[u+3],r[3]=c[u+4],r[2]=c[u+5],r[1]=c[u+6],r[0]=c[u+7],t[0]}e.readDoubleLE=n?a:o,e.readDoubleBE=n?o:a}():function(){function t(n,i,s,a,o,c){var u=a<0?1:0;if(u&&(a=-a),a===0)n(0,o,c+i),n(1/a>0?0:2147483648,o,c+s);else if(isNaN(a))n(0,o,c+i),n(2146959360,o,c+s);else if(a>17976931348623157e292)n(0,o,c+i),n((u<<31|2146435072)>>>0,o,c+s);else{var f;if(a<22250738585072014e-324)f=a/5e-324,n(f>>>0,o,c+i),n((u<<31|f/4294967296)>>>0,o,c+s);else{var l=Math.floor(Math.log(a)/Math.LN2);l===1024&&(l=1023),f=a*Math.pow(2,-l),n(f*4503599627370496>>>0,o,c+i),n((u<<31|l+1023<<20|f*1048576&1048575)>>>0,o,c+s)}}}e.writeDoubleLE=t.bind(null,Cc,0,4),e.writeDoubleBE=t.bind(null,Tc,4,0);function r(n,i,s,a,o){var c=n(a,o+i),u=n(a,o+s),f=(u>>31)*2+1,l=u>>>20&2047,h=4294967296*(u&1048575)+c;return l===2047?h?NaN:f*(1/0):l===0?f*5e-324*h:f*Math.pow(2,l-1075)*(h+4503599627370496)}e.readDoubleLE=r.bind(null,_c,0,4),e.readDoubleBE=r.bind(null,Ic,4,0)}(),e}function Cc(e,t,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24}function Tc(e,t,r){t[r]=e>>>24,t[r+1]=e>>>16&255,t[r+2]=e>>>8&255,t[r+3]=e&255}function _c(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function Ic(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}});var Nc=U((exports,module)=>{"use strict";module.exports=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}});var Dc=U(Lc=>{"use strict";var Ta=Lc;Ta.length=function(t){for(var r=0,n=0,i=0;i<t.length;++i)n=t.charCodeAt(i),n<128?r+=1:n<2048?r+=2:(n&64512)===55296&&(t.charCodeAt(i+1)&64512)===56320?(++i,r+=4):r+=3;return r};Ta.read=function(t,r,n){var i=n-r;if(i<1)return"";for(var s=null,a=[],o=0,c;r<n;)c=t[r++],c<128?a[o++]=c:c>191&&c<224?a[o++]=(c&31)<<6|t[r++]&63:c>239&&c<365?(c=((c&7)<<18|(t[r++]&63)<<12|(t[r++]&63)<<6|t[r++]&63)-65536,a[o++]=55296+(c>>10),a[o++]=56320+(c&1023)):a[o++]=(c&15)<<12|(t[r++]&63)<<6|t[r++]&63,o>8191&&((s||(s=[])).push(String.fromCharCode.apply(String,a)),o=0);return s?(o&&s.push(String.fromCharCode.apply(String,a.slice(0,o))),s.join("")):String.fromCharCode.apply(String,a.slice(0,o))};Ta.write=function(t,r,n){for(var i=n,s,a,o=0;o<t.length;++o)s=t.charCodeAt(o),s<128?r[n++]=s:s<2048?(r[n++]=s>>6|192,r[n++]=s&63|128):(s&64512)===55296&&((a=t.charCodeAt(o+1))&64512)===56320?(s=65536+((s&1023)<<10)+(a&1023),++o,r[n++]=s>>18|240,r[n++]=s>>12&63|128,r[n++]=s>>6&63|128,r[n++]=s&63|128):(r[n++]=s>>12|224,r[n++]=s>>6&63|128,r[n++]=s&63|128);return n-i}});var Uc=U((mx,Pc)=>{"use strict";Pc.exports=mp;function mp(e,t,r){var n=r||8192,i=n>>>1,s=null,a=n;return function(c){if(c<1||c>i)return e(c);a+c>n&&(s=e(n),a=0);var u=t.call(s,a,a+=c);return a&7&&(a=(a|7)+1),u}}});var Fc=U((xx,Kc)=>{"use strict";Kc.exports=It;var Rn=Fe();function It(e,t){this.lo=e>>>0,this.hi=t>>>0}var Sr=It.zero=new It(0,0);Sr.toNumber=function(){return 0};Sr.zzEncode=Sr.zzDecode=function(){return this};Sr.length=function(){return 1};var xp=It.zeroHash="\0\0\0\0\0\0\0\0";It.fromNumber=function(t){if(t===0)return Sr;var r=t<0;r&&(t=-t);var n=t>>>0,i=(t-n)/4294967296>>>0;return r&&(i=~i>>>0,n=~n>>>0,++n>4294967295&&(n=0,++i>4294967295&&(i=0))),new It(n,i)};It.from=function(t){if(typeof t=="number")return It.fromNumber(t);if(Rn.isString(t))if(Rn.Long)t=Rn.Long.fromString(t);else return It.fromNumber(parseInt(t,10));return t.low||t.high?new It(t.low>>>0,t.high>>>0):Sr};It.prototype.toNumber=function(t){if(!t&&this.hi>>>31){var r=~this.lo+1>>>0,n=~this.hi>>>0;return r||(n=n+1>>>0),-(r+n*4294967296)}return this.lo+this.hi*4294967296};It.prototype.toLong=function(t){return Rn.Long?new Rn.Long(this.lo|0,this.hi|0,Boolean(t)):{low:this.lo|0,high:this.hi|0,unsigned:Boolean(t)}};var Ye=String.prototype.charCodeAt;It.fromHash=function(t){return t===xp?Sr:new It((Ye.call(t,0)|Ye.call(t,1)<<8|Ye.call(t,2)<<16|Ye.call(t,3)<<24)>>>0,(Ye.call(t,4)|Ye.call(t,5)<<8|Ye.call(t,6)<<16|Ye.call(t,7)<<24)>>>0)};It.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)};It.prototype.zzEncode=function(){var t=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^t)>>>0,this.lo=(this.lo<<1^t)>>>0,this};It.prototype.zzDecode=function(){var t=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^t)>>>0,this.hi=(this.hi>>>1^t)>>>0,this};It.prototype.length=function(){var t=this.lo,r=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return n===0?r===0?t<16384?t<128?1:2:t<2097152?3:4:r<16384?r<128?5:6:r<2097152?7:8:n<128?9:10}});var Fe=U(_a=>{"use strict";var N=_a;N.asPromise=xc();N.base64=Ec();N.EventEmitter=Ac();N.float=kc();N.inquire=Nc();N.utf8=Dc();N.pool=Uc();N.LongBits=Fc();N.isNode=Boolean(typeof globalThis<"u"&&globalThis&&globalThis.process&&globalThis.process.versions&&globalThis.process.versions.node);N.global=N.isNode&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||_a;N.emptyArray=Object.freeze?Object.freeze([]):[];N.emptyObject=Object.freeze?Object.freeze({}):{};N.isInteger=Number.isInteger||function(t){return typeof t=="number"&&isFinite(t)&&Math.floor(t)===t};N.isString=function(t){return typeof t=="string"||t instanceof String};N.isObject=function(t){return t&&typeof t=="object"};N.isset=N.isSet=function(t,r){var n=t[r];return n!=null&&t.hasOwnProperty(r)?typeof n!="object"||(Array.isArray(n)?n.length:Object.keys(n).length)>0:!1};N.Buffer=function(){try{var e=N.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch{return null}}();N._Buffer_from=null;N._Buffer_allocUnsafe=null;N.newBuffer=function(t){return typeof t=="number"?N.Buffer?N._Buffer_allocUnsafe(t):new N.Array(t):N.Buffer?N._Buffer_from(t):typeof Uint8Array>"u"?t:new Uint8Array(t)};N.Array=typeof Uint8Array<"u"?Uint8Array:Array;N.Long=N.global.dcodeIO&&N.global.dcodeIO.Long||N.global.Long||N.inquire("long");N.key2Re=/^true|false|0|1$/;N.key32Re=/^-?(?:0|[1-9][0-9]*)$/;N.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/;N.longToHash=function(t){return t?N.LongBits.from(t).toHash():N.LongBits.zeroHash};N.longFromHash=function(t,r){var n=N.LongBits.fromHash(t);return N.Long?N.Long.fromBits(n.lo,n.hi,r):n.toNumber(Boolean(r))};function Oc(e,t,r){for(var n=Object.keys(t),i=0;i<n.length;++i)(e[n[i]]===void 0||!r)&&(e[n[i]]=t[n[i]]);return e}N.merge=Oc;N.lcFirst=function(t){return t.charAt(0).toLowerCase()+t.substring(1)};function Mc(e){function t(r,n){if(!(this instanceof t))return new t(r,n);Object.defineProperty(this,"message",{get:function(){return r}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:new Error().stack||""}),n&&Oc(this,n)}return t.prototype=Object.create(Error.prototype,{constructor:{value:t,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return e},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),t}N.newError=Mc;N.ProtocolError=Mc("ProtocolError");N.oneOfGetter=function(t){for(var r={},n=0;n<t.length;++n)r[t[n]]=1;return function(){for(var i=Object.keys(this),s=i.length-1;s>-1;--s)if(r[i[s]]===1&&this[i[s]]!==void 0&&this[i[s]]!==null)return i[s]}};N.oneOfSetter=function(t){return function(r){for(var n=0;n<t.length;++n)t[n]!==r&&delete this[t[n]]}};N.toJSONOptions={longs:String,enums:String,bytes:String,json:!0};N._configure=function(){var e=N.Buffer;if(!e){N._Buffer_from=N._Buffer_allocUnsafe=null;return}N._Buffer_from=e.from!==Uint8Array.from&&e.from||function(r,n){return new e(r,n)},N._Buffer_allocUnsafe=e.allocUnsafe||function(r){return new e(r)}}});var kn=U((wx,Gc)=>{"use strict";Gc.exports=vt;var we=Fe(),Ra,zc=we.LongBits,vp=we.utf8;function fe(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function vt(e){this.buf=e,this.pos=0,this.len=e.length}var Vc=typeof Uint8Array<"u"?function(t){if(t instanceof Uint8Array||Array.isArray(t))return new vt(t);throw Error("illegal buffer")}:function(t){if(Array.isArray(t))return new vt(t);throw Error("illegal buffer")},Hc=function(){return we.Buffer?function(r){return(vt.create=function(i){return we.Buffer.isBuffer(i)?new Ra(i):Vc(i)})(r)}:Vc};vt.create=Hc();vt.prototype._slice=we.Array.prototype.subarray||we.Array.prototype.slice;vt.prototype.uint32=function(){var t=4294967295;return function(){if(t=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(t=(t|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(t=(t|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(t=(t|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(t=(t|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return t;if((this.pos+=5)>this.len)throw this.pos=this.len,fe(this,10);return t}}();vt.prototype.int32=function(){return this.uint32()|0};vt.prototype.sint32=function(){var t=this.uint32();return t>>>1^-(t&1)|0};function Ia(){var e=new zc(0,0),t=0;if(this.len-this.pos>4){for(;t<4;++t)if(e.lo=(e.lo|(this.buf[this.pos]&127)<<t*7)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(this.buf[this.pos]&127)<<28)>>>0,e.hi=(e.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return e;t=0}else{for(;t<3;++t){if(this.pos>=this.len)throw fe(this);if(e.lo=(e.lo|(this.buf[this.pos]&127)<<t*7)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(this.buf[this.pos++]&127)<<t*7)>>>0,e}if(this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(this.buf[this.pos]&127)<<t*7+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw fe(this);if(e.hi=(e.hi|(this.buf[this.pos]&127)<<t*7+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}vt.prototype.bool=function(){return this.uint32()!==0};function ki(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}vt.prototype.fixed32=function(){if(this.pos+4>this.len)throw fe(this,4);return ki(this.buf,this.pos+=4)};vt.prototype.sfixed32=function(){if(this.pos+4>this.len)throw fe(this,4);return ki(this.buf,this.pos+=4)|0};function qc(){if(this.pos+8>this.len)throw fe(this,8);return new zc(ki(this.buf,this.pos+=4),ki(this.buf,this.pos+=4))}vt.prototype.float=function(){if(this.pos+4>this.len)throw fe(this,4);var t=we.float.readFloatLE(this.buf,this.pos);return this.pos+=4,t};vt.prototype.double=function(){if(this.pos+8>this.len)throw fe(this,4);var t=we.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,t};vt.prototype.bytes=function(){var t=this.uint32(),r=this.pos,n=this.pos+t;if(n>this.len)throw fe(this,t);return this.pos+=t,Array.isArray(this.buf)?this.buf.slice(r,n):r===n?new this.buf.constructor(0):this._slice.call(this.buf,r,n)};vt.prototype.string=function(){var t=this.bytes();return vp.read(t,0,t.length)};vt.prototype.skip=function(t){if(typeof t=="number"){if(this.pos+t>this.len)throw fe(this,t);this.pos+=t}else do if(this.pos>=this.len)throw fe(this);while(this.buf[this.pos++]&128);return this};vt.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(e=this.uint32()&7)!==4;)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this};vt._configure=function(e){Ra=e,vt.create=Hc(),Ra._configure();var t=we.Long?"toLong":"toNumber";we.merge(vt.prototype,{int64:function(){return Ia.call(this)[t](!1)},uint64:function(){return Ia.call(this)[t](!0)},sint64:function(){return Ia.call(this).zzDecode()[t](!1)},fixed64:function(){return qc.call(this)[t](!0)},sfixed64:function(){return qc.call(this)[t](!1)}})}});var Ni=U((bx,Qc)=>{"use strict";Qc.exports=Ar;var $c=kn();(Ar.prototype=Object.create($c.prototype)).constructor=Ar;var Wc=Fe();function Ar(e){$c.call(this,e)}Ar._configure=function(){Wc.Buffer&&(Ar.prototype._slice=Wc.Buffer.prototype.slice)};Ar.prototype.string=function(){var t=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+t,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+t,this.len))};Ar._configure()});var Ln=U((Ex,Jc)=>{"use strict";Jc.exports=Z;var ne=Fe(),ka,Li=ne.LongBits,Zc=ne.base64,Yc=ne.utf8;function Nn(e,t,r){this.fn=e,this.len=t,this.next=void 0,this.val=r}function La(){}function wp(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function Z(){this.len=0,this.head=new Nn(La,0,0),this.tail=this.head,this.states=null}var Xc=function(){return ne.Buffer?function(){return(Z.create=function(){return new ka})()}:function(){return new Z}};Z.create=Xc();Z.alloc=function(t){return new ne.Array(t)};ne.Array!==Array&&(Z.alloc=ne.pool(Z.alloc,ne.Array.prototype.subarray));Z.prototype._push=function(t,r,n){return this.tail=this.tail.next=new Nn(t,r,n),this.len+=r,this};function Da(e,t,r){t[r]=e&255}function bp(e,t,r){for(;e>127;)t[r++]=e&127|128,e>>>=7;t[r]=e}function Pa(e,t){this.len=e,this.next=void 0,this.val=t}Pa.prototype=Object.create(Nn.prototype);Pa.prototype.fn=bp;Z.prototype.uint32=function(t){return this.len+=(this.tail=this.tail.next=new Pa((t=t>>>0)<128?1:t<16384?2:t<2097152?3:t<268435456?4:5,t)).len,this};Z.prototype.int32=function(t){return t<0?this._push(Ua,10,Li.fromNumber(t)):this.uint32(t)};Z.prototype.sint32=function(t){return this.uint32((t<<1^t>>31)>>>0)};function Ua(e,t,r){for(;e.hi;)t[r++]=e.lo&127|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[r++]=e.lo&127|128,e.lo=e.lo>>>7;t[r++]=e.lo}Z.prototype.uint64=function(t){var r=Li.from(t);return this._push(Ua,r.length(),r)};Z.prototype.int64=Z.prototype.uint64;Z.prototype.sint64=function(t){var r=Li.from(t).zzEncode();return this._push(Ua,r.length(),r)};Z.prototype.bool=function(t){return this._push(Da,1,t?1:0)};function Na(e,t,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24}Z.prototype.fixed32=function(t){return this._push(Na,4,t>>>0)};Z.prototype.sfixed32=Z.prototype.fixed32;Z.prototype.fixed64=function(t){var r=Li.from(t);return this._push(Na,4,r.lo)._push(Na,4,r.hi)};Z.prototype.sfixed64=Z.prototype.fixed64;Z.prototype.float=function(t){return this._push(ne.float.writeFloatLE,4,t)};Z.prototype.double=function(t){return this._push(ne.float.writeDoubleLE,8,t)};var Ep=ne.Array.prototype.set?function(t,r,n){r.set(t,n)}:function(t,r,n){for(var i=0;i<t.length;++i)r[n+i]=t[i]};Z.prototype.bytes=function(t){var r=t.length>>>0;if(!r)return this._push(Da,1,0);if(ne.isString(t)){var n=Z.alloc(r=Zc.length(t));Zc.decode(t,n,0),t=n}return this.uint32(r)._push(Ep,r,t)};Z.prototype.string=function(t){var r=Yc.length(t);return r?this.uint32(r)._push(Yc.write,r,t):this._push(Da,1,0)};Z.prototype.fork=function(){return this.states=new wp(this),this.head=this.tail=new Nn(La,0,0),this.len=0,this};Z.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Nn(La,0,0),this.len=0),this};Z.prototype.ldelim=function(){var t=this.head,r=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=t.next,this.tail=r,this.len+=n),this};Z.prototype.finish=function(){for(var t=this.head.next,r=this.constructor.alloc(this.len),n=0;t;)t.fn(t.val,r,n),n+=t.len,t=t.next;return r};Z._configure=function(e){ka=e,Z.create=Xc(),ka._configure()}});var Di=U((Sx,tu)=>{"use strict";tu.exports=be;var jc=Ln();(be.prototype=Object.create(jc.prototype)).constructor=be;var Xe=Fe();function be(){jc.call(this)}be._configure=function(){be.alloc=Xe._Buffer_allocUnsafe,be.writeBytesBuffer=Xe.Buffer&&Xe.Buffer.prototype instanceof Uint8Array&&Xe.Buffer.prototype.set.name==="set"?function(t,r,n){r.set(t,n)}:function(t,r,n){if(t.copy)t.copy(r,n,0,t.length);else for(var i=0;i<t.length;)r[n++]=t[i++]}};be.prototype.bytes=function(t){Xe.isString(t)&&(t=Xe._Buffer_from(t,"base64"));var r=t.length>>>0;return this.uint32(r),r&&this._push(be.writeBytesBuffer,r,t),this};function Sp(e,t,r){e.length<40?Xe.utf8.write(e,t,r):t.utf8Write?t.utf8Write(e,r):t.write(e,r)}be.prototype.string=function(t){var r=Xe.Buffer.byteLength(t);return this.uint32(r),r&&this._push(Sp,r,t),this};be._configure()});var et=U((Vx,su)=>{su.exports={options:{usePureJavaScript:!1}}});var cu=U((qx,ou)=>{var za={};ou.exports=za;var au={};za.encode=function(e,t,r){if(typeof t!="string")throw new TypeError('"alphabet" must be a string.');if(r!==void 0&&typeof r!="number")throw new TypeError('"maxline" must be a number.');var n="";if(!(e instanceof Uint8Array))n=Tp(e,t);else{var i=0,s=t.length,a=t.charAt(0),o=[0];for(i=0;i<e.length;++i){for(var c=0,u=e[i];c<o.length;++c)u+=o[c]<<8,o[c]=u%s,u=u/s|0;for(;u>0;)o.push(u%s),u=u/s|0}for(i=0;e[i]===0&&i<e.length-1;++i)n+=a;for(i=o.length-1;i>=0;--i)n+=t[o[i]]}if(r){var f=new RegExp(".{1,"+r+"}","g");n=n.match(f).join(`\r
`)}return n};za.decode=function(e,t){if(typeof e!="string")throw new TypeError('"input" must be a string.');if(typeof t!="string")throw new TypeError('"alphabet" must be a string.');var r=au[t];if(!r){r=au[t]=[];for(var n=0;n<t.length;++n)r[t.charCodeAt(n)]=n}e=e.replace(/\s/g,"");for(var i=t.length,s=t.charAt(0),a=[0],n=0;n<e.length;n++){var o=r[e.charCodeAt(n)];if(o===void 0)return;for(var c=0,u=o;c<a.length;++c)u+=a[c]*i,a[c]=u&255,u>>=8;for(;u>0;)a.push(u&255),u>>=8}for(var f=0;e[f]===s&&f<e.length-1;++f)a.push(0);return typeof Buffer<"u"?Buffer.from(a.reverse()):new Uint8Array(a.reverse())};function Tp(e,t){var r=0,n=t.length,i=t.charAt(0),s=[0];for(r=0;r<e.length();++r){for(var a=0,o=e.at(r);a<s.length;++a)o+=s[a]<<8,s[a]=o%n,o=o/n|0;for(;o>0;)s.push(o%n),o=o/n|0}var c="";for(r=0;e.at(r)===0&&r<e.length()-1;++r)c+=i;for(r=s.length-1;r>=0;--r)c+=t[s[r]];return c}});var St=U((zx,hu)=>{var uu=et(),fu=cu(),y=hu.exports=uu.util=uu.util||{};(function(){if(typeof process<"u"&&process.nextTick&&!process.browser){y.nextTick=process.nextTick,typeof setImmediate=="function"?y.setImmediate=setImmediate:y.setImmediate=y.nextTick;return}if(typeof setImmediate=="function"){y.setImmediate=function(){return setImmediate.apply(void 0,arguments)},y.nextTick=function(o){return setImmediate(o)};return}if(y.setImmediate=function(o){setTimeout(o,0)},typeof window<"u"&&typeof window.postMessage=="function"){let o=function(c){if(c.source===window&&c.data===e){c.stopPropagation();var u=t.slice();t.length=0,u.forEach(function(f){f()})}};var a=o,e="forge.setImmediate",t=[];y.setImmediate=function(c){t.push(c),t.length===1&&window.postMessage(e,"*")},window.addEventListener("message",o,!0)}if(typeof MutationObserver<"u"){var r=Date.now(),n=!0,i=document.createElement("div"),t=[];new MutationObserver(function(){var c=t.slice();t.length=0,c.forEach(function(u){u()})}).observe(i,{attributes:!0});var s=y.setImmediate;y.setImmediate=function(c){Date.now()-r>15?(r=Date.now(),s(c)):(t.push(c),t.length===1&&i.setAttribute("a",n=!n))}}y.nextTick=y.setImmediate})();y.isNodejs=typeof process<"u"&&process.versions&&process.versions.node;y.globalScope=function(){return y.isNodejs?globalThis:typeof self>"u"?window:self}();y.isArray=Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"};y.isArrayBuffer=function(e){return typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer};y.isArrayBufferView=function(e){return e&&y.isArrayBuffer(e.buffer)&&e.byteLength!==void 0};function Dn(e){if(!(e===8||e===16||e===24||e===32))throw new Error("Only 8, 16, 24, or 32 bits supported: "+e)}y.ByteBuffer=Ha;function Ha(e){if(this.data="",this.read=0,typeof e=="string")this.data=e;else if(y.isArrayBuffer(e)||y.isArrayBufferView(e))if(typeof Buffer<"u"&&e instanceof Buffer)this.data=e.toString("binary");else{var t=new Uint8Array(e);try{this.data=String.fromCharCode.apply(null,t)}catch{for(var r=0;r<t.length;++r)this.putByte(t[r])}}else(e instanceof Ha||typeof e=="object"&&typeof e.data=="string"&&typeof e.read=="number")&&(this.data=e.data,this.read=e.read);this._constructedStringLength=0}y.ByteStringBuffer=Ha;var _p=4096;y.ByteStringBuffer.prototype._optimizeConstructedString=function(e){this._constructedStringLength+=e,this._constructedStringLength>_p&&(this.data.substr(0,1),this._constructedStringLength=0)};y.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read};y.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0};y.ByteStringBuffer.prototype.putByte=function(e){return this.putBytes(String.fromCharCode(e))};y.ByteStringBuffer.prototype.fillWithByte=function(e,t){e=String.fromCharCode(e);for(var r=this.data;t>0;)t&1&&(r+=e),t>>>=1,t>0&&(e+=e);return this.data=r,this._optimizeConstructedString(t),this};y.ByteStringBuffer.prototype.putBytes=function(e){return this.data+=e,this._optimizeConstructedString(e.length),this};y.ByteStringBuffer.prototype.putString=function(e){return this.putBytes(y.encodeUtf8(e))};y.ByteStringBuffer.prototype.putInt16=function(e){return this.putBytes(String.fromCharCode(e>>8&255)+String.fromCharCode(e&255))};y.ByteStringBuffer.prototype.putInt24=function(e){return this.putBytes(String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e&255))};y.ByteStringBuffer.prototype.putInt32=function(e){return this.putBytes(String.fromCharCode(e>>24&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e&255))};y.ByteStringBuffer.prototype.putInt16Le=function(e){return this.putBytes(String.fromCharCode(e&255)+String.fromCharCode(e>>8&255))};y.ByteStringBuffer.prototype.putInt24Le=function(e){return this.putBytes(String.fromCharCode(e&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e>>16&255))};y.ByteStringBuffer.prototype.putInt32Le=function(e){return this.putBytes(String.fromCharCode(e&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>24&255))};y.ByteStringBuffer.prototype.putInt=function(e,t){Dn(t);var r="";do t-=8,r+=String.fromCharCode(e>>t&255);while(t>0);return this.putBytes(r)};y.ByteStringBuffer.prototype.putSignedInt=function(e,t){return e<0&&(e+=2<<t-1),this.putInt(e,t)};y.ByteStringBuffer.prototype.putBuffer=function(e){return this.putBytes(e.getBytes())};y.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)};y.ByteStringBuffer.prototype.getInt16=function(){var e=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,e};y.ByteStringBuffer.prototype.getInt24=function(){var e=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,e};y.ByteStringBuffer.prototype.getInt32=function(){var e=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,e};y.ByteStringBuffer.prototype.getInt16Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,e};y.ByteStringBuffer.prototype.getInt24Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,e};y.ByteStringBuffer.prototype.getInt32Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,e};y.ByteStringBuffer.prototype.getInt=function(e){Dn(e);var t=0;do t=(t<<8)+this.data.charCodeAt(this.read++),e-=8;while(e>0);return t};y.ByteStringBuffer.prototype.getSignedInt=function(e){var t=this.getInt(e),r=2<<e-2;return t>=r&&(t-=r<<1),t};y.ByteStringBuffer.prototype.getBytes=function(e){var t;return e?(e=Math.min(this.length(),e),t=this.data.slice(this.read,this.read+e),this.read+=e):e===0?t="":(t=this.read===0?this.data:this.data.slice(this.read),this.clear()),t};y.ByteStringBuffer.prototype.bytes=function(e){return typeof e>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+e)};y.ByteStringBuffer.prototype.at=function(e){return this.data.charCodeAt(this.read+e)};y.ByteStringBuffer.prototype.setAt=function(e,t){return this.data=this.data.substr(0,this.read+e)+String.fromCharCode(t)+this.data.substr(this.read+e+1),this};y.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)};y.ByteStringBuffer.prototype.copy=function(){var e=y.createBuffer(this.data);return e.read=this.read,e};y.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this};y.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this};y.ByteStringBuffer.prototype.truncate=function(e){var t=Math.max(0,this.length()-e);return this.data=this.data.substr(this.read,t),this.read=0,this};y.ByteStringBuffer.prototype.toHex=function(){for(var e="",t=this.read;t<this.data.length;++t){var r=this.data.charCodeAt(t);r<16&&(e+="0"),e+=r.toString(16)}return e};y.ByteStringBuffer.prototype.toString=function(){return y.decodeUtf8(this.bytes())};function Ip(e,t){t=t||{},this.read=t.readOffset||0,this.growSize=t.growSize||1024;var r=y.isArrayBuffer(e),n=y.isArrayBufferView(e);if(r||n){r?this.data=new DataView(e):this.data=new DataView(e.buffer,e.byteOffset,e.byteLength),this.write="writeOffset"in t?t.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0)),this.write=0,e!=null&&this.putBytes(e),"writeOffset"in t&&(this.write=t.writeOffset)}y.DataBuffer=Ip;y.DataBuffer.prototype.length=function(){return this.write-this.read};y.DataBuffer.prototype.isEmpty=function(){return this.length()<=0};y.DataBuffer.prototype.accommodate=function(e,t){if(this.length()>=e)return this;t=Math.max(t||this.growSize,e);var r=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),n=new Uint8Array(this.length()+t);return n.set(r),this.data=new DataView(n.buffer),this};y.DataBuffer.prototype.putByte=function(e){return this.accommodate(1),this.data.setUint8(this.write++,e),this};y.DataBuffer.prototype.fillWithByte=function(e,t){this.accommodate(t);for(var r=0;r<t;++r)this.data.setUint8(e);return this};y.DataBuffer.prototype.putBytes=function(e,t){if(y.isArrayBufferView(e)){var r=new Uint8Array(e.buffer,e.byteOffset,e.byteLength),n=r.byteLength-r.byteOffset;this.accommodate(n);var i=new Uint8Array(this.data.buffer,this.write);return i.set(r),this.write+=n,this}if(y.isArrayBuffer(e)){var r=new Uint8Array(e);this.accommodate(r.byteLength);var i=new Uint8Array(this.data.buffer);return i.set(r,this.write),this.write+=r.byteLength,this}if(e instanceof y.DataBuffer||typeof e=="object"&&typeof e.read=="number"&&typeof e.write=="number"&&y.isArrayBufferView(e.data)){var r=new Uint8Array(e.data.byteLength,e.read,e.length());this.accommodate(r.byteLength);var i=new Uint8Array(e.data.byteLength,this.write);return i.set(r),this.write+=r.byteLength,this}if(e instanceof y.ByteStringBuffer&&(e=e.data,t="binary"),t=t||"binary",typeof e=="string"){var s;if(t==="hex")return this.accommodate(Math.ceil(e.length/2)),s=new Uint8Array(this.data.buffer,this.write),this.write+=y.binary.hex.decode(e,s,this.write),this;if(t==="base64")return this.accommodate(Math.ceil(e.length/4)*3),s=new Uint8Array(this.data.buffer,this.write),this.write+=y.binary.base64.decode(e,s,this.write),this;if(t==="utf8"&&(e=y.encodeUtf8(e),t="binary"),t==="binary"||t==="raw")return this.accommodate(e.length),s=new Uint8Array(this.data.buffer,this.write),this.write+=y.binary.raw.decode(s),this;if(t==="utf16")return this.accommodate(e.length*2),s=new Uint16Array(this.data.buffer,this.write),this.write+=y.text.utf16.encode(s),this;throw new Error("Invalid encoding: "+t)}throw Error("Invalid parameter: "+e)};y.DataBuffer.prototype.putBuffer=function(e){return this.putBytes(e),e.clear(),this};y.DataBuffer.prototype.putString=function(e){return this.putBytes(e,"utf16")};y.DataBuffer.prototype.putInt16=function(e){return this.accommodate(2),this.data.setInt16(this.write,e),this.write+=2,this};y.DataBuffer.prototype.putInt24=function(e){return this.accommodate(3),this.data.setInt16(this.write,e>>8&65535),this.data.setInt8(this.write,e>>16&255),this.write+=3,this};y.DataBuffer.prototype.putInt32=function(e){return this.accommodate(4),this.data.setInt32(this.write,e),this.write+=4,this};y.DataBuffer.prototype.putInt16Le=function(e){return this.accommodate(2),this.data.setInt16(this.write,e,!0),this.write+=2,this};y.DataBuffer.prototype.putInt24Le=function(e){return this.accommodate(3),this.data.setInt8(this.write,e>>16&255),this.data.setInt16(this.write,e>>8&65535,!0),this.write+=3,this};y.DataBuffer.prototype.putInt32Le=function(e){return this.accommodate(4),this.data.setInt32(this.write,e,!0),this.write+=4,this};y.DataBuffer.prototype.putInt=function(e,t){Dn(t),this.accommodate(t/8);do t-=8,this.data.setInt8(this.write++,e>>t&255);while(t>0);return this};y.DataBuffer.prototype.putSignedInt=function(e,t){return Dn(t),this.accommodate(t/8),e<0&&(e+=2<<t-1),this.putInt(e,t)};y.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)};y.DataBuffer.prototype.getInt16=function(){var e=this.data.getInt16(this.read);return this.read+=2,e};y.DataBuffer.prototype.getInt24=function(){var e=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,e};y.DataBuffer.prototype.getInt32=function(){var e=this.data.getInt32(this.read);return this.read+=4,e};y.DataBuffer.prototype.getInt16Le=function(){var e=this.data.getInt16(this.read,!0);return this.read+=2,e};y.DataBuffer.prototype.getInt24Le=function(){var e=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,e};y.DataBuffer.prototype.getInt32Le=function(){var e=this.data.getInt32(this.read,!0);return this.read+=4,e};y.DataBuffer.prototype.getInt=function(e){Dn(e);var t=0;do t=(t<<8)+this.data.getInt8(this.read++),e-=8;while(e>0);return t};y.DataBuffer.prototype.getSignedInt=function(e){var t=this.getInt(e),r=2<<e-2;return t>=r&&(t-=r<<1),t};y.DataBuffer.prototype.getBytes=function(e){var t;return e?(e=Math.min(this.length(),e),t=this.data.slice(this.read,this.read+e),this.read+=e):e===0?t="":(t=this.read===0?this.data:this.data.slice(this.read),this.clear()),t};y.DataBuffer.prototype.bytes=function(e){return typeof e>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+e)};y.DataBuffer.prototype.at=function(e){return this.data.getUint8(this.read+e)};y.DataBuffer.prototype.setAt=function(e,t){return this.data.setUint8(e,t),this};y.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)};y.DataBuffer.prototype.copy=function(){return new y.DataBuffer(this)};y.DataBuffer.prototype.compact=function(){if(this.read>0){var e=new Uint8Array(this.data.buffer,this.read),t=new Uint8Array(e.byteLength);t.set(e),this.data=new DataView(t),this.write-=this.read,this.read=0}return this};y.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this};y.DataBuffer.prototype.truncate=function(e){return this.write=Math.max(0,this.length()-e),this.read=Math.min(this.read,this.write),this};y.DataBuffer.prototype.toHex=function(){for(var e="",t=this.read;t<this.data.byteLength;++t){var r=this.data.getUint8(t);r<16&&(e+="0"),e+=r.toString(16)}return e};y.DataBuffer.prototype.toString=function(e){var t=new Uint8Array(this.data,this.read,this.length());if(e=e||"utf8",e==="binary"||e==="raw")return y.binary.raw.encode(t);if(e==="hex")return y.binary.hex.encode(t);if(e==="base64")return y.binary.base64.encode(t);if(e==="utf8")return y.text.utf8.decode(t);if(e==="utf16")return y.text.utf16.decode(t);throw new Error("Invalid encoding: "+e)};y.createBuffer=function(e,t){return t=t||"raw",e!==void 0&&t==="utf8"&&(e=y.encodeUtf8(e)),new y.ByteBuffer(e)};y.fillString=function(e,t){for(var r="";t>0;)t&1&&(r+=e),t>>>=1,t>0&&(e+=e);return r};y.xorBytes=function(e,t,r){for(var n="",i="",s="",a=0,o=0;r>0;--r,++a)i=e.charCodeAt(a)^t.charCodeAt(a),o>=10&&(n+=s,s="",o=0),s+=String.fromCharCode(i),++o;return n+=s,n};y.hexToBytes=function(e){var t="",r=0;for(e.length&!0&&(r=1,t+=String.fromCharCode(parseInt(e[0],16)));r<e.length;r+=2)t+=String.fromCharCode(parseInt(e.substr(r,2),16));return t};y.bytesToHex=function(e){return y.createBuffer(e).toHex()};y.int32ToBytes=function(e){return String.fromCharCode(e>>24&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e&255)};var Je="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",je=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],lu="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";y.encode64=function(e,t){for(var r="",n="",i,s,a,o=0;o<e.length;)i=e.charCodeAt(o++),s=e.charCodeAt(o++),a=e.charCodeAt(o++),r+=Je.charAt(i>>2),r+=Je.charAt((i&3)<<4|s>>4),isNaN(s)?r+="==":(r+=Je.charAt((s&15)<<2|a>>6),r+=isNaN(a)?"=":Je.charAt(a&63)),t&&r.length>t&&(n+=r.substr(0,t)+`\r
`,r=r.substr(t));return n+=r,n};y.decode64=function(e){e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var t="",r,n,i,s,a=0;a<e.length;)r=je[e.charCodeAt(a++)-43],n=je[e.charCodeAt(a++)-43],i=je[e.charCodeAt(a++)-43],s=je[e.charCodeAt(a++)-43],t+=String.fromCharCode(r<<2|n>>4),i!==64&&(t+=String.fromCharCode((n&15)<<4|i>>2),s!==64&&(t+=String.fromCharCode((i&3)<<6|s)));return t};y.encodeUtf8=function(e){return unescape(encodeURIComponent(e))};y.decodeUtf8=function(e){return decodeURIComponent(escape(e))};y.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:fu.encode,decode:fu.decode}};y.binary.raw.encode=function(e){return String.fromCharCode.apply(null,e)};y.binary.raw.decode=function(e,t,r){var n=t;n||(n=new Uint8Array(e.length)),r=r||0;for(var i=r,s=0;s<e.length;++s)n[i++]=e.charCodeAt(s);return t?i-r:n};y.binary.hex.encode=y.bytesToHex;y.binary.hex.decode=function(e,t,r){var n=t;n||(n=new Uint8Array(Math.ceil(e.length/2))),r=r||0;var i=0,s=r;for(e.length&1&&(i=1,n[s++]=parseInt(e[0],16));i<e.length;i+=2)n[s++]=parseInt(e.substr(i,2),16);return t?s-r:n};y.binary.base64.encode=function(e,t){for(var r="",n="",i,s,a,o=0;o<e.byteLength;)i=e[o++],s=e[o++],a=e[o++],r+=Je.charAt(i>>2),r+=Je.charAt((i&3)<<4|s>>4),isNaN(s)?r+="==":(r+=Je.charAt((s&15)<<2|a>>6),r+=isNaN(a)?"=":Je.charAt(a&63)),t&&r.length>t&&(n+=r.substr(0,t)+`\r
`,r=r.substr(t));return n+=r,n};y.binary.base64.decode=function(e,t,r){var n=t;n||(n=new Uint8Array(Math.ceil(e.length/4)*3)),e=e.replace(/[^A-Za-z0-9\+\/\=]/g,""),r=r||0;for(var i,s,a,o,c=0,u=r;c<e.length;)i=je[e.charCodeAt(c++)-43],s=je[e.charCodeAt(c++)-43],a=je[e.charCodeAt(c++)-43],o=je[e.charCodeAt(c++)-43],n[u++]=i<<2|s>>4,a!==64&&(n[u++]=(s&15)<<4|a>>2,o!==64&&(n[u++]=(a&3)<<6|o));return t?u-r:n.subarray(0,u)};y.binary.base58.encode=function(e,t){return y.binary.baseN.encode(e,lu,t)};y.binary.base58.decode=function(e,t){return y.binary.baseN.decode(e,lu,t)};y.text={utf8:{},utf16:{}};y.text.utf8.encode=function(e,t,r){e=y.encodeUtf8(e);var n=t;n||(n=new Uint8Array(e.length)),r=r||0;for(var i=r,s=0;s<e.length;++s)n[i++]=e.charCodeAt(s);return t?i-r:n};y.text.utf8.decode=function(e){return y.decodeUtf8(String.fromCharCode.apply(null,e))};y.text.utf16.encode=function(e,t,r){var n=t;n||(n=new Uint8Array(e.length*2));var i=new Uint16Array(n.buffer);r=r||0;for(var s=r,a=r,o=0;o<e.length;++o)i[a++]=e.charCodeAt(o),s+=2;return t?s-r:n};y.text.utf16.decode=function(e){return String.fromCharCode.apply(null,new Uint16Array(e.buffer))};y.deflate=function(e,t,r){if(t=y.decode64(e.deflate(y.encode64(t)).rval),r){var n=2,i=t.charCodeAt(1);i&32&&(n=6),t=t.substring(n,t.length-4)}return t};y.inflate=function(e,t,r){var n=e.inflate(y.encode64(t)).rval;return n===null?null:y.decode64(n)};var Ga=function(e,t,r){if(!e)throw new Error("WebStorage not available.");var n;if(r===null?n=e.removeItem(t):(r=y.encode64(JSON.stringify(r)),n=e.setItem(t,r)),typeof n<"u"&&n.rval!==!0){var i=new Error(n.error.message);throw i.id=n.error.id,i.name=n.error.name,i}},Wa=function(e,t){if(!e)throw new Error("WebStorage not available.");var r=e.getItem(t);if(e.init)if(r.rval===null){if(r.error){var n=new Error(r.error.message);throw n.id=r.error.id,n.name=r.error.name,n}r=null}else r=r.rval;return r!==null&&(r=JSON.parse(y.decode64(r))),r},Rp=function(e,t,r,n){var i=Wa(e,t);i===null&&(i={}),i[r]=n,Ga(e,t,i)},kp=function(e,t,r){var n=Wa(e,t);return n!==null&&(n=r in n?n[r]:null),n},Np=function(e,t,r){var n=Wa(e,t);if(n!==null&&r in n){delete n[r];var i=!0;for(var s in n){i=!1;break}i&&(n=null),Ga(e,t,n)}},Lp=function(e,t){Ga(e,t,null)},Mi=function(e,t,r){var n=null;typeof r>"u"&&(r=["web","flash"]);var i,s=!1,a=null;for(var o in r){i=r[o];try{if(i==="flash"||i==="both"){if(t[0]===null)throw new Error("Flash local storage not available.");n=e.apply(this,t),s=i==="flash"}(i==="web"||i==="both")&&(t[0]=localStorage,n=e.apply(this,t),s=!0)}catch(c){a=c}if(s)break}if(!s)throw a;return n};y.setItem=function(e,t,r,n,i){Mi(Rp,arguments,i)};y.getItem=function(e,t,r,n){return Mi(kp,arguments,n)};y.removeItem=function(e,t,r,n){Mi(Np,arguments,n)};y.clearItems=function(e,t,r){Mi(Lp,arguments,r)};y.isEmpty=function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0};y.format=function(e){for(var t=/%./g,r,n,i=0,s=[],a=0;r=t.exec(e);){n=e.substring(a,t.lastIndex-2),n.length>0&&s.push(n),a=t.lastIndex;var o=r[0][1];switch(o){case"s":case"o":i<arguments.length?s.push(arguments[i+++1]):s.push("<?>");break;case"%":s.push("%");break;default:s.push("<%"+o+"?>")}}return s.push(e.substring(a)),s.join("")};y.formatNumber=function(e,t,r,n){var i=e,s=isNaN(t=Math.abs(t))?2:t,a=r===void 0?",":r,o=n===void 0?".":n,c=i<0?"-":"",u=parseInt(i=Math.abs(+i||0).toFixed(s),10)+"",f=u.length>3?u.length%3:0;return c+(f?u.substr(0,f)+o:"")+u.substr(f).replace(/(\d{3})(?=\d)/g,"$1"+o)+(s?a+Math.abs(i-u).toFixed(s).slice(2):"")};y.formatSize=function(e){return e>=1073741824?e=y.formatNumber(e/1073741824,2,".","")+" GiB":e>=1048576?e=y.formatNumber(e/1048576,2,".","")+" MiB":e>=1024?e=y.formatNumber(e/1024,0)+" KiB":e=y.formatNumber(e,0)+" bytes",e};y.bytesFromIP=function(e){return e.indexOf(".")!==-1?y.bytesFromIPv4(e):e.indexOf(":")!==-1?y.bytesFromIPv6(e):null};y.bytesFromIPv4=function(e){if(e=e.split("."),e.length!==4)return null;for(var t=y.createBuffer(),r=0;r<e.length;++r){var n=parseInt(e[r],10);if(isNaN(n))return null;t.putByte(n)}return t.getBytes()};y.bytesFromIPv6=function(e){var t=0;e=e.split(":").filter(function(a){return a.length===0&&++t,!0});for(var r=(8-e.length+t)*2,n=y.createBuffer(),i=0;i<8;++i){if(!e[i]||e[i].length===0){n.fillWithByte(0,r),r=0;continue}var s=y.hexToBytes(e[i]);s.length<2&&n.putByte(0),n.putBytes(s)}return n.getBytes()};y.bytesToIP=function(e){return e.length===4?y.bytesToIPv4(e):e.length===16?y.bytesToIPv6(e):null};y.bytesToIPv4=function(e){if(e.length!==4)return null;for(var t=[],r=0;r<e.length;++r)t.push(e.charCodeAt(r));return t.join(".")};y.bytesToIPv6=function(e){if(e.length!==16)return null;for(var t=[],r=[],n=0,i=0;i<e.length;i+=2){for(var s=y.bytesToHex(e[i]+e[i+1]);s[0]==="0"&&s!=="0";)s=s.substr(1);if(s==="0"){var a=r[r.length-1],o=t.length;!a||o!==a.end+1?r.push({start:o,end:o}):(a.end=o,a.end-a.start>r[n].end-r[n].start&&(n=r.length-1))}t.push(s)}if(r.length>0){var c=r[n];c.end-c.start>0&&(t.splice(c.start,c.end-c.start+1,""),c.start===0&&t.unshift(""),c.end===7&&t.push(""))}return t.join(":")};y.estimateCores=function(e,t){if(typeof e=="function"&&(t=e,e={}),e=e||{},"cores"in y&&!e.update)return t(null,y.cores);if(typeof navigator<"u"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return y.cores=navigator.hardwareConcurrency,t(null,y.cores);if(typeof Worker>"u")return y.cores=1,t(null,y.cores);if(typeof Blob>"u")return y.cores=2,t(null,y.cores);var r=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(a){for(var o=Date.now(),c=o+4;Date.now()<c;);self.postMessage({st:o,et:c})})}.toString(),")()"],{type:"application/javascript"}));n([],5,16);function n(a,o,c){if(o===0){var u=Math.floor(a.reduce(function(f,l){return f+l},0)/a.length);return y.cores=Math.max(1,u),URL.revokeObjectURL(r),t(null,y.cores)}i(c,function(f,l){a.push(s(c,l)),n(a,o-1,c)})}function i(a,o){for(var c=[],u=[],f=0;f<a;++f){var l=new Worker(r);l.addEventListener("message",function(h){if(u.push(h.data),u.length===a){for(var p=0;p<a;++p)c[p].terminate();o(null,u)}}),c.push(l)}for(var f=0;f<a;++f)c[f].postMessage(f)}function s(a,o){for(var c=[],u=0;u<a;++u)for(var f=o[u],l=c[u]=[],h=0;h<a;++h)if(u!==h){var p=o[h];(f.st>p.st&&f.st<p.et||p.st>f.st&&p.st<f.et)&&l.push(h)}return c.reduce(function(d,g){return Math.max(d,g.length)},0)}}});var Vi=U((Hx,du)=>{var Pn=et();Pn.pki=Pn.pki||{};var $a=du.exports=Pn.pki.oids=Pn.oids=Pn.oids||{};function A(e,t){$a[e]=t,$a[t]=e}function j(e,t){$a[e]=t}A("1.2.840.113549.1.1.1","rsaEncryption");A("1.2.840.113549.1.1.4","md5WithRSAEncryption");A("1.2.840.113549.1.1.5","sha1WithRSAEncryption");A("1.2.840.113549.1.1.7","RSAES-OAEP");A("1.2.840.113549.1.1.8","mgf1");A("1.2.840.113549.1.1.9","pSpecified");A("1.2.840.113549.1.1.10","RSASSA-PSS");A("1.2.840.113549.1.1.11","sha256WithRSAEncryption");A("1.2.840.113549.1.1.12","sha384WithRSAEncryption");A("1.2.840.113549.1.1.13","sha512WithRSAEncryption");A("1.3.101.112","EdDSA25519");A("1.2.840.10040.4.3","dsa-with-sha1");A("1.3.14.3.2.7","desCBC");A("1.3.14.3.2.26","sha1");A("1.3.14.3.2.29","sha1WithRSASignature");A("2.16.840.1.101.3.4.2.1","sha256");A("2.16.840.1.101.3.4.2.2","sha384");A("2.16.840.1.101.3.4.2.3","sha512");A("2.16.840.1.101.3.4.2.4","sha224");A("2.16.840.1.101.3.4.2.5","sha512-224");A("2.16.840.1.101.3.4.2.6","sha512-256");A("1.2.840.113549.2.2","md2");A("1.2.840.113549.2.5","md5");A("1.2.840.113549.1.7.1","data");A("1.2.840.113549.1.7.2","signedData");A("1.2.840.113549.1.7.3","envelopedData");A("1.2.840.113549.1.7.4","signedAndEnvelopedData");A("1.2.840.113549.1.7.5","digestedData");A("1.2.840.113549.1.7.6","encryptedData");A("1.2.840.113549.1.9.1","emailAddress");A("1.2.840.113549.1.9.2","unstructuredName");A("1.2.840.113549.1.9.3","contentType");A("1.2.840.113549.1.9.4","messageDigest");A("1.2.840.113549.1.9.5","signingTime");A("1.2.840.113549.1.9.6","counterSignature");A("1.2.840.113549.1.9.7","challengePassword");A("1.2.840.113549.1.9.8","unstructuredAddress");A("1.2.840.113549.1.9.14","extensionRequest");A("1.2.840.113549.1.9.20","friendlyName");A("1.2.840.113549.1.9.21","localKeyId");A("1.2.840.113549.1.9.22.1","x509Certificate");A("1.2.840.113549.1.12.10.1.1","keyBag");A("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag");A("1.2.840.113549.1.12.10.1.3","certBag");A("1.2.840.113549.1.12.10.1.4","crlBag");A("1.2.840.113549.1.12.10.1.5","secretBag");A("1.2.840.113549.1.12.10.1.6","safeContentsBag");A("1.2.840.113549.1.5.13","pkcs5PBES2");A("1.2.840.113549.1.5.12","pkcs5PBKDF2");A("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4");A("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4");A("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC");A("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC");A("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC");A("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC");A("1.2.840.113549.2.7","hmacWithSHA1");A("1.2.840.113549.2.8","hmacWithSHA224");A("1.2.840.113549.2.9","hmacWithSHA256");A("1.2.840.113549.2.10","hmacWithSHA384");A("1.2.840.113549.2.11","hmacWithSHA512");A("1.2.840.113549.3.7","des-EDE3-CBC");A("2.16.840.1.101.3.4.1.2","aes128-CBC");A("2.16.840.1.101.3.4.1.22","aes192-CBC");A("2.16.840.1.101.3.4.1.42","aes256-CBC");A("2.5.4.3","commonName");A("2.5.4.4","surname");A("2.5.4.5","serialNumber");A("2.5.4.6","countryName");A("2.5.4.7","localityName");A("2.5.4.8","stateOrProvinceName");A("2.5.4.9","streetAddress");A("2.5.4.10","organizationName");A("2.5.4.11","organizationalUnitName");A("2.5.4.12","title");A("2.5.4.13","description");A("2.5.4.15","businessCategory");A("2.5.4.17","postalCode");A("2.5.4.42","givenName");A("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName");A("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName");A("2.16.840.1.113730.1.1","nsCertType");A("2.16.840.1.113730.1.13","nsComment");j("2.5.29.1","authorityKeyIdentifier");j("2.5.29.2","keyAttributes");j("2.5.29.3","certificatePolicies");j("2.5.29.4","keyUsageRestriction");j("2.5.29.5","policyMapping");j("2.5.29.6","subtreesConstraint");j("2.5.29.7","subjectAltName");j("2.5.29.8","issuerAltName");j("2.5.29.9","subjectDirectoryAttributes");j("2.5.29.10","basicConstraints");j("2.5.29.11","nameConstraints");j("2.5.29.12","policyConstraints");j("2.5.29.13","basicConstraints");A("2.5.29.14","subjectKeyIdentifier");A("2.5.29.15","keyUsage");j("2.5.29.16","privateKeyUsagePeriod");A("2.5.29.17","subjectAltName");A("2.5.29.18","issuerAltName");A("2.5.29.19","basicConstraints");j("2.5.29.20","cRLNumber");j("2.5.29.21","cRLReason");j("2.5.29.22","expirationDate");j("2.5.29.23","instructionCode");j("2.5.29.24","invalidityDate");j("2.5.29.25","cRLDistributionPoints");j("2.5.29.26","issuingDistributionPoint");j("2.5.29.27","deltaCRLIndicator");j("2.5.29.28","issuingDistributionPoint");j("2.5.29.29","certificateIssuer");j("2.5.29.30","nameConstraints");A("2.5.29.31","cRLDistributionPoints");A("2.5.29.32","certificatePolicies");j("2.5.29.33","policyMappings");j("2.5.29.34","policyConstraints");A("2.5.29.35","authorityKeyIdentifier");j("2.5.29.36","policyConstraints");A("2.5.29.37","extKeyUsage");j("2.5.29.46","freshestCRL");j("2.5.29.54","inhibitAnyPolicy");A("1.3.6.1.4.1.11129.2.4.2","timestampList");A("1.3.6.1.5.5.7.1.1","authorityInfoAccess");A("1.3.6.1.5.5.7.3.1","serverAuth");A("1.3.6.1.5.5.7.3.2","clientAuth");A("1.3.6.1.5.5.7.3.3","codeSigning");A("1.3.6.1.5.5.7.3.4","emailProtection");A("1.3.6.1.5.5.7.3.8","timeStamping")});var Kn=U((Gx,yu)=>{var at=et();St();Vi();var T=yu.exports=at.asn1=at.asn1||{};T.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192};T.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30};T.create=function(e,t,r,n,i){if(at.util.isArray(n)){for(var s=[],a=0;a<n.length;++a)n[a]!==void 0&&s.push(n[a]);n=s}var o={tagClass:e,type:t,constructed:r,composed:r||at.util.isArray(n),value:n};return i&&"bitStringContents"in i&&(o.bitStringContents=i.bitStringContents,o.original=T.copy(o)),o};T.copy=function(e,t){var r;if(at.util.isArray(e)){r=[];for(var n=0;n<e.length;++n)r.push(T.copy(e[n],t));return r}return typeof e=="string"?e:(r={tagClass:e.tagClass,type:e.type,constructed:e.constructed,composed:e.composed,value:T.copy(e.value,t)},t&&!t.excludeBitStringContents&&(r.bitStringContents=e.bitStringContents),r)};T.equals=function(e,t,r){if(at.util.isArray(e)){if(!at.util.isArray(t)||e.length!==t.length)return!1;for(var n=0;n<e.length;++n)if(!T.equals(e[n],t[n]))return!1;return!0}if(typeof e!=typeof t)return!1;if(typeof e=="string")return e===t;var i=e.tagClass===t.tagClass&&e.type===t.type&&e.constructed===t.constructed&&e.composed===t.composed&&T.equals(e.value,t.value);return r&&r.includeBitStringContents&&(i=i&&e.bitStringContents===t.bitStringContents),i};T.getBerValueLength=function(e){var t=e.getByte();if(t!==128){var r,n=t&128;return n?r=e.getInt((t&127)<<3):r=t,r}};function Un(e,t,r){if(r>t){var n=new Error("Too few bytes to parse DER.");throw n.available=e.length(),n.remaining=t,n.requested=r,n}}var Dp=function(e,t){var r=e.getByte();if(t--,r!==128){var n,i=r&128;if(!i)n=r;else{var s=r&127;Un(e,t,s),n=e.getInt(s<<3)}if(n<0)throw new Error("Negative length: "+n);return n}};T.fromDer=function(e,t){t===void 0&&(t={strict:!0,parseAllBytes:!0,decodeBitStrings:!0}),typeof t=="boolean"&&(t={strict:t,parseAllBytes:!0,decodeBitStrings:!0}),"strict"in t||(t.strict=!0),"parseAllBytes"in t||(t.parseAllBytes=!0),"decodeBitStrings"in t||(t.decodeBitStrings=!0),typeof e=="string"&&(e=at.util.createBuffer(e));var r=e.length(),n=qi(e,e.length(),0,t);if(t.parseAllBytes&&e.length()!==0){var i=new Error("Unparsed DER bytes remain after ASN.1 parsing.");throw i.byteCount=r,i.remaining=e.length(),i}return n};function qi(e,t,r,n){var i;Un(e,t,2);var s=e.getByte();t--;var a=s&192,o=s&31;i=e.length();var c=Dp(e,t);if(t-=i-e.length(),c!==void 0&&c>t){if(n.strict){var u=new Error("Too few bytes to read ASN.1 value.");throw u.available=e.length(),u.remaining=t,u.requested=c,u}c=t}var f,l,h=(s&32)===32;if(h)if(f=[],c===void 0)for(;;){if(Un(e,t,2),e.bytes(2)===String.fromCharCode(0,0)){e.getBytes(2),t-=2;break}i=e.length(),f.push(qi(e,t,r+1,n)),t-=i-e.length()}else for(;c>0;)i=e.length(),f.push(qi(e,c,r+1,n)),t-=i-e.length(),c-=i-e.length();if(f===void 0&&a===T.Class.UNIVERSAL&&o===T.Type.BITSTRING&&(l=e.bytes(c)),f===void 0&&n.decodeBitStrings&&a===T.Class.UNIVERSAL&&o===T.Type.BITSTRING&&c>1){var p=e.read,d=t,g=0;if(o===T.Type.BITSTRING&&(Un(e,t,1),g=e.getByte(),t--),g===0)try{i=e.length();var x={strict:!0,decodeBitStrings:!0},v=qi(e,t,r+1,x),S=i-e.length();t-=S,o==T.Type.BITSTRING&&S++;var B=v.tagClass;S===c&&(B===T.Class.UNIVERSAL||B===T.Class.CONTEXT_SPECIFIC)&&(f=[v])}catch{}f===void 0&&(e.read=p,t=d)}if(f===void 0){if(c===void 0){if(n.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");c=t}if(o===T.Type.BMPSTRING)for(f="";c>0;c-=2)Un(e,t,2),f+=String.fromCharCode(e.getInt16()),t-=2;else f=e.getBytes(c),t-=c}var L=l===void 0?null:{bitStringContents:l};return T.create(a,o,h,f,L)}T.toDer=function(e){var t=at.util.createBuffer(),r=e.tagClass|e.type,n=at.util.createBuffer(),i=!1;if("bitStringContents"in e&&(i=!0,e.original&&(i=T.equals(e,e.original))),i)n.putBytes(e.bitStringContents);else if(e.composed){e.constructed?r|=32:n.putByte(0);for(var s=0;s<e.value.length;++s)e.value[s]!==void 0&&n.putBuffer(T.toDer(e.value[s]))}else if(e.type===T.Type.BMPSTRING)for(var s=0;s<e.value.length;++s)n.putInt16(e.value.charCodeAt(s));else e.type===T.Type.INTEGER&&e.value.length>1&&(e.value.charCodeAt(0)===0&&!(e.value.charCodeAt(1)&128)||e.value.charCodeAt(0)===255&&(e.value.charCodeAt(1)&128)===128)?n.putBytes(e.value.substr(1)):n.putBytes(e.value);if(t.putByte(r),n.length()<=127)t.putByte(n.length()&127);else{var a=n.length(),o="";do o+=String.fromCharCode(a&255),a=a>>>8;while(a>0);t.putByte(o.length|128);for(var s=o.length-1;s>=0;--s)t.putByte(o.charCodeAt(s))}return t.putBuffer(n),t};T.oidToDer=function(e){var t=e.split("."),r=at.util.createBuffer();r.putByte(40*parseInt(t[0],10)+parseInt(t[1],10));for(var n,i,s,a,o=2;o<t.length;++o){n=!0,i=[],s=parseInt(t[o],10);do a=s&127,s=s>>>7,n||(a|=128),i.push(a),n=!1;while(s>0);for(var c=i.length-1;c>=0;--c)r.putByte(i[c])}return r};T.derToOid=function(e){var t;typeof e=="string"&&(e=at.util.createBuffer(e));var r=e.getByte();t=Math.floor(r/40)+"."+r%40;for(var n=0;e.length()>0;)r=e.getByte(),n=n<<7,r&128?n+=r&127:(t+="."+(n+r),n=0);return t};T.utcTimeToDate=function(e){var t=new Date,r=parseInt(e.substr(0,2),10);r=r>=50?1900+r:2e3+r;var n=parseInt(e.substr(2,2),10)-1,i=parseInt(e.substr(4,2),10),s=parseInt(e.substr(6,2),10),a=parseInt(e.substr(8,2),10),o=0;if(e.length>11){var c=e.charAt(10),u=10;c!=="+"&&c!=="-"&&(o=parseInt(e.substr(10,2),10),u+=2)}if(t.setUTCFullYear(r,n,i),t.setUTCHours(s,a,o,0),u&&(c=e.charAt(u),c==="+"||c==="-")){var f=parseInt(e.substr(u+1,2),10),l=parseInt(e.substr(u+4,2),10),h=f*60+l;h*=6e4,c==="+"?t.setTime(+t-h):t.setTime(+t+h)}return t};T.generalizedTimeToDate=function(e){var t=new Date,r=parseInt(e.substr(0,4),10),n=parseInt(e.substr(4,2),10)-1,i=parseInt(e.substr(6,2),10),s=parseInt(e.substr(8,2),10),a=parseInt(e.substr(10,2),10),o=parseInt(e.substr(12,2),10),c=0,u=0,f=!1;e.charAt(e.length-1)==="Z"&&(f=!0);var l=e.length-5,h=e.charAt(l);if(h==="+"||h==="-"){var p=parseInt(e.substr(l+1,2),10),d=parseInt(e.substr(l+4,2),10);u=p*60+d,u*=6e4,h==="+"&&(u*=-1),f=!0}return e.charAt(14)==="."&&(c=parseFloat(e.substr(14),10)*1e3),f?(t.setUTCFullYear(r,n,i),t.setUTCHours(s,a,o,c),t.setTime(+t+u)):(t.setFullYear(r,n,i),t.setHours(s,a,o,c)),t};T.dateToUtcTime=function(e){if(typeof e=="string")return e;var t="",r=[];r.push((""+e.getUTCFullYear()).substr(2)),r.push(""+(e.getUTCMonth()+1)),r.push(""+e.getUTCDate()),r.push(""+e.getUTCHours()),r.push(""+e.getUTCMinutes()),r.push(""+e.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(t+="0"),t+=r[n];return t+="Z",t};T.dateToGeneralizedTime=function(e){if(typeof e=="string")return e;var t="",r=[];r.push(""+e.getUTCFullYear()),r.push(""+(e.getUTCMonth()+1)),r.push(""+e.getUTCDate()),r.push(""+e.getUTCHours()),r.push(""+e.getUTCMinutes()),r.push(""+e.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(t+="0"),t+=r[n];return t+="Z",t};T.integerToDer=function(e){var t=at.util.createBuffer();if(e>=-128&&e<128)return t.putSignedInt(e,8);if(e>=-32768&&e<32768)return t.putSignedInt(e,16);if(e>=-8388608&&e<8388608)return t.putSignedInt(e,24);if(e>=-2147483648&&e<2147483648)return t.putSignedInt(e,32);var r=new Error("Integer too large; max is 32-bits.");throw r.integer=e,r};T.derToInteger=function(e){typeof e=="string"&&(e=at.util.createBuffer(e));var t=e.length()*8;if(t>32)throw new Error("Integer too large; max is 32-bits.");return e.getSignedInt(t)};T.validate=function(e,t,r,n){var i=!1;if((e.tagClass===t.tagClass||typeof t.tagClass>"u")&&(e.type===t.type||typeof t.type>"u"))if(e.constructed===t.constructed||typeof t.constructed>"u"){if(i=!0,t.value&&at.util.isArray(t.value))for(var s=0,a=0;i&&a<t.value.length;++a)i=t.value[a].optional||!1,e.value[s]&&(i=T.validate(e.value[s],t.value[a],r,n),i?++s:t.value[a].optional&&(i=!0)),!i&&n&&n.push("["+t.name+'] Tag class "'+t.tagClass+'", type "'+t.type+'" expected value length "'+t.value.length+'", got "'+e.value.length+'"');if(i&&r&&(t.capture&&(r[t.capture]=e.value),t.captureAsn1&&(r[t.captureAsn1]=e),t.captureBitStringContents&&"bitStringContents"in e&&(r[t.captureBitStringContents]=e.bitStringContents),t.captureBitStringValue&&"bitStringContents"in e)){var o;if(e.bitStringContents.length<2)r[t.captureBitStringValue]="";else{var c=e.bitStringContents.charCodeAt(0);if(c!==0)throw new Error("captureBitStringValue only supported for zero unused bits");r[t.captureBitStringValue]=e.bitStringContents.slice(1)}}}else n&&n.push("["+t.name+'] Expected constructed "'+t.constructed+'", got "'+e.constructed+'"');else n&&(e.tagClass!==t.tagClass&&n.push("["+t.name+'] Expected tag class "'+t.tagClass+'", got "'+e.tagClass+'"'),e.type!==t.type&&n.push("["+t.name+'] Expected type "'+t.type+'", got "'+e.type+'"'));return i};var pu=/[^\\u0000-\\u00ff]/;T.prettyPrint=function(e,t,r){var n="";t=t||0,r=r||2,t>0&&(n+=`
`);for(var i="",s=0;s<t*r;++s)i+=" ";switch(n+=i+"Tag: ",e.tagClass){case T.Class.UNIVERSAL:n+="Universal:";break;case T.Class.APPLICATION:n+="Application:";break;case T.Class.CONTEXT_SPECIFIC:n+="Context-Specific:";break;case T.Class.PRIVATE:n+="Private:";break}if(e.tagClass===T.Class.UNIVERSAL)switch(n+=e.type,e.type){case T.Type.NONE:n+=" (None)";break;case T.Type.BOOLEAN:n+=" (Boolean)";break;case T.Type.INTEGER:n+=" (Integer)";break;case T.Type.BITSTRING:n+=" (Bit string)";break;case T.Type.OCTETSTRING:n+=" (Octet string)";break;case T.Type.NULL:n+=" (Null)";break;case T.Type.OID:n+=" (Object Identifier)";break;case T.Type.ODESC:n+=" (Object Descriptor)";break;case T.Type.EXTERNAL:n+=" (External or Instance of)";break;case T.Type.REAL:n+=" (Real)";break;case T.Type.ENUMERATED:n+=" (Enumerated)";break;case T.Type.EMBEDDED:n+=" (Embedded PDV)";break;case T.Type.UTF8:n+=" (UTF8)";break;case T.Type.ROID:n+=" (Relative Object Identifier)";break;case T.Type.SEQUENCE:n+=" (Sequence)";break;case T.Type.SET:n+=" (Set)";break;case T.Type.PRINTABLESTRING:n+=" (Printable String)";break;case T.Type.IA5String:n+=" (IA5String (ASCII))";break;case T.Type.UTCTIME:n+=" (UTC time)";break;case T.Type.GENERALIZEDTIME:n+=" (Generalized time)";break;case T.Type.BMPSTRING:n+=" (BMP String)";break}else n+=e.type;if(n+=`
`,n+=i+"Constructed: "+e.constructed+`
`,e.composed){for(var a=0,o="",s=0;s<e.value.length;++s)e.value[s]!==void 0&&(a+=1,o+=T.prettyPrint(e.value[s],t+1,r),s+1<e.value.length&&(o+=","));n+=i+"Sub values: "+a+o}else{if(n+=i+"Value: ",e.type===T.Type.OID){var c=T.derToOid(e.value);n+=c,at.pki&&at.pki.oids&&c in at.pki.oids&&(n+=" ("+at.pki.oids[c]+") ")}if(e.type===T.Type.INTEGER)try{n+=T.derToInteger(e.value)}catch{n+="0x"+at.util.bytesToHex(e.value)}else if(e.type===T.Type.BITSTRING){if(e.value.length>1?n+="0x"+at.util.bytesToHex(e.value.slice(1)):n+="(none)",e.value.length>0){var u=e.value.charCodeAt(0);u==1?n+=" (1 unused bit shown)":u>1&&(n+=" ("+u+" unused bits shown)")}}else if(e.type===T.Type.OCTETSTRING)pu.test(e.value)||(n+="("+e.value+") "),n+="0x"+at.util.bytesToHex(e.value);else if(e.type===T.Type.UTF8)try{n+=at.util.decodeUtf8(e.value)}catch(f){if(f.message==="URI malformed")n+="0x"+at.util.bytesToHex(e.value)+" (malformed UTF8)";else throw f}else e.type===T.Type.PRINTABLESTRING||e.type===T.Type.IA5String?n+=e.value:pu.test(e.value)?n+="0x"+at.util.bytesToHex(e.value):e.value.length===0?n+="[null]":n+=e.value}return n}});var Za=U((Wx,gu)=>{var Rt=et();St();gu.exports=Rt.cipher=Rt.cipher||{};Rt.cipher.algorithms=Rt.cipher.algorithms||{};Rt.cipher.createCipher=function(e,t){var r=e;if(typeof r=="string"&&(r=Rt.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+e);return new Rt.cipher.BlockCipher({algorithm:r,key:t,decrypt:!1})};Rt.cipher.createDecipher=function(e,t){var r=e;if(typeof r=="string"&&(r=Rt.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+e);return new Rt.cipher.BlockCipher({algorithm:r,key:t,decrypt:!0})};Rt.cipher.registerAlgorithm=function(e,t){e=e.toUpperCase(),Rt.cipher.algorithms[e]=t};Rt.cipher.getAlgorithm=function(e){return e=e.toUpperCase(),e in Rt.cipher.algorithms?Rt.cipher.algorithms[e]:null};var Qa=Rt.cipher.BlockCipher=function(e){this.algorithm=e.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=e.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=e.decrypt,this.algorithm.initialize(e)};Qa.prototype.start=function(e){e=e||{};var t={};for(var r in e)t[r]=e[r];t.decrypt=this._decrypt,this._finish=!1,this._input=Rt.util.createBuffer(),this.output=e.output||Rt.util.createBuffer(),this.mode.start(t)};Qa.prototype.update=function(e){for(e&&this._input.putBuffer(e);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()};Qa.prototype.finish=function(e){e&&(this.mode.name==="ECB"||this.mode.name==="CBC")&&(this.mode.pad=function(r){return e(this.blockSize,r,!1)},this.mode.unpad=function(r){return e(this.blockSize,r,!0)});var t={};return t.decrypt=this._decrypt,t.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,t)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,t))||this.mode.afterFinish&&!this.mode.afterFinish(this.output,t))}});var Xa=U(($x,mu)=>{var kt=et();St();kt.cipher=kt.cipher||{};var q=mu.exports=kt.cipher.modes=kt.cipher.modes||{};q.ecb=function(e){e=e||{},this.name="ECB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};q.ecb.prototype.start=function(e){};q.ecb.prototype.encrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=e.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)t.putInt32(this._outBlock[n])};q.ecb.prototype.decrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=e.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)t.putInt32(this._outBlock[n])};q.ecb.prototype.pad=function(e,t){var r=e.length()===this.blockSize?this.blockSize:this.blockSize-e.length();return e.fillWithByte(r,r),!0};q.ecb.prototype.unpad=function(e,t){if(t.overflow>0)return!1;var r=e.length(),n=e.at(r-1);return n>this.blockSize<<2?!1:(e.truncate(n),!0)};q.cbc=function(e){e=e||{},this.name="CBC",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};q.cbc.prototype.start=function(e){if(e.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if("iv"in e)this._iv=zi(e.iv,this.blockSize),this._prev=this._iv.slice(0);else throw new Error("Invalid IV parameter.")};q.cbc.prototype.encrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=this._prev[n]^e.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)t.putInt32(this._outBlock[n]);this._prev=this._outBlock};q.cbc.prototype.decrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=e.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)t.putInt32(this._prev[n]^this._outBlock[n]);this._prev=this._inBlock.slice(0)};q.cbc.prototype.pad=function(e,t){var r=e.length()===this.blockSize?this.blockSize:this.blockSize-e.length();return e.fillWithByte(r,r),!0};q.cbc.prototype.unpad=function(e,t){if(t.overflow>0)return!1;var r=e.length(),n=e.at(r-1);return n>this.blockSize<<2?!1:(e.truncate(n),!0)};q.cfb=function(e){e=e||{},this.name="CFB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=kt.util.createBuffer(),this._partialBytes=0};q.cfb.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=zi(e.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};q.cfb.prototype.encrypt=function(e,t,r){var n=e.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)this._inBlock[i]=e.getInt32()^this._outBlock[i],t.putInt32(this._inBlock[i]);return}var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=e.getInt32()^this._outBlock[i],this._partialOutput.putInt32(this._partialBlock[i]);if(s>0)e.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return t.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};q.cfb.prototype.decrypt=function(e,t,r){var n=e.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)this._inBlock[i]=e.getInt32(),t.putInt32(this._inBlock[i]^this._outBlock[i]);return}var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=e.getInt32(),this._partialOutput.putInt32(this._partialBlock[i]^this._outBlock[i]);if(s>0)e.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return t.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};q.ofb=function(e){e=e||{},this.name="OFB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=kt.util.createBuffer(),this._partialBytes=0};q.ofb.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=zi(e.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};q.ofb.prototype.encrypt=function(e,t,r){var n=e.length();if(e.length()===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)t.putInt32(e.getInt32()^this._outBlock[i]),this._inBlock[i]=this._outBlock[i];return}var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(e.getInt32()^this._outBlock[i]);if(s>0)e.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._outBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return t.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};q.ofb.prototype.decrypt=q.ofb.prototype.encrypt;q.ctr=function(e){e=e||{},this.name="CTR",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=kt.util.createBuffer(),this._partialBytes=0};q.ctr.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=zi(e.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};q.ctr.prototype.encrypt=function(e,t,r){var n=e.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize)for(var i=0;i<this._ints;++i)t.putInt32(e.getInt32()^this._outBlock[i]);else{var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(e.getInt32()^this._outBlock[i]);if(s>0&&(e.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return t.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}Hi(this._inBlock)};q.ctr.prototype.decrypt=q.ctr.prototype.encrypt;q.gcm=function(e){e=e||{},this.name="GCM",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=kt.util.createBuffer(),this._partialBytes=0,this._R=3774873600};q.gcm.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");var t=kt.util.createBuffer(e.iv);this._cipherLength=0;var r;if("additionalData"in e?r=kt.util.createBuffer(e.additionalData):r=kt.util.createBuffer(),"tagLength"in e?this._tagLength=e.tagLength:this._tagLength=128,this._tag=null,e.decrypt&&(this._tag=kt.util.createBuffer(e.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var n=t.length();if(n===12)this._j0=[t.getInt32(),t.getInt32(),t.getInt32(),1];else{for(this._j0=[0,0,0,0];t.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[t.getInt32(),t.getInt32(),t.getInt32(),t.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(Ya(n*8)))}this._inBlock=this._j0.slice(0),Hi(this._inBlock),this._partialBytes=0,r=kt.util.createBuffer(r),this._aDataLength=Ya(r.length()*8);var i=r.length()%this.blockSize;for(i&&r.fillWithByte(0,this.blockSize-i),this._s=[0,0,0,0];r.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[r.getInt32(),r.getInt32(),r.getInt32(),r.getInt32()])};q.gcm.prototype.encrypt=function(e,t,r){var n=e.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)t.putInt32(this._outBlock[i]^=e.getInt32());this._cipherLength+=this.blockSize}else{var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(e.getInt32()^this._outBlock[i]);if(s<=0||r){if(r){var a=n%this.blockSize;this._cipherLength+=a,this._partialOutput.truncate(this.blockSize-a)}else this._cipherLength+=this.blockSize;for(var i=0;i<this._ints;++i)this._outBlock[i]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.read-=this.blockSize,t.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),Hi(this._inBlock)};q.gcm.prototype.decrypt=function(e,t,r){var n=e.length();if(n<this.blockSize&&!(r&&n>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),Hi(this._inBlock),this._hashBlock[0]=e.getInt32(),this._hashBlock[1]=e.getInt32(),this._hashBlock[2]=e.getInt32(),this._hashBlock[3]=e.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var i=0;i<this._ints;++i)t.putInt32(this._outBlock[i]^this._hashBlock[i]);n<this.blockSize?this._cipherLength+=n%this.blockSize:this._cipherLength+=this.blockSize};q.gcm.prototype.afterFinish=function(e,t){var r=!0;t.decrypt&&t.overflow&&e.truncate(this.blockSize-t.overflow),this.tag=kt.util.createBuffer();var n=this._aDataLength.concat(Ya(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,n);var i=[];this.cipher.encrypt(this._j0,i);for(var s=0;s<this._ints;++s)this.tag.putInt32(this._s[s]^i[s]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),t.decrypt&&this.tag.bytes()!==this._tag&&(r=!1),r};q.gcm.prototype.multiply=function(e,t){for(var r=[0,0,0,0],n=t.slice(0),i=0;i<128;++i){var s=e[i/32|0]&1<<31-i%32;s&&(r[0]^=n[0],r[1]^=n[1],r[2]^=n[2],r[3]^=n[3]),this.pow(n,n)}return r};q.gcm.prototype.pow=function(e,t){for(var r=e[3]&1,n=3;n>0;--n)t[n]=e[n]>>>1|(e[n-1]&1)<<31;t[0]=e[0]>>>1,r&&(t[0]^=this._R)};q.gcm.prototype.tableMultiply=function(e){for(var t=[0,0,0,0],r=0;r<32;++r){var n=r/8|0,i=e[n]>>>(7-r%8)*4&15,s=this._m[r][i];t[0]^=s[0],t[1]^=s[1],t[2]^=s[2],t[3]^=s[3]}return t};q.gcm.prototype.ghash=function(e,t,r){return t[0]^=r[0],t[1]^=r[1],t[2]^=r[2],t[3]^=r[3],this.tableMultiply(t)};q.gcm.prototype.generateHashTable=function(e,t){for(var r=8/t,n=4*r,i=16*r,s=new Array(i),a=0;a<i;++a){var o=[0,0,0,0],c=a/n|0,u=(n-1-a%n)*t;o[c]=1<<t-1<<u,s[a]=this.generateSubHashTable(this.multiply(o,e),t)}return s};q.gcm.prototype.generateSubHashTable=function(e,t){var r=1<<t,n=r>>>1,i=new Array(r);i[n]=e.slice(0);for(var s=n>>>1;s>0;)this.pow(i[2*s],i[s]=[]),s>>=1;for(s=2;s<n;){for(var a=1;a<s;++a){var o=i[s],c=i[a];i[s+a]=[o[0]^c[0],o[1]^c[1],o[2]^c[2],o[3]^c[3]]}s*=2}for(i[0]=[0,0,0,0],s=n+1;s<r;++s){var u=i[s^n];i[s]=[e[0]^u[0],e[1]^u[1],e[2]^u[2],e[3]^u[3]]}return i};function zi(e,t){if(typeof e=="string"&&(e=kt.util.createBuffer(e)),kt.util.isArray(e)&&e.length>4){var r=e;e=kt.util.createBuffer();for(var n=0;n<r.length;++n)e.putByte(r[n])}if(e.length()<t)throw new Error("Invalid IV length; got "+e.length()+" bytes and expected "+t+" bytes.");if(!kt.util.isArray(e)){for(var i=[],s=t/4,n=0;n<s;++n)i.push(e.getInt32());e=i}return e}function Hi(e){e[e.length-1]=e[e.length-1]+1&4294967295}function Ya(e){return[e/4294967296|0,e&4294967295]}});var eo=U((Qx,bu)=>{var it=et();Za();Xa();St();bu.exports=it.aes=it.aes||{};it.aes.startEncrypting=function(e,t,r,n){var i=Gi({key:e,output:r,decrypt:!1,mode:n});return i.start(t),i};it.aes.createEncryptionCipher=function(e,t){return Gi({key:e,output:null,decrypt:!1,mode:t})};it.aes.startDecrypting=function(e,t,r,n){var i=Gi({key:e,output:r,decrypt:!0,mode:n});return i.start(t),i};it.aes.createDecryptionCipher=function(e,t){return Gi({key:e,output:null,decrypt:!0,mode:t})};it.aes.Algorithm=function(e,t){to||vu();var r=this;r.name=e,r.mode=new t({blockSize:16,cipher:{encrypt:function(n,i){return ja(r._w,n,i,!1)},decrypt:function(n,i){return ja(r._w,n,i,!0)}}}),r._init=!1};it.aes.Algorithm.prototype.initialize=function(e){if(!this._init){var t=e.key,r;if(typeof t=="string"&&(t.length===16||t.length===24||t.length===32))t=it.util.createBuffer(t);else if(it.util.isArray(t)&&(t.length===16||t.length===24||t.length===32)){r=t,t=it.util.createBuffer();for(var n=0;n<r.length;++n)t.putByte(r[n])}if(!it.util.isArray(t)){r=t,t=[];var i=r.length();if(i===16||i===24||i===32){i=i>>>2;for(var n=0;n<i;++n)t.push(r.getInt32())}}if(!it.util.isArray(t)||!(t.length===4||t.length===6||t.length===8))throw new Error("Invalid key parameter.");var s=this.mode.name,a=["CFB","OFB","CTR","GCM"].indexOf(s)!==-1;this._w=wu(t,e.decrypt&&!a),this._init=!0}};it.aes._expandKey=function(e,t){return to||vu(),wu(e,t)};it.aes._updateBlock=ja;rn("AES-ECB",it.cipher.modes.ecb);rn("AES-CBC",it.cipher.modes.cbc);rn("AES-CFB",it.cipher.modes.cfb);rn("AES-OFB",it.cipher.modes.ofb);rn("AES-CTR",it.cipher.modes.ctr);rn("AES-GCM",it.cipher.modes.gcm);function rn(e,t){var r=function(){return new it.aes.Algorithm(e,t)};it.cipher.registerAlgorithm(e,r)}var to=!1,en=4,Ot,Ja,xu,Br,le;function vu(){to=!0,xu=[0,1,2,4,8,16,32,64,128,27,54];for(var e=new Array(256),t=0;t<128;++t)e[t]=t<<1,e[t+128]=t+128<<1^283;Ot=new Array(256),Ja=new Array(256),Br=new Array(4),le=new Array(4);for(var t=0;t<4;++t)Br[t]=new Array(256),le[t]=new Array(256);for(var r=0,n=0,i,s,a,o,c,u,f,t=0;t<256;++t){o=n^n<<1^n<<2^n<<3^n<<4,o=o>>8^o&255^99,Ot[r]=o,Ja[o]=r,c=e[o],i=e[r],s=e[i],a=e[s],u=c<<24^o<<16^o<<8^(o^c),f=(i^s^a)<<24^(r^a)<<16^(r^s^a)<<8^(r^i^a);for(var l=0;l<4;++l)Br[l][r]=u,le[l][o]=f,u=u<<24|u>>>8,f=f<<24|f>>>8;r===0?r=n=1:(r=i^e[e[e[i^a]]],n^=e[e[n]])}}function wu(e,t){for(var r=e.slice(0),n,i=1,s=r.length,a=s+6+1,o=en*a,c=s;c<o;++c)n=r[c-1],c%s===0?(n=Ot[n>>>16&255]<<24^Ot[n>>>8&255]<<16^Ot[n&255]<<8^Ot[n>>>24]^xu[i]<<24,i++):s>6&&c%s===4&&(n=Ot[n>>>24]<<24^Ot[n>>>16&255]<<16^Ot[n>>>8&255]<<8^Ot[n&255]),r[c]=r[c-s]^n;if(t){var u,f=le[0],l=le[1],h=le[2],p=le[3],d=r.slice(0);o=r.length;for(var c=0,g=o-en;c<o;c+=en,g-=en)if(c===0||c===o-en)d[c]=r[g],d[c+1]=r[g+3],d[c+2]=r[g+2],d[c+3]=r[g+1];else for(var x=0;x<en;++x)u=r[g+x],d[c+(3&-x)]=f[Ot[u>>>24]]^l[Ot[u>>>16&255]]^h[Ot[u>>>8&255]]^p[Ot[u&255]];r=d}return r}function ja(e,t,r,n){var i=e.length/4-1,s,a,o,c,u;n?(s=le[0],a=le[1],o=le[2],c=le[3],u=Ja):(s=Br[0],a=Br[1],o=Br[2],c=Br[3],u=Ot);var f,l,h,p,d,g,x;f=t[0]^e[0],l=t[n?3:1]^e[1],h=t[2]^e[2],p=t[n?1:3]^e[3];for(var v=3,S=1;S<i;++S)d=s[f>>>24]^a[l>>>16&255]^o[h>>>8&255]^c[p&255]^e[++v],g=s[l>>>24]^a[h>>>16&255]^o[p>>>8&255]^c[f&255]^e[++v],x=s[h>>>24]^a[p>>>16&255]^o[f>>>8&255]^c[l&255]^e[++v],p=s[p>>>24]^a[f>>>16&255]^o[l>>>8&255]^c[h&255]^e[++v],f=d,l=g,h=x;r[0]=u[f>>>24]<<24^u[l>>>16&255]<<16^u[h>>>8&255]<<8^u[p&255]^e[++v],r[n?3:1]=u[l>>>24]<<24^u[h>>>16&255]<<16^u[p>>>8&255]<<8^u[f&255]^e[++v],r[2]=u[h>>>24]<<24^u[p>>>16&255]<<16^u[f>>>8&255]<<8^u[l&255]^e[++v],r[n?1:3]=u[p>>>24]<<24^u[f>>>16&255]<<16^u[l>>>8&255]<<8^u[h&255]^e[++v]}function Gi(e){e=e||{};var t=(e.mode||"CBC").toUpperCase(),r="AES-"+t,n;e.decrypt?n=it.cipher.createDecipher(r,e.key):n=it.cipher.createCipher(r,e.key);var i=n.start;return n.start=function(s,a){var o=null;a instanceof it.util.ByteBuffer&&(o=a,a={}),a=a||{},a.output=o,a.iv=s,i.call(n,a)},n}});var Au=U((Zx,Su)=>{var lt=et();Za();Xa();St();Su.exports=lt.des=lt.des||{};lt.des.startEncrypting=function(e,t,r,n){var i=Wi({key:e,output:r,decrypt:!1,mode:n||(t===null?"ECB":"CBC")});return i.start(t),i};lt.des.createEncryptionCipher=function(e,t){return Wi({key:e,output:null,decrypt:!1,mode:t})};lt.des.startDecrypting=function(e,t,r,n){var i=Wi({key:e,output:r,decrypt:!0,mode:n||(t===null?"ECB":"CBC")});return i.start(t),i};lt.des.createDecryptionCipher=function(e,t){return Wi({key:e,output:null,decrypt:!0,mode:t})};lt.des.Algorithm=function(e,t){var r=this;r.name=e,r.mode=new t({blockSize:8,cipher:{encrypt:function(n,i){return Eu(r._keys,n,i,!1)},decrypt:function(n,i){return Eu(r._keys,n,i,!0)}}}),r._init=!1};lt.des.Algorithm.prototype.initialize=function(e){if(!this._init){var t=lt.util.createBuffer(e.key);if(this.name.indexOf("3DES")===0&&t.length()!==24)throw new Error("Invalid Triple-DES key size: "+t.length()*8);this._keys=zp(t),this._init=!0}};Ae("DES-ECB",lt.cipher.modes.ecb);Ae("DES-CBC",lt.cipher.modes.cbc);Ae("DES-CFB",lt.cipher.modes.cfb);Ae("DES-OFB",lt.cipher.modes.ofb);Ae("DES-CTR",lt.cipher.modes.ctr);Ae("3DES-ECB",lt.cipher.modes.ecb);Ae("3DES-CBC",lt.cipher.modes.cbc);Ae("3DES-CFB",lt.cipher.modes.cfb);Ae("3DES-OFB",lt.cipher.modes.ofb);Ae("3DES-CTR",lt.cipher.modes.ctr);function Ae(e,t){var r=function(){return new lt.des.Algorithm(e,t)};lt.cipher.registerAlgorithm(e,r)}var Pp=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],Up=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],Kp=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],Fp=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],Op=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],Mp=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],Vp=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],qp=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function zp(e){for(var t=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],r=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],n=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],i=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],s=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],a=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],o=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],c=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],u=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],f=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],l=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],h=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],p=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],d=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],g=e.length()>8?3:1,x=[],v=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],S=0,B,L=0;L<g;L++){var C=e.getInt32(),_=e.getInt32();B=(C>>>4^_)&252645135,_^=B,C^=B<<4,B=(_>>>-16^C)&65535,C^=B,_^=B<<-16,B=(C>>>2^_)&858993459,_^=B,C^=B<<2,B=(_>>>-16^C)&65535,C^=B,_^=B<<-16,B=(C>>>1^_)&1431655765,_^=B,C^=B<<1,B=(_>>>8^C)&16711935,C^=B,_^=B<<8,B=(C>>>1^_)&1431655765,_^=B,C^=B<<1,B=C<<8|_>>>20&240,C=_<<24|_<<8&16711680|_>>>8&65280|_>>>24&240,_=B;for(var z=0;z<v.length;++z){v[z]?(C=C<<2|C>>>26,_=_<<2|_>>>26):(C=C<<1|C>>>27,_=_<<1|_>>>27),C&=-15,_&=-15;var G=t[C>>>28]|r[C>>>24&15]|n[C>>>20&15]|i[C>>>16&15]|s[C>>>12&15]|a[C>>>8&15]|o[C>>>4&15],Ct=c[_>>>28]|u[_>>>24&15]|f[_>>>20&15]|l[_>>>16&15]|h[_>>>12&15]|p[_>>>8&15]|d[_>>>4&15];B=(Ct>>>16^G)&65535,x[S++]=G^B,x[S++]=Ct^B<<16}}return x}function Eu(e,t,r,n){var i=e.length===32?3:9,s;i===3?s=n?[30,-2,-2]:[0,32,2]:s=n?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var a,o=t[0],c=t[1];a=(o>>>4^c)&252645135,c^=a,o^=a<<4,a=(o>>>16^c)&65535,c^=a,o^=a<<16,a=(c>>>2^o)&858993459,o^=a,c^=a<<2,a=(c>>>8^o)&16711935,o^=a,c^=a<<8,a=(o>>>1^c)&1431655765,c^=a,o^=a<<1,o=o<<1|o>>>31,c=c<<1|c>>>31;for(var u=0;u<i;u+=3){for(var f=s[u+1],l=s[u+2],h=s[u];h!=f;h+=l){var p=c^e[h],d=(c>>>4|c<<28)^e[h+1];a=o,o=c,c=a^(Up[p>>>24&63]|Fp[p>>>16&63]|Mp[p>>>8&63]|qp[p&63]|Pp[d>>>24&63]|Kp[d>>>16&63]|Op[d>>>8&63]|Vp[d&63])}a=o,o=c,c=a}o=o>>>1|o<<31,c=c>>>1|c<<31,a=(o>>>1^c)&1431655765,c^=a,o^=a<<1,a=(c>>>8^o)&16711935,o^=a,c^=a<<8,a=(c>>>2^o)&858993459,o^=a,c^=a<<2,a=(o>>>16^c)&65535,c^=a,o^=a<<16,a=(o>>>4^c)&252645135,c^=a,o^=a<<4,r[0]=o,r[1]=c}function Wi(e){e=e||{};var t=(e.mode||"CBC").toUpperCase(),r="DES-"+t,n;e.decrypt?n=lt.cipher.createDecipher(r,e.key):n=lt.cipher.createCipher(r,e.key);var i=n.start;return n.start=function(s,a){var o=null;a instanceof lt.util.ByteBuffer&&(o=a,a={}),a=a||{},a.output=o,a.iv=s,i.call(n,a)},n}});var Cr=U((Yx,Bu)=>{var $i=et();Bu.exports=$i.md=$i.md||{};$i.md.algorithms=$i.md.algorithms||{}});var Tu=U((Xx,Cu)=>{var Oe=et();Cr();St();var Hp=Cu.exports=Oe.hmac=Oe.hmac||{};Hp.create=function(){var e=null,t=null,r=null,n=null,i={};return i.start=function(s,a){if(s!==null)if(typeof s=="string")if(s=s.toLowerCase(),s in Oe.md.algorithms)t=Oe.md.algorithms[s].create();else throw new Error('Unknown hash algorithm "'+s+'"');else t=s;if(a===null)a=e;else{if(typeof a=="string")a=Oe.util.createBuffer(a);else if(Oe.util.isArray(a)){var o=a;a=Oe.util.createBuffer();for(var c=0;c<o.length;++c)a.putByte(o[c])}var u=a.length();u>t.blockLength&&(t.start(),t.update(a.bytes()),a=t.digest()),r=Oe.util.createBuffer(),n=Oe.util.createBuffer(),u=a.length();for(var c=0;c<u;++c){var o=a.at(c);r.putByte(54^o),n.putByte(92^o)}if(u<t.blockLength)for(var o=t.blockLength-u,c=0;c<o;++c)r.putByte(54),n.putByte(92);e=a,r=r.bytes(),n=n.bytes()}t.start(),t.update(r)},i.update=function(s){t.update(s)},i.getMac=function(){var s=t.digest().bytes();return t.start(),t.update(n),t.update(s),t.digest()},i.digest=i.getMac,i}});var nn=U(()=>{});var Iu=U((tv,_u)=>{var Mt=et();Tu();Cr();St();var Gp=Mt.pkcs5=Mt.pkcs5||{},Me;Mt.util.isNodejs&&!Mt.options.usePureJavaScript&&(Me=nn());_u.exports=Mt.pbkdf2=Gp.pbkdf2=function(e,t,r,n,i,s){if(typeof i=="function"&&(s=i,i=null),Mt.util.isNodejs&&!Mt.options.usePureJavaScript&&Me.pbkdf2&&(i===null||typeof i!="object")&&(Me.pbkdf2Sync.length>4||!i||i==="sha1"))return typeof i!="string"&&(i="sha1"),e=Buffer.from(e,"binary"),t=Buffer.from(t,"binary"),s?Me.pbkdf2Sync.length===4?Me.pbkdf2(e,t,r,n,function(B,L){if(B)return s(B);s(null,L.toString("binary"))}):Me.pbkdf2(e,t,r,n,i,function(B,L){if(B)return s(B);s(null,L.toString("binary"))}):Me.pbkdf2Sync.length===4?Me.pbkdf2Sync(e,t,r,n).toString("binary"):Me.pbkdf2Sync(e,t,r,n,i).toString("binary");if((typeof i>"u"||i===null)&&(i="sha1"),typeof i=="string"){if(!(i in Mt.md.algorithms))throw new Error("Unknown hash algorithm: "+i);i=Mt.md[i].create()}var a=i.digestLength;if(n>4294967295*a){var o=new Error("Derived key is too long.");if(s)return s(o);throw o}var c=Math.ceil(n/a),u=n-(c-1)*a,f=Mt.hmac.create();f.start(i,e);var l="",h,p,d;if(!s){for(var g=1;g<=c;++g){f.start(null,null),f.update(t),f.update(Mt.util.int32ToBytes(g)),h=d=f.digest().getBytes();for(var x=2;x<=r;++x)f.start(null,null),f.update(d),p=f.digest().getBytes(),h=Mt.util.xorBytes(h,p,a),d=p;l+=g<c?h:h.substr(0,u)}return l}var g=1,x;function v(){if(g>c)return s(null,l);f.start(null,null),f.update(t),f.update(Mt.util.int32ToBytes(g)),h=d=f.digest().getBytes(),x=2,S()}function S(){if(x<=r)return f.start(null,null),f.update(d),p=f.digest().getBytes(),h=Mt.util.xorBytes(h,p,a),d=p,++x,Mt.util.setImmediate(S);l+=g<c?h:h.substr(0,u),++g,v()}v()}});var Nu=U((ev,ku)=>{var Zi=et();St();var Ru=ku.exports=Zi.pem=Zi.pem||{};Ru.encode=function(e,t){t=t||{};var r="-----BEGIN "+e.type+`-----\r
`,n;if(e.procType&&(n={name:"Proc-Type",values:[String(e.procType.version),e.procType.type]},r+=Qi(n)),e.contentDomain&&(n={name:"Content-Domain",values:[e.contentDomain]},r+=Qi(n)),e.dekInfo&&(n={name:"DEK-Info",values:[e.dekInfo.algorithm]},e.dekInfo.parameters&&n.values.push(e.dekInfo.parameters),r+=Qi(n)),e.headers)for(var i=0;i<e.headers.length;++i)r+=Qi(e.headers[i]);return e.procType&&(r+=`\r
`),r+=Zi.util.encode64(e.body,t.maxline||64)+`\r
`,r+="-----END "+e.type+`-----\r
`,r};Ru.decode=function(e){for(var t=[],r=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,n=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,i=/\r?\n/,s;s=r.exec(e),!!s;){var a=s[1];a==="NEW CERTIFICATE REQUEST"&&(a="CERTIFICATE REQUEST");var o={type:a,procType:null,contentDomain:null,dekInfo:null,headers:[],body:Zi.util.decode64(s[3])};if(t.push(o),!!s[2]){for(var c=s[2].split(i),u=0;s&&u<c.length;){for(var f=c[u].replace(/\s+$/,""),l=u+1;l<c.length;++l){var h=c[l];if(!/\s/.test(h[0]))break;f+=h,u=l}if(s=f.match(n),s){for(var p={name:s[1],values:[]},d=s[2].split(","),g=0;g<d.length;++g)p.values.push(Wp(d[g]));if(o.procType)if(!o.contentDomain&&p.name==="Content-Domain")o.contentDomain=d[0]||"";else if(!o.dekInfo&&p.name==="DEK-Info"){if(p.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');o.dekInfo={algorithm:d[0],parameters:d[1]||null}}else o.headers.push(p);else{if(p.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(p.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');o.procType={version:d[0],type:d[1]}}}++u}if(o.procType==="ENCRYPTED"&&!o.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(t.length===0)throw new Error("Invalid PEM formatted message.");return t};function Qi(e){for(var t=e.name+": ",r=[],n=function(c,u){return" "+u},i=0;i<e.values.length;++i)r.push(e.values[i].replace(/^(\S+\r\n)/,n));t+=r.join(",")+`\r
`;for(var s=0,a=-1,i=0;i<t.length;++i,++s)if(s>65&&a!==-1){var o=t[a];o===","?(++a,t=t.substr(0,a)+`\r
 `+t.substr(a)):t=t.substr(0,a)+`\r
`+o+t.substr(a+1),s=i-a-1,a=-1,++i}else(t[i]===" "||t[i]==="	"||t[i]===",")&&(a=i);return t}function Wp(e){return e.replace(/^\s+/,"")}});var Fu=U((rv,Ku)=>{var Be=et();Cr();St();var Du=Ku.exports=Be.sha256=Be.sha256||{};Be.md.sha256=Be.md.algorithms.sha256=Du;Du.create=function(){Pu||$p();var e=null,t=Be.util.createBuffer(),r=new Array(64),n={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var i=n.messageLengthSize/4,s=0;s<i;++s)n.fullMessageLength.push(0);return t=Be.util.createBuffer(),e={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},n},n.start(),n.update=function(i,s){s==="utf8"&&(i=Be.util.encodeUtf8(i));var a=i.length;n.messageLength+=a,a=[a/4294967296>>>0,a>>>0];for(var o=n.fullMessageLength.length-1;o>=0;--o)n.fullMessageLength[o]+=a[1],a[1]=a[0]+(n.fullMessageLength[o]/4294967296>>>0),n.fullMessageLength[o]=n.fullMessageLength[o]>>>0,a[0]=a[1]/4294967296>>>0;return t.putBytes(i),Lu(e,r,t),(t.read>2048||t.length()===0)&&t.compact(),n},n.digest=function(){var i=Be.util.createBuffer();i.putBytes(t.bytes());var s=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,a=s&n.blockLength-1;i.putBytes(ro.substr(0,n.blockLength-a));for(var o,c,u=n.fullMessageLength[0]*8,f=0;f<n.fullMessageLength.length-1;++f)o=n.fullMessageLength[f+1]*8,c=o/4294967296>>>0,u+=c,i.putInt32(u>>>0),u=o>>>0;i.putInt32(u);var l={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3,h4:e.h4,h5:e.h5,h6:e.h6,h7:e.h7};Lu(l,r,i);var h=Be.util.createBuffer();return h.putInt32(l.h0),h.putInt32(l.h1),h.putInt32(l.h2),h.putInt32(l.h3),h.putInt32(l.h4),h.putInt32(l.h5),h.putInt32(l.h6),h.putInt32(l.h7),h},n};var ro=null,Pu=!1,Uu=null;function $p(){ro=String.fromCharCode(128),ro+=Be.util.fillString(String.fromCharCode(0),64),Uu=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],Pu=!0}function Lu(e,t,r){for(var n,i,s,a,o,c,u,f,l,h,p,d,g,x,v,S=r.length();S>=64;){for(u=0;u<16;++u)t[u]=r.getInt32();for(;u<64;++u)n=t[u-2],n=(n>>>17|n<<15)^(n>>>19|n<<13)^n>>>10,i=t[u-15],i=(i>>>7|i<<25)^(i>>>18|i<<14)^i>>>3,t[u]=n+t[u-7]+i+t[u-16]|0;for(f=e.h0,l=e.h1,h=e.h2,p=e.h3,d=e.h4,g=e.h5,x=e.h6,v=e.h7,u=0;u<64;++u)a=(d>>>6|d<<26)^(d>>>11|d<<21)^(d>>>25|d<<7),o=x^d&(g^x),s=(f>>>2|f<<30)^(f>>>13|f<<19)^(f>>>22|f<<10),c=f&l|h&(f^l),n=v+a+o+Uu[u]+t[u],i=s+c,v=x,x=g,g=d,d=p+n>>>0,p=h,h=l,l=f,f=n+i>>>0;e.h0=e.h0+f|0,e.h1=e.h1+l|0,e.h2=e.h2+h|0,e.h3=e.h3+p|0,e.h4=e.h4+d|0,e.h5=e.h5+g|0,e.h6=e.h6+x|0,e.h7=e.h7+v|0,S-=64}}});var Mu=U((nv,Ou)=>{var Ce=et();St();var Yi=null;Ce.util.isNodejs&&!Ce.options.usePureJavaScript&&!process.versions["node-webkit"]&&(Yi=nn());var Qp=Ou.exports=Ce.prng=Ce.prng||{};Qp.create=function(e){for(var t={plugin:e,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},r=e.md,n=new Array(32),i=0;i<32;++i)n[i]=r.create();t.pools=n,t.pool=0,t.generate=function(u,f){if(!f)return t.generateSync(u);var l=t.plugin.cipher,h=t.plugin.increment,p=t.plugin.formatKey,d=t.plugin.formatSeed,g=Ce.util.createBuffer();t.key=null,x();function x(v){if(v)return f(v);if(g.length()>=u)return f(null,g.getBytes(u));if(t.generated>1048575&&(t.key=null),t.key===null)return Ce.util.nextTick(function(){s(x)});var S=l(t.key,t.seed);t.generated+=S.length,g.putBytes(S),t.key=p(l(t.key,h(t.seed))),t.seed=d(l(t.key,t.seed)),Ce.util.setImmediate(x)}},t.generateSync=function(u){var f=t.plugin.cipher,l=t.plugin.increment,h=t.plugin.formatKey,p=t.plugin.formatSeed;t.key=null;for(var d=Ce.util.createBuffer();d.length()<u;){t.generated>1048575&&(t.key=null),t.key===null&&a();var g=f(t.key,t.seed);t.generated+=g.length,d.putBytes(g),t.key=h(f(t.key,l(t.seed))),t.seed=p(f(t.key,t.seed))}return d.getBytes(u)};function s(u){if(t.pools[0].messageLength>=32)return o(),u();var f=32-t.pools[0].messageLength<<5;t.seedFile(f,function(l,h){if(l)return u(l);t.collect(h),o(),u()})}function a(){if(t.pools[0].messageLength>=32)return o();var u=32-t.pools[0].messageLength<<5;t.collect(t.seedFileSync(u)),o()}function o(){t.reseeds=t.reseeds===4294967295?0:t.reseeds+1;var u=t.plugin.md.create();u.update(t.keyBytes);for(var f=1,l=0;l<32;++l)t.reseeds%f===0&&(u.update(t.pools[l].digest().getBytes()),t.pools[l].start()),f=f<<1;t.keyBytes=u.digest().getBytes(),u.start(),u.update(t.keyBytes);var h=u.digest().getBytes();t.key=t.plugin.formatKey(t.keyBytes),t.seed=t.plugin.formatSeed(h),t.generated=0}function c(u){var f=null,l=Ce.util.globalScope,h=l.crypto||l.msCrypto;h&&h.getRandomValues&&(f=function(C){return h.getRandomValues(C)});var p=Ce.util.createBuffer();if(f)for(;p.length()<u;){var d=Math.max(1,Math.min(u-p.length(),65536)/4),g=new Uint32Array(Math.floor(d));try{f(g);for(var x=0;x<g.length;++x)p.putInt32(g[x])}catch(C){if(!(typeof QuotaExceededError<"u"&&C instanceof QuotaExceededError))throw C}}if(p.length()<u)for(var v,S,B,L=Math.floor(Math.random()*65536);p.length()<u;){S=16807*(L&65535),v=16807*(L>>16),S+=(v&32767)<<16,S+=v>>15,S=(S&2147483647)+(S>>31),L=S&4294967295;for(var x=0;x<3;++x)B=L>>>(x<<3),B^=Math.floor(Math.random()*256),p.putByte(B&255)}return p.getBytes(u)}return Yi?(t.seedFile=function(u,f){Yi.randomBytes(u,function(l,h){if(l)return f(l);f(null,h.toString())})},t.seedFileSync=function(u){return Yi.randomBytes(u).toString()}):(t.seedFile=function(u,f){try{f(null,c(u))}catch(l){f(l)}},t.seedFileSync=c),t.collect=function(u){for(var f=u.length,l=0;l<f;++l)t.pools[t.pool].update(u.substr(l,1)),t.pool=t.pool===31?0:t.pool+1},t.collectInt=function(u,f){for(var l="",h=0;h<f;h+=8)l+=String.fromCharCode(u>>h&255);t.collect(l)},t.registerWorker=function(u){if(u===self)t.seedFile=function(l,h){function p(d){var g=d.data;g.forge&&g.forge.prng&&(self.removeEventListener("message",p),h(g.forge.prng.err,g.forge.prng.bytes))}self.addEventListener("message",p),self.postMessage({forge:{prng:{needed:l}}})};else{var f=function(l){var h=l.data;h.forge&&h.forge.prng&&t.seedFile(h.forge.prng.needed,function(p,d){u.postMessage({forge:{prng:{err:p,bytes:d}}})})};u.addEventListener("message",f)}},t}});var Fn=U((iv,no)=>{var Nt=et();eo();Fu();Mu();St();(function(){if(Nt.random&&Nt.random.getBytes){no.exports=Nt.random;return}(function(e){var t={},r=new Array(4),n=Nt.util.createBuffer();t.formatKey=function(l){var h=Nt.util.createBuffer(l);return l=new Array(4),l[0]=h.getInt32(),l[1]=h.getInt32(),l[2]=h.getInt32(),l[3]=h.getInt32(),Nt.aes._expandKey(l,!1)},t.formatSeed=function(l){var h=Nt.util.createBuffer(l);return l=new Array(4),l[0]=h.getInt32(),l[1]=h.getInt32(),l[2]=h.getInt32(),l[3]=h.getInt32(),l},t.cipher=function(l,h){return Nt.aes._updateBlock(l,h,r,!1),n.putInt32(r[0]),n.putInt32(r[1]),n.putInt32(r[2]),n.putInt32(r[3]),n.getBytes()},t.increment=function(l){return++l[3],l},t.md=Nt.md.sha256;function i(){var l=Nt.prng.create(t);return l.getBytes=function(h,p){return l.generate(h,p)},l.getBytesSync=function(h){return l.generate(h)},l}var s=i(),a=null,o=Nt.util.globalScope,c=o.crypto||o.msCrypto;if(c&&c.getRandomValues&&(a=function(l){return c.getRandomValues(l)}),Nt.options.usePureJavaScript||!Nt.util.isNodejs&&!a){if(typeof window>"u"||window.document,s.collectInt(+new Date,32),typeof navigator<"u"){var u="";for(var f in navigator)try{typeof navigator[f]=="string"&&(u+=navigator[f])}catch{}s.collect(u),u=null}e&&(e().mousemove(function(l){s.collectInt(l.clientX,16),s.collectInt(l.clientY,16)}),e().keypress(function(l){s.collectInt(l.charCode,8)}))}if(!Nt.random)Nt.random=s;else for(var f in s)Nt.random[f]=s[f];Nt.random.createInstance=i,no.exports=Nt.random})(typeof jQuery<"u"?jQuery:null)})()});var Hu=U((sv,zu)=>{var zt=et();St();var io=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],Vu=[1,2,3,5],Zp=function(e,t){return e<<t&65535|(e&65535)>>16-t},Yp=function(e,t){return(e&65535)>>t|e<<16-t&65535};zu.exports=zt.rc2=zt.rc2||{};zt.rc2.expandKey=function(e,t){typeof e=="string"&&(e=zt.util.createBuffer(e)),t=t||128;var r=e,n=e.length(),i=t,s=Math.ceil(i/8),a=255>>(i&7),o;for(o=n;o<128;o++)r.putByte(io[r.at(o-1)+r.at(o-n)&255]);for(r.setAt(128-s,io[r.at(128-s)&a]),o=127-s;o>=0;o--)r.setAt(o,io[r.at(o+1)^r.at(o+s)]);return r};var qu=function(e,t,r){var n=!1,i=null,s=null,a=null,o,c,u,f,l=[];for(e=zt.rc2.expandKey(e,t),u=0;u<64;u++)l.push(e.getInt16Le());r?(o=function(d){for(u=0;u<4;u++)d[u]+=l[f]+(d[(u+3)%4]&d[(u+2)%4])+(~d[(u+3)%4]&d[(u+1)%4]),d[u]=Zp(d[u],Vu[u]),f++},c=function(d){for(u=0;u<4;u++)d[u]+=l[d[(u+3)%4]&63]}):(o=function(d){for(u=3;u>=0;u--)d[u]=Yp(d[u],Vu[u]),d[u]-=l[f]+(d[(u+3)%4]&d[(u+2)%4])+(~d[(u+3)%4]&d[(u+1)%4]),f--},c=function(d){for(u=3;u>=0;u--)d[u]-=l[d[(u+3)%4]&63]});var h=function(d){var g=[];for(u=0;u<4;u++){var x=i.getInt16Le();a!==null&&(r?x^=a.getInt16Le():a.putInt16Le(x)),g.push(x&65535)}f=r?0:63;for(var v=0;v<d.length;v++)for(var S=0;S<d[v][0];S++)d[v][1](g);for(u=0;u<4;u++)a!==null&&(r?a.putInt16Le(g[u]):g[u]^=a.getInt16Le()),s.putInt16Le(g[u])},p=null;return p={start:function(d,g){d&&typeof d=="string"&&(d=zt.util.createBuffer(d)),n=!1,i=zt.util.createBuffer(),s=g||new zt.util.createBuffer,a=d,p.output=s},update:function(d){for(n||i.putBuffer(d);i.length()>=8;)h([[5,o],[1,c],[6,o],[1,c],[5,o]])},finish:function(d){var g=!0;if(r)if(d)g=d(8,i,!r);else{var x=i.length()===8?8:8-i.length();i.fillWithByte(x,x)}if(g&&(n=!0,p.update()),!r&&(g=i.length()===0,g))if(d)g=d(8,s,!r);else{var v=s.length(),S=s.at(v-1);S>v?g=!1:s.truncate(S)}return g}},p};zt.rc2.startEncrypting=function(e,t,r){var n=zt.rc2.createEncryptionCipher(e,128);return n.start(t,r),n};zt.rc2.createEncryptionCipher=function(e,t){return qu(e,t,!0)};zt.rc2.startDecrypting=function(e,t,r){var n=zt.rc2.createDecryptionCipher(e,128);return n.start(t,r),n};zt.rc2.createDecryptionCipher=function(e,t){return qu(e,t,!1)}});var ji=U((av,Ju)=>{var so=et();Ju.exports=so.jsbn=so.jsbn||{};var Ve,Xp=0xdeadbeefcafe,Gu=(Xp&16777215)==15715070;function b(e,t,r){this.data=[],e!=null&&(typeof e=="number"?this.fromNumber(e,t,r):t==null&&typeof e!="string"?this.fromString(e,256):this.fromString(e,t))}so.jsbn.BigInteger=b;function Y(){return new b(null)}function Jp(e,t,r,n,i,s){for(;--s>=0;){var a=t*this.data[e++]+r.data[n]+i;i=Math.floor(a/67108864),r.data[n++]=a&67108863}return i}function jp(e,t,r,n,i,s){for(var a=t&32767,o=t>>15;--s>=0;){var c=this.data[e]&32767,u=this.data[e++]>>15,f=o*c+u*a;c=a*c+((f&32767)<<15)+r.data[n]+(i&1073741823),i=(c>>>30)+(f>>>15)+o*u+(i>>>30),r.data[n++]=c&1073741823}return i}function Wu(e,t,r,n,i,s){for(var a=t&16383,o=t>>14;--s>=0;){var c=this.data[e]&16383,u=this.data[e++]>>14,f=o*c+u*a;c=a*c+((f&16383)<<14)+r.data[n]+i,i=(c>>28)+(f>>14)+o*u,r.data[n++]=c&268435455}return i}typeof navigator>"u"?(b.prototype.am=Wu,Ve=28):Gu&&navigator.appName=="Microsoft Internet Explorer"?(b.prototype.am=jp,Ve=30):Gu&&navigator.appName!="Netscape"?(b.prototype.am=Jp,Ve=26):(b.prototype.am=Wu,Ve=28);b.prototype.DB=Ve;b.prototype.DM=(1<<Ve)-1;b.prototype.DV=1<<Ve;var ao=52;b.prototype.FV=Math.pow(2,ao);b.prototype.F1=ao-Ve;b.prototype.F2=2*Ve-ao;var ty="0123456789abcdefghijklmnopqrstuvwxyz",Xi=new Array,sn,ie;sn="0".charCodeAt(0);for(ie=0;ie<=9;++ie)Xi[sn++]=ie;sn="a".charCodeAt(0);for(ie=10;ie<36;++ie)Xi[sn++]=ie;sn="A".charCodeAt(0);for(ie=10;ie<36;++ie)Xi[sn++]=ie;function $u(e){return ty.charAt(e)}function Qu(e,t){var r=Xi[e.charCodeAt(t)];return r??-1}function ey(e){for(var t=this.t-1;t>=0;--t)e.data[t]=this.data[t];e.t=this.t,e.s=this.s}function ry(e){this.t=1,this.s=e<0?-1:0,e>0?this.data[0]=e:e<-1?this.data[0]=e+this.DV:this.t=0}function tr(e){var t=Y();return t.fromInt(e),t}function ny(e,t){var r;if(t==16)r=4;else if(t==8)r=3;else if(t==256)r=8;else if(t==2)r=1;else if(t==32)r=5;else if(t==4)r=2;else{this.fromRadix(e,t);return}this.t=0,this.s=0;for(var n=e.length,i=!1,s=0;--n>=0;){var a=r==8?e[n]&255:Qu(e,n);if(a<0){e.charAt(n)=="-"&&(i=!0);continue}i=!1,s==0?this.data[this.t++]=a:s+r>this.DB?(this.data[this.t-1]|=(a&(1<<this.DB-s)-1)<<s,this.data[this.t++]=a>>this.DB-s):this.data[this.t-1]|=a<<s,s+=r,s>=this.DB&&(s-=this.DB)}r==8&&e[0]&128&&(this.s=-1,s>0&&(this.data[this.t-1]|=(1<<this.DB-s)-1<<s)),this.clamp(),i&&b.ZERO.subTo(this,this)}function iy(){for(var e=this.s&this.DM;this.t>0&&this.data[this.t-1]==e;)--this.t}function sy(e){if(this.s<0)return"-"+this.negate().toString(e);var t;if(e==16)t=4;else if(e==8)t=3;else if(e==2)t=1;else if(e==32)t=5;else if(e==4)t=2;else return this.toRadix(e);var r=(1<<t)-1,n,i=!1,s="",a=this.t,o=this.DB-a*this.DB%t;if(a-- >0)for(o<this.DB&&(n=this.data[a]>>o)>0&&(i=!0,s=$u(n));a>=0;)o<t?(n=(this.data[a]&(1<<o)-1)<<t-o,n|=this.data[--a]>>(o+=this.DB-t)):(n=this.data[a]>>(o-=t)&r,o<=0&&(o+=this.DB,--a)),n>0&&(i=!0),i&&(s+=$u(n));return i?s:"0"}function ay(){var e=Y();return b.ZERO.subTo(this,e),e}function oy(){return this.s<0?this.negate():this}function cy(e){var t=this.s-e.s;if(t!=0)return t;var r=this.t;if(t=r-e.t,t!=0)return this.s<0?-t:t;for(;--r>=0;)if((t=this.data[r]-e.data[r])!=0)return t;return 0}function Ji(e){var t=1,r;return(r=e>>>16)!=0&&(e=r,t+=16),(r=e>>8)!=0&&(e=r,t+=8),(r=e>>4)!=0&&(e=r,t+=4),(r=e>>2)!=0&&(e=r,t+=2),(r=e>>1)!=0&&(e=r,t+=1),t}function uy(){return this.t<=0?0:this.DB*(this.t-1)+Ji(this.data[this.t-1]^this.s&this.DM)}function fy(e,t){var r;for(r=this.t-1;r>=0;--r)t.data[r+e]=this.data[r];for(r=e-1;r>=0;--r)t.data[r]=0;t.t=this.t+e,t.s=this.s}function ly(e,t){for(var r=e;r<this.t;++r)t.data[r-e]=this.data[r];t.t=Math.max(this.t-e,0),t.s=this.s}function hy(e,t){var r=e%this.DB,n=this.DB-r,i=(1<<n)-1,s=Math.floor(e/this.DB),a=this.s<<r&this.DM,o;for(o=this.t-1;o>=0;--o)t.data[o+s+1]=this.data[o]>>n|a,a=(this.data[o]&i)<<r;for(o=s-1;o>=0;--o)t.data[o]=0;t.data[s]=a,t.t=this.t+s+1,t.s=this.s,t.clamp()}function dy(e,t){t.s=this.s;var r=Math.floor(e/this.DB);if(r>=this.t){t.t=0;return}var n=e%this.DB,i=this.DB-n,s=(1<<n)-1;t.data[0]=this.data[r]>>n;for(var a=r+1;a<this.t;++a)t.data[a-r-1]|=(this.data[a]&s)<<i,t.data[a-r]=this.data[a]>>n;n>0&&(t.data[this.t-r-1]|=(this.s&s)<<i),t.t=this.t-r,t.clamp()}function py(e,t){for(var r=0,n=0,i=Math.min(e.t,this.t);r<i;)n+=this.data[r]-e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n-=e.s;r<this.t;)n+=this.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n-=e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n-=e.s}t.s=n<0?-1:0,n<-1?t.data[r++]=this.DV+n:n>0&&(t.data[r++]=n),t.t=r,t.clamp()}function yy(e,t){var r=this.abs(),n=e.abs(),i=r.t;for(t.t=i+n.t;--i>=0;)t.data[i]=0;for(i=0;i<n.t;++i)t.data[i+r.t]=r.am(0,n.data[i],t,i,0,r.t);t.s=0,t.clamp(),this.s!=e.s&&b.ZERO.subTo(t,t)}function gy(e){for(var t=this.abs(),r=e.t=2*t.t;--r>=0;)e.data[r]=0;for(r=0;r<t.t-1;++r){var n=t.am(r,t.data[r],e,2*r,0,1);(e.data[r+t.t]+=t.am(r+1,2*t.data[r],e,2*r+1,n,t.t-r-1))>=t.DV&&(e.data[r+t.t]-=t.DV,e.data[r+t.t+1]=1)}e.t>0&&(e.data[e.t-1]+=t.am(r,t.data[r],e,2*r,0,1)),e.s=0,e.clamp()}function my(e,t,r){var n=e.abs();if(!(n.t<=0)){var i=this.abs();if(i.t<n.t){t?.fromInt(0),r!=null&&this.copyTo(r);return}r==null&&(r=Y());var s=Y(),a=this.s,o=e.s,c=this.DB-Ji(n.data[n.t-1]);c>0?(n.lShiftTo(c,s),i.lShiftTo(c,r)):(n.copyTo(s),i.copyTo(r));var u=s.t,f=s.data[u-1];if(f!=0){var l=f*(1<<this.F1)+(u>1?s.data[u-2]>>this.F2:0),h=this.FV/l,p=(1<<this.F1)/l,d=1<<this.F2,g=r.t,x=g-u,v=t??Y();for(s.dlShiftTo(x,v),r.compareTo(v)>=0&&(r.data[r.t++]=1,r.subTo(v,r)),b.ONE.dlShiftTo(u,v),v.subTo(s,s);s.t<u;)s.data[s.t++]=0;for(;--x>=0;){var S=r.data[--g]==f?this.DM:Math.floor(r.data[g]*h+(r.data[g-1]+d)*p);if((r.data[g]+=s.am(0,S,r,x,0,u))<S)for(s.dlShiftTo(x,v),r.subTo(v,r);r.data[g]<--S;)r.subTo(v,r)}t!=null&&(r.drShiftTo(u,t),a!=o&&b.ZERO.subTo(t,t)),r.t=u,r.clamp(),c>0&&r.rShiftTo(c,r),a<0&&b.ZERO.subTo(r,r)}}}function xy(e){var t=Y();return this.abs().divRemTo(e,null,t),this.s<0&&t.compareTo(b.ZERO)>0&&e.subTo(t,t),t}function Tr(e){this.m=e}function vy(e){return e.s<0||e.compareTo(this.m)>=0?e.mod(this.m):e}function wy(e){return e}function by(e){e.divRemTo(this.m,null,e)}function Ey(e,t,r){e.multiplyTo(t,r),this.reduce(r)}function Sy(e,t){e.squareTo(t),this.reduce(t)}Tr.prototype.convert=vy;Tr.prototype.revert=wy;Tr.prototype.reduce=by;Tr.prototype.mulTo=Ey;Tr.prototype.sqrTo=Sy;function Ay(){if(this.t<1)return 0;var e=this.data[0];if(!(e&1))return 0;var t=e&3;return t=t*(2-(e&15)*t)&15,t=t*(2-(e&255)*t)&255,t=t*(2-((e&65535)*t&65535))&65535,t=t*(2-e*t%this.DV)%this.DV,t>0?this.DV-t:-t}function _r(e){this.m=e,this.mp=e.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<e.DB-15)-1,this.mt2=2*e.t}function By(e){var t=Y();return e.abs().dlShiftTo(this.m.t,t),t.divRemTo(this.m,null,t),e.s<0&&t.compareTo(b.ZERO)>0&&this.m.subTo(t,t),t}function Cy(e){var t=Y();return e.copyTo(t),this.reduce(t),t}function Ty(e){for(;e.t<=this.mt2;)e.data[e.t++]=0;for(var t=0;t<this.m.t;++t){var r=e.data[t]&32767,n=r*this.mpl+((r*this.mph+(e.data[t]>>15)*this.mpl&this.um)<<15)&e.DM;for(r=t+this.m.t,e.data[r]+=this.m.am(0,n,e,t,0,this.m.t);e.data[r]>=e.DV;)e.data[r]-=e.DV,e.data[++r]++}e.clamp(),e.drShiftTo(this.m.t,e),e.compareTo(this.m)>=0&&e.subTo(this.m,e)}function _y(e,t){e.squareTo(t),this.reduce(t)}function Iy(e,t,r){e.multiplyTo(t,r),this.reduce(r)}_r.prototype.convert=By;_r.prototype.revert=Cy;_r.prototype.reduce=Ty;_r.prototype.mulTo=Iy;_r.prototype.sqrTo=_y;function Ry(){return(this.t>0?this.data[0]&1:this.s)==0}function ky(e,t){if(e>4294967295||e<1)return b.ONE;var r=Y(),n=Y(),i=t.convert(this),s=Ji(e)-1;for(i.copyTo(r);--s>=0;)if(t.sqrTo(r,n),(e&1<<s)>0)t.mulTo(n,i,r);else{var a=r;r=n,n=a}return t.revert(r)}function Ny(e,t){var r;return e<256||t.isEven()?r=new Tr(t):r=new _r(t),this.exp(e,r)}b.prototype.copyTo=ey;b.prototype.fromInt=ry;b.prototype.fromString=ny;b.prototype.clamp=iy;b.prototype.dlShiftTo=fy;b.prototype.drShiftTo=ly;b.prototype.lShiftTo=hy;b.prototype.rShiftTo=dy;b.prototype.subTo=py;b.prototype.multiplyTo=yy;b.prototype.squareTo=gy;b.prototype.divRemTo=my;b.prototype.invDigit=Ay;b.prototype.isEven=Ry;b.prototype.exp=ky;b.prototype.toString=sy;b.prototype.negate=ay;b.prototype.abs=oy;b.prototype.compareTo=cy;b.prototype.bitLength=uy;b.prototype.mod=xy;b.prototype.modPowInt=Ny;b.ZERO=tr(0);b.ONE=tr(1);function Ly(){var e=Y();return this.copyTo(e),e}function Dy(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this.data[0];if(this.t==0)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function Py(){return this.t==0?this.s:this.data[0]<<24>>24}function Uy(){return this.t==0?this.s:this.data[0]<<16>>16}function Ky(e){return Math.floor(Math.LN2*this.DB/Math.log(e))}function Fy(){return this.s<0?-1:this.t<=0||this.t==1&&this.data[0]<=0?0:1}function Oy(e){if(e==null&&(e=10),this.signum()==0||e<2||e>36)return"0";var t=this.chunkSize(e),r=Math.pow(e,t),n=tr(r),i=Y(),s=Y(),a="";for(this.divRemTo(n,i,s);i.signum()>0;)a=(r+s.intValue()).toString(e).substr(1)+a,i.divRemTo(n,i,s);return s.intValue().toString(e)+a}function My(e,t){this.fromInt(0),t==null&&(t=10);for(var r=this.chunkSize(t),n=Math.pow(t,r),i=!1,s=0,a=0,o=0;o<e.length;++o){var c=Qu(e,o);if(c<0){e.charAt(o)=="-"&&this.signum()==0&&(i=!0);continue}a=t*a+c,++s>=r&&(this.dMultiply(n),this.dAddOffset(a,0),s=0,a=0)}s>0&&(this.dMultiply(Math.pow(t,s)),this.dAddOffset(a,0)),i&&b.ZERO.subTo(this,this)}function Vy(e,t,r){if(typeof t=="number")if(e<2)this.fromInt(1);else for(this.fromNumber(e,r),this.testBit(e-1)||this.bitwiseTo(b.ONE.shiftLeft(e-1),oo,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(t);)this.dAddOffset(2,0),this.bitLength()>e&&this.subTo(b.ONE.shiftLeft(e-1),this);else{var n=new Array,i=e&7;n.length=(e>>3)+1,t.nextBytes(n),i>0?n[0]&=(1<<i)-1:n[0]=0,this.fromString(n,256)}}function qy(){var e=this.t,t=new Array;t[0]=this.s;var r=this.DB-e*this.DB%8,n,i=0;if(e-- >0)for(r<this.DB&&(n=this.data[e]>>r)!=(this.s&this.DM)>>r&&(t[i++]=n|this.s<<this.DB-r);e>=0;)r<8?(n=(this.data[e]&(1<<r)-1)<<8-r,n|=this.data[--e]>>(r+=this.DB-8)):(n=this.data[e]>>(r-=8)&255,r<=0&&(r+=this.DB,--e)),n&128&&(n|=-256),i==0&&(this.s&128)!=(n&128)&&++i,(i>0||n!=this.s)&&(t[i++]=n);return t}function zy(e){return this.compareTo(e)==0}function Hy(e){return this.compareTo(e)<0?this:e}function Gy(e){return this.compareTo(e)>0?this:e}function Wy(e,t,r){var n,i,s=Math.min(e.t,this.t);for(n=0;n<s;++n)r.data[n]=t(this.data[n],e.data[n]);if(e.t<this.t){for(i=e.s&this.DM,n=s;n<this.t;++n)r.data[n]=t(this.data[n],i);r.t=this.t}else{for(i=this.s&this.DM,n=s;n<e.t;++n)r.data[n]=t(i,e.data[n]);r.t=e.t}r.s=t(this.s,e.s),r.clamp()}function $y(e,t){return e&t}function Qy(e){var t=Y();return this.bitwiseTo(e,$y,t),t}function oo(e,t){return e|t}function Zy(e){var t=Y();return this.bitwiseTo(e,oo,t),t}function Zu(e,t){return e^t}function Yy(e){var t=Y();return this.bitwiseTo(e,Zu,t),t}function Yu(e,t){return e&~t}function Xy(e){var t=Y();return this.bitwiseTo(e,Yu,t),t}function Jy(){for(var e=Y(),t=0;t<this.t;++t)e.data[t]=this.DM&~this.data[t];return e.t=this.t,e.s=~this.s,e}function jy(e){var t=Y();return e<0?this.rShiftTo(-e,t):this.lShiftTo(e,t),t}function tg(e){var t=Y();return e<0?this.lShiftTo(-e,t):this.rShiftTo(e,t),t}function eg(e){if(e==0)return-1;var t=0;return e&65535||(e>>=16,t+=16),e&255||(e>>=8,t+=8),e&15||(e>>=4,t+=4),e&3||(e>>=2,t+=2),e&1||++t,t}function rg(){for(var e=0;e<this.t;++e)if(this.data[e]!=0)return e*this.DB+eg(this.data[e]);return this.s<0?this.t*this.DB:-1}function ng(e){for(var t=0;e!=0;)e&=e-1,++t;return t}function ig(){for(var e=0,t=this.s&this.DM,r=0;r<this.t;++r)e+=ng(this.data[r]^t);return e}function sg(e){var t=Math.floor(e/this.DB);return t>=this.t?this.s!=0:(this.data[t]&1<<e%this.DB)!=0}function ag(e,t){var r=b.ONE.shiftLeft(e);return this.bitwiseTo(r,t,r),r}function og(e){return this.changeBit(e,oo)}function cg(e){return this.changeBit(e,Yu)}function ug(e){return this.changeBit(e,Zu)}function fg(e,t){for(var r=0,n=0,i=Math.min(e.t,this.t);r<i;)n+=this.data[r]+e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n+=e.s;r<this.t;)n+=this.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n+=e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n+=e.s}t.s=n<0?-1:0,n>0?t.data[r++]=n:n<-1&&(t.data[r++]=this.DV+n),t.t=r,t.clamp()}function lg(e){var t=Y();return this.addTo(e,t),t}function hg(e){var t=Y();return this.subTo(e,t),t}function dg(e){var t=Y();return this.multiplyTo(e,t),t}function pg(e){var t=Y();return this.divRemTo(e,t,null),t}function yg(e){var t=Y();return this.divRemTo(e,null,t),t}function gg(e){var t=Y(),r=Y();return this.divRemTo(e,t,r),new Array(t,r)}function mg(e){this.data[this.t]=this.am(0,e-1,this,0,0,this.t),++this.t,this.clamp()}function xg(e,t){if(e!=0){for(;this.t<=t;)this.data[this.t++]=0;for(this.data[t]+=e;this.data[t]>=this.DV;)this.data[t]-=this.DV,++t>=this.t&&(this.data[this.t++]=0),++this.data[t]}}function On(){}function Xu(e){return e}function vg(e,t,r){e.multiplyTo(t,r)}function wg(e,t){e.squareTo(t)}On.prototype.convert=Xu;On.prototype.revert=Xu;On.prototype.mulTo=vg;On.prototype.sqrTo=wg;function bg(e){return this.exp(e,new On)}function Eg(e,t,r){var n=Math.min(this.t+e.t,t);for(r.s=0,r.t=n;n>0;)r.data[--n]=0;var i;for(i=r.t-this.t;n<i;++n)r.data[n+this.t]=this.am(0,e.data[n],r,n,0,this.t);for(i=Math.min(e.t,t);n<i;++n)this.am(0,e.data[n],r,n,0,t-n);r.clamp()}function Sg(e,t,r){--t;var n=r.t=this.t+e.t-t;for(r.s=0;--n>=0;)r.data[n]=0;for(n=Math.max(t-this.t,0);n<e.t;++n)r.data[this.t+n-t]=this.am(t-n,e.data[n],r,0,0,this.t+n-t);r.clamp(),r.drShiftTo(1,r)}function an(e){this.r2=Y(),this.q3=Y(),b.ONE.dlShiftTo(2*e.t,this.r2),this.mu=this.r2.divide(e),this.m=e}function Ag(e){if(e.s<0||e.t>2*this.m.t)return e.mod(this.m);if(e.compareTo(this.m)<0)return e;var t=Y();return e.copyTo(t),this.reduce(t),t}function Bg(e){return e}function Cg(e){for(e.drShiftTo(this.m.t-1,this.r2),e.t>this.m.t+1&&(e.t=this.m.t+1,e.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);e.compareTo(this.r2)<0;)e.dAddOffset(1,this.m.t+1);for(e.subTo(this.r2,e);e.compareTo(this.m)>=0;)e.subTo(this.m,e)}function Tg(e,t){e.squareTo(t),this.reduce(t)}function _g(e,t,r){e.multiplyTo(t,r),this.reduce(r)}an.prototype.convert=Ag;an.prototype.revert=Bg;an.prototype.reduce=Cg;an.prototype.mulTo=_g;an.prototype.sqrTo=Tg;function Ig(e,t){var r=e.bitLength(),n,i=tr(1),s;if(r<=0)return i;r<18?n=1:r<48?n=3:r<144?n=4:r<768?n=5:n=6,r<8?s=new Tr(t):t.isEven()?s=new an(t):s=new _r(t);var a=new Array,o=3,c=n-1,u=(1<<n)-1;if(a[1]=s.convert(this),n>1){var f=Y();for(s.sqrTo(a[1],f);o<=u;)a[o]=Y(),s.mulTo(f,a[o-2],a[o]),o+=2}var l=e.t-1,h,p=!0,d=Y(),g;for(r=Ji(e.data[l])-1;l>=0;){for(r>=c?h=e.data[l]>>r-c&u:(h=(e.data[l]&(1<<r+1)-1)<<c-r,l>0&&(h|=e.data[l-1]>>this.DB+r-c)),o=n;!(h&1);)h>>=1,--o;if((r-=o)<0&&(r+=this.DB,--l),p)a[h].copyTo(i),p=!1;else{for(;o>1;)s.sqrTo(i,d),s.sqrTo(d,i),o-=2;o>0?s.sqrTo(i,d):(g=i,i=d,d=g),s.mulTo(d,a[h],i)}for(;l>=0&&!(e.data[l]&1<<r);)s.sqrTo(i,d),g=i,i=d,d=g,--r<0&&(r=this.DB-1,--l)}return s.revert(i)}function Rg(e){var t=this.s<0?this.negate():this.clone(),r=e.s<0?e.negate():e.clone();if(t.compareTo(r)<0){var n=t;t=r,r=n}var i=t.getLowestSetBit(),s=r.getLowestSetBit();if(s<0)return t;for(i<s&&(s=i),s>0&&(t.rShiftTo(s,t),r.rShiftTo(s,r));t.signum()>0;)(i=t.getLowestSetBit())>0&&t.rShiftTo(i,t),(i=r.getLowestSetBit())>0&&r.rShiftTo(i,r),t.compareTo(r)>=0?(t.subTo(r,t),t.rShiftTo(1,t)):(r.subTo(t,r),r.rShiftTo(1,r));return s>0&&r.lShiftTo(s,r),r}function kg(e){if(e<=0)return 0;var t=this.DV%e,r=this.s<0?e-1:0;if(this.t>0)if(t==0)r=this.data[0]%e;else for(var n=this.t-1;n>=0;--n)r=(t*r+this.data[n])%e;return r}function Ng(e){var t=e.isEven();if(this.isEven()&&t||e.signum()==0)return b.ZERO;for(var r=e.clone(),n=this.clone(),i=tr(1),s=tr(0),a=tr(0),o=tr(1);r.signum()!=0;){for(;r.isEven();)r.rShiftTo(1,r),t?((!i.isEven()||!s.isEven())&&(i.addTo(this,i),s.subTo(e,s)),i.rShiftTo(1,i)):s.isEven()||s.subTo(e,s),s.rShiftTo(1,s);for(;n.isEven();)n.rShiftTo(1,n),t?((!a.isEven()||!o.isEven())&&(a.addTo(this,a),o.subTo(e,o)),a.rShiftTo(1,a)):o.isEven()||o.subTo(e,o),o.rShiftTo(1,o);r.compareTo(n)>=0?(r.subTo(n,r),t&&i.subTo(a,i),s.subTo(o,s)):(n.subTo(r,n),t&&a.subTo(i,a),o.subTo(s,o))}if(n.compareTo(b.ONE)!=0)return b.ZERO;if(o.compareTo(e)>=0)return o.subtract(e);if(o.signum()<0)o.addTo(e,o);else return o;return o.signum()<0?o.add(e):o}var he=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],Lg=(1<<26)/he[he.length-1];function Dg(e){var t,r=this.abs();if(r.t==1&&r.data[0]<=he[he.length-1]){for(t=0;t<he.length;++t)if(r.data[0]==he[t])return!0;return!1}if(r.isEven())return!1;for(t=1;t<he.length;){for(var n=he[t],i=t+1;i<he.length&&n<Lg;)n*=he[i++];for(n=r.modInt(n);t<i;)if(n%he[t++]==0)return!1}return r.millerRabin(e)}function Pg(e){var t=this.subtract(b.ONE),r=t.getLowestSetBit();if(r<=0)return!1;for(var n=t.shiftRight(r),i=Ug(),s,a=0;a<e;++a){do s=new b(this.bitLength(),i);while(s.compareTo(b.ONE)<=0||s.compareTo(t)>=0);var o=s.modPow(n,this);if(o.compareTo(b.ONE)!=0&&o.compareTo(t)!=0){for(var c=1;c++<r&&o.compareTo(t)!=0;)if(o=o.modPowInt(2,this),o.compareTo(b.ONE)==0)return!1;if(o.compareTo(t)!=0)return!1}}return!0}function Ug(){return{nextBytes:function(e){for(var t=0;t<e.length;++t)e[t]=Math.floor(Math.random()*256)}}}b.prototype.chunkSize=Ky;b.prototype.toRadix=Oy;b.prototype.fromRadix=My;b.prototype.fromNumber=Vy;b.prototype.bitwiseTo=Wy;b.prototype.changeBit=ag;b.prototype.addTo=fg;b.prototype.dMultiply=mg;b.prototype.dAddOffset=xg;b.prototype.multiplyLowerTo=Eg;b.prototype.multiplyUpperTo=Sg;b.prototype.modInt=kg;b.prototype.millerRabin=Pg;b.prototype.clone=Ly;b.prototype.intValue=Dy;b.prototype.byteValue=Py;b.prototype.shortValue=Uy;b.prototype.signum=Fy;b.prototype.toByteArray=qy;b.prototype.equals=zy;b.prototype.min=Hy;b.prototype.max=Gy;b.prototype.and=Qy;b.prototype.or=Zy;b.prototype.xor=Yy;b.prototype.andNot=Xy;b.prototype.not=Jy;b.prototype.shiftLeft=jy;b.prototype.shiftRight=tg;b.prototype.getLowestSetBit=rg;b.prototype.bitCount=ig;b.prototype.testBit=sg;b.prototype.setBit=og;b.prototype.clearBit=cg;b.prototype.flipBit=ug;b.prototype.add=lg;b.prototype.subtract=hg;b.prototype.multiply=dg;b.prototype.divide=pg;b.prototype.remainder=yg;b.prototype.divideAndRemainder=gg;b.prototype.modPow=Ig;b.prototype.modInverse=Ng;b.prototype.pow=bg;b.prototype.gcd=Rg;b.prototype.isProbablePrime=Dg});var nf=U((ov,rf)=>{var Te=et();Cr();St();var tf=rf.exports=Te.sha1=Te.sha1||{};Te.md.sha1=Te.md.algorithms.sha1=tf;tf.create=function(){ef||Kg();var e=null,t=Te.util.createBuffer(),r=new Array(80),n={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var i=n.messageLengthSize/4,s=0;s<i;++s)n.fullMessageLength.push(0);return t=Te.util.createBuffer(),e={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},n},n.start(),n.update=function(i,s){s==="utf8"&&(i=Te.util.encodeUtf8(i));var a=i.length;n.messageLength+=a,a=[a/4294967296>>>0,a>>>0];for(var o=n.fullMessageLength.length-1;o>=0;--o)n.fullMessageLength[o]+=a[1],a[1]=a[0]+(n.fullMessageLength[o]/4294967296>>>0),n.fullMessageLength[o]=n.fullMessageLength[o]>>>0,a[0]=a[1]/4294967296>>>0;return t.putBytes(i),ju(e,r,t),(t.read>2048||t.length()===0)&&t.compact(),n},n.digest=function(){var i=Te.util.createBuffer();i.putBytes(t.bytes());var s=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,a=s&n.blockLength-1;i.putBytes(co.substr(0,n.blockLength-a));for(var o,c,u=n.fullMessageLength[0]*8,f=0;f<n.fullMessageLength.length-1;++f)o=n.fullMessageLength[f+1]*8,c=o/4294967296>>>0,u+=c,i.putInt32(u>>>0),u=o>>>0;i.putInt32(u);var l={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3,h4:e.h4};ju(l,r,i);var h=Te.util.createBuffer();return h.putInt32(l.h0),h.putInt32(l.h1),h.putInt32(l.h2),h.putInt32(l.h3),h.putInt32(l.h4),h},n};var co=null,ef=!1;function Kg(){co=String.fromCharCode(128),co+=Te.util.fillString(String.fromCharCode(0),64),ef=!0}function ju(e,t,r){for(var n,i,s,a,o,c,u,f,l=r.length();l>=64;){for(i=e.h0,s=e.h1,a=e.h2,o=e.h3,c=e.h4,f=0;f<16;++f)n=r.getInt32(),t[f]=n,u=o^s&(a^o),n=(i<<5|i>>>27)+u+c+1518500249+n,c=o,o=a,a=(s<<30|s>>>2)>>>0,s=i,i=n;for(;f<20;++f)n=t[f-3]^t[f-8]^t[f-14]^t[f-16],n=n<<1|n>>>31,t[f]=n,u=o^s&(a^o),n=(i<<5|i>>>27)+u+c+1518500249+n,c=o,o=a,a=(s<<30|s>>>2)>>>0,s=i,i=n;for(;f<32;++f)n=t[f-3]^t[f-8]^t[f-14]^t[f-16],n=n<<1|n>>>31,t[f]=n,u=s^a^o,n=(i<<5|i>>>27)+u+c+1859775393+n,c=o,o=a,a=(s<<30|s>>>2)>>>0,s=i,i=n;for(;f<40;++f)n=t[f-6]^t[f-16]^t[f-28]^t[f-32],n=n<<2|n>>>30,t[f]=n,u=s^a^o,n=(i<<5|i>>>27)+u+c+1859775393+n,c=o,o=a,a=(s<<30|s>>>2)>>>0,s=i,i=n;for(;f<60;++f)n=t[f-6]^t[f-16]^t[f-28]^t[f-32],n=n<<2|n>>>30,t[f]=n,u=s&a|o&(s^a),n=(i<<5|i>>>27)+u+c+2400959708+n,c=o,o=a,a=(s<<30|s>>>2)>>>0,s=i,i=n;for(;f<80;++f)n=t[f-6]^t[f-16]^t[f-28]^t[f-32],n=n<<2|n>>>30,t[f]=n,u=s^a^o,n=(i<<5|i>>>27)+u+c+3395469782+n,c=o,o=a,a=(s<<30|s>>>2)>>>0,s=i,i=n;e.h0=e.h0+i|0,e.h1=e.h1+s|0,e.h2=e.h2+a|0,e.h3=e.h3+o|0,e.h4=e.h4+c|0,l-=64}}});var of=U((cv,af)=>{var _e=et();St();Fn();nf();var sf=af.exports=_e.pkcs1=_e.pkcs1||{};sf.encode_rsa_oaep=function(e,t,r){var n,i,s,a;typeof r=="string"?(n=r,i=arguments[3]||void 0,s=arguments[4]||void 0):r&&(n=r.label||void 0,i=r.seed||void 0,s=r.md||void 0,r.mgf1&&r.mgf1.md&&(a=r.mgf1.md)),s?s.start():s=_e.md.sha1.create(),a||(a=s);var o=Math.ceil(e.n.bitLength()/8),c=o-2*s.digestLength-2;if(t.length>c){var u=new Error("RSAES-OAEP input message length is too long.");throw u.length=t.length,u.maxLength=c,u}n||(n=""),s.update(n,"raw");for(var f=s.digest(),l="",h=c-t.length,p=0;p<h;p++)l+="\0";var d=f.getBytes()+l+""+t;if(!i)i=_e.random.getBytes(s.digestLength);else if(i.length!==s.digestLength){var u=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw u.seedLength=i.length,u.digestLength=s.digestLength,u}var g=ts(i,o-s.digestLength-1,a),x=_e.util.xorBytes(d,g,d.length),v=ts(x,s.digestLength,a),S=_e.util.xorBytes(i,v,i.length);return"\0"+S+x};sf.decode_rsa_oaep=function(e,t,r){var n,i,s;typeof r=="string"?(n=r,i=arguments[3]||void 0):r&&(n=r.label||void 0,i=r.md||void 0,r.mgf1&&r.mgf1.md&&(s=r.mgf1.md));var a=Math.ceil(e.n.bitLength()/8);if(t.length!==a){var x=new Error("RSAES-OAEP encoded message length is invalid.");throw x.length=t.length,x.expectedLength=a,x}if(i===void 0?i=_e.md.sha1.create():i.start(),s||(s=i),a<2*i.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");n||(n=""),i.update(n,"raw");for(var o=i.digest().getBytes(),c=t.charAt(0),u=t.substring(1,i.digestLength+1),f=t.substring(1+i.digestLength),l=ts(f,i.digestLength,s),h=_e.util.xorBytes(u,l,u.length),p=ts(h,a-i.digestLength-1,s),d=_e.util.xorBytes(f,p,f.length),g=d.substring(0,i.digestLength),x=c!=="\0",v=0;v<i.digestLength;++v)x|=o.charAt(v)!==g.charAt(v);for(var S=1,B=i.digestLength,L=i.digestLength;L<d.length;L++){var C=d.charCodeAt(L),_=C&1^1,z=S?65534:0;x|=C&z,S=S&_,B+=S}if(x||d.charCodeAt(B)!==1)throw new Error("Invalid RSAES-OAEP padding.");return d.substring(B+1)};function ts(e,t,r){r||(r=_e.md.sha1.create());for(var n="",i=Math.ceil(t/r.digestLength),s=0;s<i;++s){var a=String.fromCharCode(s>>24&255,s>>16&255,s>>8&255,s&255);r.start(),r.update(e+a),n+=r.digest().getBytes()}return n.substring(0,t)}});var cf=U((uv,uo)=>{var er=et();St();ji();Fn();(function(){if(er.prime){uo.exports=er.prime;return}var e=uo.exports=er.prime=er.prime||{},t=er.jsbn.BigInteger,r=[6,4,2,4,2,4,6,2],n=new t(null);n.fromInt(30);var i=function(l,h){return l|h};e.generateProbablePrime=function(l,h,p){typeof h=="function"&&(p=h,h={}),h=h||{};var d=h.algorithm||"PRIMEINC";typeof d=="string"&&(d={name:d}),d.options=d.options||{};var g=h.prng||er.random,x={nextBytes:function(v){for(var S=g.getBytesSync(v.length),B=0;B<v.length;++B)v[B]=S.charCodeAt(B)}};if(d.name==="PRIMEINC")return s(l,x,d.options,p);throw new Error("Invalid prime generation algorithm: "+d.name)};function s(l,h,p,d){return"workers"in p?c(l,h,p,d):a(l,h,p,d)}function a(l,h,p,d){var g=u(l,h),x=0,v=f(g.bitLength());"millerRabinTests"in p&&(v=p.millerRabinTests);var S=10;"maxBlockTime"in p&&(S=p.maxBlockTime),o(g,l,h,x,v,S,d)}function o(l,h,p,d,g,x,v){var S=+new Date;do{if(l.bitLength()>h&&(l=u(h,p)),l.isProbablePrime(g))return v(null,l);l.dAddOffset(r[d++%8],0)}while(x<0||+new Date-S<x);er.util.setImmediate(function(){o(l,h,p,d,g,x,v)})}function c(l,h,p,d){if(typeof Worker>"u")return a(l,h,p,d);var g=u(l,h),x=p.workers,v=p.workLoad||100,S=v*30/8,B=p.workerScript||"forge/prime.worker.js";if(x===-1)return er.util.estimateCores(function(C,_){C&&(_=2),x=_-1,L()});L();function L(){x=Math.max(1,x);for(var C=[],_=0;_<x;++_)C[_]=new Worker(B);for(var z=x,_=0;_<x;++_)C[_].addEventListener("message",Ct);var G=!1;function Ct(ce){if(!G){--z;var $t=ce.data;if($t.found){for(var Ft=0;Ft<C.length;++Ft)C[Ft].terminate();return G=!0,d(null,new t($t.prime,16))}g.bitLength()>l&&(g=u(l,h));var Vr=g.toString(16);ce.target.postMessage({hex:Vr,workLoad:v}),g.dAddOffset(S,0)}}}}function u(l,h){var p=new t(l,h),d=l-1;return p.testBit(d)||p.bitwiseTo(t.ONE.shiftLeft(d),i,p),p.dAddOffset(31-p.mod(n).byteValue(),0),p}function f(l){return l<=100?27:l<=150?18:l<=200?15:l<=250?12:l<=300?9:l<=350?8:l<=400?7:l<=500?6:l<=600?5:l<=800?4:l<=1250?3:2}})()});var rs=U((fv,yf)=>{var D=et();Kn();ji();Vi();of();cf();Fn();St();typeof W>"u"&&(W=D.jsbn.BigInteger);var W,fo=D.util.isNodejs?nn():null,m=D.asn1,se=D.util;D.pki=D.pki||{};yf.exports=D.pki.rsa=D.rsa=D.rsa||{};var F=D.pki,Fg=[6,4,2,4,2,4,6,2],Og={name:"PrivateKeyInfo",tagClass:m.Class.UNIVERSAL,type:m.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:m.Class.UNIVERSAL,type:m.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:m.Class.UNIVERSAL,type:m.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:m.Class.UNIVERSAL,type:m.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:m.Class.UNIVERSAL,type:m.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},Mg={name:"RSAPrivateKey",tagClass:m.Class.UNIVERSAL,type:m.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:m.Class.UNIVERSAL,type:m.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:m.Class.UNIVERSAL,type:m.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:m.Class.UNIVERSAL,type:m.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:m.Class.UNIVERSAL,type:m.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:m.Class.UNIVERSAL,type:m.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:m.Class.UNIVERSAL,type:m.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:m.Class.UNIVERSAL,type:m.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:m.Class.UNIVERSAL,type:m.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:m.Class.UNIVERSAL,type:m.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},Vg={name:"RSAPublicKey",tagClass:m.Class.UNIVERSAL,type:m.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:m.Class.UNIVERSAL,type:m.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:m.Class.UNIVERSAL,type:m.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},qg=D.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:m.Class.UNIVERSAL,type:m.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:m.Class.UNIVERSAL,type:m.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:m.Class.UNIVERSAL,type:m.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:m.Class.UNIVERSAL,type:m.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:m.Class.UNIVERSAL,type:m.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},zg={name:"DigestInfo",tagClass:m.Class.UNIVERSAL,type:m.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm",tagClass:m.Class.UNIVERSAL,type:m.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm.algorithmIdentifier",tagClass:m.Class.UNIVERSAL,type:m.Type.OID,constructed:!1,capture:"algorithmIdentifier"},{name:"DigestInfo.DigestAlgorithm.parameters",tagClass:m.Class.UNIVERSAL,type:m.Type.NULL,capture:"parameters",optional:!0,constructed:!1}]},{name:"DigestInfo.digest",tagClass:m.Class.UNIVERSAL,type:m.Type.OCTETSTRING,constructed:!1,capture:"digest"}]},Hg=function(e){var t;if(e.algorithm in F.oids)t=F.oids[e.algorithm];else{var r=new Error("Unknown message digest algorithm.");throw r.algorithm=e.algorithm,r}var n=m.oidToDer(t).getBytes(),i=m.create(m.Class.UNIVERSAL,m.Type.SEQUENCE,!0,[]),s=m.create(m.Class.UNIVERSAL,m.Type.SEQUENCE,!0,[]);s.value.push(m.create(m.Class.UNIVERSAL,m.Type.OID,!1,n)),s.value.push(m.create(m.Class.UNIVERSAL,m.Type.NULL,!1,""));var a=m.create(m.Class.UNIVERSAL,m.Type.OCTETSTRING,!1,e.digest().getBytes());return i.value.push(s),i.value.push(a),m.toDer(i).getBytes()},df=function(e,t,r){if(r)return e.modPow(t.e,t.n);if(!t.p||!t.q)return e.modPow(t.d,t.n);t.dP||(t.dP=t.d.mod(t.p.subtract(W.ONE))),t.dQ||(t.dQ=t.d.mod(t.q.subtract(W.ONE))),t.qInv||(t.qInv=t.q.modInverse(t.p));var n;do n=new W(D.util.bytesToHex(D.random.getBytes(t.n.bitLength()/8)),16);while(n.compareTo(t.n)>=0||!n.gcd(t.n).equals(W.ONE));e=e.multiply(n.modPow(t.e,t.n)).mod(t.n);for(var i=e.mod(t.p).modPow(t.dP,t.p),s=e.mod(t.q).modPow(t.dQ,t.q);i.compareTo(s)<0;)i=i.add(t.p);var a=i.subtract(s).multiply(t.qInv).mod(t.p).multiply(t.q).add(s);return a=a.multiply(n.modInverse(t.n)).mod(t.n),a};F.rsa.encrypt=function(e,t,r){var n=r,i,s=Math.ceil(t.n.bitLength()/8);r!==!1&&r!==!0?(n=r===2,i=pf(e,t,r)):(i=D.util.createBuffer(),i.putBytes(e));for(var a=new W(i.toHex(),16),o=df(a,t,n),c=o.toString(16),u=D.util.createBuffer(),f=s-Math.ceil(c.length/2);f>0;)u.putByte(0),--f;return u.putBytes(D.util.hexToBytes(c)),u.getBytes()};F.rsa.decrypt=function(e,t,r,n){var i=Math.ceil(t.n.bitLength()/8);if(e.length!==i){var s=new Error("Encrypted message length is invalid.");throw s.length=e.length,s.expected=i,s}var a=new W(D.util.createBuffer(e).toHex(),16);if(a.compareTo(t.n)>=0)throw new Error("Encrypted message is invalid.");for(var o=df(a,t,r),c=o.toString(16),u=D.util.createBuffer(),f=i-Math.ceil(c.length/2);f>0;)u.putByte(0),--f;return u.putBytes(D.util.hexToBytes(c)),n!==!1?es(u.getBytes(),t,r):u.getBytes()};F.rsa.createKeyPairGenerationState=function(e,t,r){typeof e=="string"&&(e=parseInt(e,10)),e=e||2048,r=r||{};var n=r.prng||D.random,i={nextBytes:function(o){for(var c=n.getBytesSync(o.length),u=0;u<o.length;++u)o[u]=c.charCodeAt(u)}},s=r.algorithm||"PRIMEINC",a;if(s==="PRIMEINC")a={algorithm:s,state:0,bits:e,rng:i,eInt:t||65537,e:new W(null),p:null,q:null,qBits:e>>1,pBits:e-(e>>1),pqState:0,num:null,keys:null},a.e.fromInt(a.eInt);else throw new Error("Invalid key generation algorithm: "+s);return a};F.rsa.stepKeyPairGenerationState=function(e,t){"algorithm"in e||(e.algorithm="PRIMEINC");var r=new W(null);r.fromInt(30);for(var n=0,i=function(l,h){return l|h},s=+new Date,a,o=0;e.keys===null&&(t<=0||o<t);){if(e.state===0){var c=e.p===null?e.pBits:e.qBits,u=c-1;e.pqState===0?(e.num=new W(c,e.rng),e.num.testBit(u)||e.num.bitwiseTo(W.ONE.shiftLeft(u),i,e.num),e.num.dAddOffset(31-e.num.mod(r).byteValue(),0),n=0,++e.pqState):e.pqState===1?e.num.bitLength()>c?e.pqState=0:e.num.isProbablePrime(Wg(e.num.bitLength()))?++e.pqState:e.num.dAddOffset(Fg[n++%8],0):e.pqState===2?e.pqState=e.num.subtract(W.ONE).gcd(e.e).compareTo(W.ONE)===0?3:0:e.pqState===3&&(e.pqState=0,e.p===null?e.p=e.num:e.q=e.num,e.p!==null&&e.q!==null&&++e.state,e.num=null)}else if(e.state===1)e.p.compareTo(e.q)<0&&(e.num=e.p,e.p=e.q,e.q=e.num),++e.state;else if(e.state===2)e.p1=e.p.subtract(W.ONE),e.q1=e.q.subtract(W.ONE),e.phi=e.p1.multiply(e.q1),++e.state;else if(e.state===3)e.phi.gcd(e.e).compareTo(W.ONE)===0?++e.state:(e.p=null,e.q=null,e.state=0);else if(e.state===4)e.n=e.p.multiply(e.q),e.n.bitLength()===e.bits?++e.state:(e.q=null,e.state=0);else if(e.state===5){var f=e.e.modInverse(e.phi);e.keys={privateKey:F.rsa.setPrivateKey(e.n,e.e,f,e.p,e.q,f.mod(e.p1),f.mod(e.q1),e.q.modInverse(e.p)),publicKey:F.rsa.setPublicKey(e.n,e.e)}}a=+new Date,o+=a-s,s=a}return e.keys!==null};F.rsa.generateKeyPair=function(e,t,r,n){if(arguments.length===1?typeof e=="object"?(r=e,e=void 0):typeof e=="function"&&(n=e,e=void 0):arguments.length===2?typeof e=="number"?typeof t=="function"?(n=t,t=void 0):typeof t!="number"&&(r=t,t=void 0):(r=e,n=t,e=void 0,t=void 0):arguments.length===3&&(typeof t=="number"?typeof r=="function"&&(n=r,r=void 0):(n=r,r=t,t=void 0)),r=r||{},e===void 0&&(e=r.bits||2048),t===void 0&&(t=r.e||65537),!D.options.usePureJavaScript&&!r.prng&&e>=256&&e<=16384&&(t===65537||t===3)){if(n){if(uf("generateKeyPair"))return fo.generateKeyPair("rsa",{modulusLength:e,publicExponent:t,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(o,c,u){if(o)return n(o);n(null,{privateKey:F.privateKeyFromPem(u),publicKey:F.publicKeyFromPem(c)})});if(ff("generateKey")&&ff("exportKey"))return se.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:hf(t),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(o){return se.globalScope.crypto.subtle.exportKey("pkcs8",o.privateKey)}).then(void 0,function(o){n(o)}).then(function(o){if(o){var c=F.privateKeyFromAsn1(m.fromDer(D.util.createBuffer(o)));n(null,{privateKey:c,publicKey:F.setRsaPublicKey(c.n,c.e)})}});if(lf("generateKey")&&lf("exportKey")){var i=se.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:hf(t),hash:{name:"SHA-256"}},!0,["sign","verify"]);i.oncomplete=function(o){var c=o.target.result,u=se.globalScope.msCrypto.subtle.exportKey("pkcs8",c.privateKey);u.oncomplete=function(f){var l=f.target.result,h=F.privateKeyFromAsn1(m.fromDer(D.util.createBuffer(l)));n(null,{privateKey:h,publicKey:F.setRsaPublicKey(h.n,h.e)})},u.onerror=function(f){n(f)}},i.onerror=function(o){n(o)};return}}else if(uf("generateKeyPairSync")){var s=fo.generateKeyPairSync("rsa",{modulusLength:e,publicExponent:t,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:F.privateKeyFromPem(s.privateKey),publicKey:F.publicKeyFromPem(s.publicKey)}}}var a=F.rsa.createKeyPairGenerationState(e,t,r);if(!n)return F.rsa.stepKeyPairGenerationState(a,0),a.keys;Gg(a,r,n)};F.setRsaPublicKey=F.rsa.setPublicKey=function(e,t){var r={n:e,e:t};return r.encrypt=function(n,i,s){if(typeof i=="string"?i=i.toUpperCase():i===void 0&&(i="RSAES-PKCS1-V1_5"),i==="RSAES-PKCS1-V1_5")i={encode:function(o,c,u){return pf(o,c,2).getBytes()}};else if(i==="RSA-OAEP"||i==="RSAES-OAEP")i={encode:function(o,c){return D.pkcs1.encode_rsa_oaep(c,o,s)}};else if(["RAW","NONE","NULL",null].indexOf(i)!==-1)i={encode:function(o){return o}};else if(typeof i=="string")throw new Error('Unsupported encryption scheme: "'+i+'".');var a=i.encode(n,r,!0);return F.rsa.encrypt(a,r,!0)},r.verify=function(n,i,s,a){typeof s=="string"?s=s.toUpperCase():s===void 0&&(s="RSASSA-PKCS1-V1_5"),a===void 0&&(a={_parseAllDigestBytes:!0}),"_parseAllDigestBytes"in a||(a._parseAllDigestBytes=!0),s==="RSASSA-PKCS1-V1_5"?s={verify:function(c,u){u=es(u,r,!0);var f=m.fromDer(u,{parseAllBytes:a._parseAllDigestBytes}),l={},h=[];if(!m.validate(f,zg,l,h)){var p=new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value.");throw p.errors=h,p}var d=m.derToOid(l.algorithmIdentifier);if(!(d===D.oids.md2||d===D.oids.md5||d===D.oids.sha1||d===D.oids.sha224||d===D.oids.sha256||d===D.oids.sha384||d===D.oids.sha512||d===D.oids["sha512-224"]||d===D.oids["sha512-256"])){var p=new Error("Unknown RSASSA-PKCS1-v1_5 DigestAlgorithm identifier.");throw p.oid=d,p}if((d===D.oids.md2||d===D.oids.md5)&&!("parameters"in l))throw new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value. Missing algorithm identifer NULL parameters.");return c===l.digest}}:(s==="NONE"||s==="NULL"||s===null)&&(s={verify:function(c,u){return u=es(u,r,!0),c===u}});var o=F.rsa.decrypt(i,r,!0,!1);return s.verify(n,o,r.n.bitLength())},r};F.setRsaPrivateKey=F.rsa.setPrivateKey=function(e,t,r,n,i,s,a,o){var c={n:e,e:t,d:r,p:n,q:i,dP:s,dQ:a,qInv:o};return c.decrypt=function(u,f,l){typeof f=="string"?f=f.toUpperCase():f===void 0&&(f="RSAES-PKCS1-V1_5");var h=F.rsa.decrypt(u,c,!1,!1);if(f==="RSAES-PKCS1-V1_5")f={decode:es};else if(f==="RSA-OAEP"||f==="RSAES-OAEP")f={decode:function(p,d){return D.pkcs1.decode_rsa_oaep(d,p,l)}};else if(["RAW","NONE","NULL",null].indexOf(f)!==-1)f={decode:function(p){return p}};else throw new Error('Unsupported encryption scheme: "'+f+'".');return f.decode(h,c,!1)},c.sign=function(u,f){var l=!1;typeof f=="string"&&(f=f.toUpperCase()),f===void 0||f==="RSASSA-PKCS1-V1_5"?(f={encode:Hg},l=1):(f==="NONE"||f==="NULL"||f===null)&&(f={encode:function(){return u}},l=1);var h=f.encode(u,c.n.bitLength());return F.rsa.encrypt(h,c,l)},c};F.wrapRsaPrivateKey=function(e){return m.create(m.Class.UNIVERSAL,m.Type.SEQUENCE,!0,[m.create(m.Class.UNIVERSAL,m.Type.INTEGER,!1,m.integerToDer(0).getBytes()),m.create(m.Class.UNIVERSAL,m.Type.SEQUENCE,!0,[m.create(m.Class.UNIVERSAL,m.Type.OID,!1,m.oidToDer(F.oids.rsaEncryption).getBytes()),m.create(m.Class.UNIVERSAL,m.Type.NULL,!1,"")]),m.create(m.Class.UNIVERSAL,m.Type.OCTETSTRING,!1,m.toDer(e).getBytes())])};F.privateKeyFromAsn1=function(e){var t={},r=[];if(m.validate(e,Og,t,r)&&(e=m.fromDer(D.util.createBuffer(t.privateKey))),t={},r=[],!m.validate(e,Mg,t,r)){var n=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw n.errors=r,n}var i,s,a,o,c,u,f,l;return i=D.util.createBuffer(t.privateKeyModulus).toHex(),s=D.util.createBuffer(t.privateKeyPublicExponent).toHex(),a=D.util.createBuffer(t.privateKeyPrivateExponent).toHex(),o=D.util.createBuffer(t.privateKeyPrime1).toHex(),c=D.util.createBuffer(t.privateKeyPrime2).toHex(),u=D.util.createBuffer(t.privateKeyExponent1).toHex(),f=D.util.createBuffer(t.privateKeyExponent2).toHex(),l=D.util.createBuffer(t.privateKeyCoefficient).toHex(),F.setRsaPrivateKey(new W(i,16),new W(s,16),new W(a,16),new W(o,16),new W(c,16),new W(u,16),new W(f,16),new W(l,16))};F.privateKeyToAsn1=F.privateKeyToRSAPrivateKey=function(e){return m.create(m.Class.UNIVERSAL,m.Type.SEQUENCE,!0,[m.create(m.Class.UNIVERSAL,m.Type.INTEGER,!1,m.integerToDer(0).getBytes()),m.create(m.Class.UNIVERSAL,m.Type.INTEGER,!1,Ie(e.n)),m.create(m.Class.UNIVERSAL,m.Type.INTEGER,!1,Ie(e.e)),m.create(m.Class.UNIVERSAL,m.Type.INTEGER,!1,Ie(e.d)),m.create(m.Class.UNIVERSAL,m.Type.INTEGER,!1,Ie(e.p)),m.create(m.Class.UNIVERSAL,m.Type.INTEGER,!1,Ie(e.q)),m.create(m.Class.UNIVERSAL,m.Type.INTEGER,!1,Ie(e.dP)),m.create(m.Class.UNIVERSAL,m.Type.INTEGER,!1,Ie(e.dQ)),m.create(m.Class.UNIVERSAL,m.Type.INTEGER,!1,Ie(e.qInv))])};F.publicKeyFromAsn1=function(e){var t={},r=[];if(m.validate(e,qg,t,r)){var n=m.derToOid(t.publicKeyOid);if(n!==F.oids.rsaEncryption){var i=new Error("Cannot read public key. Unknown OID.");throw i.oid=n,i}e=t.rsaPublicKey}if(r=[],!m.validate(e,Vg,t,r)){var i=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw i.errors=r,i}var s=D.util.createBuffer(t.publicKeyModulus).toHex(),a=D.util.createBuffer(t.publicKeyExponent).toHex();return F.setRsaPublicKey(new W(s,16),new W(a,16))};F.publicKeyToAsn1=F.publicKeyToSubjectPublicKeyInfo=function(e){return m.create(m.Class.UNIVERSAL,m.Type.SEQUENCE,!0,[m.create(m.Class.UNIVERSAL,m.Type.SEQUENCE,!0,[m.create(m.Class.UNIVERSAL,m.Type.OID,!1,m.oidToDer(F.oids.rsaEncryption).getBytes()),m.create(m.Class.UNIVERSAL,m.Type.NULL,!1,"")]),m.create(m.Class.UNIVERSAL,m.Type.BITSTRING,!1,[F.publicKeyToRSAPublicKey(e)])])};F.publicKeyToRSAPublicKey=function(e){return m.create(m.Class.UNIVERSAL,m.Type.SEQUENCE,!0,[m.create(m.Class.UNIVERSAL,m.Type.INTEGER,!1,Ie(e.n)),m.create(m.Class.UNIVERSAL,m.Type.INTEGER,!1,Ie(e.e))])};function pf(e,t,r){var n=D.util.createBuffer(),i=Math.ceil(t.n.bitLength()/8);if(e.length>i-11){var s=new Error("Message is too long for PKCS#1 v1.5 padding.");throw s.length=e.length,s.max=i-11,s}n.putByte(0),n.putByte(r);var a=i-3-e.length,o;if(r===0||r===1){o=r===0?0:255;for(var c=0;c<a;++c)n.putByte(o)}else for(;a>0;){for(var u=0,f=D.random.getBytes(a),c=0;c<a;++c)o=f.charCodeAt(c),o===0?++u:n.putByte(o);a=u}return n.putByte(0),n.putBytes(e),n}function es(e,t,r,n){var i=Math.ceil(t.n.bitLength()/8),s=D.util.createBuffer(e),a=s.getByte(),o=s.getByte();if(a!==0||r&&o!==0&&o!==1||!r&&o!=2||r&&o===0&&typeof n>"u")throw new Error("Encryption block is invalid.");var c=0;if(o===0){c=i-3-n;for(var u=0;u<c;++u)if(s.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(o===1)for(c=0;s.length()>1;){if(s.getByte()!==255){--s.read;break}++c}else if(o===2)for(c=0;s.length()>1;){if(s.getByte()===0){--s.read;break}++c}var f=s.getByte();if(f!==0||c!==i-3-s.length())throw new Error("Encryption block is invalid.");return s.getBytes()}function Gg(e,t,r){typeof t=="function"&&(r=t,t={}),t=t||{};var n={algorithm:{name:t.algorithm||"PRIMEINC",options:{workers:t.workers||2,workLoad:t.workLoad||100,workerScript:t.workerScript}}};"prng"in t&&(n.prng=t.prng),i();function i(){s(e.pBits,function(o,c){if(o)return r(o);if(e.p=c,e.q!==null)return a(o,e.q);s(e.qBits,a)})}function s(o,c){D.prime.generateProbablePrime(o,n,c)}function a(o,c){if(o)return r(o);if(e.q=c,e.p.compareTo(e.q)<0){var u=e.p;e.p=e.q,e.q=u}if(e.p.subtract(W.ONE).gcd(e.e).compareTo(W.ONE)!==0){e.p=null,i();return}if(e.q.subtract(W.ONE).gcd(e.e).compareTo(W.ONE)!==0){e.q=null,s(e.qBits,a);return}if(e.p1=e.p.subtract(W.ONE),e.q1=e.q.subtract(W.ONE),e.phi=e.p1.multiply(e.q1),e.phi.gcd(e.e).compareTo(W.ONE)!==0){e.p=e.q=null,i();return}if(e.n=e.p.multiply(e.q),e.n.bitLength()!==e.bits){e.q=null,s(e.qBits,a);return}var f=e.e.modInverse(e.phi);e.keys={privateKey:F.rsa.setPrivateKey(e.n,e.e,f,e.p,e.q,f.mod(e.p1),f.mod(e.q1),e.q.modInverse(e.p)),publicKey:F.rsa.setPublicKey(e.n,e.e)},r(null,e.keys)}}function Ie(e){var t=e.toString(16);t[0]>="8"&&(t="00"+t);var r=D.util.hexToBytes(t);return r.length>1&&(r.charCodeAt(0)===0&&!(r.charCodeAt(1)&128)||r.charCodeAt(0)===255&&(r.charCodeAt(1)&128)===128)?r.substr(1):r}function Wg(e){return e<=100?27:e<=150?18:e<=200?15:e<=250?12:e<=300?9:e<=350?8:e<=400?7:e<=500?6:e<=600?5:e<=800?4:e<=1250?3:2}function uf(e){return D.util.isNodejs&&typeof fo[e]=="function"}function ff(e){return typeof se.globalScope<"u"&&typeof se.globalScope.crypto=="object"&&typeof se.globalScope.crypto.subtle=="object"&&typeof se.globalScope.crypto.subtle[e]=="function"}function lf(e){return typeof se.globalScope<"u"&&typeof se.globalScope.msCrypto=="object"&&typeof se.globalScope.msCrypto.subtle=="object"&&typeof se.globalScope.msCrypto.subtle[e]=="function"}function hf(e){for(var t=D.util.hexToBytes(e.toString(16)),r=new Uint8Array(t.length),n=0;n<t.length;++n)r[n]=t.charCodeAt(n);return r}});var bf=U((lv,wf)=>{var I=et();eo();Kn();Au();Cr();Vi();Iu();Nu();Fn();Hu();rs();St();typeof gf>"u"&&(gf=I.jsbn.BigInteger);var gf,w=I.asn1,O=I.pki=I.pki||{};wf.exports=O.pbe=I.pbe=I.pbe||{};var Ir=O.oids,$g={name:"EncryptedPrivateKeyInfo",tagClass:w.Class.UNIVERSAL,type:w.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:w.Class.UNIVERSAL,type:w.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:w.Class.UNIVERSAL,type:w.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:w.Class.UNIVERSAL,type:w.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:w.Class.UNIVERSAL,type:w.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},Qg={name:"PBES2Algorithms",tagClass:w.Class.UNIVERSAL,type:w.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:w.Class.UNIVERSAL,type:w.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:w.Class.UNIVERSAL,type:w.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:w.Class.UNIVERSAL,type:w.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:w.Class.UNIVERSAL,type:w.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:w.Class.UNIVERSAL,type:w.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:w.Class.UNIVERSAL,type:w.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:w.Class.UNIVERSAL,type:w.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:w.Class.UNIVERSAL,type:w.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:w.Class.UNIVERSAL,type:w.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:w.Class.UNIVERSAL,type:w.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:w.Class.UNIVERSAL,type:w.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},Zg={name:"pkcs-12PbeParams",tagClass:w.Class.UNIVERSAL,type:w.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:w.Class.UNIVERSAL,type:w.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:w.Class.UNIVERSAL,type:w.Type.INTEGER,constructed:!1,capture:"iterations"}]};O.encryptPrivateKeyInfo=function(e,t,r){r=r||{},r.saltSize=r.saltSize||8,r.count=r.count||2048,r.algorithm=r.algorithm||"aes128",r.prfAlgorithm=r.prfAlgorithm||"sha1";var n=I.random.getBytesSync(r.saltSize),i=r.count,s=w.integerToDer(i),a,o,c;if(r.algorithm.indexOf("aes")===0||r.algorithm==="des"){var u,f,l;switch(r.algorithm){case"aes128":a=16,u=16,f=Ir["aes128-CBC"],l=I.aes.createEncryptionCipher;break;case"aes192":a=24,u=16,f=Ir["aes192-CBC"],l=I.aes.createEncryptionCipher;break;case"aes256":a=32,u=16,f=Ir["aes256-CBC"],l=I.aes.createEncryptionCipher;break;case"des":a=8,u=8,f=Ir.desCBC,l=I.des.createEncryptionCipher;break;default:var h=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw h.algorithm=r.algorithm,h}var p="hmacWith"+r.prfAlgorithm.toUpperCase(),d=vf(p),g=I.pkcs5.pbkdf2(t,n,i,a,d),x=I.random.getBytesSync(u),v=l(g);v.start(x),v.update(w.toDer(e)),v.finish(),c=v.output.getBytes();var S=Yg(n,s,a,p);o=w.create(w.Class.UNIVERSAL,w.Type.SEQUENCE,!0,[w.create(w.Class.UNIVERSAL,w.Type.OID,!1,w.oidToDer(Ir.pkcs5PBES2).getBytes()),w.create(w.Class.UNIVERSAL,w.Type.SEQUENCE,!0,[w.create(w.Class.UNIVERSAL,w.Type.SEQUENCE,!0,[w.create(w.Class.UNIVERSAL,w.Type.OID,!1,w.oidToDer(Ir.pkcs5PBKDF2).getBytes()),S]),w.create(w.Class.UNIVERSAL,w.Type.SEQUENCE,!0,[w.create(w.Class.UNIVERSAL,w.Type.OID,!1,w.oidToDer(f).getBytes()),w.create(w.Class.UNIVERSAL,w.Type.OCTETSTRING,!1,x)])])])}else if(r.algorithm==="3des"){a=24;var B=new I.util.ByteBuffer(n),g=O.pbe.generatePkcs12Key(t,B,1,i,a),x=O.pbe.generatePkcs12Key(t,B,2,i,a),v=I.des.createEncryptionCipher(g);v.start(x),v.update(w.toDer(e)),v.finish(),c=v.output.getBytes(),o=w.create(w.Class.UNIVERSAL,w.Type.SEQUENCE,!0,[w.create(w.Class.UNIVERSAL,w.Type.OID,!1,w.oidToDer(Ir["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),w.create(w.Class.UNIVERSAL,w.Type.SEQUENCE,!0,[w.create(w.Class.UNIVERSAL,w.Type.OCTETSTRING,!1,n),w.create(w.Class.UNIVERSAL,w.Type.INTEGER,!1,s.getBytes())])])}else{var h=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw h.algorithm=r.algorithm,h}var L=w.create(w.Class.UNIVERSAL,w.Type.SEQUENCE,!0,[o,w.create(w.Class.UNIVERSAL,w.Type.OCTETSTRING,!1,c)]);return L};O.decryptPrivateKeyInfo=function(e,t){var r=null,n={},i=[];if(!w.validate(e,$g,n,i)){var s=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=i,s}var a=w.derToOid(n.encryptionOid),o=O.pbe.getCipher(a,n.encryptionParams,t),c=I.util.createBuffer(n.encryptedData);return o.update(c),o.finish()&&(r=w.fromDer(o.output)),r};O.encryptedPrivateKeyToPem=function(e,t){var r={type:"ENCRYPTED PRIVATE KEY",body:w.toDer(e).getBytes()};return I.pem.encode(r,{maxline:t})};O.encryptedPrivateKeyFromPem=function(e){var t=I.pem.decode(e)[0];if(t.type!=="ENCRYPTED PRIVATE KEY"){var r=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw r.headerType=t.type,r}if(t.procType&&t.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return w.fromDer(t.body)};O.encryptRsaPrivateKey=function(e,t,r){if(r=r||{},!r.legacy){var n=O.wrapRsaPrivateKey(O.privateKeyToAsn1(e));return n=O.encryptPrivateKeyInfo(n,t,r),O.encryptedPrivateKeyToPem(n)}var i,s,a,o;switch(r.algorithm){case"aes128":i="AES-128-CBC",a=16,s=I.random.getBytesSync(16),o=I.aes.createEncryptionCipher;break;case"aes192":i="AES-192-CBC",a=24,s=I.random.getBytesSync(16),o=I.aes.createEncryptionCipher;break;case"aes256":i="AES-256-CBC",a=32,s=I.random.getBytesSync(16),o=I.aes.createEncryptionCipher;break;case"3des":i="DES-EDE3-CBC",a=24,s=I.random.getBytesSync(8),o=I.des.createEncryptionCipher;break;case"des":i="DES-CBC",a=8,s=I.random.getBytesSync(8),o=I.des.createEncryptionCipher;break;default:var c=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+r.algorithm+'".');throw c.algorithm=r.algorithm,c}var u=I.pbe.opensslDeriveBytes(t,s.substr(0,8),a),f=o(u);f.start(s),f.update(w.toDer(O.privateKeyToAsn1(e))),f.finish();var l={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:i,parameters:I.util.bytesToHex(s).toUpperCase()},body:f.output.getBytes()};return I.pem.encode(l)};O.decryptRsaPrivateKey=function(e,t){var r=null,n=I.pem.decode(e)[0];if(n.type!=="ENCRYPTED PRIVATE KEY"&&n.type!=="PRIVATE KEY"&&n.type!=="RSA PRIVATE KEY"){var i=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw i.headerType=i,i}if(n.procType&&n.procType.type==="ENCRYPTED"){var s,a;switch(n.dekInfo.algorithm){case"DES-CBC":s=8,a=I.des.createDecryptionCipher;break;case"DES-EDE3-CBC":s=24,a=I.des.createDecryptionCipher;break;case"AES-128-CBC":s=16,a=I.aes.createDecryptionCipher;break;case"AES-192-CBC":s=24,a=I.aes.createDecryptionCipher;break;case"AES-256-CBC":s=32,a=I.aes.createDecryptionCipher;break;case"RC2-40-CBC":s=5,a=function(l){return I.rc2.createDecryptionCipher(l,40)};break;case"RC2-64-CBC":s=8,a=function(l){return I.rc2.createDecryptionCipher(l,64)};break;case"RC2-128-CBC":s=16,a=function(l){return I.rc2.createDecryptionCipher(l,128)};break;default:var i=new Error('Could not decrypt private key; unsupported encryption algorithm "'+n.dekInfo.algorithm+'".');throw i.algorithm=n.dekInfo.algorithm,i}var o=I.util.hexToBytes(n.dekInfo.parameters),c=I.pbe.opensslDeriveBytes(t,o.substr(0,8),s),u=a(c);if(u.start(o),u.update(I.util.createBuffer(n.body)),u.finish())r=u.output.getBytes();else return r}else r=n.body;return n.type==="ENCRYPTED PRIVATE KEY"?r=O.decryptPrivateKeyInfo(w.fromDer(r),t):r=w.fromDer(r),r!==null&&(r=O.privateKeyFromAsn1(r)),r};O.pbe.generatePkcs12Key=function(e,t,r,n,i,s){var a,o;if(typeof s>"u"||s===null){if(!("sha1"in I.md))throw new Error('"sha1" hash algorithm unavailable.');s=I.md.sha1.create()}var c=s.digestLength,u=s.blockLength,f=new I.util.ByteBuffer,l=new I.util.ByteBuffer;if(e!=null){for(o=0;o<e.length;o++)l.putInt16(e.charCodeAt(o));l.putInt16(0)}var h=l.length(),p=t.length(),d=new I.util.ByteBuffer;d.fillWithByte(r,u);var g=u*Math.ceil(p/u),x=new I.util.ByteBuffer;for(o=0;o<g;o++)x.putByte(t.at(o%p));var v=u*Math.ceil(h/u),S=new I.util.ByteBuffer;for(o=0;o<v;o++)S.putByte(l.at(o%h));var B=x;B.putBuffer(S);for(var L=Math.ceil(i/c),C=1;C<=L;C++){var _=new I.util.ByteBuffer;_.putBytes(d.bytes()),_.putBytes(B.bytes());for(var z=0;z<n;z++)s.start(),s.update(_.getBytes()),_=s.digest();var G=new I.util.ByteBuffer;for(o=0;o<u;o++)G.putByte(_.at(o%c));var Ct=Math.ceil(p/u)+Math.ceil(h/u),ce=new I.util.ByteBuffer;for(a=0;a<Ct;a++){var $t=new I.util.ByteBuffer(B.getBytes(u)),Ft=511;for(o=G.length()-1;o>=0;o--)Ft=Ft>>8,Ft+=G.at(o)+$t.at(o),$t.setAt(o,Ft&255);ce.putBuffer($t)}B=ce,f.putBuffer(_)}return f.truncate(f.length()-i),f};O.pbe.getCipher=function(e,t,r){switch(e){case O.oids.pkcs5PBES2:return O.pbe.getCipherForPBES2(e,t,r);case O.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case O.oids["pbewithSHAAnd40BitRC2-CBC"]:return O.pbe.getCipherForPKCS12PBE(e,t,r);default:var n=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw n.oid=e,n.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],n}};O.pbe.getCipherForPBES2=function(e,t,r){var n={},i=[];if(!w.validate(t,Qg,n,i)){var s=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=i,s}if(e=w.derToOid(n.kdfOid),e!==O.oids.pkcs5PBKDF2){var s=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw s.oid=e,s.supportedOids=["pkcs5PBKDF2"],s}if(e=w.derToOid(n.encOid),e!==O.oids["aes128-CBC"]&&e!==O.oids["aes192-CBC"]&&e!==O.oids["aes256-CBC"]&&e!==O.oids["des-EDE3-CBC"]&&e!==O.oids.desCBC){var s=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw s.oid=e,s.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],s}var a=n.kdfSalt,o=I.util.createBuffer(n.kdfIterationCount);o=o.getInt(o.length()<<3);var c,u;switch(O.oids[e]){case"aes128-CBC":c=16,u=I.aes.createDecryptionCipher;break;case"aes192-CBC":c=24,u=I.aes.createDecryptionCipher;break;case"aes256-CBC":c=32,u=I.aes.createDecryptionCipher;break;case"des-EDE3-CBC":c=24,u=I.des.createDecryptionCipher;break;case"desCBC":c=8,u=I.des.createDecryptionCipher;break}var f=xf(n.prfOid),l=I.pkcs5.pbkdf2(r,a,o,c,f),h=n.encIv,p=u(l);return p.start(h),p};O.pbe.getCipherForPKCS12PBE=function(e,t,r){var n={},i=[];if(!w.validate(t,Zg,n,i)){var s=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=i,s}var a=I.util.createBuffer(n.salt),o=I.util.createBuffer(n.iterations);o=o.getInt(o.length()<<3);var c,u,f;switch(e){case O.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:c=24,u=8,f=I.des.startDecrypting;break;case O.oids["pbewithSHAAnd40BitRC2-CBC"]:c=5,u=8,f=function(g,x){var v=I.rc2.createDecryptionCipher(g,40);return v.start(x,null),v};break;default:var s=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw s.oid=e,s}var l=xf(n.prfOid),h=O.pbe.generatePkcs12Key(r,a,1,o,c,l);l.start();var p=O.pbe.generatePkcs12Key(r,a,2,o,u,l);return f(h,p)};O.pbe.opensslDeriveBytes=function(e,t,r,n){if(typeof n>"u"||n===null){if(!("md5"in I.md))throw new Error('"md5" hash algorithm unavailable.');n=I.md.md5.create()}t===null&&(t="");for(var i=[mf(n,e+t)],s=16,a=1;s<r;++a,s+=16)i.push(mf(n,i[a-1]+e+t));return i.join("").substr(0,r)};function mf(e,t){return e.start().update(t).digest().getBytes()}function xf(e){var t;if(!e)t="hmacWithSHA1";else if(t=O.oids[w.derToOid(e)],!t){var r=new Error("Unsupported PRF OID.");throw r.oid=e,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}return vf(t)}function vf(e){var t=I.md;switch(e){case"hmacWithSHA224":t=I.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":e=e.substr(8).toLowerCase();break;default:var r=new Error("Unsupported PRF algorithm.");throw r.algorithm=e,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}if(!t||!(e in t))throw new Error("Unknown hash algorithm: "+e);return t[e].create()}function Yg(e,t,r,n){var i=w.create(w.Class.UNIVERSAL,w.Type.SEQUENCE,!0,[w.create(w.Class.UNIVERSAL,w.Type.OCTETSTRING,!1,e),w.create(w.Class.UNIVERSAL,w.Type.INTEGER,!1,t.getBytes())]);return n!=="hmacWithSHA1"&&i.value.push(w.create(w.Class.UNIVERSAL,w.Type.INTEGER,!1,I.util.hexToBytes(r.toString(16))),w.create(w.Class.UNIVERSAL,w.Type.SEQUENCE,!0,[w.create(w.Class.UNIVERSAL,w.Type.OID,!1,w.oidToDer(O.oids[n]).getBytes()),w.create(w.Class.UNIVERSAL,w.Type.NULL,!1,"")])),i}});var If=U((Hv,_f)=>{var ot=et();Cr();St();var Mn=_f.exports=ot.sha512=ot.sha512||{};ot.md.sha512=ot.md.algorithms.sha512=Mn;var Cf=ot.sha384=ot.sha512.sha384=ot.sha512.sha384||{};Cf.create=function(){return Mn.create("SHA-384")};ot.md.sha384=ot.md.algorithms.sha384=Cf;ot.sha512.sha256=ot.sha512.sha256||{create:function(){return Mn.create("SHA-512/256")}};ot.md["sha512/256"]=ot.md.algorithms["sha512/256"]=ot.sha512.sha256;ot.sha512.sha224=ot.sha512.sha224||{create:function(){return Mn.create("SHA-512/224")}};ot.md["sha512/224"]=ot.md.algorithms["sha512/224"]=ot.sha512.sha224;Mn.create=function(e){if(Tf||t1(),typeof e>"u"&&(e="SHA-512"),!(e in Rr))throw new Error("Invalid SHA-512 algorithm: "+e);for(var t=Rr[e],r=null,n=ot.util.createBuffer(),i=new Array(80),s=0;s<80;++s)i[s]=new Array(2);var a=64;switch(e){case"SHA-384":a=48;break;case"SHA-512/256":a=32;break;case"SHA-512/224":a=28;break}var o={algorithm:e.replace("-","").toLowerCase(),blockLength:128,digestLength:a,messageLength:0,fullMessageLength:null,messageLengthSize:16};return o.start=function(){o.messageLength=0,o.fullMessageLength=o.messageLength128=[];for(var c=o.messageLengthSize/4,u=0;u<c;++u)o.fullMessageLength.push(0);n=ot.util.createBuffer(),r=new Array(t.length);for(var u=0;u<t.length;++u)r[u]=t[u].slice(0);return o},o.start(),o.update=function(c,u){u==="utf8"&&(c=ot.util.encodeUtf8(c));var f=c.length;o.messageLength+=f,f=[f/4294967296>>>0,f>>>0];for(var l=o.fullMessageLength.length-1;l>=0;--l)o.fullMessageLength[l]+=f[1],f[1]=f[0]+(o.fullMessageLength[l]/4294967296>>>0),o.fullMessageLength[l]=o.fullMessageLength[l]>>>0,f[0]=f[1]/4294967296>>>0;return n.putBytes(c),Bf(r,i,n),(n.read>2048||n.length()===0)&&n.compact(),o},o.digest=function(){var c=ot.util.createBuffer();c.putBytes(n.bytes());var u=o.fullMessageLength[o.fullMessageLength.length-1]+o.messageLengthSize,f=u&o.blockLength-1;c.putBytes(ho.substr(0,o.blockLength-f));for(var l,h,p=o.fullMessageLength[0]*8,d=0;d<o.fullMessageLength.length-1;++d)l=o.fullMessageLength[d+1]*8,h=l/4294967296>>>0,p+=h,c.putInt32(p>>>0),p=l>>>0;c.putInt32(p);for(var g=new Array(r.length),d=0;d<r.length;++d)g[d]=r[d].slice(0);Bf(g,i,c);var x=ot.util.createBuffer(),v;e==="SHA-512"?v=g.length:e==="SHA-384"?v=g.length-2:v=g.length-4;for(var d=0;d<v;++d)x.putInt32(g[d][0]),(d!==v-1||e!=="SHA-512/224")&&x.putInt32(g[d][1]);return x},o};var ho=null,Tf=!1,po=null,Rr=null;function t1(){ho=String.fromCharCode(128),ho+=ot.util.fillString(String.fromCharCode(0),128),po=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],Rr={},Rr["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],Rr["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],Rr["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],Rr["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],Tf=!0}function Bf(e,t,r){for(var n,i,s,a,o,c,u,f,l,h,p,d,g,x,v,S,B,L,C,_,z,G,Ct,ce,$t,Ft,Vr,gi,Et,qt,P,Ms,Vs,qs,zs,d0=r.length();d0>=128;){for(Et=0;Et<16;++Et)t[Et][0]=r.getInt32()>>>0,t[Et][1]=r.getInt32()>>>0;for(;Et<80;++Et)Ms=t[Et-2],qt=Ms[0],P=Ms[1],n=((qt>>>19|P<<13)^(P>>>29|qt<<3)^qt>>>6)>>>0,i=((qt<<13|P>>>19)^(P<<3|qt>>>29)^(qt<<26|P>>>6))>>>0,qs=t[Et-15],qt=qs[0],P=qs[1],s=((qt>>>1|P<<31)^(qt>>>8|P<<24)^qt>>>7)>>>0,a=((qt<<31|P>>>1)^(qt<<24|P>>>8)^(qt<<25|P>>>7))>>>0,Vs=t[Et-7],zs=t[Et-16],P=i+Vs[1]+a+zs[1],t[Et][0]=n+Vs[0]+s+zs[0]+(P/4294967296>>>0)>>>0,t[Et][1]=P>>>0;for(g=e[0][0],x=e[0][1],v=e[1][0],S=e[1][1],B=e[2][0],L=e[2][1],C=e[3][0],_=e[3][1],z=e[4][0],G=e[4][1],Ct=e[5][0],ce=e[5][1],$t=e[6][0],Ft=e[6][1],Vr=e[7][0],gi=e[7][1],Et=0;Et<80;++Et)u=((z>>>14|G<<18)^(z>>>18|G<<14)^(G>>>9|z<<23))>>>0,f=((z<<18|G>>>14)^(z<<14|G>>>18)^(G<<23|z>>>9))>>>0,l=($t^z&(Ct^$t))>>>0,h=(Ft^G&(ce^Ft))>>>0,o=((g>>>28|x<<4)^(x>>>2|g<<30)^(x>>>7|g<<25))>>>0,c=((g<<4|x>>>28)^(x<<30|g>>>2)^(x<<25|g>>>7))>>>0,p=(g&v|B&(g^v))>>>0,d=(x&S|L&(x^S))>>>0,P=gi+f+h+po[Et][1]+t[Et][1],n=Vr+u+l+po[Et][0]+t[Et][0]+(P/4294967296>>>0)>>>0,i=P>>>0,P=c+d,s=o+p+(P/4294967296>>>0)>>>0,a=P>>>0,Vr=$t,gi=Ft,$t=Ct,Ft=ce,Ct=z,ce=G,P=_+i,z=C+n+(P/4294967296>>>0)>>>0,G=P>>>0,C=B,_=L,B=v,L=S,v=g,S=x,P=i+a,g=n+s+(P/4294967296>>>0)>>>0,x=P>>>0;P=e[0][1]+x,e[0][0]=e[0][0]+g+(P/4294967296>>>0)>>>0,e[0][1]=P>>>0,P=e[1][1]+S,e[1][0]=e[1][0]+v+(P/4294967296>>>0)>>>0,e[1][1]=P>>>0,P=e[2][1]+L,e[2][0]=e[2][0]+B+(P/4294967296>>>0)>>>0,e[2][1]=P>>>0,P=e[3][1]+_,e[3][0]=e[3][0]+C+(P/4294967296>>>0)>>>0,e[3][1]=P>>>0,P=e[4][1]+G,e[4][0]=e[4][0]+z+(P/4294967296>>>0)>>>0,e[4][1]=P>>>0,P=e[5][1]+ce,e[5][0]=e[5][0]+Ct+(P/4294967296>>>0)>>>0,e[5][1]=P>>>0,P=e[6][1]+Ft,e[6][0]=e[6][0]+$t+(P/4294967296>>>0)>>>0,e[6][1]=P>>>0,P=e[7][1]+gi,e[7][0]=e[7][0]+Vr+(P/4294967296>>>0)>>>0,e[7][1]=P>>>0,d0-=128}}});var Ql=U((QE,Qo)=>{"use strict";var bm=Object.prototype.hasOwnProperty,Vt="~";function ci(){}Object.create&&(ci.prototype=Object.create(null),new ci().__proto__||(Vt=!1));function Em(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function $l(e,t,r,n,i){if(typeof r!="function")throw new TypeError("The listener must be a function");var s=new Em(r,n||e,i),a=Vt?Vt+t:t;return e._events[a]?e._events[a].fn?e._events[a]=[e._events[a],s]:e._events[a].push(s):(e._events[a]=s,e._eventsCount++),e}function Is(e,t){--e._eventsCount===0?e._events=new ci:delete e._events[t]}function Kt(){this._events=new ci,this._eventsCount=0}Kt.prototype.eventNames=function(){var t=[],r,n;if(this._eventsCount===0)return t;for(n in r=this._events)bm.call(r,n)&&t.push(Vt?n.slice(1):n);return Object.getOwnPropertySymbols?t.concat(Object.getOwnPropertySymbols(r)):t};Kt.prototype.listeners=function(t){var r=Vt?Vt+t:t,n=this._events[r];if(!n)return[];if(n.fn)return[n.fn];for(var i=0,s=n.length,a=new Array(s);i<s;i++)a[i]=n[i].fn;return a};Kt.prototype.listenerCount=function(t){var r=Vt?Vt+t:t,n=this._events[r];return n?n.fn?1:n.length:0};Kt.prototype.emit=function(t,r,n,i,s,a){var o=Vt?Vt+t:t;if(!this._events[o])return!1;var c=this._events[o],u=arguments.length,f,l;if(c.fn){switch(c.once&&this.removeListener(t,c.fn,void 0,!0),u){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,r),!0;case 3:return c.fn.call(c.context,r,n),!0;case 4:return c.fn.call(c.context,r,n,i),!0;case 5:return c.fn.call(c.context,r,n,i,s),!0;case 6:return c.fn.call(c.context,r,n,i,s,a),!0}for(l=1,f=new Array(u-1);l<u;l++)f[l-1]=arguments[l];c.fn.apply(c.context,f)}else{var h=c.length,p;for(l=0;l<h;l++)switch(c[l].once&&this.removeListener(t,c[l].fn,void 0,!0),u){case 1:c[l].fn.call(c[l].context);break;case 2:c[l].fn.call(c[l].context,r);break;case 3:c[l].fn.call(c[l].context,r,n);break;case 4:c[l].fn.call(c[l].context,r,n,i);break;default:if(!f)for(p=1,f=new Array(u-1);p<u;p++)f[p-1]=arguments[p];c[l].fn.apply(c[l].context,f)}}return!0};Kt.prototype.on=function(t,r,n){return $l(this,t,r,n,!1)};Kt.prototype.once=function(t,r,n){return $l(this,t,r,n,!0)};Kt.prototype.removeListener=function(t,r,n,i){var s=Vt?Vt+t:t;if(!this._events[s])return this;if(!r)return Is(this,s),this;var a=this._events[s];if(a.fn)a.fn===r&&(!i||a.once)&&(!n||a.context===n)&&Is(this,s);else{for(var o=0,c=[],u=a.length;o<u;o++)(a[o].fn!==r||i&&!a[o].once||n&&a[o].context!==n)&&c.push(a[o]);c.length?this._events[s]=c.length===1?c[0]:c:Is(this,s)}return this};Kt.prototype.removeAllListeners=function(t){var r;return t?(r=Vt?Vt+t:t,this._events[r]&&Is(this,r)):(this._events=new ci,this._eventsCount=0),this};Kt.prototype.off=Kt.prototype.removeListener;Kt.prototype.addListener=Kt.prototype.on;Kt.prefixed=Vt;Kt.EventEmitter=Kt;typeof Qo<"u"&&(Qo.exports=Kt)});var Cm={};Dt(Cm,{PersistentPeerStore:()=>h0});var me=V(v0(),1);var Qs={};Dt(Qs,{base58btc:()=>mt,base58flickr:()=>Dh});function Ih(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<e.length;i++){var s=e.charAt(i),a=s.charCodeAt(0);if(r[a]!==255)throw new TypeError(s+" is ambiguous");r[a]=i}var o=e.length,c=e.charAt(0),u=Math.log(o)/Math.log(256),f=Math.log(256)/Math.log(o);function l(d){if(d instanceof Uint8Array||(ArrayBuffer.isView(d)?d=new Uint8Array(d.buffer,d.byteOffset,d.byteLength):Array.isArray(d)&&(d=Uint8Array.from(d))),!(d instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(d.length===0)return"";for(var g=0,x=0,v=0,S=d.length;v!==S&&d[v]===0;)v++,g++;for(var B=(S-v)*f+1>>>0,L=new Uint8Array(B);v!==S;){for(var C=d[v],_=0,z=B-1;(C!==0||_<x)&&z!==-1;z--,_++)C+=256*L[z]>>>0,L[z]=C%o>>>0,C=C/o>>>0;if(C!==0)throw new Error("Non-zero carry");x=_,v++}for(var G=B-x;G!==B&&L[G]===0;)G++;for(var Ct=c.repeat(g);G<B;++G)Ct+=e.charAt(L[G]);return Ct}function h(d){if(typeof d!="string")throw new TypeError("Expected String");if(d.length===0)return new Uint8Array;var g=0;if(d[g]!==" "){for(var x=0,v=0;d[g]===c;)x++,g++;for(var S=(d.length-g)*u+1>>>0,B=new Uint8Array(S);d[g];){var L=r[d.charCodeAt(g)];if(L===255)return;for(var C=0,_=S-1;(L!==0||C<v)&&_!==-1;_--,C++)L+=o*B[_]>>>0,B[_]=L%256>>>0,L=L/256>>>0;if(L!==0)throw new Error("Non-zero carry");v=C,g++}if(d[g]!==" "){for(var z=S-v;z!==S&&B[z]===0;)z++;for(var G=new Uint8Array(x+(S-z)),Ct=x;z!==S;)G[Ct++]=B[z++];return G}}}function p(d){var g=h(d);if(g)return g;throw new Error(`Non-${t} character`)}return{encode:l,decodeUnsafe:h,decode:p}}var Rh=Ih,kh=Rh,w0=kh;var km=new Uint8Array(0);var b0=(e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0},Le=e=>{if(e instanceof Uint8Array&&e.constructor.name==="Uint8Array")return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")};var E0=e=>new TextEncoder().encode(e),S0=e=>new TextDecoder().decode(e);var Hs=class{constructor(t,r,n){this.name=t,this.prefix=r,this.baseEncode=n}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}},Gs=class{constructor(t,r,n){if(this.name=t,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return B0(this,t)}},Ws=class{constructor(t){this.decoders=t}or(t){return B0(this,t)}decode(t){let r=t[0],n=this.decoders[r];if(n)return n.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},B0=(e,t)=>new Ws({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}}),$s=class{constructor(t,r,n,i){this.name=t,this.prefix=r,this.baseEncode=n,this.baseDecode=i,this.encoder=new Hs(t,r,n),this.decoder=new Gs(t,r,i)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}},Gr=({name:e,prefix:t,encode:r,decode:n})=>new $s(e,t,r,n),$e=({prefix:e,name:t,alphabet:r})=>{let{encode:n,decode:i}=w0(r,t);return Gr({prefix:e,name:t,encode:n,decode:s=>Le(i(s))})},Nh=(e,t,r,n)=>{let i={};for(let f=0;f<t.length;++f)i[t[f]]=f;let s=e.length;for(;e[s-1]==="=";)--s;let a=new Uint8Array(s*r/8|0),o=0,c=0,u=0;for(let f=0;f<s;++f){let l=i[e[f]];if(l===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<r|l,o+=r,o>=8&&(o-=8,a[u++]=255&c>>o)}if(o>=r||255&c<<8-o)throw new SyntaxError("Unexpected end of data");return a},Lh=(e,t,r)=>{let n=t[t.length-1]==="=",i=(1<<r)-1,s="",a=0,o=0;for(let c=0;c<e.length;++c)for(o=o<<8|e[c],a+=8;a>r;)a-=r,s+=t[i&o>>a];if(a&&(s+=t[i&o<<r-a]),n)for(;s.length*r&7;)s+="=";return s},yt=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>Gr({prefix:t,name:e,encode(i){return Lh(i,n,r)},decode(i){return Nh(i,n,r,e)}});var mt=$e({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Dh=$e({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Zs={};Dt(Zs,{base32:()=>Zt,base32hex:()=>Fh,base32hexpad:()=>Mh,base32hexpadupper:()=>Vh,base32hexupper:()=>Oh,base32pad:()=>Uh,base32padupper:()=>Kh,base32upper:()=>Ph,base32z:()=>qh});var Zt=yt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Ph=yt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Uh=yt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Kh=yt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Fh=yt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Oh=yt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Mh=yt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Vh=yt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),qh=yt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Ys={};Dt(Ys,{base64:()=>Wr,base64pad:()=>zh,base64url:()=>Hh,base64urlpad:()=>Gh});var Wr=yt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),zh=yt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Hh=yt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Gh=yt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});me.default.formatters.b=e=>e==null?"undefined":mt.baseEncode(e);me.default.formatters.t=e=>e==null?"undefined":Zt.baseEncode(e);me.default.formatters.m=e=>e==null?"undefined":Wr.baseEncode(e);me.default.formatters.p=e=>e==null?"undefined":e.toString();me.default.formatters.c=e=>e==null?"undefined":e.toString();me.default.formatters.k=e=>e==null?"undefined":e.toString();function re(e){return Object.assign((0,me.default)(e),{error:(0,me.default)(`${e}:error`),trace:(0,me.default)(`${e}:trace`)})}var vr=function(e,t,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(e):n?n.value:t.get(e)},De,wi=class extends EventTarget{constructor(){super(...arguments),De.set(this,new Map)}listenerCount(t){let r=vr(this,De,"f").get(t);return r==null?0:r.length}addEventListener(t,r,n){super.addEventListener(t,r,n);let i=vr(this,De,"f").get(t);i==null&&(i=[],vr(this,De,"f").set(t,i)),i.push({callback:r,once:(n!==!0&&n!==!1&&n?.once)??!1})}removeEventListener(t,r,n){super.removeEventListener(t.toString(),r??null,n);let i=vr(this,De,"f").get(t);i!=null&&(i=i.filter(({callback:s})=>s!==r),vr(this,De,"f").set(t,i))}dispatchEvent(t){let r=super.dispatchEvent(t),n=vr(this,De,"f").get(t.type);return n==null||(n=n.filter(({once:i})=>!i),vr(this,De,"f").set(t.type,n)),r}safeDispatchEvent(t,r){return this.dispatchEvent(new xt(t,r))}};De=new WeakMap;var Xs=class extends Event{constructor(t,r){super(t,r),this.detail=r?.detail}},xt=globalThis.CustomEvent??Xs;var K=class extends Error{constructor(t,r,n){super(t),this.code=r,this.name=n?.name??"CodeError",this.props=n??{}}};var bi=class{index=0;input="";new(t){return this.index=0,this.input=t,this}readAtomically(t){let r=this.index,n=t();return n===void 0&&(this.index=r),n}parseWith(t){let r=t();if(this.index===this.input.length)return r}peekChar(){if(!(this.index>=this.input.length))return this.input[this.index]}readChar(){if(!(this.index>=this.input.length))return this.input[this.index++]}readGivenChar(t){return this.readAtomically(()=>{let r=this.readChar();if(r===t)return r})}readSeparator(t,r,n){return this.readAtomically(()=>{if(!(r>0&&this.readGivenChar(t)===void 0))return n()})}readNumber(t,r,n,i){return this.readAtomically(()=>{let s=0,a=0,o=this.peekChar();if(o===void 0)return;let c=o==="0",u=2**(8*i)-1;for(;;){let f=this.readAtomically(()=>{let l=this.readChar();if(l===void 0)return;let h=Number.parseInt(l,t);if(!Number.isNaN(h))return h});if(f===void 0)break;if(s*=t,s+=f,s>u||(a+=1,r!==void 0&&a>r))return}if(a!==0)return!n&&c&&a>1?void 0:s})}readIPv4Addr(){return this.readAtomically(()=>{let t=new Uint8Array(4);for(let r=0;r<t.length;r++){let n=this.readSeparator(".",r,()=>this.readNumber(10,3,!1,1));if(n===void 0)return;t[r]=n}return t})}readIPv6Addr(){let t=r=>{for(let n=0;n<r.length/2;n++){let i=n*2;if(n<r.length-3){let a=this.readSeparator(":",n,()=>this.readIPv4Addr());if(a!==void 0)return r[i]=a[0],r[i+1]=a[1],r[i+2]=a[2],r[i+3]=a[3],[i+4,!0]}let s=this.readSeparator(":",n,()=>this.readNumber(16,4,!0,2));if(s===void 0)return[i,!1];r[i]=s>>8,r[i+1]=s&255}return[r.length,!1]};return this.readAtomically(()=>{let r=new Uint8Array(16),[n,i]=t(r);if(n===16)return r;if(i||this.readGivenChar(":")===void 0||this.readGivenChar(":")===void 0)return;let s=new Uint8Array(14),a=16-(n+2),[o]=t(s.subarray(0,a));return r.set(s.subarray(0,o),16-o),r})}readIPAddr(){return this.readIPv4Addr()??this.readIPv6Addr()}};var C0=45,Wh=15,$r=new bi;function T0(e){if(!(e.length>Wh))return $r.new(e).parseWith(()=>$r.readIPv4Addr())}function _0(e){if(!(e.length>C0))return $r.new(e).parseWith(()=>$r.readIPv6Addr())}function I0(e){if(!(e.length>C0))return $r.new(e).parseWith(()=>$r.readIPAddr())}function R0(e){return Boolean(T0(e))}function k0(e){return Boolean(_0(e))}function Ei(e){return Boolean(I0(e))}var Js={};Dt(Js,{identity:()=>$h});var $h=Gr({prefix:"\0",name:"identity",encode:e=>S0(e),decode:e=>E0(e)});var js={};Dt(js,{base2:()=>Qh});var Qh=yt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var ta={};Dt(ta,{base8:()=>Zh});var Zh=yt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var ea={};Dt(ea,{base10:()=>Yh});var Yh=$e({prefix:"9",name:"base10",alphabet:"0123456789"});var ra={};Dt(ra,{base16:()=>Xh,base16upper:()=>Jh});var Xh=yt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Jh=yt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var na={};Dt(na,{base36:()=>jh,base36upper:()=>td});var jh=$e({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),td=$e({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var ia={};Dt(ia,{base256emoji:()=>sd});var N0=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),ed=N0.reduce((e,t,r)=>(e[r]=t,e),[]),rd=N0.reduce((e,t,r)=>(e[t.codePointAt(0)]=r,e),[]);function nd(e){return e.reduce((t,r)=>(t+=ed[r],t),"")}function id(e){let t=[];for(let r of e){let n=rd[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);t.push(n)}return new Uint8Array(t)}var sd=Gr({prefix:"\u{1F680}",name:"base256emoji",encode:nd,decode:id});var ca={};Dt(ca,{sha256:()=>Pt,sha512:()=>Ad});var ad=P0,L0=128,od=127,cd=~od,ud=Math.pow(2,31);function P0(e,t,r){t=t||[],r=r||0;for(var n=r;e>=ud;)t[r++]=e&255|L0,e/=128;for(;e&cd;)t[r++]=e&255|L0,e>>>=7;return t[r]=e|0,P0.bytes=r-n+1,t}var fd=sa,ld=128,D0=127;function sa(e,n){var r=0,n=n||0,i=0,s=n,a,o=e.length;do{if(s>=o)throw sa.bytes=0,new RangeError("Could not decode varint");a=e[s++],r+=i<28?(a&D0)<<i:(a&D0)*Math.pow(2,i),i+=7}while(a>=ld);return sa.bytes=s-n,r}var hd=Math.pow(2,7),dd=Math.pow(2,14),pd=Math.pow(2,21),yd=Math.pow(2,28),gd=Math.pow(2,35),md=Math.pow(2,42),xd=Math.pow(2,49),vd=Math.pow(2,56),wd=Math.pow(2,63),bd=function(e){return e<hd?1:e<dd?2:e<pd?3:e<yd?4:e<gd?5:e<md?6:e<xd?7:e<vd?8:e<wd?9:10},Ed={encode:ad,decode:fd,encodingLength:bd},Sd=Ed,En=Sd;var Sn=(e,t=0)=>[En.decode(e,t),En.decode.bytes],Qr=(e,t,r=0)=>(En.encode(e,t,r),t),Zr=e=>En.encodingLength(e);var xe=(e,t)=>{let r=t.byteLength,n=Zr(e),i=n+Zr(r),s=new Uint8Array(i+r);return Qr(e,s,0),Qr(r,s,n),s.set(t,i),new Yr(e,r,t,s)},wr=e=>{let t=Le(e),[r,n]=Sn(t),[i,s]=Sn(t.subarray(n)),a=t.subarray(n+s);if(a.byteLength!==i)throw new Error("Incorrect length");return new Yr(r,i,a,t)},U0=(e,t)=>{if(e===t)return!0;{let r=t;return e.code===r.code&&e.size===r.size&&r.bytes instanceof Uint8Array&&b0(e.bytes,r.bytes)}},Yr=class{constructor(t,r,n,i){this.code=t,this.size=r,this.digest=n,this.bytes=i}};var oa=({name:e,code:t,encode:r})=>new aa(e,t,r),aa=class{constructor(t,r,n){this.name=t,this.code=r,this.encode=n}digest(t){if(t instanceof Uint8Array){let r=this.encode(t);return r instanceof Uint8Array?xe(this.code,r):r.then(n=>xe(this.code,n))}else throw Error("Unknown type, must be binary type")}};var F0=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),Pt=oa({name:"sha2-256",code:18,encode:F0("SHA-256")}),Ad=oa({name:"sha2-512",code:19,encode:F0("SHA-512")});var ua={};Dt(ua,{identity:()=>Qe});var O0=0,Bd="identity",M0=Le,Cd=e=>xe(O0,M0(e)),Qe={code:O0,name:Bd,encode:M0,digest:Cd};var u2=new TextEncoder,f2=new TextDecoder;var V0=(e,t)=>{let{bytes:r,version:n}=e;switch(n){case 0:return Rd(r,fa(e),t||mt.encoder);default:return kd(r,fa(e),t||Zt.encoder)}};var q0=new WeakMap,fa=e=>{let t=q0.get(e);if(t==null){let r=new Map;return q0.set(e,r),r}return t},nt=class{constructor(t,r,n,i){this.code=r,this.version=t,this.multihash=n,this.bytes=i,this["/"]=i}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{let{code:t,multihash:r}=this;if(t!==An)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==Nd)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return nt.createV0(r)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{let{code:t,digest:r}=this.multihash,n=xe(t,r);return nt.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(t){return nt.equals(this,t)}static equals(t,r){let n=r;return n&&t.code===n.code&&t.version===n.version&&U0(t.multihash,n.multihash)}toString(t){return V0(this,t)}toJSON(){return{"/":V0(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(t){if(t==null)return null;let r=t;if(r instanceof nt)return r;if(r["/"]!=null&&r["/"]===r.bytes||r.asCID===r){let{version:n,code:i,multihash:s,bytes:a}=r;return new nt(n,i,s,a||z0(n,i,s.bytes))}else if(r[Ld]===!0){let{version:n,multihash:i,code:s}=r,a=wr(i);return nt.create(n,s,a)}else return null}static create(t,r,n){if(typeof r!="number")throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(t){case 0:{if(r!==An)throw new Error(`Version 0 CID must use dag-pb (code: ${An}) block encoding`);return new nt(t,r,n,n.bytes)}case 1:{let i=z0(t,r,n.bytes);return new nt(t,r,n,i)}default:throw new Error("Invalid version")}}static createV0(t){return nt.create(0,An,t)}static createV1(t,r){return nt.create(1,t,r)}static decode(t){let[r,n]=nt.decodeFirst(t);if(n.length)throw new Error("Incorrect length");return r}static decodeFirst(t){let r=nt.inspectBytes(t),n=r.size-r.multihashSize,i=Le(t.subarray(n,n+r.multihashSize));if(i.byteLength!==r.multihashSize)throw new Error("Incorrect length");let s=i.subarray(r.multihashSize-r.digestSize),a=new Yr(r.multihashCode,r.digestSize,s,i);return[r.version===0?nt.createV0(a):nt.createV1(r.codec,a),t.subarray(r.size)]}static inspectBytes(t){let r=0,n=()=>{let[l,h]=Sn(t.subarray(r));return r+=h,l},i=n(),s=An;if(i===18?(i=0,r=0):s=n(),i!==0&&i!==1)throw new RangeError(`Invalid CID version ${i}`);let a=r,o=n(),c=n(),u=r+c,f=u-a;return{version:i,codec:s,multihashCode:o,digestSize:c,multihashSize:f,size:u}}static parse(t,r){let[n,i]=Id(t,r),s=nt.decode(i);if(s.version===0&&t[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return fa(s).set(n,t),s}},Id=(e,t)=>{switch(e[0]){case"Q":{let r=t||mt;return[mt.prefix,r.decode(`${mt.prefix}${e}`)]}case mt.prefix:{let r=t||mt;return[mt.prefix,r.decode(e)]}case Zt.prefix:{let r=t||Zt;return[Zt.prefix,r.decode(e)]}default:{if(t==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}}},Rd=(e,t,r)=>{let{prefix:n}=r;if(n!==mt.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);let i=t.get(n);if(i==null){let s=r.encode(e).slice(1);return t.set(n,s),s}else return i},kd=(e,t,r)=>{let{prefix:n}=r,i=t.get(n);if(i==null){let s=r.encode(e);return t.set(n,s),s}else return i},An=112,Nd=18,z0=(e,t,r)=>{let n=Zr(e),i=n+Zr(t),s=new Uint8Array(i+r.byteLength);return Qr(e,s,0),Qr(t,s,n),s.set(r,i),s},Ld=Symbol.for("@ipld/js-cid/CID");var Ze={...Js,...js,...ta,...ea,...ra,...Zs,...na,...Qs,...Ys,...ia},w2={...ca,...ua};function Er(e){return globalThis.Buffer!=null?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function Pe(e=0){return globalThis.Buffer?.alloc!=null?Er(globalThis.Buffer.alloc(e)):new Uint8Array(e)}function Ue(e=0){return globalThis.Buffer?.allocUnsafe!=null?Er(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}function G0(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}var H0=G0("utf8","u",e=>"u"+new TextDecoder("utf8").decode(e),e=>new TextEncoder().encode(e.substring(1))),la=G0("ascii","a",e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t},e=>{e=e.substring(1);let t=Ue(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}),Dd={utf8:H0,"utf-8":H0,hex:Ze.base16,latin1:la,ascii:la,binary:la,...Ze},Ai=Dd;function tt(e,t="utf8"){let r=Ai[t];if(r==null)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8"):r.encoder.encode(e).substring(1)}var W0=R0,Pd=k0,ha=function(e){let t=0;if(e=e.toString().trim(),W0(e)){let r=new Uint8Array(t+4);return e.split(/\./g).forEach(n=>{r[t++]=parseInt(n,10)&255}),r}if(Pd(e)){let r=e.split(":",8),n;for(n=0;n<r.length;n++){let s=W0(r[n]),a;s&&(a=ha(r[n]),r[n]=tt(a.slice(0,2),"base16")),a!=null&&++n<8&&r.splice(n,0,tt(a.slice(2,4),"base16"))}if(r[0]==="")for(;r.length<8;)r.unshift("0");else if(r[r.length-1]==="")for(;r.length<8;)r.push("0");else if(r.length<8){for(n=0;n<r.length&&r[n]!=="";n++);let s=[n,1];for(n=9-r.length;n>0;n--)s.push("0");r.splice.apply(r,s)}let i=new Uint8Array(t+16);for(n=0;n<r.length;n++){let s=parseInt(r[n],16);i[t++]=s>>8&255,i[t++]=s&255}return i}throw new Error("invalid ip address")},$0=function(e,t=0,r){t=~~t,r=r??e.length-t;let n=new DataView(e.buffer);if(r===4){let i=[];for(let s=0;s<r;s++)i.push(e[t+s]);return i.join(".")}if(r===16){let i=[];for(let s=0;s<r;s+=2)i.push(n.getUint16(t+s).toString(16));return i.join(":").replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3").replace(/:{3,4}/,"::")}return""};var Bn={},da={},Kd=[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,-1,"ip6zone"],[43,8,"ipcidr"],[53,-1,"dns",!0],[54,-1,"dns4",!0],[55,-1,"dns6",!0],[56,-1,"dnsaddr",!0],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[280,0,"webrtc"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,-1,"unix",!1,!0],[421,-1,"ipfs"],[421,-1,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,-1,"garlic64"],[448,0,"tls"],[460,0,"quic"],[461,0,"quic-v1"],[465,0,"webtransport"],[466,-1,"certhash"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[777,-1,"memory"]];Kd.forEach(e=>{let t=Fd(...e);da[t.code]=t,Bn[t.name]=t});function Fd(e,t,r,n,i){return{code:e,size:t,name:r,resolvable:Boolean(n),path:Boolean(i)}}function dt(e){if(typeof e=="number"){if(da[e]!=null)return da[e];throw new Error(`no protocol with code: ${e}`)}else if(typeof e=="string"){if(Bn[e]!=null)return Bn[e];throw new Error(`no protocol with name: ${e}`)}throw new Error(`invalid protocol id type: ${typeof e}`)}var ve=V(Bi(),1);function Tt(e,t="utf8"){let r=Ai[t];if(r==null)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Er(globalThis.Buffer.from(e,"utf-8")):r.decoder.decode(`${r.prefix}${e}`)}function _t(e,t){t==null&&(t=e.reduce((i,s)=>i+s.length,0));let r=Ue(t),n=0;for(let i of e)r.set(i,n),n+=i.length;return Er(r)}function oc(e,t){switch(dt(e).code){case 4:case 41:return jd(t);case 42:return sc(t);case 6:case 273:case 33:case 132:return uc(t).toString();case 53:case 54:case 55:case 56:case 400:case 777:return sc(t);case 421:return np(t);case 444:return ac(t);case 445:return ac(t);case 466:return rp(t);default:return tt(t,"base16")}}function cc(e,t){switch(dt(e).code){case 4:return nc(t);case 41:return nc(t);case 42:return ic(t);case 6:case 273:case 33:case 132:return ma(parseInt(t,10));case 53:case 54:case 55:case 56:case 400:case 777:return ic(t);case 421:return tp(t);case 444:return ip(t);case 445:return sp(t);case 466:return ep(t);default:return Tt(t,"base16")}}var ga=Object.values(Ze).map(e=>e.decoder),Jd=function(){let e=ga[0].or(ga[1]);return ga.slice(2).forEach(t=>e=e.or(t)),e}();function nc(e){if(!Ei(e))throw new Error("invalid ip address");return ha(e)}function jd(e){let t=$0(e,0,e.length);if(t==null)throw new Error("ipBuff is required");if(!Ei(t))throw new Error("invalid ip address");return t}function ma(e){let t=new ArrayBuffer(2);return new DataView(t).setUint16(0,e),new Uint8Array(t)}function uc(e){return new DataView(e.buffer).getUint16(e.byteOffset)}function ic(e){let t=Tt(e),r=Uint8Array.from(ve.default.encode(t.length));return _t([r,t],r.length+t.length)}function sc(e){let t=ve.default.decode(e);if(e=e.slice(ve.default.decode.bytes),e.length!==t)throw new Error("inconsistent lengths");return tt(e)}function tp(e){let t;e[0]==="Q"||e[0]==="1"?t=wr(mt.decode(`z${e}`)).bytes:t=nt.parse(e).multihash.bytes;let r=Uint8Array.from(ve.default.encode(t.length));return _t([r,t],r.length+t.length)}function ep(e){let t=Jd.decode(e),r=Uint8Array.from(ve.default.encode(t.length));return _t([r,t],r.length+t.length)}function rp(e){let t=ve.default.decode(e),r=e.slice(ve.default.decode.bytes);if(r.length!==t)throw new Error("inconsistent lengths");return"u"+tt(r,"base64url")}function np(e){let t=ve.default.decode(e),r=e.slice(ve.default.decode.bytes);if(r.length!==t)throw new Error("inconsistent lengths");return tt(r,"base58btc")}function ip(e){let t=e.split(":");if(t.length!==2)throw new Error(`failed to parse onion addr: ["'${t.join('", "')}'"]' does not contain a port number`);if(t[0].length!==16)throw new Error(`failed to parse onion addr: ${t[0]} not a Tor onion address.`);let r=Zt.decode("b"+t[0]),n=parseInt(t[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");let i=ma(n);return _t([r,i],r.length+i.length)}function sp(e){let t=e.split(":");if(t.length!==2)throw new Error(`failed to parse onion addr: ["'${t.join('", "')}'"]' does not contain a port number`);if(t[0].length!==56)throw new Error(`failed to parse onion addr: ${t[0]} not a Tor onion3 address.`);let r=Zt.decode(`b${t[0]}`),n=parseInt(t[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");let i=ma(n);return _t([r,i],r.length+i.length)}function ac(e){let t=e.slice(0,e.length-2),r=e.slice(e.length-2),n=tt(t,"base32"),i=uc(r);return`${n}:${i}`}var Xr=V(Bi(),1);function ap(e){let t=[],r=e.split("/").slice(1);if(r.length===1&&r[0]==="")return[];for(let n=0;n<r.length;n++){let i=r[n],s=dt(i);if(s.size===0){t.push([i]);continue}if(n++,n>=r.length)throw lc("invalid address: "+e);if(s.path===!0){t.push([i,Ea(r.slice(n).join("/"))]);break}t.push([i,r[n]])}return t}function op(e){let t=[];return e.map(r=>{let n=_i(r);return t.push(n.name),r.length>1&&r[1]!=null&&t.push(r[1]),null}),Ea(t.join("/"))}function cp(e){return e.map(t=>{Array.isArray(t)||(t=[t]);let r=_i(t);return t.length>1?[r.code,cc(r.code,t[1])]:[r.code]})}function xa(e){return e.map(t=>{let r=_i(t);return t[1]!=null?[r.code,oc(r.code,t[1])]:[r.code]})}function va(e){return Ti(_t(e.map(t=>{let r=_i(t),n=Uint8Array.from(Xr.default.encode(r.code));return t.length>1&&t[1]!=null&&(n=_t([n,t[1]])),n})))}function wa(e,t){return e.size>0?e.size/8:e.size===0?0:Xr.default.decode(t)+(Xr.default.decode.bytes??0)}function Ci(e){let t=[],r=0;for(;r<e.length;){let n=Xr.default.decode(e,r),i=Xr.default.decode.bytes??0,s=dt(n),a=wa(s,e.slice(r+i));if(a===0){t.push([n]),r+=i;continue}let o=e.slice(r+i,r+i+a);if(r+=a+i,r>e.length)throw lc("Invalid address Uint8Array: "+tt(e,"base16"));t.push([n,o])}return t}function ba(e){let t=Ci(e),r=xa(t);return op(r)}function up(e){e=Ea(e);let t=ap(e),r=cp(t);return va(r)}function fc(e){return up(e)}function Ti(e){let t=fp(e);if(t!=null)throw t;return Uint8Array.from(e)}function fp(e){try{Ci(e)}catch(t){return t}}function Ea(e){return"/"+e.trim().split("/").filter(t=>t).join("/")}function lc(e){return new Error("Error parsing address: "+e)}function _i(e){return dt(e[0])}var Ba=V(Bi(),1);var yc=V(Sa(),1);function st(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0}var Jr=function(e,t,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(e):n?n.value:t.get(e)},Aa=function(e,t,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(e,r):i?i.value=r:t.set(e,r),r},Cn,Tn,_n,pc,dp=Symbol.for("nodejs.util.inspect.custom"),pp=[dt("dns").code,dt("dns4").code,dt("dns6").code,dt("dnsaddr").code],yp=new Map,gc=Symbol.for("@multiformats/js-multiaddr/multiaddr");function Ca(e){return Boolean(e?.[gc])}var Ke=class{constructor(t){if(Cn.set(this,void 0),Tn.set(this,void 0),_n.set(this,void 0),this[pc]=!0,t==null&&(t=""),t instanceof Uint8Array)this.bytes=Ti(t);else if(typeof t=="string"){if(t.length>0&&t.charAt(0)!=="/")throw new Error(`multiaddr "${t}" must start with a "/"`);this.bytes=fc(t)}else if(Ca(t))this.bytes=Ti(t.bytes);else throw new Error("addr must be a string, Buffer, or another Multiaddr")}toString(){return Jr(this,Cn,"f")==null&&Aa(this,Cn,ba(this.bytes),"f"),Jr(this,Cn,"f")}toJSON(){return this.toString()}toOptions(){let t,r,n,i,s="",a=dt("tcp"),o=dt("udp"),c=dt("ip4"),u=dt("ip6"),f=dt("dns6"),l=dt("ip6zone");for(let[p,d]of this.stringTuples())p===l.code&&(s=`%${d??""}`),pp.includes(p)&&(r=a.name,i=443,n=`${d??""}${s}`,t=p===f.code?6:4),(p===a.code||p===o.code)&&(r=dt(p).name,i=parseInt(d??"")),(p===c.code||p===u.code)&&(r=dt(p).name,n=`${d??""}${s}`,t=p===u.code?6:4);if(t==null||r==null||n==null||i==null)throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6, dnsaddr}/{address}/{tcp, udp}/{port}".');return{family:t,host:n,transport:r,port:i}}protos(){return this.protoCodes().map(t=>Object.assign({},dt(t)))}protoCodes(){let t=[],r=this.bytes,n=0;for(;n<r.length;){let i=Ba.default.decode(r,n),s=Ba.default.decode.bytes??0,a=dt(i),o=wa(a,r.slice(n+s));n+=o+s,t.push(i)}return t}protoNames(){return this.protos().map(t=>t.name)}tuples(){return Jr(this,Tn,"f")==null&&Aa(this,Tn,Ci(this.bytes),"f"),Jr(this,Tn,"f")}stringTuples(){return Jr(this,_n,"f")==null&&Aa(this,_n,xa(this.tuples()),"f"),Jr(this,_n,"f")}encapsulate(t){return t=new Ke(t),new Ke(this.toString()+t.toString())}decapsulate(t){let r=t.toString(),n=this.toString(),i=n.lastIndexOf(r);if(i<0)throw new Error(`Address ${this.toString()} does not contain subaddress: ${t.toString()}`);return new Ke(n.slice(0,i))}decapsulateCode(t){let r=this.tuples();for(let n=r.length-1;n>=0;n--)if(r[n][0]===t)return new Ke(va(r.slice(0,n)));return this}getPeerId(){try{let r=this.stringTuples().filter(n=>n[0]===Bn.ipfs.code).pop();if(r?.[1]!=null){let n=r[1];return n[0]==="Q"||n[0]==="1"?tt(mt.decode(`z${n}`),"base58btc"):tt(nt.parse(n).multihash.bytes,"base58btc")}return null}catch{return null}}getPath(){let t=null;try{t=this.stringTuples().filter(r=>dt(r[0]).path===!0)[0][1],t==null&&(t=null)}catch{t=null}return t}equals(t){return st(this.bytes,t.bytes)}async resolve(t){let r=this.protos().find(s=>s.resolvable);if(r==null)return[this];let n=yp.get(r.name);if(n==null)throw(0,yc.default)(new Error(`no available resolver for ${r.name}`),"ERR_NO_AVAILABLE_RESOLVER");return(await n(this,t)).map(s=>new Ke(s))}nodeAddress(){let t=this.toOptions();if(t.transport!=="tcp"&&t.transport!=="udp")throw new Error(`multiaddr must have a valid format - no protocol with name: "${t.transport}". Must have a valid transport protocol: "{tcp, udp}"`);return{family:t.family,address:t.host,port:t.port}}isThinWaistAddress(t){let r=(t??this).protos();return!(r.length!==2||r[0].code!==4&&r[0].code!==41||r[1].code!==6&&r[1].code!==273)}[(Cn=new WeakMap,Tn=new WeakMap,_n=new WeakMap,pc=gc,dp)](){return`Multiaddr(${ba(this.bytes)})`}};function In(e){return new Ke(e)}var M={ERR_INVALID_PARAMETERS:"ERR_INVALID_PARAMETERS",ERR_NOT_FOUND:"ERR_NOT_FOUND"};var Ul=V(Sa(),1);var Ka=V(kn(),1),eu=V(Ni(),1),Fa=V(Ln(),1),ru=V(Di(),1),nu=V(Fe(),1);function Ap(){nu.default._configure(),Ka.default._configure(eu.default),Fa.default._configure(ru.default)}Ap();var iu=["uint64","int64","sint64","fixed64","sfixed64"];function Bp(e){for(let t of iu){if(e[t]==null)continue;let r=e[t];e[t]=function(){return BigInt(r.call(this).toString())}}return e}function Oa(e){return Bp(new Ka.default(e))}function Cp(e){for(let t of iu){if(e[t]==null)continue;let r=e[t];e[t]=function(n){return r.call(this,n.toString())}}return e}function Ma(){return Cp(Fa.default.create())}function Pi(e,t){let r=Oa(e instanceof Uint8Array?e:e.subarray());return t.decode(r)}function Ui(e,t){let r=Ma();return t.encode(e,r,{lengthDelimited:!1}),r.finish()}var tn;(function(e){e[e.VARINT=0]="VARINT",e[e.BIT64=1]="BIT64",e[e.LENGTH_DELIMITED=2]="LENGTH_DELIMITED",e[e.START_GROUP=3]="START_GROUP",e[e.END_GROUP=4]="END_GROUP",e[e.BIT32=5]="BIT32"})(tn||(tn={}));function Ki(e,t,r,n){return{name:e,type:t,encode:r,decode:n}}function Va(e){function t(i){if(e[i.toString()]==null)throw new Error("Invalid enum value");return e[i]}let r=function(s,a){let o=t(s);a.int32(o)},n=function(s){let a=s.int32();return t(a)};return Ki("enum",tn.VARINT,r,n)}function Fi(e,t){return Ki("message",tn.LENGTH_DELIMITED,e,t)}var ft;(function(e){e.RSA="RSA",e.Ed25519="Ed25519",e.Secp256k1="Secp256k1"})(ft||(ft={}));var qa;(function(e){e[e.RSA=0]="RSA",e[e.Ed25519=1]="Ed25519",e[e.Secp256k1=2]="Secp256k1"})(qa||(qa={}));(function(e){e.codec=()=>Va(qa)})(ft||(ft={}));var Ee;(function(e){let t;e.codec=()=>(t==null&&(t=Fi((r,n,i={})=>{i.lengthDelimited!==!1&&n.fork(),r.Type!=null&&(n.uint32(8),ft.codec().encode(r.Type,n)),r.Data!=null&&(n.uint32(18),n.bytes(r.Data)),i.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let i={},s=n==null?r.len:r.pos+n;for(;r.pos<s;){let a=r.uint32();switch(a>>>3){case 1:i.Type=ft.codec().decode(r);break;case 2:i.Data=r.bytes();break;default:r.skipType(a&7);break}}return i})),t),e.encode=r=>Ui(r,e.codec()),e.decode=r=>Pi(r,e.codec())})(Ee||(Ee={}));var Se;(function(e){let t;e.codec=()=>(t==null&&(t=Fi((r,n,i={})=>{i.lengthDelimited!==!1&&n.fork(),r.Type!=null&&(n.uint32(8),ft.codec().encode(r.Type,n)),r.Data!=null&&(n.uint32(18),n.bytes(r.Data)),i.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let i={},s=n==null?r.len:r.pos+n;for(;r.pos<s;){let a=r.uint32();switch(a>>>3){case 1:i.Type=ft.codec().decode(r);break;case 2:i.Data=r.bytes();break;default:r.skipType(a&7);break}}return i})),t),e.encode=r=>Ui(r,e.codec()),e.decode=r=>Pi(r,e.codec())})(Se||(Se={}));var Dw=V(Kn(),1),Pw=V(bf(),1),X1=V(et(),1);var Ht={get(e=globalThis){let t=e.crypto;if(t==null||t.subtle==null)throw Object.assign(new Error("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p-crypto/blob/master/README.md#web-crypto-api"),{code:"ERR_MISSING_WEB_CRYPTO"});return t}};var Ev=V(St(),1),Sv=V(ji(),1),Ef=V(et(),1);function de(e,t){let r=Uint8Array.from(e.abs().toByteArray());if(r=r[0]===0?r.subarray(1):r,t!=null){if(r.length>t)throw new Error("byte array longer than desired length");r=_t([new Uint8Array(t-r.length),r])}return tt(r,"base64url")}function Yt(e){let t=Sf(e);return new Ef.default.jsbn.BigInteger(tt(t,"base16"),16)}function Sf(e,t){let r=Tt(e,"base64urlpad");if(t!=null){if(r.length>t)throw new Error("byte array longer than desired length");r=_t([new Uint8Array(t-r.length),r])}return r}var Jg={"P-256":256,"P-384":384,"P-521":521},jg=Object.keys(Jg),Dv=jg.join(" / ");function lo(e){let t=e?.algorithm??"AES-GCM",r=e?.keyLength??16,n=e?.nonceLength??12,i=e?.digest??"SHA-256",s=e?.saltLength??16,a=e?.iterations??32767,o=Ht.get();r*=8;async function c(l,h){let p=o.getRandomValues(new Uint8Array(s)),d=o.getRandomValues(new Uint8Array(n)),g={name:t,iv:d};typeof h=="string"&&(h=Tt(h));let x={name:"PBKDF2",salt:p,iterations:a,hash:{name:i}},v=await o.subtle.importKey("raw",h,{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),S=await o.subtle.deriveKey(x,v,{name:t,length:r},!0,["encrypt"]),B=await o.subtle.encrypt(g,S,l);return _t([p,g.iv,new Uint8Array(B)])}async function u(l,h){let p=l.subarray(0,s),d=l.subarray(s,s+n),g=l.subarray(s+n),x={name:t,iv:d};typeof h=="string"&&(h=Tt(h));let v={name:"PBKDF2",salt:p,iterations:a,hash:{name:i}},S=await o.subtle.importKey("raw",h,{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),B=await o.subtle.deriveKey(v,S,{name:t,length:r},!0,["decrypt"]),L=await o.subtle.decrypt(x,B,g);return new Uint8Array(L)}return{encrypt:c,decrypt:u}}var So={};Dt(So,{RsaPrivateKey:()=>pn,RsaPublicKey:()=>Wn,fromJwk:()=>A1,generateKeyPair:()=>B1,unmarshalRsaPrivateKey:()=>E1,unmarshalRsaPublicKey:()=>S1});var yw=V(If(),1),Gn=V(et(),1);var e1=V(nn(),1);var $=BigInt(0),ct=BigInt(1),nr=BigInt(2),qn=BigInt(3),Rf=BigInt(8),gt=Object.freeze({a:$,b:BigInt(7),P:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),n:BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h:ct,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee")}),kf=(e,t)=>(e+t/nr)/t,ns={beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar(e){let{n:t}=gt,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-ct*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),s=r,a=BigInt("0x100000000000000000000000000000000"),o=kf(s*e,t),c=kf(-n*e,t),u=R(e-o*r-c*i,t),f=R(-o*n-c*s,t),l=u>a,h=f>a;if(l&&(u=t-u),h&&(f=t-f),u>a||f>a)throw new Error("splitScalarEndo: Endomorphism failed, k="+e);return{k1neg:l,k1:u,k2neg:h,k2:f}}},pe=32,un=32,r1=32,Nf=pe+1,Lf=2*pe+1;function Df(e){let{a:t,b:r}=gt,n=R(e*e),i=R(n*e);return R(i+t*e+r)}var is=gt.a===$,os=class extends Error{constructor(t){super(t)}};function Pf(e){if(!(e instanceof X))throw new TypeError("JacobianPoint expected")}var X=class{constructor(t,r,n){this.x=t,this.y=r,this.z=n}static fromAffine(t){if(!(t instanceof J))throw new TypeError("JacobianPoint#fromAffine: expected Point");return t.equals(J.ZERO)?X.ZERO:new X(t.x,t.y,ct)}static toAffineBatch(t){let r=o1(t.map(n=>n.z));return t.map((n,i)=>n.toAffine(r[i]))}static normalizeZ(t){return X.toAffineBatch(t).map(X.fromAffine)}equals(t){Pf(t);let{x:r,y:n,z:i}=this,{x:s,y:a,z:o}=t,c=R(i*i),u=R(o*o),f=R(r*u),l=R(s*c),h=R(R(n*o)*u),p=R(R(a*i)*c);return f===l&&h===p}negate(){return new X(this.x,R(-this.y),this.z)}double(){let{x:t,y:r,z:n}=this,i=R(t*t),s=R(r*r),a=R(s*s),o=t+s,c=R(nr*(R(o*o)-i-a)),u=R(qn*i),f=R(u*u),l=R(f-nr*c),h=R(u*(c-l)-Rf*a),p=R(nr*r*n);return new X(l,h,p)}add(t){Pf(t);let{x:r,y:n,z:i}=this,{x:s,y:a,z:o}=t;if(s===$||a===$)return this;if(r===$||n===$)return t;let c=R(i*i),u=R(o*o),f=R(r*u),l=R(s*c),h=R(R(n*o)*u),p=R(R(a*i)*c),d=R(l-f),g=R(p-h);if(d===$)return g===$?this.double():X.ZERO;let x=R(d*d),v=R(d*x),S=R(f*x),B=R(g*g-v-nr*S),L=R(g*(S-B)-h*v),C=R(i*o*d);return new X(B,L,C)}subtract(t){return this.add(t.negate())}multiplyUnsafe(t){let r=X.ZERO;if(typeof t=="bigint"&&t===$)return r;let n=Ff(t);if(n===ct)return this;if(!is){let l=r,h=this;for(;n>$;)n&ct&&(l=l.add(h)),h=h.double(),n>>=ct;return l}let{k1neg:i,k1:s,k2neg:a,k2:o}=ns.splitScalar(n),c=r,u=r,f=this;for(;s>$||o>$;)s&ct&&(c=c.add(f)),o&ct&&(u=u.add(f)),f=f.double(),s>>=ct,o>>=ct;return i&&(c=c.negate()),a&&(u=u.negate()),u=new X(R(u.x*ns.beta),u.y,u.z),c.add(u)}precomputeWindow(t){let r=is?128/t+1:256/t+1,n=[],i=this,s=i;for(let a=0;a<r;a++){s=i,n.push(s);for(let o=1;o<2**(t-1);o++)s=s.add(i),n.push(s);i=s.double()}return n}wNAF(t,r){!r&&this.equals(X.BASE)&&(r=J.BASE);let n=r&&r._WINDOW_SIZE||1;if(256%n)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let i=r&&go.get(r);i||(i=this.precomputeWindow(n),r&&n!==1&&(i=X.normalizeZ(i),go.set(r,i)));let s=X.ZERO,a=X.BASE,o=1+(is?128/n:256/n),c=2**(n-1),u=BigInt(2**n-1),f=2**n,l=BigInt(n);for(let h=0;h<o;h++){let p=h*c,d=Number(t&u);t>>=l,d>c&&(d-=f,t+=ct);let g=p,x=p+Math.abs(d)-1,v=h%2!==0,S=d<0;d===0?a=a.add(ss(v,i[g])):s=s.add(ss(S,i[x]))}return{p:s,f:a}}multiply(t,r){let n=Ff(t),i,s;if(is){let{k1neg:a,k1:o,k2neg:c,k2:u}=ns.splitScalar(n),{p:f,f:l}=this.wNAF(o,r),{p:h,f:p}=this.wNAF(u,r);f=ss(a,f),h=ss(c,h),h=new X(R(h.x*ns.beta),h.y,h.z),i=f.add(h),s=l.add(p)}else{let{p:a,f:o}=this.wNAF(n,r);i=a,s=o}return X.normalizeZ([i,s])[0]}toAffine(t){let{x:r,y:n,z:i}=this,s=this.equals(X.ZERO);t==null&&(t=s?Rf:hn(i));let a=t,o=R(a*a),c=R(o*a),u=R(r*o),f=R(n*c),l=R(i*a);if(s)return J.ZERO;if(l!==ct)throw new Error("invZ was invalid");return new J(u,f)}};X.BASE=new X(gt.Gx,gt.Gy,ct);X.ZERO=new X($,ct,$);function ss(e,t){let r=t.negate();return e?r:t}var go=new WeakMap,J=class{constructor(t,r){this.x=t,this.y=r}_setWindowSize(t){this._WINDOW_SIZE=t,go.delete(this)}hasEvenY(){return this.y%nr===$}static fromCompressedHex(t){let r=t.length===32,n=ir(r?t:t.subarray(1));if(!yo(n))throw new Error("Point is not on curve");let i=Df(n),s=a1(i),a=(s&ct)===ct;r?a&&(s=R(-s)):(t[0]&1)===1!==a&&(s=R(-s));let o=new J(n,s);return o.assertValidity(),o}static fromUncompressedHex(t){let r=ir(t.subarray(1,pe+1)),n=ir(t.subarray(pe+1,pe*2+1)),i=new J(r,n);return i.assertValidity(),i}static fromHex(t){let r=ln(t),n=r.length,i=r[0];if(n===pe)return this.fromCompressedHex(r);if(n===Nf&&(i===2||i===3))return this.fromCompressedHex(r);if(n===Lf&&i===4)return this.fromUncompressedHex(r);throw new Error(`Point.fromHex: received invalid point. Expected 32-${Nf} compressed bytes or ${Lf} uncompressed bytes, not ${n}`)}static fromPrivateKey(t){return J.BASE.multiply(us(t))}static fromSignature(t,r,n){let{r:i,s}=Of(r);if(![0,1,2,3].includes(n))throw new Error("Cannot recover: invalid recovery bit");let a=vo(ln(t)),{n:o}=gt,c=n===2||n===3?i+o:i,u=hn(c,o),f=R(-a*u,o),l=R(s*u,o),h=n&1?"03":"02",p=J.fromHex(h+on(c)),d=J.BASE.multiplyAndAddUnsafe(p,f,l);if(!d)throw new Error("Cannot recover signature: point at infinify");return d.assertValidity(),d}toRawBytes(t=!1){return kr(this.toHex(t))}toHex(t=!1){let r=on(this.x);return t?`${this.hasEvenY()?"02":"03"}${r}`:`04${r}${on(this.y)}`}toHexX(){return this.toHex(!0).slice(2)}toRawX(){return this.toRawBytes(!0).slice(1)}assertValidity(){let t="Point is not on elliptic curve",{x:r,y:n}=this;if(!yo(r)||!yo(n))throw new Error(t);let i=R(n*n),s=Df(r);if(R(i-s)!==$)throw new Error(t)}equals(t){return this.x===t.x&&this.y===t.y}negate(){return new J(this.x,R(-this.y))}double(){return X.fromAffine(this).double().toAffine()}add(t){return X.fromAffine(this).add(X.fromAffine(t)).toAffine()}subtract(t){return this.add(t.negate())}multiply(t){return X.fromAffine(this).multiply(t,this).toAffine()}multiplyAndAddUnsafe(t,r,n){let i=X.fromAffine(this),s=r===$||r===ct||this!==J.BASE?i.multiplyUnsafe(r):i.multiply(r),a=X.fromAffine(t).multiplyUnsafe(n),o=s.add(a);return o.equals(X.ZERO)?void 0:o.toAffine()}};J.BASE=new J(gt.Gx,gt.Gy);J.ZERO=new J($,$);function Uf(e){return Number.parseInt(e[0],16)>=8?"00"+e:e}function Kf(e){if(e.length<2||e[0]!==2)throw new Error(`Invalid signature integer tag: ${fn(e)}`);let t=e[1],r=e.subarray(2,t+2);if(!t||r.length!==t)throw new Error("Invalid signature integer: wrong length");if(r[0]===0&&r[1]<=127)throw new Error("Invalid signature integer: trailing length");return{data:ir(r),left:e.subarray(t+2)}}function n1(e){if(e.length<2||e[0]!=48)throw new Error(`Invalid signature tag: ${fn(e)}`);if(e[1]!==e.length-2)throw new Error("Invalid signature: incorrect length");let{data:t,left:r}=Kf(e.subarray(2)),{data:n,left:i}=Kf(r);if(i.length)throw new Error(`Invalid signature: left bytes after parsing: ${fn(i)}`);return{r:t,s:n}}var Re=class{constructor(t,r){this.r=t,this.s=r,this.assertValidity()}static fromCompact(t){let r=t instanceof Uint8Array,n="Signature.fromCompact";if(typeof t!="string"&&!r)throw new TypeError(`${n}: Expected string or Uint8Array`);let i=r?fn(t):t;if(i.length!==128)throw new Error(`${n}: Expected 64-byte hex`);return new Re(cs(i.slice(0,64)),cs(i.slice(64,128)))}static fromDER(t){let r=t instanceof Uint8Array;if(typeof t!="string"&&!r)throw new TypeError("Signature.fromDER: Expected string or Uint8Array");let{r:n,s:i}=n1(r?t:kr(t));return new Re(n,i)}static fromHex(t){return this.fromDER(t)}assertValidity(){let{r:t,s:r}=this;if(!Hn(t))throw new Error("Invalid Signature: r must be 0 < r < n");if(!Hn(r))throw new Error("Invalid Signature: s must be 0 < s < n")}hasHighS(){let t=gt.n>>ct;return this.s>t}normalizeS(){return this.hasHighS()?new Re(this.r,R(-this.s,gt.n)):this}toDERRawBytes(){return kr(this.toDERHex())}toDERHex(){let t=Uf(Vn(this.s)),r=Uf(Vn(this.r)),n=t.length/2,i=r.length/2,s=Vn(n),a=Vn(i);return`30${Vn(i+n+4)}02${a}${r}02${s}${t}`}toRawBytes(){return this.toDERRawBytes()}toHex(){return this.toDERHex()}toCompactRawBytes(){return kr(this.toCompactHex())}toCompactHex(){return on(this.r)+on(this.s)}};function rr(...e){if(!e.every(n=>n instanceof Uint8Array))throw new Error("Uint8Array list expected");if(e.length===1)return e[0];let t=e.reduce((n,i)=>n+i.length,0),r=new Uint8Array(t);for(let n=0,i=0;n<e.length;n++){let s=e[n];r.set(s,i),i+=s.length}return r}var i1=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function fn(e){if(!(e instanceof Uint8Array))throw new Error("Expected Uint8Array");let t="";for(let r=0;r<e.length;r++)t+=i1[e[r]];return t}var s1=BigInt("0x10000000000000000000000000000000000000000000000000000000000000000");function on(e){if(typeof e!="bigint")throw new Error("Expected bigint");if(!($<=e&&e<s1))throw new Error("Expected number 0 <= n < 2^256");return e.toString(16).padStart(64,"0")}function mo(e){let t=kr(on(e));if(t.length!==32)throw new Error("Error: expected 32 bytes");return t}function Vn(e){let t=e.toString(16);return t.length&1?`0${t}`:t}function cs(e){if(typeof e!="string")throw new TypeError("hexToNumber: expected string, got "+typeof e);return BigInt(`0x${e}`)}function kr(e){if(typeof e!="string")throw new TypeError("hexToBytes: expected string, got "+typeof e);if(e.length%2)throw new Error("hexToBytes: received invalid unpadded hex"+e.length);let t=new Uint8Array(e.length/2);for(let r=0;r<t.length;r++){let n=r*2,i=e.slice(n,n+2),s=Number.parseInt(i,16);if(Number.isNaN(s)||s<0)throw new Error("Invalid byte sequence");t[r]=s}return t}function ir(e){return cs(fn(e))}function ln(e){return e instanceof Uint8Array?Uint8Array.from(e):kr(e)}function Ff(e){if(typeof e=="number"&&Number.isSafeInteger(e)&&e>0)return BigInt(e);if(typeof e=="bigint"&&Hn(e))return e;throw new TypeError("Expected valid private scalar: 0 < scalar < curve.n")}function R(e,t=gt.P){let r=e%t;return r>=$?r:t+r}function ae(e,t){let{P:r}=gt,n=e;for(;t-- >$;)n*=n,n%=r;return n}function a1(e){let{P:t}=gt,r=BigInt(6),n=BigInt(11),i=BigInt(22),s=BigInt(23),a=BigInt(44),o=BigInt(88),c=e*e*e%t,u=c*c*e%t,f=ae(u,qn)*u%t,l=ae(f,qn)*u%t,h=ae(l,nr)*c%t,p=ae(h,n)*h%t,d=ae(p,i)*p%t,g=ae(d,a)*d%t,x=ae(g,o)*g%t,v=ae(x,a)*d%t,S=ae(v,qn)*u%t,B=ae(S,s)*p%t,L=ae(B,r)*c%t,C=ae(L,nr);if(C*C%t!==e)throw new Error("Cannot find square root");return C}function hn(e,t=gt.P){if(e===$||t<=$)throw new Error(`invert: expected positive integers, got n=${e} mod=${t}`);let r=R(e,t),n=t,i=$,s=ct,a=ct,o=$;for(;r!==$;){let u=n/r,f=n%r,l=i-a*u,h=s-o*u;n=r,r=f,i=a,s=o,a=l,o=h}if(n!==ct)throw new Error("invert: does not exist");return R(i,t)}function o1(e,t=gt.P){let r=new Array(e.length),n=e.reduce((s,a,o)=>a===$?s:(r[o]=s,R(s*a,t)),ct),i=hn(n,t);return e.reduceRight((s,a,o)=>a===$?s:(r[o]=R(s*r[o],t),R(s*a,t)),i),r}function c1(e){let t=e.length*8-un*8,r=ir(e);return t>0?r>>BigInt(t):r}function vo(e,t=!1){let r=c1(e);if(t)return r;let{n}=gt;return r>=n?r-n:r}var cn,zn,xo=class{constructor(t,r){if(this.hashLen=t,this.qByteLen=r,typeof t!="number"||t<2)throw new Error("hashLen must be a number");if(typeof r!="number"||r<2)throw new Error("qByteLen must be a number");this.v=new Uint8Array(t).fill(1),this.k=new Uint8Array(t).fill(0),this.counter=0}hmac(...t){return ye.hmacSha256(this.k,...t)}hmacSync(...t){return zn(this.k,...t)}checkSync(){if(typeof zn!="function")throw new os("hmacSha256Sync needs to be set")}incr(){if(this.counter>=1e3)throw new Error("Tried 1,000 k values for sign(), all were invalid");this.counter+=1}async reseed(t=new Uint8Array){this.k=await this.hmac(this.v,Uint8Array.from([0]),t),this.v=await this.hmac(this.v),t.length!==0&&(this.k=await this.hmac(this.v,Uint8Array.from([1]),t),this.v=await this.hmac(this.v))}reseedSync(t=new Uint8Array){this.checkSync(),this.k=this.hmacSync(this.v,Uint8Array.from([0]),t),this.v=this.hmacSync(this.v),t.length!==0&&(this.k=this.hmacSync(this.v,Uint8Array.from([1]),t),this.v=this.hmacSync(this.v))}async generate(){this.incr();let t=0,r=[];for(;t<this.qByteLen;){this.v=await this.hmac(this.v);let n=this.v.slice();r.push(n),t+=this.v.length}return rr(...r)}generateSync(){this.checkSync(),this.incr();let t=0,r=[];for(;t<this.qByteLen;){this.v=this.hmacSync(this.v);let n=this.v.slice();r.push(n),t+=this.v.length}return rr(...r)}};function Hn(e){return $<e&&e<gt.n}function yo(e){return $<e&&e<gt.P}function u1(e,t,r,n=!0){let{n:i}=gt,s=vo(e,!0);if(!Hn(s))return;let a=hn(s,i),o=J.BASE.multiply(s),c=R(o.x,i);if(c===$)return;let u=R(a*R(t+r*c,i),i);if(u===$)return;let f=new Re(c,u),l=(o.x===f.r?0:2)|Number(o.y&ct);return n&&f.hasHighS()&&(f=f.normalizeS(),l^=1),{sig:f,recovery:l}}function us(e){let t;if(typeof e=="bigint")t=e;else if(typeof e=="number"&&Number.isSafeInteger(e)&&e>0)t=BigInt(e);else if(typeof e=="string"){if(e.length!==2*un)throw new Error("Expected 32 bytes of private key");t=cs(e)}else if(e instanceof Uint8Array){if(e.length!==un)throw new Error("Expected 32 bytes of private key");t=ir(e)}else throw new TypeError("Expected valid private key");if(!Hn(t))throw new Error("Expected private key: 0 < key < n");return t}function f1(e){return e instanceof J?(e.assertValidity(),e):J.fromHex(e)}function Of(e){if(e instanceof Re)return e.assertValidity(),e;try{return Re.fromDER(e)}catch{return Re.fromCompact(e)}}function wo(e,t=!1){return J.fromPrivateKey(e).toRawBytes(t)}function Mf(e){let t=e.length>pe?e.slice(0,pe):e;return ir(t)}function l1(e){let t=Mf(e),r=R(t,gt.n);return Vf(r<$?t:r)}function Vf(e){return mo(e)}function h1(e,t,r){if(e==null)throw new Error(`sign: expected valid message hash, not "${e}"`);let n=ln(e),i=us(t),s=[Vf(i),l1(n)];if(r!=null){r===!0&&(r=ye.randomBytes(pe));let c=ln(r);if(c.length!==pe)throw new Error(`sign: Expected ${pe} bytes of extra data`);s.push(c)}let a=rr(...s),o=Mf(n);return{seed:a,m:o,d:i}}function d1(e,t){let{sig:r,recovery:n}=e,{der:i,recovered:s}=Object.assign({canonical:!0,der:!0},t),a=i?r.toDERRawBytes():r.toCompactRawBytes();return s?[a,n]:a}async function qf(e,t,r={}){let{seed:n,m:i,d:s}=h1(e,t,r.extraEntropy),a=new xo(r1,un);await a.reseed(n);let o;for(;!(o=u1(await a.generate(),i,s,r.canonical));)await a.reseed();return d1(o,r)}var p1={strict:!0};function zf(e,t,r,n=p1){let i;try{i=Of(e),t=ln(t)}catch{return!1}let{r:s,s:a}=i;if(n.strict&&i.hasHighS())return!1;let o=vo(t),c;try{c=f1(r)}catch{return!1}let{n:u}=gt,f=hn(a,u),l=R(o*f,u),h=R(s*f,u),p=J.BASE.multiplyAndAddUnsafe(c,l,h);return p?R(p.x,u)===s:!1}J.BASE._setWindowSize(8);var Xt={node:e1,web:typeof self=="object"&&"crypto"in self?self.crypto:void 0};var as={},ye={bytesToHex:fn,hexToBytes:kr,concatBytes:rr,mod:R,invert:hn,isValidPrivateKey(e){try{return us(e),!0}catch{return!1}},_bigintTo32Bytes:mo,_normalizePrivateKey:us,hashToPrivateKey:e=>{e=ln(e);let t=un+8;if(e.length<t||e.length>1024)throw new Error("Expected valid bytes of private key as per FIPS 186");let r=R(ir(e),gt.n-ct)+ct;return mo(r)},randomBytes:(e=32)=>{if(Xt.web)return Xt.web.getRandomValues(new Uint8Array(e));if(Xt.node){let{randomBytes:t}=Xt.node;return Uint8Array.from(t(e))}else throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>ye.hashToPrivateKey(ye.randomBytes(un+8)),precompute(e=8,t=J.BASE){let r=t===J.BASE?t:new J(t.x,t.y);return r._setWindowSize(e),r.multiply(qn),r},sha256:async(...e)=>{if(Xt.web){let t=await Xt.web.subtle.digest("SHA-256",rr(...e));return new Uint8Array(t)}else if(Xt.node){let{createHash:t}=Xt.node,r=t("sha256");return e.forEach(n=>r.update(n)),Uint8Array.from(r.digest())}else throw new Error("The environment doesn't have sha256 function")},hmacSha256:async(e,...t)=>{if(Xt.web){let r=await Xt.web.subtle.importKey("raw",e,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),n=rr(...t),i=await Xt.web.subtle.sign("HMAC",r,n);return new Uint8Array(i)}else if(Xt.node){let{createHmac:r}=Xt.node,n=r("sha256",e);return t.forEach(i=>n.update(i)),Uint8Array.from(n.digest())}else throw new Error("The environment doesn't have hmac-sha256 function")},sha256Sync:void 0,hmacSha256Sync:void 0,taggedHash:async(e,...t)=>{let r=as[e];if(r===void 0){let n=await ye.sha256(Uint8Array.from(e,i=>i.charCodeAt(0)));r=rr(n,n),as[e]=r}return ye.sha256(r,...t)},taggedHashSync:(e,...t)=>{if(typeof cn!="function")throw new os("sha256Sync is undefined, you need to set it");let r=as[e];if(r===void 0){let n=cn(Uint8Array.from(e,i=>i.charCodeAt(0)));r=rr(n,n),as[e]=r}return cn(r,...t)},_JacobianPoint:X};Object.defineProperties(ye,{sha256Sync:{configurable:!1,get(){return cn},set(e){cn||(cn=e)}},hmacSha256Sync:{configurable:!1,get(){return zn},set(e){zn||(zn=e)}}});function fs(e){if(isNaN(e)||e<=0)throw new K("random bytes length must be a Number bigger than 0","ERR_INVALID_LENGTH");return ye.randomBytes(e)}var Nr={};Dt(Nr,{jwkToPkcs1:()=>m1,jwkToPkix:()=>v1,pkcs1ToJwk:()=>g1,pkixToJwk:()=>x1});var Qv=V(Kn(),1),Zv=V(rs(),1),qe=V(et(),1);function g1(e){let t=qe.default.asn1.fromDer(tt(e,"ascii")),r=qe.default.pki.privateKeyFromAsn1(t);return{kty:"RSA",n:de(r.n),e:de(r.e),d:de(r.d),p:de(r.p),q:de(r.q),dp:de(r.dP),dq:de(r.dQ),qi:de(r.qInv),alg:"RS256"}}function m1(e){if(e.n==null||e.e==null||e.d==null||e.p==null||e.q==null||e.dp==null||e.dq==null||e.qi==null)throw new K("JWK was missing components","ERR_INVALID_PARAMETERS");let t=qe.default.pki.privateKeyToAsn1({n:Yt(e.n),e:Yt(e.e),d:Yt(e.d),p:Yt(e.p),q:Yt(e.q),dP:Yt(e.dp),dQ:Yt(e.dq),qInv:Yt(e.qi)});return Tt(qe.default.asn1.toDer(t).getBytes(),"ascii")}function x1(e){let t=qe.default.asn1.fromDer(tt(e,"ascii")),r=qe.default.pki.publicKeyFromAsn1(t);return{kty:"RSA",n:de(r.n),e:de(r.e)}}function v1(e){if(e.n==null||e.e==null)throw new K("JWK was missing components","ERR_INVALID_PARAMETERS");let t=qe.default.pki.publicKeyToAsn1({n:Yt(e.n),e:Yt(e.e)});return Tt(qe.default.asn1.toDer(t).getBytes(),"ascii")}var tw=V(rs(),1),bo=V(et(),1);function Hf(e,t){return t.map(r=>Yt(e[r]))}function Gf(e){return bo.default.pki.setRsaPrivateKey(...Hf(e,["n","e","d","p","q","dp","dq","qi"]))}function Wf(e){return bo.default.pki.setRsaPublicKey(...Hf(e,["n","e"]))}async function $f(e){let t=await Ht.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),r=await Yf(t);return{privateKey:r[0],publicKey:r[1]}}async function Eo(e){let r=[await Ht.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["sign"]),await w1(e)],n=await Yf({privateKey:r[0],publicKey:r[1]});return{privateKey:n[0],publicKey:n[1]}}async function Qf(e,t){let r=await Ht.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),n=await Ht.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},r,Uint8Array.from(t));return new Uint8Array(n,0,n.byteLength)}async function Zf(e,t,r){let n=await Ht.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return await Ht.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},n,t,r)}async function Yf(e){if(e.privateKey==null||e.publicKey==null)throw new K("Private and public key are required","ERR_INVALID_PARAMETERS");return await Promise.all([Ht.get().subtle.exportKey("jwk",e.privateKey),Ht.get().subtle.exportKey("jwk",e.publicKey)])}async function w1(e){return await Ht.get().subtle.importKey("jwk",{kty:e.kty,n:e.n,e:e.e},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["verify"])}function Xf(e,t,r,n){let i=t?Wf(e):Gf(e),s=tt(Uint8Array.from(r),"ascii"),a=n(s,i);return Tt(a,"ascii")}function Jf(e,t){return Xf(e,!0,t,(r,n)=>n.encrypt(r))}function jf(e,t){return Xf(e,!1,t,(r,n)=>n.decrypt(r))}async function dn(e,t){let n=await lo().encrypt(e,t);return Wr.encode(n)}var Wn=class{constructor(t){this._key=t}async verify(t,r){return await Zf(this._key,r,t)}marshal(){return Nr.jwkToPkix(this._key)}get bytes(){return Ee.encode({Type:ft.RSA,Data:this.marshal()}).subarray()}encrypt(t){return Jf(this._key,t)}equals(t){return st(this.bytes,t.bytes)}async hash(){let{bytes:t}=await Pt.digest(this.bytes);return t}},pn=class{constructor(t,r){this._key=t,this._publicKey=r}genSecret(){return fs(16)}async sign(t){return await Qf(this._key,t)}get public(){if(this._publicKey==null)throw new K("public key not provided","ERR_PUBKEY_NOT_PROVIDED");return new Wn(this._publicKey)}decrypt(t){return jf(this._key,t)}marshal(){return Nr.jwkToPkcs1(this._key)}get bytes(){return Se.encode({Type:ft.RSA,Data:this.marshal()}).subarray()}equals(t){return st(this.bytes,t.bytes)}async hash(){let{bytes:t}=await Pt.digest(this.bytes);return t}async id(){let t=await this.public.hash();return tt(t,"base58btc")}async export(t,r="pkcs-8"){if(r==="pkcs-8"){let n=new Gn.default.util.ByteBuffer(this.marshal()),i=Gn.default.asn1.fromDer(n),s=Gn.default.pki.privateKeyFromAsn1(i),a={algorithm:"aes256",count:1e4,saltSize:128/8,prfAlgorithm:"sha512"};return Gn.default.pki.encryptRsaPrivateKey(s,t,a)}else{if(r==="libp2p-key")return await dn(this.bytes,t);throw new K(`export format '${r}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}}};async function E1(e){let t=Nr.pkcs1ToJwk(e),r=await Eo(t);return new pn(r.privateKey,r.publicKey)}function S1(e){let t=Nr.pkixToJwk(e);return new Wn(t)}async function A1(e){let t=await Eo(e);return new pn(t.privateKey,t.publicKey)}async function B1(e){let t=await $f(e);return new pn(t.privateKey,t.publicKey)}var No={};Dt(No,{Ed25519PrivateKey:()=>Dr,Ed25519PublicKey:()=>Xn,generateKeyPair:()=>W1,generateKeyPairFromSeed:()=>pl,unmarshalEd25519PrivateKey:()=>H1,unmarshalEd25519PublicKey:()=>G1});var C1=V(nn(),1);var Lt=BigInt(0),Q=BigInt(1),or=BigInt(2),T1=BigInt(8),tl=BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),ut=Object.freeze({a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),P:BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),l:tl,n:tl,h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960")});var sl=BigInt("0x10000000000000000000000000000000000000000000000000000000000000000"),$n=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),mw=BigInt("6853475219497561581579357271197624642482790079785650197046958215289687604742"),_1=BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),I1=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),R1=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),k1=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952"),H=class{constructor(t,r,n,i){this.x=t,this.y=r,this.z=n,this.t=i}static fromAffine(t){if(!(t instanceof ht))throw new TypeError("ExtendedPoint#fromAffine: expected Point");return t.equals(ht.ZERO)?H.ZERO:new H(t.x,t.y,Q,E(t.x*t.y))}static toAffineBatch(t){let r=D1(t.map(n=>n.z));return t.map((n,i)=>n.toAffine(r[i]))}static normalizeZ(t){return this.toAffineBatch(t).map(this.fromAffine)}equals(t){rl(t);let{x:r,y:n,z:i}=this,{x:s,y:a,z:o}=t,c=E(r*o),u=E(s*i),f=E(n*o),l=E(a*i);return c===u&&f===l}negate(){return new H(E(-this.x),this.y,this.z,E(-this.t))}double(){let{x:t,y:r,z:n}=this,{a:i}=ut,s=E(t*t),a=E(r*r),o=E(or*E(n*n)),c=E(i*s),u=t+r,f=E(E(u*u)-s-a),l=c+a,h=l-o,p=c-a,d=E(f*h),g=E(l*p),x=E(f*p),v=E(h*l);return new H(d,g,v,x)}add(t){rl(t);let{x:r,y:n,z:i,t:s}=this,{x:a,y:o,z:c,t:u}=t,f=E((n-r)*(o+a)),l=E((n+r)*(o-a)),h=E(l-f);if(h===Lt)return this.double();let p=E(i*or*u),d=E(s*or*c),g=d+p,x=l+f,v=d-p,S=E(g*h),B=E(x*v),L=E(g*v),C=E(h*x);return new H(S,B,C,L)}subtract(t){return this.add(t.negate())}precomputeWindow(t){let r=1+256/t,n=[],i=this,s=i;for(let a=0;a<r;a++){s=i,n.push(s);for(let o=1;o<2**(t-1);o++)s=s.add(i),n.push(s);i=s.double()}return n}wNAF(t,r){!r&&this.equals(H.BASE)&&(r=ht.BASE);let n=r&&r._WINDOW_SIZE||1;if(256%n)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let i=r&&_o.get(r);i||(i=this.precomputeWindow(n),r&&n!==1&&(i=H.normalizeZ(i),_o.set(r,i)));let s=H.ZERO,a=H.BASE,o=1+256/n,c=2**(n-1),u=BigInt(2**n-1),f=2**n,l=BigInt(n);for(let h=0;h<o;h++){let p=h*c,d=Number(t&u);t>>=l,d>c&&(d-=f,t+=Q);let g=p,x=p+Math.abs(d)-1,v=h%2!==0,S=d<0;d===0?a=a.add(el(v,i[g])):s=s.add(el(S,i[x]))}return H.normalizeZ([s,a])[0]}multiply(t,r){return this.wNAF(hs(t,ut.l),r)}multiplyUnsafe(t){let r=hs(t,ut.l,!1),n=H.BASE,i=H.ZERO;if(r===Lt)return i;if(this.equals(i)||r===Q)return this;if(this.equals(n))return this.wNAF(r);let s=i,a=this;for(;r>Lt;)r&Q&&(s=s.add(a)),a=a.double(),r>>=Q;return s}isSmallOrder(){return this.multiplyUnsafe(ut.h).equals(H.ZERO)}isTorsionFree(){let t=this.multiplyUnsafe(ut.l/or).double();return ut.l%or&&(t=t.add(this)),t.equals(H.ZERO)}toAffine(t){let{x:r,y:n,z:i}=this,s=this.equals(H.ZERO);t==null&&(t=s?T1:ds(i));let a=E(r*t),o=E(n*t),c=E(i*t);if(s)return ht.ZERO;if(c!==Q)throw new Error("invZ was invalid");return new ht(a,o)}fromRistrettoBytes(){Bo()}toRistrettoBytes(){Bo()}fromRistrettoHash(){Bo()}};H.BASE=new H(ut.Gx,ut.Gy,Q,E(ut.Gx*ut.Gy));H.ZERO=new H(Lt,Q,Q,Lt);function el(e,t){let r=t.negate();return e?r:t}function rl(e){if(!(e instanceof H))throw new TypeError("ExtendedPoint expected")}function Ao(e){if(!(e instanceof Gt))throw new TypeError("RistrettoPoint expected")}function Bo(){throw new Error("Legacy method: switch to RistrettoPoint")}var Gt=class{constructor(t){this.ep=t}static calcElligatorRistrettoMap(t){let{d:r}=ut,n=E($n*t*t),i=E((n+Q)*R1),s=BigInt(-1),a=E((s-r*n)*E(n+r)),{isValid:o,value:c}=Ro(i,a),u=E(c*t);ar(u)||(u=E(-u)),o||(c=u),o||(s=n);let f=E(s*(n-Q)*k1-a),l=c*c,h=E((c+c)*a),p=E(f*_1),d=E(Q-l),g=E(Q+l);return new H(E(h*g),E(d*p),E(p*g),E(h*d))}static hashToCurve(t){t=cr(t,64);let r=Co(t.slice(0,32)),n=this.calcElligatorRistrettoMap(r),i=Co(t.slice(32,64)),s=this.calcElligatorRistrettoMap(i);return new Gt(n.add(s))}static fromHex(t){t=cr(t,32);let{a:r,d:n}=ut,i="RistrettoPoint.fromHex: the hex is not valid encoding of RistrettoPoint",s=Co(t);if(!U1(Qn(s),t)||ar(s))throw new Error(i);let a=E(s*s),o=E(Q+r*a),c=E(Q-r*a),u=E(o*o),f=E(c*c),l=E(r*n*u-f),{isValid:h,value:p}=il(E(l*f)),d=E(p*c),g=E(p*d*l),x=E((s+s)*d);ar(x)&&(x=E(-x));let v=E(o*g),S=E(x*v);if(!h||ar(S)||v===Lt)throw new Error(i);return new Gt(new H(x,v,Q,S))}toRawBytes(){let{x:t,y:r,z:n,t:i}=this.ep,s=E(E(n+r)*E(n-r)),a=E(t*r),o=E(a*a),{value:c}=il(E(s*o)),u=E(c*s),f=E(c*a),l=E(u*f*i),h;if(ar(i*l)){let d=E(r*$n),g=E(t*$n);t=d,r=g,h=E(u*I1)}else h=f;ar(t*l)&&(r=E(-r));let p=E((n-r)*h);return ar(p)&&(p=E(-p)),Qn(p)}toHex(){return Zn(this.toRawBytes())}toString(){return this.toHex()}equals(t){Ao(t);let r=this.ep,n=t.ep,i=E(r.x*n.y)===E(r.y*n.x),s=E(r.y*n.y)===E(r.x*n.x);return i||s}add(t){return Ao(t),new Gt(this.ep.add(t.ep))}subtract(t){return Ao(t),new Gt(this.ep.subtract(t.ep))}multiply(t){return new Gt(this.ep.multiply(t))}multiplyUnsafe(t){return new Gt(this.ep.multiplyUnsafe(t))}};Gt.BASE=new Gt(H.BASE);Gt.ZERO=new Gt(H.ZERO);var _o=new WeakMap,ht=class{constructor(t,r){this.x=t,this.y=r}_setWindowSize(t){this._WINDOW_SIZE=t,_o.delete(this)}static fromHex(t,r=!0){let{d:n,P:i}=ut;t=cr(t,32);let s=t.slice();s[31]=t[31]&-129;let a=Yn(s);if(r&&a>=i)throw new Error("Expected 0 < hex < P");if(!r&&a>=sl)throw new Error("Expected 0 < hex < 2**256");let o=E(a*a),c=E(o-Q),u=E(n*o+Q),{isValid:f,value:l}=Ro(c,u);if(!f)throw new Error("Point.fromHex: invalid y coordinate");let h=(l&Q)===Q;return(t[31]&128)!==0!==h&&(l=E(-l)),new ht(l,a)}static async fromPrivateKey(t){return(await ps(t)).point}toRawBytes(){let t=Qn(this.y);return t[31]|=this.x&Q?128:0,t}toHex(){return Zn(this.toRawBytes())}toX25519(){let{y:t}=this,r=E((Q+t)*ds(Q-t));return Qn(r)}isTorsionFree(){return H.fromAffine(this).isTorsionFree()}equals(t){return this.x===t.x&&this.y===t.y}negate(){return new ht(E(-this.x),this.y)}add(t){return H.fromAffine(this).add(H.fromAffine(t)).toAffine()}subtract(t){return this.add(t.negate())}multiply(t){return H.fromAffine(this).multiply(t,this).toAffine()}};ht.BASE=new ht(ut.Gx,ut.Gy);ht.ZERO=new ht(Lt,Q);var Lr=class{constructor(t,r){this.r=t,this.s=r,this.assertValidity()}static fromHex(t){let r=cr(t,64),n=ht.fromHex(r.slice(0,32),!1),i=Yn(r.slice(32,64));return new Lr(n,i)}assertValidity(){let{r:t,s:r}=this;if(!(t instanceof ht))throw new Error("Expected Point instance");return hs(r,ut.l,!1),this}toRawBytes(){let t=new Uint8Array(64);return t.set(this.r.toRawBytes()),t.set(Qn(this.s),32),t}toHex(){return Zn(this.toRawBytes())}};function nl(...e){if(!e.every(n=>n instanceof Uint8Array))throw new Error("Expected Uint8Array list");if(e.length===1)return e[0];let t=e.reduce((n,i)=>n+i.length,0),r=new Uint8Array(t);for(let n=0,i=0;n<e.length;n++){let s=e[n];r.set(s,i),i+=s.length}return r}var N1=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function Zn(e){if(!(e instanceof Uint8Array))throw new Error("Uint8Array expected");let t="";for(let r=0;r<e.length;r++)t+=N1[e[r]];return t}function Io(e){if(typeof e!="string")throw new TypeError("hexToBytes: expected string, got "+typeof e);if(e.length%2)throw new Error("hexToBytes: received invalid unpadded hex");let t=new Uint8Array(e.length/2);for(let r=0;r<t.length;r++){let n=r*2,i=e.slice(n,n+2),s=Number.parseInt(i,16);if(Number.isNaN(s)||s<0)throw new Error("Invalid byte sequence");t[r]=s}return t}function al(e){let r=e.toString(16).padStart(64,"0");return Io(r)}function Qn(e){return al(e).reverse()}function ar(e){return(E(e)&Q)===Q}function Yn(e){if(!(e instanceof Uint8Array))throw new Error("Expected Uint8Array");return BigInt("0x"+Zn(Uint8Array.from(e).reverse()))}var L1=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");function Co(e){return E(Yn(e)&L1)}function E(e,t=ut.P){let r=e%t;return r>=Lt?r:t+r}function ds(e,t=ut.P){if(e===Lt||t<=Lt)throw new Error(`invert: expected positive integers, got n=${e} mod=${t}`);let r=E(e,t),n=t,i=Lt,s=Q,a=Q,o=Lt;for(;r!==Lt;){let u=n/r,f=n%r,l=i-a*u,h=s-o*u;n=r,r=f,i=a,s=o,a=l,o=h}if(n!==Q)throw new Error("invert: does not exist");return E(i,t)}function D1(e,t=ut.P){let r=new Array(e.length),n=e.reduce((s,a,o)=>a===Lt?s:(r[o]=s,E(s*a,t)),Q),i=ds(n,t);return e.reduceRight((s,a,o)=>a===Lt?s:(r[o]=E(s*r[o],t),E(s*a,t)),i),r}function ke(e,t){let{P:r}=ut,n=e;for(;t-- >Lt;)n*=n,n%=r;return n}function P1(e){let{P:t}=ut,r=BigInt(5),n=BigInt(10),i=BigInt(20),s=BigInt(40),a=BigInt(80),c=e*e%t*e%t,u=ke(c,or)*c%t,f=ke(u,Q)*e%t,l=ke(f,r)*f%t,h=ke(l,n)*l%t,p=ke(h,i)*h%t,d=ke(p,s)*p%t,g=ke(d,a)*d%t,x=ke(g,a)*d%t,v=ke(x,n)*l%t;return{pow_p_5_8:ke(v,or)*e%t,b2:c}}function Ro(e,t){let r=E(t*t*t),n=E(r*r*t),i=P1(e*n).pow_p_5_8,s=E(e*r*i),a=E(t*s*s),o=s,c=E(s*$n),u=a===e,f=a===E(-e),l=a===E(-e*$n);return u&&(s=o),(f||l)&&(s=c),ar(s)&&(s=E(-s)),{isValid:u||f,value:s}}function il(e){return Ro(Q,e)}function ls(e){return E(Yn(e),ut.l)}function U1(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function cr(e,t){let r=e instanceof Uint8Array?Uint8Array.from(e):Io(e);if(typeof t=="number"&&r.length!==t)throw new Error(`Expected ${t} bytes`);return r}function hs(e,t,r=!0){if(!t)throw new TypeError("Specify max value");if(typeof e=="number"&&Number.isSafeInteger(e)&&(e=BigInt(e)),typeof e=="bigint"&&e<t){if(r){if(Lt<e)return e}else if(Lt<=e)return e}throw new TypeError("Expected valid scalar: 0 < scalar < max")}function K1(e){return e[0]&=248,e[31]&=127,e[31]|=64,e}function F1(e){if(e=typeof e=="bigint"||typeof e=="number"?al(hs(e,sl)):cr(e),e.length!==32)throw new Error("Expected 32 bytes");return e}function O1(e){let t=K1(e.slice(0,32)),r=e.slice(32,64),n=ls(t),i=ht.BASE.multiply(n),s=i.toRawBytes();return{head:t,prefix:r,scalar:n,point:i,pointBytes:s}}var To;async function ps(e){return O1(await ur.sha512(F1(e)))}async function ko(e){return(await ps(e)).pointBytes}async function ol(e,t){e=cr(e);let{prefix:r,scalar:n,pointBytes:i}=await ps(t),s=ls(await ur.sha512(r,e)),a=ht.BASE.multiply(s),o=ls(await ur.sha512(a.toRawBytes(),i,e)),c=E(s+o*n,ut.l);return new Lr(a,c).toRawBytes()}function M1(e,t,r){t=cr(t),r instanceof ht||(r=ht.fromHex(r,!1));let{r:n,s:i}=e instanceof Lr?e.assertValidity():Lr.fromHex(e),s=H.BASE.multiplyUnsafe(i);return{r:n,s:i,SB:s,pub:r,msg:t}}function V1(e,t,r,n){let i=ls(n),s=H.fromAffine(e).multiplyUnsafe(i);return H.fromAffine(t).add(s).subtract(r).multiplyUnsafe(ut.h).equals(H.ZERO)}async function cl(e,t,r){let{r:n,SB:i,msg:s,pub:a}=M1(e,t,r),o=await ur.sha512(n.toRawBytes(),a.toRawBytes(),s);return V1(a,n,i,o)}ht.BASE._setWindowSize(8);var sr={node:C1,web:typeof self=="object"&&"crypto"in self?self.crypto:void 0},ur={bytesToHex:Zn,hexToBytes:Io,concatBytes:nl,getExtendedPublicKey:ps,mod:E,invert:ds,TORSION_SUBGROUP:["0100000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac037a","0000000000000000000000000000000000000000000000000000000000000080","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc05","ecffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff7f","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc85","0000000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac03fa"],hashToPrivateScalar:e=>{if(e=cr(e),e.length<40||e.length>1024)throw new Error("Expected 40-1024 bytes of private key as per FIPS 186");return E(Yn(e),ut.l-Q)+Q},randomBytes:(e=32)=>{if(sr.web)return sr.web.getRandomValues(new Uint8Array(e));if(sr.node){let{randomBytes:t}=sr.node;return new Uint8Array(t(e).buffer)}else throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>ur.randomBytes(32),sha512:async(...e)=>{let t=nl(...e);if(sr.web){let r=await sr.web.subtle.digest("SHA-512",t.buffer);return new Uint8Array(r)}else{if(sr.node)return Uint8Array.from(sr.node.createHash("sha512").update(t).digest());throw new Error("The environment doesn't have sha512 function")}},precompute(e=8,t=ht.BASE){let r=t.equals(ht.BASE)?t:new ht(t.x,t.y);return r._setWindowSize(e),r.multiply(or),r},sha512Sync:void 0};Object.defineProperties(ur,{sha512Sync:{configurable:!1,get(){return To},set(e){To||(To=e)}}});var yn=32,ze=64,ys=32;async function ul(){let e=ur.randomPrivateKey(),t=await ko(e);return{privateKey:dl(e,t),publicKey:t}}async function fl(e){if(e.length!==ys)throw new TypeError('"seed" must be 32 bytes in length.');if(!(e instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, or Uint8Array.');let t=e,r=await ko(t);return{privateKey:dl(t,r),publicKey:r}}async function ll(e,t){let r=e.subarray(0,ys);return await ol(t,r)}async function hl(e,t,r){return await cl(t,r,e)}function dl(e,t){let r=new Uint8Array(ze);for(let n=0;n<ys;n++)r[n]=e[n],r[ys+n]=t[n];return r}var Xn=class{constructor(t){this._key=gn(t,yn)}async verify(t,r){return await hl(this._key,r,t)}marshal(){return this._key}get bytes(){return Ee.encode({Type:ft.Ed25519,Data:this.marshal()}).subarray()}equals(t){return st(this.bytes,t.bytes)}async hash(){let{bytes:t}=await Pt.digest(this.bytes);return t}},Dr=class{constructor(t,r){this._key=gn(t,ze),this._publicKey=gn(r,yn)}async sign(t){return await ll(this._key,t)}get public(){return new Xn(this._publicKey)}marshal(){return this._key}get bytes(){return Se.encode({Type:ft.Ed25519,Data:this.marshal()}).subarray()}equals(t){return st(this.bytes,t.bytes)}async hash(){let{bytes:t}=await Pt.digest(this.bytes);return t}async id(){let t=await Qe.digest(this.public.bytes);return mt.encode(t.bytes).substring(1)}async export(t,r="libp2p-key"){if(r==="libp2p-key")return await dn(this.bytes,t);throw new K(`export format '${r}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}};function H1(e){if(e.length>ze){e=gn(e,ze+yn);let n=e.subarray(0,ze),i=e.subarray(ze,e.length);return new Dr(n,i)}e=gn(e,ze);let t=e.subarray(0,ze),r=e.subarray(yn);return new Dr(t,r)}function G1(e){return e=gn(e,yn),new Xn(e)}async function W1(){let{privateKey:e,publicKey:t}=await ul();return new Dr(e,t)}async function pl(e){let{privateKey:t,publicKey:r}=await fl(e);return new Dr(t,r)}function gn(e,t){if(e=Uint8Array.from(e??[]),e.length!==t)throw new K(`Key must be a Uint8Array of length ${t}, got ${e.length}`,"ERR_INVALID_KEY_TYPE");return e}var Do={};Dt(Do,{Secp256k1PrivateKey:()=>jn,Secp256k1PublicKey:()=>Jn,generateKeyPair:()=>Y1,unmarshalSecp256k1PrivateKey:()=>Q1,unmarshalSecp256k1PublicKey:()=>Z1});function yl(){return ye.randomPrivateKey()}async function gl(e,t){let{digest:r}=await Pt.digest(t);try{return await qf(r,e)}catch(n){throw new K(String(n),"ERR_INVALID_INPUT")}}async function ml(e,t,r){try{let{digest:n}=await Pt.digest(r);return zf(t,n,e)}catch(n){throw new K(String(n),"ERR_INVALID_INPUT")}}function xl(e){return J.fromHex(e).toRawBytes(!0)}function vl(e){try{wo(e,!0)}catch(t){throw new K(String(t),"ERR_INVALID_PRIVATE_KEY")}}function Lo(e){try{J.fromHex(e)}catch(t){throw new K(String(t),"ERR_INVALID_PUBLIC_KEY")}}function wl(e){try{return wo(e,!0)}catch(t){throw new K(String(t),"ERR_INVALID_PRIVATE_KEY")}}var Jn=class{constructor(t){Lo(t),this._key=t}async verify(t,r){return await ml(this._key,r,t)}marshal(){return xl(this._key)}get bytes(){return Ee.encode({Type:ft.Secp256k1,Data:this.marshal()}).subarray()}equals(t){return st(this.bytes,t.bytes)}async hash(){let{bytes:t}=await Pt.digest(this.bytes);return t}},jn=class{constructor(t,r){this._key=t,this._publicKey=r??wl(t),vl(this._key),Lo(this._publicKey)}async sign(t){return await gl(this._key,t)}get public(){return new Jn(this._publicKey)}marshal(){return this._key}get bytes(){return Se.encode({Type:ft.Secp256k1,Data:this.marshal()}).subarray()}equals(t){return st(this.bytes,t.bytes)}async hash(){let{bytes:t}=await Pt.digest(this.bytes);return t}async id(){let t=await this.public.hash();return tt(t,"base58btc")}async export(t,r="libp2p-key"){if(r==="libp2p-key")return await dn(this.bytes,t);throw new K(`export format '${r}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}};function Q1(e){return new jn(e)}function Z1(e){return new Jn(e)}async function Y1(){let e=await yl();return new jn(e)}var Pr={rsa:So,ed25519:No,secp256k1:Do};function bl(e){let t=Object.keys(Pr).join(" / ");return new K(`invalid or unsupported key type ${e}. Must be ${t}`,"ERR_UNSUPPORTED_KEY_TYPE")}function El(e){let t=Ee.decode(e),r=t.Data??new Uint8Array;switch(t.Type){case ft.RSA:return Pr.rsa.unmarshalRsaPublicKey(r);case ft.Ed25519:return Pr.ed25519.unmarshalEd25519PublicKey(r);case ft.Secp256k1:return Pr.secp256k1.unmarshalSecp256k1PublicKey(r);default:throw bl(t.Type??"RSA")}}async function Sl(e){let t=Se.decode(e),r=t.Data??new Uint8Array;switch(t.Type){case ft.RSA:return await Pr.rsa.unmarshalRsaPrivateKey(r);case ft.Ed25519:return Pr.ed25519.unmarshalEd25519PrivateKey(r);case ft.Secp256k1:return Pr.secp256k1.unmarshalSecp256k1PrivateKey(r);default:throw bl(t.Type??"RSA")}}var Al={ERR_SIGNATURE_NOT_VALID:"ERR_SIGNATURE_NOT_VALID"};var Po=V(kn(),1),Bl=V(Ni(),1),Uo=V(Ln(),1),Cl=V(Di(),1),Tl=V(Fe(),1);function J1(){Tl.default._configure(),Po.default._configure(Bl.default),Uo.default._configure(Cl.default)}J1();var _l=["uint64","int64","sint64","fixed64","sfixed64"];function j1(e){for(let t of _l){if(e[t]==null)continue;let r=e[t];e[t]=function(){return BigInt(r.call(this).toString())}}return e}function Ko(e){return j1(new Po.default(e))}function tm(e){for(let t of _l){if(e[t]==null)continue;let r=e[t];e[t]=function(n){return r.call(this,n.toString())}}return e}function Fo(){return tm(Uo.default.create())}function mn(e,t){let r=Ko(e instanceof Uint8Array?e:e.subarray());return t.decode(r)}function xn(e,t){let r=Fo();return t.encode(e,r,{lengthDelimited:!1}),r.finish()}var ti;(function(e){e[e.VARINT=0]="VARINT",e[e.BIT64=1]="BIT64",e[e.LENGTH_DELIMITED=2]="LENGTH_DELIMITED",e[e.START_GROUP=3]="START_GROUP",e[e.END_GROUP=4]="END_GROUP",e[e.BIT32=5]="BIT32"})(ti||(ti={}));function Oo(e,t,r,n){return{name:e,type:t,encode:r,decode:n}}function vn(e,t){return Oo("message",ti.LENGTH_DELIMITED,e,t)}var ei;(function(e){let t;e.codec=()=>(t==null&&(t=vn((r,n,i={})=>{i.lengthDelimited!==!1&&n.fork(),(i.writeDefaults===!0||r.publicKey!=null&&r.publicKey.byteLength>0)&&(n.uint32(10),n.bytes(r.publicKey)),(i.writeDefaults===!0||r.payloadType!=null&&r.payloadType.byteLength>0)&&(n.uint32(18),n.bytes(r.payloadType)),(i.writeDefaults===!0||r.payload!=null&&r.payload.byteLength>0)&&(n.uint32(26),n.bytes(r.payload)),(i.writeDefaults===!0||r.signature!=null&&r.signature.byteLength>0)&&(n.uint32(42),n.bytes(r.signature)),i.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let i={publicKey:new Uint8Array(0),payloadType:new Uint8Array(0),payload:new Uint8Array(0),signature:new Uint8Array(0)},s=n==null?r.len:r.pos+n;for(;r.pos<s;){let a=r.uint32();switch(a>>>3){case 1:i.publicKey=r.bytes();break;case 2:i.payloadType=r.bytes();break;case 3:i.payload=r.bytes();break;case 5:i.signature=r.bytes();break;default:r.skipType(a&7);break}}return i})),t),e.encode=r=>xn(r,e.codec()),e.decode=r=>mn(r,e.codec())})(ei||(ei={}));var Il=Symbol.for("@libp2p/peer-id");var em=Symbol.for("nodejs.util.inspect.custom"),Rl=Object.values(Ze).map(e=>e.decoder).reduce((e,t)=>e.or(t),Ze.identity.decoder),kl=114,Mo=36,Vo=37,ri=class{constructor(t){this.type=t.type,this.multihash=t.multihash,this.privateKey=t.privateKey,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return`PeerId(${this.toString()})`}get[Il](){return!0}toString(){return this.string==null&&(this.string=mt.encode(this.multihash.bytes).slice(1)),this.string}toCID(){return nt.createV1(kl,this.multihash)}toBytes(){return this.multihash.bytes}toJSON(){return this.toString()}equals(t){if(t instanceof Uint8Array)return st(this.multihash.bytes,t);if(typeof t=="string")return rm(t).equals(this);if(t?.multihash?.bytes!=null)return st(this.multihash.bytes,t.multihash.bytes);throw new Error("not valid Id")}[em](){return`PeerId(${this.toString()})`}},Ur=class extends ri{constructor(t){super({...t,type:"RSA"}),this.type="RSA",this.publicKey=t.publicKey}},Kr=class extends ri{constructor(t){super({...t,type:"Ed25519"}),this.type="Ed25519",this.publicKey=t.multihash.digest}},Fr=class extends ri{constructor(t){super({...t,type:"secp256k1"}),this.type="secp256k1",this.publicKey=t.multihash.digest}};function wt(e){if(e.type==="RSA")return new Ur(e);if(e.type==="Ed25519")return new Kr(e);if(e.type==="secp256k1")return new Fr(e);throw new K("Not a PeerId","ERR_INVALID_PARAMETERS")}function rm(e,t){if(t=t??Rl,e.charAt(0)==="1"||e.charAt(0)==="Q"){let r=wr(mt.decode(`z${e}`));return e.startsWith("12D")?new Kr({multihash:r}):e.startsWith("16U")?new Fr({multihash:r}):new Ur({multihash:r})}return ni(Rl.decode(e))}function ni(e){try{let t=wr(e);if(t.code===Qe.code){if(t.digest.length===Mo)return new Kr({multihash:t});if(t.digest.length===Vo)return new Fr({multihash:t})}if(t.code===Pt.code)return new Ur({multihash:t})}catch{return nm(nt.decode(e))}throw new Error("Supplied PeerID CID is invalid")}function nm(e){if(e==null||e.multihash==null||e.version==null||e.version===1&&e.code!==kl)throw new Error("Supplied PeerID CID is invalid");let t=e.multihash;if(t.code===Pt.code)return new Ur({multihash:e.multihash});if(t.code===Qe.code){if(t.digest.length===Mo)return new Kr({multihash:e.multihash});if(t.digest.length===Vo)return new Fr({multihash:e.multihash})}throw new Error("Supplied PeerID CID is invalid")}async function Nl(e,t){return e.length===Mo?new Kr({multihash:xe(Qe.code,e),privateKey:t}):e.length===Vo?new Fr({multihash:xe(Qe.code,e),privateKey:t}):new Ur({multihash:await Pt.digest(e),publicKey:e,privateKey:t})}var Dl=Symbol.for("@achingbrain/uint8arraylist");function Ll(e,t){if(t==null||t<0)throw new RangeError("index is out of bounds");let r=0;for(let n of e){let i=r+n.byteLength;if(t<i)return{buf:n,index:t-r};r=i}throw new RangeError("index is out of bounds")}function gs(e){return Boolean(e?.[Dl])}var fr=class{constructor(...t){Object.defineProperty(this,Dl,{value:!0}),this.bufs=[],this.length=0,t.length>0&&this.appendAll(t)}*[Symbol.iterator](){yield*this.bufs}get byteLength(){return this.length}append(...t){this.appendAll(t)}appendAll(t){let r=0;for(let n of t)if(n instanceof Uint8Array)r+=n.byteLength,this.bufs.push(n);else if(gs(n))r+=n.byteLength,this.bufs.push(...n.bufs);else throw new Error("Could not append value, must be an Uint8Array or a Uint8ArrayList");this.length+=r}prepend(...t){this.prependAll(t)}prependAll(t){let r=0;for(let n of t.reverse())if(n instanceof Uint8Array)r+=n.byteLength,this.bufs.unshift(n);else if(gs(n))r+=n.byteLength,this.bufs.unshift(...n.bufs);else throw new Error("Could not prepend value, must be an Uint8Array or a Uint8ArrayList");this.length+=r}get(t){let r=Ll(this.bufs,t);return r.buf[r.index]}set(t,r){let n=Ll(this.bufs,t);n.buf[n.index]=r}write(t,r=0){if(t instanceof Uint8Array)for(let n=0;n<t.length;n++)this.set(r+n,t[n]);else if(gs(t))for(let n=0;n<t.length;n++)this.set(r+n,t.get(n));else throw new Error("Could not write value, must be an Uint8Array or a Uint8ArrayList")}consume(t){if(t=Math.trunc(t),!(Number.isNaN(t)||t<=0)){if(t===this.byteLength){this.bufs=[],this.length=0;return}for(;this.bufs.length>0;)if(t>=this.bufs[0].byteLength)t-=this.bufs[0].byteLength,this.length-=this.bufs[0].byteLength,this.bufs.shift();else{this.bufs[0]=this.bufs[0].subarray(t),this.length-=t;break}}}slice(t,r){let{bufs:n,length:i}=this._subList(t,r);return _t(n,i)}subarray(t,r){let{bufs:n,length:i}=this._subList(t,r);return n.length===1?n[0]:_t(n,i)}sublist(t,r){let{bufs:n,length:i}=this._subList(t,r),s=new fr;return s.length=i,s.bufs=n,s}_subList(t,r){if(t=t??0,r=r??this.length,t<0&&(t=this.length+t),r<0&&(r=this.length+r),t<0||r>this.length)throw new RangeError("index is out of bounds");if(t===r)return{bufs:[],length:0};if(t===0&&r===this.length)return{bufs:[...this.bufs],length:this.length};let n=[],i=0;for(let s=0;s<this.bufs.length;s++){let a=this.bufs[s],o=i,c=o+a.byteLength;if(i=c,t>=c)continue;let u=t>=o&&t<c,f=r>o&&r<=c;if(u&&f){if(t===o&&r===c){n.push(a);break}let l=t-o;n.push(a.subarray(l,l+(r-t)));break}if(u){if(t===0){n.push(a);continue}n.push(a.subarray(t-o));continue}if(f){if(r===c){n.push(a);break}n.push(a.subarray(0,r-o));break}n.push(a)}return{bufs:n,length:r-t}}indexOf(t,r=0){if(!gs(t)&&!(t instanceof Uint8Array))throw new TypeError('The "value" argument must be a Uint8ArrayList or Uint8Array');let n=t instanceof Uint8Array?t:t.subarray();if(r=Number(r??0),isNaN(r)&&(r=0),r<0&&(r=this.length+r),r<0&&(r=0),t.length===0)return r>this.length?this.length:r;let i=n.byteLength;if(i===0)throw new TypeError("search must be at least 1 byte long");let s=256,a=new Int32Array(s);for(let l=0;l<s;l++)a[l]=-1;for(let l=0;l<i;l++)a[n[l]]=l;let o=a,c=this.byteLength-n.byteLength,u=n.byteLength-1,f;for(let l=r;l<=c;l+=f){f=0;for(let h=u;h>=0;h--){let p=this.get(l+h);if(n[h]!==p){f=Math.max(1,h-o[p]);break}}if(f===0)return l}return-1}getInt8(t){let r=this.subarray(t,t+1);return new DataView(r.buffer,r.byteOffset,r.byteLength).getInt8(0)}setInt8(t,r){let n=Ue(1);new DataView(n.buffer,n.byteOffset,n.byteLength).setInt8(0,r),this.write(n,t)}getInt16(t,r){let n=this.subarray(t,t+2);return new DataView(n.buffer,n.byteOffset,n.byteLength).getInt16(0,r)}setInt16(t,r,n){let i=Pe(2);new DataView(i.buffer,i.byteOffset,i.byteLength).setInt16(0,r,n),this.write(i,t)}getInt32(t,r){let n=this.subarray(t,t+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getInt32(0,r)}setInt32(t,r,n){let i=Pe(4);new DataView(i.buffer,i.byteOffset,i.byteLength).setInt32(0,r,n),this.write(i,t)}getBigInt64(t,r){let n=this.subarray(t,t+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getBigInt64(0,r)}setBigInt64(t,r,n){let i=Pe(8);new DataView(i.buffer,i.byteOffset,i.byteLength).setBigInt64(0,r,n),this.write(i,t)}getUint8(t){let r=this.subarray(t,t+1);return new DataView(r.buffer,r.byteOffset,r.byteLength).getUint8(0)}setUint8(t,r){let n=Ue(1);new DataView(n.buffer,n.byteOffset,n.byteLength).setUint8(0,r),this.write(n,t)}getUint16(t,r){let n=this.subarray(t,t+2);return new DataView(n.buffer,n.byteOffset,n.byteLength).getUint16(0,r)}setUint16(t,r,n){let i=Pe(2);new DataView(i.buffer,i.byteOffset,i.byteLength).setUint16(0,r,n),this.write(i,t)}getUint32(t,r){let n=this.subarray(t,t+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getUint32(0,r)}setUint32(t,r,n){let i=Pe(4);new DataView(i.buffer,i.byteOffset,i.byteLength).setUint32(0,r,n),this.write(i,t)}getBigUint64(t,r){let n=this.subarray(t,t+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getBigUint64(0,r)}setBigUint64(t,r,n){let i=Pe(8);new DataView(i.buffer,i.byteOffset,i.byteLength).setBigUint64(0,r,n),this.write(i,t)}getFloat32(t,r){let n=this.subarray(t,t+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getFloat32(0,r)}setFloat32(t,r,n){let i=Pe(4);new DataView(i.buffer,i.byteOffset,i.byteLength).setFloat32(0,r,n),this.write(i,t)}getFloat64(t,r){let n=this.subarray(t,t+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getFloat64(0,r)}setFloat64(t,r,n){let i=Pe(8);new DataView(i.buffer,i.byteOffset,i.byteLength).setFloat64(0,r,n),this.write(i,t)}equals(t){if(t==null||!(t instanceof fr)||t.bufs.length!==this.bufs.length)return!1;for(let r=0;r<this.bufs.length;r++)if(!st(this.bufs[r],t.bufs[r]))return!1;return!0}static fromUint8Arrays(t,r){let n=new fr;return n.bufs=t,r==null&&(r=t.reduce((i,s)=>i+s.byteLength,0)),n.length=r,n}};function ms(e){return e instanceof Uint8Array?{get(t){return e[t]},set(t,r){e[t]=r}}:{get(t){return e.get(t)},set(t,r){e.set(t,r)}}}var Pl=4294967296,Jt=class{constructor(t=0,r=0){this.hi=t,this.lo=r}toBigInt(t){if(t===!0)return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n);if(this.hi>>>31){let r=~this.lo+1>>>0,n=~this.hi>>>0;return r===0&&(n=n+1>>>0),-(BigInt(r)+(BigInt(n)<<32n))}return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n)}toNumber(t){return Number(this.toBigInt(t))}zzDecode(){let t=-(this.lo&1),r=((this.lo>>>1|this.hi<<31)^t)>>>0,n=(this.hi>>>1^t)>>>0;return new Jt(n,r)}zzEncode(){let t=this.hi>>31,r=((this.hi<<1|this.lo>>>31)^t)>>>0,n=(this.lo<<1^t)>>>0;return new Jt(r,n)}toBytes(t,r=0){let n=ms(t);for(;this.hi>0;)n.set(r++,this.lo&127|128),this.lo=(this.lo>>>7|this.hi<<25)>>>0,this.hi>>>=7;for(;this.lo>127;)n.set(r++,this.lo&127|128),this.lo=this.lo>>>7;n.set(r++,this.lo)}static fromBigInt(t){if(t===0n)return new Jt;let r=t<0;r&&(t=-t);let n=Number(t>>32n)|0,i=Number(t-(BigInt(n)<<32n))|0;return r&&(n=~n>>>0,i=~i>>>0,++i>Pl&&(i=0,++n>Pl&&(n=0))),new Jt(n,i)}static fromNumber(t){if(t===0)return new Jt;let r=t<0;r&&(t=-t);let n=t>>>0,i=(t-n)/4294967296>>>0;return r&&(i=~i>>>0,n=~n>>>0,++n>4294967295&&(n=0,++i>4294967295&&(i=0))),new Jt(i,n)}static fromBytes(t,r=0){let n=ms(t),i=new Jt,s=0;if(t.length-r>4){for(;s<4;++s)if(i.lo=(i.lo|(n.get(r)&127)<<s*7)>>>0,n.get(r++)<128)return i;if(i.lo=(i.lo|(n.get(r)&127)<<28)>>>0,i.hi=(i.hi|(n.get(r)&127)>>4)>>>0,n.get(r++)<128)return i;s=0}else for(;s<4;++s){if(r>=t.length)throw RangeError(`index out of range: ${r} > ${t.length}`);if(i.lo=(i.lo|(n.get(r)&127)<<s*7)>>>0,n.get(r++)<128)return i}if(t.length-r>4){for(;s<5;++s)if(i.hi=(i.hi|(n.get(r)&127)<<s*7+3)>>>0,n.get(r++)<128)return i}else if(r<t.byteLength)for(;s<5;++s){if(r>=t.length)throw RangeError(`index out of range: ${r} > ${t.length}`);if(i.hi=(i.hi|(n.get(r)&127)<<s*7+3)>>>0,n.get(r++)<128)return i}throw RangeError("invalid varint encoding")}};var im=Math.pow(2,7),sm=Math.pow(2,14),am=Math.pow(2,21),om=Math.pow(2,28),cm=Math.pow(2,35),um=Math.pow(2,42),fm=Math.pow(2,49),lm=Math.pow(2,56),hm=Math.pow(2,63),ii={encodingLength(e){return e<im?1:e<sm?2:e<am?3:e<om?4:e<cm?5:e<um?6:e<fm?7:e<lm?8:e<hm?9:10},encode(e,t,r=0){if(Number.MAX_SAFE_INTEGER!=null&&e>Number.MAX_SAFE_INTEGER)throw new RangeError("Could not encode varint");return t==null&&(t=Ue(ii.encodingLength(e))),Jt.fromNumber(e).toBytes(t,r),t},decode(e,t=0){return Jt.fromBytes(e,t).toNumber(!0)}};var dm,jt=class{constructor(t){let{peerId:r,payloadType:n,payload:i,signature:s}=t;this.peerId=r,this.payloadType=n,this.payload=i,this.signature=s}marshal(){if(this.peerId.publicKey==null)throw new Error("Missing public key");return this.marshaled==null&&(this.marshaled=ei.encode({publicKey:this.peerId.publicKey,payloadType:this.payloadType,payload:this.payload.subarray(),signature:this.signature})),this.marshaled}equals(t){return st(this.marshal(),t.marshal())}async validate(t){let r=Kl(t,this.payloadType,this.payload);if(this.peerId.publicKey==null)throw new Error("Missing public key");return await El(this.peerId.publicKey).verify(r.subarray(),this.signature)}};dm=jt;jt.createFromProtobuf=async e=>{let t=ei.decode(e),r=await Nl(t.publicKey);return new jt({peerId:r,payloadType:t.payloadType,payload:t.payload,signature:t.signature})};jt.seal=async(e,t)=>{if(t.privateKey==null)throw new Error("Missing private key");let r=e.domain,n=e.codec,i=e.marshal(),s=Kl(r,n,i),o=await(await Sl(t.privateKey)).sign(s.subarray());return new jt({peerId:t,payloadType:n,payload:i,signature:o})};jt.openAndCertify=async(e,t)=>{let r=await jt.createFromProtobuf(e);if(!await r.validate(t))throw(0,Ul.default)(new Error("envelope signature is not valid for the given domain"),Al.ERR_SIGNATURE_NOT_VALID);return r};var Kl=(e,t,r)=>{let n=Tt(e),i=ii.encode(n.byteLength),s=ii.encode(t.length),a=ii.encode(r.length);return new fr(i,n,s,t,a,r)};function Fl(e,t){let r=(n,i)=>n.toString().localeCompare(i.toString());return e.length!==t.length?!1:(t.sort(r),e.sort(r).every((n,i)=>t[i].equals(n)))}var si;(function(e){let t;(function(n){let i;n.codec=()=>(i==null&&(i=vn((s,a,o={})=>{o.lengthDelimited!==!1&&a.fork(),(o.writeDefaults===!0||s.multiaddr!=null&&s.multiaddr.byteLength>0)&&(a.uint32(10),a.bytes(s.multiaddr)),o.lengthDelimited!==!1&&a.ldelim()},(s,a)=>{let o={multiaddr:new Uint8Array(0)},c=a==null?s.len:s.pos+a;for(;s.pos<c;){let u=s.uint32();switch(u>>>3){case 1:o.multiaddr=s.bytes();break;default:s.skipType(u&7);break}}return o})),i),n.encode=s=>xn(s,n.codec()),n.decode=s=>mn(s,n.codec())})(t=e.AddressInfo||(e.AddressInfo={}));let r;e.codec=()=>(r==null&&(r=vn((n,i,s={})=>{if(s.lengthDelimited!==!1&&i.fork(),(s.writeDefaults===!0||n.peerId!=null&&n.peerId.byteLength>0)&&(i.uint32(10),i.bytes(n.peerId)),(s.writeDefaults===!0||n.seq!==0n)&&(i.uint32(16),i.uint64(n.seq)),n.addresses!=null)for(let a of n.addresses)i.uint32(26),e.AddressInfo.codec().encode(a,i,{writeDefaults:!0});s.lengthDelimited!==!1&&i.ldelim()},(n,i)=>{let s={peerId:new Uint8Array(0),seq:0n,addresses:[]},a=i==null?n.len:n.pos+i;for(;n.pos<a;){let o=n.uint32();switch(o>>>3){case 1:s.peerId=n.bytes();break;case 2:s.seq=n.uint64();break;case 3:s.addresses.push(e.AddressInfo.codec().decode(n,n.uint32()));break;default:n.skipType(o&7);break}}return s})),r),e.encode=n=>xn(n,e.codec()),e.decode=n=>mn(n,e.codec())})(si||(si={}));var Ol="libp2p-peer-record",Ml=Uint8Array.from([3,1]);var Wt=class{constructor(t){this.domain=Wt.DOMAIN,this.codec=Wt.CODEC;let{peerId:r,multiaddrs:n,seqNumber:i}=t;this.peerId=r,this.multiaddrs=n??[],this.seqNumber=i??BigInt(Date.now())}marshal(){return this.marshaled==null&&(this.marshaled=si.encode({peerId:this.peerId.toBytes(),seq:BigInt(this.seqNumber),addresses:this.multiaddrs.map(t=>({multiaddr:t.bytes}))})),this.marshaled}equals(t){return!(!(t instanceof Wt)||!this.peerId.equals(t.peerId)||this.seqNumber!==t.seqNumber||!Fl(this.multiaddrs,t.multiaddrs))}};Wt.createFromProtobuf=e=>{let t=si.decode(e),r=ni(t.peerId),n=(t.addresses??[]).map(s=>In(s.multiaddr)),i=t.seq;return new Wt({peerId:r,multiaddrs:n,seqNumber:i})};Wt.DOMAIN=Ol;Wt.CODEC=Ml;var rt=re("libp2p:peer-store:address-book"),xs="change:multiaddrs";async function pm(){return!0}var vs=class{constructor(t,r,n){this.dispatchEvent=t,this.store=r,this.addressFilter=n??pm}async consumePeerRecord(t){rt.trace("consumePeerRecord await write lock");let r=await this.store.lock.writeLock();rt.trace("consumePeerRecord got write lock");let n,i,s;try{let a;try{a=Wt.createFromProtobuf(t.payload)}catch{return rt.error("invalid peer record received"),!1}n=a.peerId;let o=a.multiaddrs;if(!n.equals(t.peerId))return rt("signing key does not match PeerId in the PeerRecord"),!1;if(o==null||o.length===0)return!1;if(await this.store.has(n)&&(i=await this.store.load(n),i.peerRecordEnvelope!=null)){let u=await jt.createFromProtobuf(i.peerRecordEnvelope),f=Wt.createFromProtobuf(u.payload);if(f.seqNumber>=a.seqNumber)return rt("sequence number was lower or equal to existing sequence number - stored: %d received: %d",f.seqNumber,a.seqNumber),!1}let c=await qo(n,o,this.addressFilter,!0);s=await this.store.patchOrCreate(n,{addresses:c,peerRecordEnvelope:t.marshal().subarray()}),rt("stored provided peer record for %p",a.peerId)}finally{rt.trace("consumePeerRecord release write lock"),r()}return this.dispatchEvent(new xt(xs,{detail:{peerId:n,multiaddrs:s.addresses.map(({multiaddr:a})=>a),oldMultiaddrs:i==null?[]:i.addresses.map(({multiaddr:a})=>a)}})),!0}async getRawEnvelope(t){rt.trace("getRawEnvelope await read lock");let r=await this.store.lock.readLock();rt.trace("getRawEnvelope got read lock");try{return(await this.store.load(t)).peerRecordEnvelope}catch(n){if(n.code!==M.ERR_NOT_FOUND)throw n}finally{rt.trace("getRawEnvelope release read lock"),r()}}async getPeerRecord(t){let r=await this.getRawEnvelope(t);if(r!=null)return await jt.createFromProtobuf(r)}async get(t){t=wt(t),rt.trace("get wait for read lock");let r=await this.store.lock.readLock();rt.trace("get got read lock");try{return(await this.store.load(t)).addresses}catch(n){if(n.code!==M.ERR_NOT_FOUND)throw n}finally{rt.trace("get release read lock"),r()}return[]}async set(t,r){if(t=wt(t),!Array.isArray(r))throw rt.error("multiaddrs must be an array of Multiaddrs"),new K("multiaddrs must be an array of Multiaddrs",M.ERR_INVALID_PARAMETERS);rt.trace("set await write lock");let n=await this.store.lock.writeLock();rt.trace("set got write lock");let i=!1,s,a;try{let o=await qo(t,r,this.addressFilter);if(o.length===0)return;try{if(s=await this.store.load(t),i=!0,new Set([...o.map(({multiaddr:c})=>c.toString()),...s.addresses.map(({multiaddr:c})=>c.toString())]).size===s.addresses.length&&o.length===s.addresses.length)return}catch(c){if(c.code!==M.ERR_NOT_FOUND)throw c}a=await this.store.patchOrCreate(t,{addresses:o}),rt("set multiaddrs for %p",t)}finally{rt.trace("set multiaddrs for %p",t),rt("set release write lock"),n()}this.dispatchEvent(new xt(xs,{detail:{peerId:t,multiaddrs:a.addresses.map(o=>o.multiaddr),oldMultiaddrs:s==null?[]:s.addresses.map(({multiaddr:o})=>o)}})),i||this.dispatchEvent(new xt("peer",{detail:{id:t,multiaddrs:a.addresses.map(o=>o.multiaddr),protocols:a.protocols}}))}async add(t,r){if(t=wt(t),!Array.isArray(r))throw rt.error("multiaddrs must be an array of Multiaddrs"),new K("multiaddrs must be an array of Multiaddrs",M.ERR_INVALID_PARAMETERS);rt.trace("add await write lock");let n=await this.store.lock.writeLock();rt.trace("add got write lock");let i,s,a;try{let o=await qo(t,r,this.addressFilter);if(o.length===0)return;try{if(s=await this.store.load(t),i=!0,new Set([...o.map(({multiaddr:c})=>c.toString()),...s.addresses.map(({multiaddr:c})=>c.toString())]).size===s.addresses.length)return}catch(c){if(c.code!==M.ERR_NOT_FOUND)throw c}a=await this.store.mergeOrCreate(t,{addresses:o}),rt("added multiaddrs for %p",t)}finally{rt.trace("set release write lock"),n()}this.dispatchEvent(new xt(xs,{detail:{peerId:t,multiaddrs:a.addresses.map(o=>o.multiaddr),oldMultiaddrs:s==null?[]:s.addresses.map(({multiaddr:o})=>o)}})),i===!0&&this.dispatchEvent(new xt("peer",{detail:{id:t,multiaddrs:a.addresses.map(o=>o.multiaddr),protocols:a.protocols}}))}async delete(t){t=wt(t),rt.trace("delete await write lock");let r=await this.store.lock.writeLock();rt.trace("delete got write lock");let n;try{try{n=await this.store.load(t)}catch(i){if(i.code!==M.ERR_NOT_FOUND)throw i}await this.store.patchOrCreate(t,{addresses:[]})}finally{rt.trace("delete release write lock"),r()}n!=null&&this.dispatchEvent(new xt(xs,{detail:{peerId:t,multiaddrs:[],oldMultiaddrs:n==null?[]:n.addresses.map(({multiaddr:i})=>i)}}))}};async function qo(e,t,r,n=!1){let i=[];return await Promise.all(t.map(async s=>{if(!Ca(s))throw rt.error("multiaddr must be an instance of Multiaddr"),new K("multiaddr must be an instance of Multiaddr",M.ERR_INVALID_PARAMETERS);await r(e,s)&&i.push({multiaddr:s,isCertified:n})})),i}var Ne=re("libp2p:peer-store:key-book"),Vl="change:pubkey",ws=class{constructor(t,r){this.dispatchEvent=t,this.store=r}async set(t,r){if(t=wt(t),!(r instanceof Uint8Array))throw Ne.error("publicKey must be an instance of Uint8Array to store data"),new K("publicKey must be an instance of PublicKey",M.ERR_INVALID_PARAMETERS);Ne.trace("set await write lock");let n=await this.store.lock.writeLock();Ne.trace("set got write lock");let i=!1,s;try{try{if(s=await this.store.load(t),s.pubKey!=null&&st(s.pubKey,r))return}catch(a){if(a.code!==M.ERR_NOT_FOUND)throw a}await this.store.patchOrCreate(t,{pubKey:r}),i=!0}finally{Ne.trace("set release write lock"),n()}i&&this.dispatchEvent(new xt(Vl,{detail:{peerId:t,publicKey:r,oldPublicKey:s?.pubKey}}))}async get(t){t=wt(t),Ne.trace("get await write lock");let r=await this.store.lock.readLock();Ne.trace("get got write lock");try{return(await this.store.load(t)).pubKey}catch(n){if(n.code!==M.ERR_NOT_FOUND)throw n}finally{Ne("get release write lock"),r()}}async delete(t){t=wt(t),Ne.trace("delete await write lock");let r=await this.store.lock.writeLock();Ne.trace("delete got write lock");let n;try{try{n=await this.store.load(t)}catch(i){if(i.code!==M.ERR_NOT_FOUND)throw i}await this.store.patchOrCreate(t,{pubKey:void 0})}catch(i){if(i.code!==M.ERR_NOT_FOUND)throw i}finally{Ne.trace("delete release write lock"),r()}this.dispatchEvent(new xt(Vl,{detail:{peerId:t,publicKey:void 0,oldPublicKey:n?.pubKey}}))}};var At=re("libp2p:peer-store:metadata-book"),bs="change:metadata",Es=class{constructor(t,r){this.dispatchEvent=t,this.store=r}async get(t){t=wt(t),At.trace("get await read lock");let r=await this.store.lock.readLock();At.trace("get got read lock");try{return(await this.store.load(t)).metadata}catch(n){if(n.code!==M.ERR_NOT_FOUND)throw n}finally{At.trace("get release read lock"),r()}return new Map}async getValue(t,r){t=wt(t),At.trace("getValue await read lock");let n=await this.store.lock.readLock();At.trace("getValue got read lock");try{return(await this.store.load(t)).metadata.get(r)}catch(i){if(i.code!==M.ERR_NOT_FOUND)throw i}finally{At.trace("getValue release write lock"),n()}}async set(t,r){if(t=wt(t),!(r instanceof Map))throw At.error("valid metadata must be provided to store data"),new K("valid metadata must be provided",M.ERR_INVALID_PARAMETERS);At.trace("set await write lock");let n=await this.store.lock.writeLock();At.trace("set got write lock");let i;try{try{i=await this.store.load(t)}catch(s){if(s.code!==M.ERR_NOT_FOUND)throw s}await this.store.mergeOrCreate(t,{metadata:r})}finally{At.trace("set release write lock"),n()}this.dispatchEvent(new xt(bs,{detail:{peerId:t,metadata:r,oldMetadata:i==null?new Map:i.metadata}}))}async setValue(t,r,n){if(t=wt(t),typeof r!="string"||!(n instanceof Uint8Array))throw At.error("valid key and value must be provided to store data"),new K("valid key and value must be provided",M.ERR_INVALID_PARAMETERS);At.trace("setValue await write lock");let i=await this.store.lock.writeLock();At.trace("setValue got write lock");let s,a;try{try{s=await this.store.load(t);let o=s.metadata.get(r);if(o!=null&&st(n,o))return}catch(o){if(o.code!==M.ERR_NOT_FOUND)throw o}a=await this.store.mergeOrCreate(t,{metadata:new Map([[r,n]])})}finally{At.trace("setValue release write lock"),i()}this.dispatchEvent(new xt(bs,{detail:{peerId:t,metadata:a.metadata,oldMetadata:s==null?new Map:s.metadata}}))}async delete(t){t=wt(t),At.trace("delete await write lock");let r=await this.store.lock.writeLock();At.trace("delete got write lock");let n;try{try{n=await this.store.load(t)}catch(i){if(i.code!==M.ERR_NOT_FOUND)throw i}n!=null&&await this.store.patch(t,{metadata:new Map})}finally{At.trace("delete release write lock"),r()}n!=null&&this.dispatchEvent(new xt(bs,{detail:{peerId:t,metadata:new Map,oldMetadata:n.metadata}}))}async deleteValue(t,r){t=wt(t),At.trace("deleteValue await write lock");let n=await this.store.lock.writeLock();At.trace("deleteValue got write lock");let i,s;try{s=await this.store.load(t),i=s.metadata,i.delete(r),await this.store.patch(t,{metadata:i})}catch(a){if(a.code!==M.ERR_NOT_FOUND)throw a}finally{At.trace("deleteValue release write lock"),n()}i!=null&&this.dispatchEvent(new xt(bs,{detail:{peerId:t,metadata:i,oldMetadata:s==null?new Map:s.metadata}}))}};var Bt=re("libp2p:peer-store:proto-book"),Ss="change:protocols",As=class{constructor(t,r){this.dispatchEvent=t,this.store=r}async get(t){Bt.trace("get wait for read lock");let r=await this.store.lock.readLock();Bt.trace("get got read lock");try{return(await this.store.load(t)).protocols}catch(n){if(n.code!==M.ERR_NOT_FOUND)throw n}finally{Bt.trace("get release read lock"),r()}return[]}async set(t,r){if(t=wt(t),!Array.isArray(r))throw Bt.error("protocols must be provided to store data"),new K("protocols must be provided",M.ERR_INVALID_PARAMETERS);Bt.trace("set await write lock");let n=await this.store.lock.writeLock();Bt.trace("set got write lock");let i,s;try{try{if(i=await this.store.load(t),new Set([...r]).size===i.protocols.length)return}catch(a){if(a.code!==M.ERR_NOT_FOUND)throw a}s=await this.store.patchOrCreate(t,{protocols:r}),Bt("stored provided protocols for %p",t)}finally{Bt.trace("set release write lock"),n()}this.dispatchEvent(new xt(Ss,{detail:{peerId:t,protocols:s.protocols,oldProtocols:i==null?[]:i.protocols}}))}async add(t,r){if(t=wt(t),!Array.isArray(r))throw Bt.error("protocols must be provided to store data"),new K("protocols must be provided",M.ERR_INVALID_PARAMETERS);Bt.trace("add await write lock");let n=await this.store.lock.writeLock();Bt.trace("add got write lock");let i,s;try{try{if(i=await this.store.load(t),new Set([...i.protocols,...r]).size===i.protocols.length)return}catch(a){if(a.code!==M.ERR_NOT_FOUND)throw a}s=await this.store.mergeOrCreate(t,{protocols:r}),Bt("added provided protocols for %p",t)}finally{Bt.trace("add release write lock"),n()}this.dispatchEvent(new xt(Ss,{detail:{peerId:t,protocols:s.protocols,oldProtocols:i==null?[]:i.protocols}}))}async remove(t,r){if(t=wt(t),!Array.isArray(r))throw Bt.error("protocols must be provided to store data"),new K("protocols must be provided",M.ERR_INVALID_PARAMETERS);Bt.trace("remove await write lock");let n=await this.store.lock.writeLock();Bt.trace("remove got write lock");let i,s;try{try{i=await this.store.load(t);let a=new Set(i.protocols);for(let o of r)a.delete(o);if(i.protocols.length===a.size)return;r=Array.from(a)}catch(a){if(a.code!==M.ERR_NOT_FOUND)throw a}s=await this.store.patchOrCreate(t,{protocols:r})}finally{Bt.trace("remove release write lock"),n()}this.dispatchEvent(new xt(Ss,{detail:{peerId:t,protocols:s.protocols,oldProtocols:i==null?[]:i.protocols}}))}async delete(t){t=wt(t),Bt.trace("delete await write lock");let r=await this.store.lock.writeLock();Bt.trace("delete got write lock");let n;try{try{n=await this.store.load(t)}catch(i){if(i.code!==M.ERR_NOT_FOUND)throw i}await this.store.patchOrCreate(t,{protocols:[]})}finally{Bt.trace("delete release write lock"),r()}n!=null&&this.dispatchEvent(new xt(Ss,{detail:{peerId:t,protocols:[],oldProtocols:n.protocols}}))}};var Bs=(e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce((t,r)=>(r&=63,r<36?t+=r.toString(36):r<62?t+=(r-26).toString(36).toUpperCase():r>62?t+="-":t+="_",t),"");var He="/",ql=new TextEncoder().encode(He),Cs=ql[0],Ut=class{constructor(t,r){if(typeof t=="string")this._buf=Tt(t);else if(t instanceof Uint8Array)this._buf=t;else throw new Error("Invalid key, should be String of Uint8Array");if(r==null&&(r=!0),r&&this.clean(),this._buf.byteLength===0||this._buf[0]!==Cs)throw new Error("Invalid key")}toString(t="utf8"){return tt(this._buf,t)}uint8Array(){return this._buf}get[Symbol.toStringTag](){return`Key(${this.toString()})`}static withNamespaces(t){return new Ut(t.join(He))}static random(){return new Ut(Bs().replace(/-/g,""))}static asKey(t){return t instanceof Uint8Array||typeof t=="string"?new Ut(t):typeof t.uint8Array=="function"?new Ut(t.uint8Array()):null}clean(){if((this._buf==null||this._buf.byteLength===0)&&(this._buf=ql),this._buf[0]!==Cs){let t=new Uint8Array(this._buf.byteLength+1);t.fill(Cs,0,1),t.set(this._buf,1),this._buf=t}for(;this._buf.byteLength>1&&this._buf[this._buf.byteLength-1]===Cs;)this._buf=this._buf.subarray(0,-1)}less(t){let r=this.list(),n=t.list();for(let i=0;i<r.length;i++){if(n.length<i+1)return!1;let s=r[i],a=n[i];if(s<a)return!0;if(s>a)return!1}return r.length<n.length}reverse(){return Ut.withNamespaces(this.list().slice().reverse())}namespaces(){return this.list()}baseNamespace(){let t=this.namespaces();return t[t.length-1]}list(){return this.toString().split(He).slice(1)}type(){return ym(this.baseNamespace())}name(){return gm(this.baseNamespace())}instance(t){return new Ut(this.toString()+":"+t)}path(){let t=this.parent().toString();return t.endsWith(He)||(t+=He),t+=this.type(),new Ut(t)}parent(){let t=this.list();return t.length===1?new Ut(He):new Ut(t.slice(0,-1).join(He))}child(t){return this.toString()===He?t:t.toString()===He?this:new Ut(this.toString()+t.toString(),!1)}isAncestorOf(t){return t.toString()===this.toString()?!1:t.toString().startsWith(this.toString())}isDecendantOf(t){return t.toString()===this.toString()?!1:this.toString().startsWith(t.toString())}isTopLevel(){return this.list().length===1}concat(...t){return Ut.withNamespaces([...this.namespaces(),...mm(t.map(r=>r.namespaces()))])}};function ym(e){let t=e.split(":");return t.length<2?"":t.slice(0,-1).join(":")}function gm(e){let t=e.split(":");return t[t.length-1]}function mm(e){return[].concat(...e)}var zo=V(kn(),1),zl=V(Ni(),1),Hl=V(Fe(),1),Ho=V(Ln(),1),Gl=V(Di(),1);function xm(){Hl.default._configure(),zo.default._configure(zl.default),Ho.default._configure(Gl.default)}xm();var Wl=["uint64","int64","sint64","fixed64","sfixed64"];function vm(e){for(let t of Wl){if(e[t]==null)continue;let r=e[t];e[t]=function(){return BigInt(r.call(this).toString())}}return e}function Go(e){return vm(new zo.default(e))}function wm(e){for(let t of Wl){if(e[t]==null)continue;let r=e[t];e[t]=function(n){return r.call(this,n.toString())}}return e}function Wo(){return wm(Ho.default.create())}function lr(e,t){let r=Go(e instanceof Uint8Array?e:e.subarray());return t.decode(r)}function hr(e,t){let r=Wo();return t.encode(e,r,{lengthDelimited:!1}),r.finish()}var ai;(function(e){e[e.VARINT=0]="VARINT",e[e.BIT64=1]="BIT64",e[e.LENGTH_DELIMITED=2]="LENGTH_DELIMITED",e[e.START_GROUP=3]="START_GROUP",e[e.END_GROUP=4]="END_GROUP",e[e.BIT32=5]="BIT32"})(ai||(ai={}));function $o(e,t,r,n){return{name:e,type:t,encode:r,decode:n}}function dr(e,t){return $o("message",ai.LENGTH_DELIMITED,e,t)}var oi;(function(e){let t;e.codec=()=>(t==null&&(t=dr((r,n,i={})=>{if(i.lengthDelimited!==!1&&n.fork(),r.addresses!=null)for(let s of r.addresses)n.uint32(10),Ts.codec().encode(s,n);if(r.protocols!=null)for(let s of r.protocols)n.uint32(18),n.string(s);if(r.metadata!=null)for(let s of r.metadata)n.uint32(26),_s.codec().encode(s,n);r.pubKey!=null&&(n.uint32(34),n.bytes(r.pubKey)),r.peerRecordEnvelope!=null&&(n.uint32(42),n.bytes(r.peerRecordEnvelope)),i.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let i={addresses:[],protocols:[],metadata:[]},s=n==null?r.len:r.pos+n;for(;r.pos<s;){let a=r.uint32();switch(a>>>3){case 1:i.addresses.push(Ts.codec().decode(r,r.uint32()));break;case 2:i.protocols.push(r.string());break;case 3:i.metadata.push(_s.codec().decode(r,r.uint32()));break;case 4:i.pubKey=r.bytes();break;case 5:i.peerRecordEnvelope=r.bytes();break;default:r.skipType(a&7);break}}return i})),t),e.encode=r=>hr(r,e.codec()),e.decode=r=>lr(r,e.codec())})(oi||(oi={}));var Ts;(function(e){let t;e.codec=()=>(t==null&&(t=dr((r,n,i={})=>{i.lengthDelimited!==!1&&n.fork(),r.multiaddr!=null&&r.multiaddr.byteLength>0&&(n.uint32(10),n.bytes(r.multiaddr)),r.isCertified!=null&&(n.uint32(16),n.bool(r.isCertified)),i.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let i={multiaddr:new Uint8Array(0)},s=n==null?r.len:r.pos+n;for(;r.pos<s;){let a=r.uint32();switch(a>>>3){case 1:i.multiaddr=r.bytes();break;case 2:i.isCertified=r.bool();break;default:r.skipType(a&7);break}}return i})),t),e.encode=r=>hr(r,e.codec()),e.decode=r=>lr(r,e.codec())})(Ts||(Ts={}));var _s;(function(e){let t;e.codec=()=>(t==null&&(t=dr((r,n,i={})=>{i.lengthDelimited!==!1&&n.fork(),r.key!=null&&r.key!==""&&(n.uint32(10),n.string(r.key)),r.value!=null&&r.value.byteLength>0&&(n.uint32(18),n.bytes(r.value)),i.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let i={key:"",value:new Uint8Array(0)},s=n==null?r.len:r.pos+n;for(;r.pos<s;){let a=r.uint32();switch(a>>>3){case 1:i.key=r.string();break;case 2:i.value=r.bytes();break;default:r.skipType(a&7);break}}return i})),t),e.encode=r=>hr(r,e.codec()),e.decode=r=>lr(r,e.codec())})(_s||(_s={}));var nh=V(Ql(),1);var ui=class extends Error{constructor(t){super(t),this.name="TimeoutError"}},Zo=class extends Error{constructor(t){super(),this.name="AbortError",this.message=t}},Zl=e=>globalThis.DOMException===void 0?new Zo(e):new DOMException(e),Yl=e=>{let t=e.reason===void 0?Zl("This operation was aborted."):e.reason;return t instanceof Error?t:Zl(t)};function Yo(e,t,r,n){let i,s=new Promise((a,o)=>{if(typeof t!="number"||Math.sign(t)!==1)throw new TypeError(`Expected \`milliseconds\` to be a positive number, got \`${t}\``);if(t===Number.POSITIVE_INFINITY){a(e);return}if(n={customTimers:{setTimeout,clearTimeout},...n},n.signal){let{signal:c}=n;c.aborted&&o(Yl(c)),c.addEventListener("abort",()=>{o(Yl(c))})}i=n.customTimers.setTimeout.call(void 0,()=>{if(typeof r=="function"){try{a(r())}catch(f){o(f)}return}let c=typeof r=="string"?r:`Promise timed out after ${t} milliseconds`,u=r instanceof Error?r:new ui(c);typeof e.cancel=="function"&&e.cancel(),o(u)},t),(async()=>{try{a(await e)}catch(c){o(c)}finally{n.customTimers.clearTimeout.call(void 0,i)}})()});return s.clear=()=>{clearTimeout(i),i=void 0},s}function Xo(e,t,r){let n=0,i=e.length;for(;i>0;){let s=Math.trunc(i/2),a=n+s;r(e[a],t)<=0?(n=++a,i-=s+1):i=s}return n}var Or=function(e,t,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(e):n?n.value:t.get(e)},Ge,fi=class{constructor(){Ge.set(this,[])}enqueue(t,r){r={priority:0,...r};let n={priority:r.priority,run:t};if(this.size&&Or(this,Ge,"f")[this.size-1].priority>=r.priority){Or(this,Ge,"f").push(n);return}let i=Xo(Or(this,Ge,"f"),n,(s,a)=>a.priority-s.priority);Or(this,Ge,"f").splice(i,0,n)}dequeue(){let t=Or(this,Ge,"f").shift();return t?.run}filter(t){return Or(this,Ge,"f").filter(r=>r.priority===t.priority).map(r=>r.run)}get size(){return Or(this,Ge,"f").length}};Ge=new WeakMap;var pt=function(e,t,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(e,r):i?i.value=r:t.set(e,r),r},k=function(e,t,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(e):n?n.value:t.get(e)},bt,hi,di,yr,Ps,pi,Rs,ge,li,te,ks,ee,yi,pr,Ns,Xl,Jl,eh,jl,th,Ls,Jo,jo,Us,rh,Ds,Ks=class extends Error{},wn=class extends nh.default{constructor(t){var r,n,i,s;if(super(),bt.add(this),hi.set(this,void 0),di.set(this,void 0),yr.set(this,0),Ps.set(this,void 0),pi.set(this,void 0),Rs.set(this,0),ge.set(this,void 0),li.set(this,void 0),te.set(this,void 0),ks.set(this,void 0),ee.set(this,0),yi.set(this,void 0),pr.set(this,void 0),Ns.set(this,void 0),Object.defineProperty(this,"timeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),t={carryoverConcurrencyCount:!1,intervalCap:Number.POSITIVE_INFINITY,interval:0,concurrency:Number.POSITIVE_INFINITY,autoStart:!0,queueClass:fi,...t},!(typeof t.intervalCap=="number"&&t.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${(n=(r=t.intervalCap)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:""}\` (${typeof t.intervalCap})`);if(t.interval===void 0||!(Number.isFinite(t.interval)&&t.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${(s=(i=t.interval)===null||i===void 0?void 0:i.toString())!==null&&s!==void 0?s:""}\` (${typeof t.interval})`);pt(this,hi,t.carryoverConcurrencyCount,"f"),pt(this,di,t.intervalCap===Number.POSITIVE_INFINITY||t.interval===0,"f"),pt(this,Ps,t.intervalCap,"f"),pt(this,pi,t.interval,"f"),pt(this,te,new t.queueClass,"f"),pt(this,ks,t.queueClass,"f"),this.concurrency=t.concurrency,this.timeout=t.timeout,pt(this,Ns,t.throwOnTimeout===!0,"f"),pt(this,pr,t.autoStart===!1,"f")}get concurrency(){return k(this,yi,"f")}set concurrency(t){if(!(typeof t=="number"&&t>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${t}\` (${typeof t})`);pt(this,yi,t,"f"),k(this,bt,"m",Us).call(this)}async add(t,r={}){return r={timeout:this.timeout,throwOnTimeout:k(this,Ns,"f"),...r},new Promise((n,i)=>{k(this,te,"f").enqueue(async()=>{var s,a,o;pt(this,ee,(a=k(this,ee,"f"),a++,a),"f"),pt(this,yr,(o=k(this,yr,"f"),o++,o),"f");try{if(!((s=r.signal)===null||s===void 0)&&s.aborted)throw new Ks("The task was aborted.");let c=t({signal:r.signal});r.timeout&&(c=Yo(Promise.resolve(c),r.timeout)),r.signal&&(c=Promise.race([c,k(this,bt,"m",rh).call(this,r.signal)]));let u=await c;n(u),this.emit("completed",u)}catch(c){if(c instanceof ui&&!r.throwOnTimeout){n();return}i(c),this.emit("error",c)}finally{k(this,bt,"m",eh).call(this)}},r),this.emit("add"),k(this,bt,"m",Ls).call(this)})}async addAll(t,r){return Promise.all(t.map(async n=>this.add(n,r)))}start(){return k(this,pr,"f")?(pt(this,pr,!1,"f"),k(this,bt,"m",Us).call(this),this):this}pause(){pt(this,pr,!0,"f")}clear(){pt(this,te,new(k(this,ks,"f")),"f")}async onEmpty(){k(this,te,"f").size!==0&&await k(this,bt,"m",Ds).call(this,"empty")}async onSizeLessThan(t){k(this,te,"f").size<t||await k(this,bt,"m",Ds).call(this,"next",()=>k(this,te,"f").size<t)}async onIdle(){k(this,ee,"f")===0&&k(this,te,"f").size===0||await k(this,bt,"m",Ds).call(this,"idle")}get size(){return k(this,te,"f").size}sizeBy(t){return k(this,te,"f").filter(t).length}get pending(){return k(this,ee,"f")}get isPaused(){return k(this,pr,"f")}};hi=new WeakMap,di=new WeakMap,yr=new WeakMap,Ps=new WeakMap,pi=new WeakMap,Rs=new WeakMap,ge=new WeakMap,li=new WeakMap,te=new WeakMap,ks=new WeakMap,ee=new WeakMap,yi=new WeakMap,pr=new WeakMap,Ns=new WeakMap,bt=new WeakSet,Xl=function(){return k(this,di,"f")||k(this,yr,"f")<k(this,Ps,"f")},Jl=function(){return k(this,ee,"f")<k(this,yi,"f")},eh=function(){var t;pt(this,ee,(t=k(this,ee,"f"),t--,t),"f"),k(this,bt,"m",Ls).call(this),this.emit("next")},jl=function(){k(this,bt,"m",jo).call(this),k(this,bt,"m",Jo).call(this),pt(this,li,void 0,"f")},th=function(){let t=Date.now();if(k(this,ge,"f")===void 0){let r=k(this,Rs,"f")-t;if(r<0)pt(this,yr,k(this,hi,"f")?k(this,ee,"f"):0,"f");else return k(this,li,"f")===void 0&&pt(this,li,setTimeout(()=>{k(this,bt,"m",jl).call(this)},r),"f"),!0}return!1},Ls=function(){if(k(this,te,"f").size===0)return k(this,ge,"f")&&clearInterval(k(this,ge,"f")),pt(this,ge,void 0,"f"),this.emit("empty"),k(this,ee,"f")===0&&this.emit("idle"),!1;if(!k(this,pr,"f")){let t=!k(this,bt,"a",th);if(k(this,bt,"a",Xl)&&k(this,bt,"a",Jl)){let r=k(this,te,"f").dequeue();return r?(this.emit("active"),r(),t&&k(this,bt,"m",Jo).call(this),!0):!1}}return!1},Jo=function(){k(this,di,"f")||k(this,ge,"f")!==void 0||(pt(this,ge,setInterval(()=>{k(this,bt,"m",jo).call(this)},k(this,pi,"f")),"f"),pt(this,Rs,Date.now()+k(this,pi,"f"),"f"))},jo=function(){k(this,yr,"f")===0&&k(this,ee,"f")===0&&k(this,ge,"f")&&(clearInterval(k(this,ge,"f")),pt(this,ge,void 0,"f")),pt(this,yr,k(this,hi,"f")?k(this,ee,"f"):0,"f"),k(this,bt,"m",Us).call(this)},Us=function(){for(;k(this,bt,"m",Ls).call(this););},rh=async function(t){return new Promise((r,n)=>{t.addEventListener("abort",()=>{n(new Ks("The task was aborted."))},{once:!0})})},Ds=async function(t,r){return new Promise(n=>{let i=()=>{r&&!r()||(this.off(t,i),n())};this.on(t,i)})};var t0=class extends Error{constructor(t){super(t),this.name="TimeoutError"}},e0=class extends Error{constructor(t){super(),this.name="AbortError",this.message=t}},ih=e=>globalThis.DOMException===void 0?new e0(e):new DOMException(e),sh=e=>{let t=e.reason===void 0?ih("This operation was aborted."):e.reason;return t instanceof Error?t:ih(t)};function r0(e,t){let{milliseconds:r,fallback:n,message:i,customTimers:s={setTimeout,clearTimeout}}=t,a,o=new Promise((c,u)=>{if(typeof r!="number"||Math.sign(r)!==1)throw new TypeError(`Expected \`milliseconds\` to be a positive number, got \`${r}\``);if(r===Number.POSITIVE_INFINITY){c(e);return}if(t.signal){let{signal:l}=t;l.aborted&&u(sh(l)),l.addEventListener("abort",()=>{u(sh(l))})}let f=new t0;a=s.setTimeout.call(void 0,()=>{if(n){try{c(n())}catch(l){u(l)}return}typeof e.cancel=="function"&&e.cancel(),i===!1?c():i instanceof Error?u(i):(f.message=i??`Promise timed out after ${r} milliseconds`,u(f))},r),(async()=>{try{c(await e)}catch(l){u(l)}finally{s.clearTimeout.call(void 0,a)}})()});return o.clear=()=>{s.clearTimeout.call(void 0,a),a=void 0},o}var n0="lock:worker:request-read",i0="lock:worker:release-read",s0="lock:master:grant-read",a0="lock:worker:request-write",o0="lock:worker:release-write",c0="lock:master:grant-write";var gr={},bn=e=>{e.addEventListener("message",t=>{bn.dispatchEvent("message",e,t)}),e.port!=null&&e.port.addEventListener("message",t=>{bn.dispatchEvent("message",e,t)})};bn.addEventListener=(e,t)=>{gr[e]==null&&(gr[e]=[]),gr[e].push(t)};bn.removeEventListener=(e,t)=>{gr[e]!=null&&(gr[e]=gr[e].filter(r=>r===t))};bn.dispatchEvent=function(e,t,r){gr[e]!=null&&gr[e].forEach(n=>n(t,r))};var u0=bn;var ah=(e,t,r,n,i)=>(s,a)=>{if(a.data.type!==r)return;let o={type:a.data.type,name:a.data.name,identifier:a.data.identifier};e.dispatchEvent(new MessageEvent(t,{data:{name:o.name,handler:async()=>(s.postMessage({type:i,name:o.name,identifier:o.identifier}),await new Promise(c=>{let u=f=>{if(f==null||f.data==null)return;let l={type:f.data.type,name:f.data.name,identifier:f.data.identifier};l.type===n&&l.identifier===o.identifier&&(s.removeEventListener("message",u),c())};s.addEventListener("message",u)}))}}))},oh=(e,t,r,n)=>async()=>{let i=Bs();return globalThis.postMessage({type:t,identifier:i,name:e}),await new Promise(s=>{let a=o=>{if(o==null||o.data==null)return;let c={type:o.data.type,identifier:o.data.identifier};c.type===r&&c.identifier===i&&(globalThis.removeEventListener("message",a),s(()=>{globalThis.postMessage({type:n,identifier:i,name:e})}))};globalThis.addEventListener("message",a)})},Sm={singleProcess:!1},ch=e=>{if(e=Object.assign({},Sm,e),Boolean(globalThis.document)||e.singleProcess){let r=new EventTarget;return u0.addEventListener("message",ah(r,"requestReadLock",n0,i0,s0)),u0.addEventListener("message",ah(r,"requestWriteLock",a0,o0,c0)),r}return{isWorker:!0,readLock:r=>oh(r,n0,s0,i0),writeLock:r=>oh(r,a0,c0,o0)}};var Mr={},mr;async function f0(e,t){let r,n=new Promise(i=>{r=i});return e.add(async()=>await r0((async()=>await new Promise(i=>{r(()=>{i()})}))(),{milliseconds:t.timeout})),await n}var Am=(e,t)=>{if(mr.isWorker===!0)return{readLock:mr.readLock(e,t),writeLock:mr.writeLock(e,t)};let r=new wn({concurrency:1}),n;return{async readLock(){if(n!=null)return await f0(n,t);n=new wn({concurrency:t.concurrency,autoStart:!1});let i=n,s=f0(n,t);return r.add(async()=>(i.start(),await i.onIdle().then(()=>{n===i&&(n=null)}))),await s},async writeLock(){return n=null,await f0(r,t)}}},Bm={name:"lock",concurrency:1/0,timeout:846e5,singleProcess:!1};function l0(e){let t=Object.assign({},Bm,e);return mr==null&&(mr=ch(t),mr.isWorker!==!0&&(mr.addEventListener("requestReadLock",r=>{Mr[r.data.name]!=null&&Mr[r.data.name].readLock().then(async n=>await r.data.handler().finally(()=>n()))}),mr.addEventListener("requestWriteLock",async r=>{Mr[r.data.name]!=null&&Mr[r.data.name].writeLock().then(async n=>await r.data.handler().finally(()=>n()))}))),Mr[t.name]==null&&(Mr[t.name]=Am(t.name,t)),Mr[t.name]}var uh=re("libp2p:peer-store:store"),fh="/peers/",Fs=class{constructor(t){this.components=t,this.lock=l0({name:"peer-store",singleProcess:!0})}_peerIdToDatastoreKey(t){if(t.type==null)throw uh.error("peerId must be an instance of peer-id to store data"),new K("peerId must be an instance of peer-id",M.ERR_INVALID_PARAMETERS);let r=t.toCID().toString();return new Ut(`${fh}${r}`)}async has(t){return await this.components.datastore.has(this._peerIdToDatastoreKey(t))}async delete(t){await this.components.datastore.delete(this._peerIdToDatastoreKey(t))}async load(t){let r=await this.components.datastore.get(this._peerIdToDatastoreKey(t)),n=oi.decode(r),i=new Map;for(let s of n.metadata)i.set(s.key,s.value);return{...n,id:t,addresses:n.addresses.map(({multiaddr:s,isCertified:a})=>({multiaddr:In(s),isCertified:a??!1})),metadata:i,pubKey:n.pubKey??void 0,peerRecordEnvelope:n.peerRecordEnvelope??void 0}}async save(t){if(t.pubKey!=null&&t.id.publicKey!=null&&!st(t.pubKey,t.id.publicKey))throw uh.error("peer publicKey bytes do not match peer id publicKey bytes"),new K("publicKey bytes do not match peer id publicKey bytes",M.ERR_INVALID_PARAMETERS);let r=new Set,n=t.addresses.filter(a=>r.has(a.multiaddr.toString())?!1:(r.add(a.multiaddr.toString()),!0)).sort((a,o)=>a.multiaddr.toString().localeCompare(o.multiaddr.toString())).map(({multiaddr:a,isCertified:o})=>({multiaddr:a.bytes,isCertified:o})),i=[];[...t.metadata.keys()].sort().forEach(a=>{let o=t.metadata.get(a);o!=null&&i.push({key:a,value:o})});let s=oi.encode({addresses:n,protocols:t.protocols.sort(),pubKey:t.pubKey,metadata:i,peerRecordEnvelope:t.peerRecordEnvelope});return await this.components.datastore.put(this._peerIdToDatastoreKey(t.id),s.subarray()),await this.load(t.id)}async patch(t,r){let n=await this.load(t);return await this._patch(t,r,n)}async patchOrCreate(t,r){let n;try{n=await this.load(t)}catch(i){if(i.code!==M.ERR_NOT_FOUND)throw i;n={id:t,addresses:[],protocols:[],metadata:new Map}}return await this._patch(t,r,n)}async _patch(t,r,n){return await this.save({...n,...r,id:t})}async merge(t,r){let n=await this.load(t);return await this._merge(t,r,n)}async mergeOrCreate(t,r){let n;try{n=await this.load(t)}catch(i){if(i.code!==M.ERR_NOT_FOUND)throw i;n={id:t,addresses:[],protocols:[],metadata:new Map}}return await this._merge(t,r,n)}async _merge(t,r,n){let i=new Map;return n.addresses.forEach(s=>{i.set(s.multiaddr.toString(),s.isCertified)}),(r.addresses??[]).forEach(s=>{let a=s.multiaddr.toString(),c=Boolean(i.get(a))||s.isCertified;i.set(a,c)}),await this.save({id:t,addresses:Array.from(i.entries()).map(([s,a])=>({multiaddr:In(s),isCertified:a})),protocols:Array.from(new Set([...n.protocols??[],...r.protocols??[]])),metadata:new Map([...n.metadata?.entries()??[],...r.metadata?.entries()??[]]),pubKey:r.pubKey??n?.pubKey,peerRecordEnvelope:r.peerRecordEnvelope??n?.peerRecordEnvelope})}async*all(){for await(let t of this.components.datastore.queryKeys({prefix:fh})){let r=t.toString().split("/")[2],n=Zt.decode(r);yield this.load(ni(n))}}};var We;(function(e){let t;e.codec=()=>(t==null&&(t=dr((r,n,i={})=>{if(i.lengthDelimited!==!1&&n.fork(),r.tags!=null)for(let s of r.tags)n.uint32(10),Os.codec().encode(s,n);i.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let i={tags:[]},s=n==null?r.len:r.pos+n;for(;r.pos<s;){let a=r.uint32();switch(a>>>3){case 1:i.tags.push(Os.codec().decode(r,r.uint32()));break;default:r.skipType(a&7);break}}return i})),t),e.encode=r=>hr(r,e.codec()),e.decode=r=>lr(r,e.codec())})(We||(We={}));var Os;(function(e){let t;e.codec=()=>(t==null&&(t=dr((r,n,i={})=>{i.lengthDelimited!==!1&&n.fork(),r.name!=null&&r.name!==""&&(n.uint32(10),n.string(r.name)),r.value!=null&&(n.uint32(16),n.uint32(r.value)),r.expiry!=null&&(n.uint32(24),n.uint64(r.expiry)),i.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let i={name:""},s=n==null?r.len:r.pos+n;for(;r.pos<s;){let a=r.uint32();switch(a>>>3){case 1:i.name=r.string();break;case 2:i.value=r.uint32();break;case 3:i.expiry=r.uint64();break;default:r.skipType(a&7);break}}return i})),t),e.encode=r=>hr(r,e.codec()),e.decode=r=>lr(r,e.codec())})(Os||(Os={}));var oe=re("libp2p:peer-store"),h0=class extends wi{constructor(t,r={}){super(),this.components=t,this.store=new Fs(t),this.addressBook=new vs(this.dispatchEvent.bind(this),this.store,r.addressFilter),this.keyBook=new ws(this.dispatchEvent.bind(this),this.store),this.metadataBook=new Es(this.dispatchEvent.bind(this),this.store),this.protoBook=new As(this.dispatchEvent.bind(this),this.store)}async forEach(t){oe.trace("getPeers await read lock");let r=await this.store.lock.readLock();oe.trace("getPeers got read lock");try{for await(let n of this.store.all())n.id.equals(this.components.peerId)||t(n)}finally{oe.trace("getPeers release read lock"),r()}}async all(){let t=[];return await this.forEach(r=>{t.push(r)}),t}async delete(t){oe.trace("delete await write lock");let r=await this.store.lock.writeLock();oe.trace("delete got write lock");try{await this.store.delete(t)}finally{oe.trace("delete release write lock"),r()}}async get(t){oe.trace("get await read lock");let r=await this.store.lock.readLock();oe.trace("get got read lock");try{return await this.store.load(t)}finally{oe.trace("get release read lock"),r()}}async has(t){oe.trace("has await read lock");let r=await this.store.lock.readLock();oe.trace("has got read lock");try{return await this.store.has(t)}finally{oe.trace("has release read lock"),r()}}async tagPeer(t,r,n={}){let i=n.value??0,s=Math.round(i),a=n.ttl??void 0;if(s!==i||s<0||s>100)throw new K("Tag value must be between 0-100","ERR_TAG_VALUE_OUT_OF_BOUNDS");let o=await this.metadataBook.getValue(t,"tags"),c=[];o!=null&&(c=We.decode(o).tags),c=c.filter(u=>u.name!==r),c.push({name:r,value:s,expiry:a==null?void 0:BigInt(Date.now()+a)}),await this.metadataBook.setValue(t,"tags",We.encode({tags:c}).subarray())}async unTagPeer(t,r){let n=await this.metadataBook.getValue(t,"tags"),i=[];n!=null&&(i=We.decode(n).tags),i=i.filter(s=>s.name!==r),await this.metadataBook.setValue(t,"tags",We.encode({tags:i}).subarray())}async getTags(t){let r=await this.metadataBook.getValue(t,"tags"),n=[];r!=null&&(n=We.decode(r).tags);let i=BigInt(Date.now()),s=n.filter(a=>a.expiry==null||a.expiry>i);return s.length!==n.length&&await this.metadataBook.setValue(t,"tags",We.encode({tags:s}).subarray()),s.map(a=>({name:a.name,value:a.value??0}))}};return gh(Cm);})();
/*! Bundled license information:

@noble/secp256k1/lib/esm/index.js:
  (*! noble-secp256k1 - MIT License (c) 2019 Paul Miller (paulmillr.com) *)

@noble/ed25519/lib/esm/index.js:
  (*! noble-ed25519 - MIT License (c) 2019 Paul Miller (paulmillr.com) *)
*/
return Libp2PPeerStore}));
