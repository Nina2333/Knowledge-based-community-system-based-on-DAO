(function (root, factory) {(typeof module === 'object' && module.exports) ? module.exports = factory() : root.Libp2PCrypto = factory()}(typeof self !== 'undefined' ? self : this, function () {
"use strict";var Libp2PCrypto=(()=>{var yf=Object.create;var zr=Object.defineProperty;var gf=Object.getOwnPropertyDescriptor;var xf=Object.getOwnPropertyNames;var vf=Object.getPrototypeOf,mf=Object.prototype.hasOwnProperty;var F=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),ut=(t,e)=>{for(var r in e)zr(t,r,{get:e[r],enumerable:!0})},Ca=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of xf(e))!mf.call(t,i)&&i!==r&&zr(t,i,{get:()=>e[i],enumerable:!(n=gf(e,i))||n.enumerable});return t};var it=(t,e,r)=>(r=t!=null?yf(vf(t)):{},Ca(e||!t||!t.__esModule?zr(r,"default",{value:t,enumerable:!0}):r,t)),bf=t=>Ca(zr({},"__esModule",{value:!0}),t);var X=F((Ep,Ia)=>{Ia.exports={options:{usePureJavaScript:!1}}});var ka=F((Bp,Ra)=>{var Vn={};Ra.exports=Vn;var _a={};Vn.encode=function(t,e,r){if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');if(r!==void 0&&typeof r!="number")throw new TypeError('"maxline" must be a number.');var n="";if(!(t instanceof Uint8Array))n=Ef(t,e);else{var i=0,a=e.length,s=e.charAt(0),o=[0];for(i=0;i<t.length;++i){for(var f=0,c=t[i];f<o.length;++f)c+=o[f]<<8,o[f]=c%a,c=c/a|0;for(;c>0;)o.push(c%a),c=c/a|0}for(i=0;t[i]===0&&i<t.length-1;++i)n+=s;for(i=o.length-1;i>=0;--i)n+=e[o[i]]}if(r){var u=new RegExp(".{1,"+r+"}","g");n=n.match(u).join(`\r
`)}return n};Vn.decode=function(t,e){if(typeof t!="string")throw new TypeError('"input" must be a string.');if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');var r=_a[e];if(!r){r=_a[e]=[];for(var n=0;n<e.length;++n)r[e.charCodeAt(n)]=n}t=t.replace(/\s/g,"");for(var i=e.length,a=e.charAt(0),s=[0],n=0;n<t.length;n++){var o=r[t.charCodeAt(n)];if(o===void 0)return;for(var f=0,c=o;f<s.length;++f)c+=s[f]*i,s[f]=c&255,c>>=8;for(;c>0;)s.push(c&255),c>>=8}for(var u=0;t[u]===a&&u<t.length-1;++u)s.push(0);return typeof Buffer<"u"?Buffer.from(s.reverse()):new Uint8Array(s.reverse())};function Ef(t,e){var r=0,n=e.length,i=e.charAt(0),a=[0];for(r=0;r<t.length();++r){for(var s=0,o=t.at(r);s<a.length;++s)o+=a[s]<<8,a[s]=o%n,o=o/n|0;for(;o>0;)a.push(o%n),o=o/n|0}var f="";for(r=0;t.at(r)===0&&r<t.length()-1;++r)f+=i;for(r=a.length-1;r>=0;--r)f+=e[a[r]];return f}});var lt=F((Ap,Pa)=>{var Na=X(),Da=ka(),y=Pa.exports=Na.util=Na.util||{};(function(){if(typeof process<"u"&&process.nextTick&&!process.browser){y.nextTick=process.nextTick,typeof setImmediate=="function"?y.setImmediate=setImmediate:y.setImmediate=y.nextTick;return}if(typeof setImmediate=="function"){y.setImmediate=function(){return setImmediate.apply(void 0,arguments)},y.nextTick=function(o){return setImmediate(o)};return}if(y.setImmediate=function(o){setTimeout(o,0)},typeof window<"u"&&typeof window.postMessage=="function"){let o=function(f){if(f.source===window&&f.data===t){f.stopPropagation();var c=e.slice();e.length=0,c.forEach(function(u){u()})}};var s=o,t="forge.setImmediate",e=[];y.setImmediate=function(f){e.push(f),e.length===1&&window.postMessage(t,"*")},window.addEventListener("message",o,!0)}if(typeof MutationObserver<"u"){var r=Date.now(),n=!0,i=document.createElement("div"),e=[];new MutationObserver(function(){var f=e.slice();e.length=0,f.forEach(function(c){c()})}).observe(i,{attributes:!0});var a=y.setImmediate;y.setImmediate=function(f){Date.now()-r>15?(r=Date.now(),a(f)):(e.push(f),e.length===1&&i.setAttribute("a",n=!n))}}y.nextTick=y.setImmediate})();y.isNodejs=typeof process<"u"&&process.versions&&process.versions.node;y.globalScope=function(){return y.isNodejs?globalThis:typeof self>"u"?window:self}();y.isArray=Array.isArray||function(t){return Object.prototype.toString.call(t)==="[object Array]"};y.isArrayBuffer=function(t){return typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer};y.isArrayBufferView=function(t){return t&&y.isArrayBuffer(t.buffer)&&t.byteLength!==void 0};function dr(t){if(!(t===8||t===16||t===24||t===32))throw new Error("Only 8, 16, 24, or 32 bits supported: "+t)}y.ByteBuffer=qn;function qn(t){if(this.data="",this.read=0,typeof t=="string")this.data=t;else if(y.isArrayBuffer(t)||y.isArrayBufferView(t))if(typeof Buffer<"u"&&t instanceof Buffer)this.data=t.toString("binary");else{var e=new Uint8Array(t);try{this.data=String.fromCharCode.apply(null,e)}catch{for(var r=0;r<e.length;++r)this.putByte(e[r])}}else(t instanceof qn||typeof t=="object"&&typeof t.data=="string"&&typeof t.read=="number")&&(this.data=t.data,this.read=t.read);this._constructedStringLength=0}y.ByteStringBuffer=qn;var Bf=4096;y.ByteStringBuffer.prototype._optimizeConstructedString=function(t){this._constructedStringLength+=t,this._constructedStringLength>Bf&&(this.data.substr(0,1),this._constructedStringLength=0)};y.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read};y.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0};y.ByteStringBuffer.prototype.putByte=function(t){return this.putBytes(String.fromCharCode(t))};y.ByteStringBuffer.prototype.fillWithByte=function(t,e){t=String.fromCharCode(t);for(var r=this.data;e>0;)e&1&&(r+=t),e>>>=1,e>0&&(t+=t);return this.data=r,this._optimizeConstructedString(e),this};y.ByteStringBuffer.prototype.putBytes=function(t){return this.data+=t,this._optimizeConstructedString(t.length),this};y.ByteStringBuffer.prototype.putString=function(t){return this.putBytes(y.encodeUtf8(t))};y.ByteStringBuffer.prototype.putInt16=function(t){return this.putBytes(String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};y.ByteStringBuffer.prototype.putInt24=function(t){return this.putBytes(String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};y.ByteStringBuffer.prototype.putInt32=function(t){return this.putBytes(String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};y.ByteStringBuffer.prototype.putInt16Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255))};y.ByteStringBuffer.prototype.putInt24Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255))};y.ByteStringBuffer.prototype.putInt32Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>24&255))};y.ByteStringBuffer.prototype.putInt=function(t,e){dr(e);var r="";do e-=8,r+=String.fromCharCode(t>>e&255);while(e>0);return this.putBytes(r)};y.ByteStringBuffer.prototype.putSignedInt=function(t,e){return t<0&&(t+=2<<e-1),this.putInt(t,e)};y.ByteStringBuffer.prototype.putBuffer=function(t){return this.putBytes(t.getBytes())};y.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)};y.ByteStringBuffer.prototype.getInt16=function(){var t=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,t};y.ByteStringBuffer.prototype.getInt24=function(){var t=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,t};y.ByteStringBuffer.prototype.getInt32=function(){var t=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,t};y.ByteStringBuffer.prototype.getInt16Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,t};y.ByteStringBuffer.prototype.getInt24Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,t};y.ByteStringBuffer.prototype.getInt32Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,t};y.ByteStringBuffer.prototype.getInt=function(t){dr(t);var e=0;do e=(e<<8)+this.data.charCodeAt(this.read++),t-=8;while(t>0);return e};y.ByteStringBuffer.prototype.getSignedInt=function(t){var e=this.getInt(t),r=2<<t-2;return e>=r&&(e-=r<<1),e};y.ByteStringBuffer.prototype.getBytes=function(t){var e;return t?(t=Math.min(this.length(),t),e=this.data.slice(this.read,this.read+t),this.read+=t):t===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};y.ByteStringBuffer.prototype.bytes=function(t){return typeof t>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+t)};y.ByteStringBuffer.prototype.at=function(t){return this.data.charCodeAt(this.read+t)};y.ByteStringBuffer.prototype.setAt=function(t,e){return this.data=this.data.substr(0,this.read+t)+String.fromCharCode(e)+this.data.substr(this.read+t+1),this};y.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)};y.ByteStringBuffer.prototype.copy=function(){var t=y.createBuffer(this.data);return t.read=this.read,t};y.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this};y.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this};y.ByteStringBuffer.prototype.truncate=function(t){var e=Math.max(0,this.length()-t);return this.data=this.data.substr(this.read,e),this.read=0,this};y.ByteStringBuffer.prototype.toHex=function(){for(var t="",e=this.read;e<this.data.length;++e){var r=this.data.charCodeAt(e);r<16&&(t+="0"),t+=r.toString(16)}return t};y.ByteStringBuffer.prototype.toString=function(){return y.decodeUtf8(this.bytes())};function Af(t,e){e=e||{},this.read=e.readOffset||0,this.growSize=e.growSize||1024;var r=y.isArrayBuffer(t),n=y.isArrayBufferView(t);if(r||n){r?this.data=new DataView(t):this.data=new DataView(t.buffer,t.byteOffset,t.byteLength),this.write="writeOffset"in e?e.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0)),this.write=0,t!=null&&this.putBytes(t),"writeOffset"in e&&(this.write=e.writeOffset)}y.DataBuffer=Af;y.DataBuffer.prototype.length=function(){return this.write-this.read};y.DataBuffer.prototype.isEmpty=function(){return this.length()<=0};y.DataBuffer.prototype.accommodate=function(t,e){if(this.length()>=t)return this;e=Math.max(e||this.growSize,t);var r=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),n=new Uint8Array(this.length()+e);return n.set(r),this.data=new DataView(n.buffer),this};y.DataBuffer.prototype.putByte=function(t){return this.accommodate(1),this.data.setUint8(this.write++,t),this};y.DataBuffer.prototype.fillWithByte=function(t,e){this.accommodate(e);for(var r=0;r<e;++r)this.data.setUint8(t);return this};y.DataBuffer.prototype.putBytes=function(t,e){if(y.isArrayBufferView(t)){var r=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),n=r.byteLength-r.byteOffset;this.accommodate(n);var i=new Uint8Array(this.data.buffer,this.write);return i.set(r),this.write+=n,this}if(y.isArrayBuffer(t)){var r=new Uint8Array(t);this.accommodate(r.byteLength);var i=new Uint8Array(this.data.buffer);return i.set(r,this.write),this.write+=r.byteLength,this}if(t instanceof y.DataBuffer||typeof t=="object"&&typeof t.read=="number"&&typeof t.write=="number"&&y.isArrayBufferView(t.data)){var r=new Uint8Array(t.data.byteLength,t.read,t.length());this.accommodate(r.byteLength);var i=new Uint8Array(t.data.byteLength,this.write);return i.set(r),this.write+=r.byteLength,this}if(t instanceof y.ByteStringBuffer&&(t=t.data,e="binary"),e=e||"binary",typeof t=="string"){var a;if(e==="hex")return this.accommodate(Math.ceil(t.length/2)),a=new Uint8Array(this.data.buffer,this.write),this.write+=y.binary.hex.decode(t,a,this.write),this;if(e==="base64")return this.accommodate(Math.ceil(t.length/4)*3),a=new Uint8Array(this.data.buffer,this.write),this.write+=y.binary.base64.decode(t,a,this.write),this;if(e==="utf8"&&(t=y.encodeUtf8(t),e="binary"),e==="binary"||e==="raw")return this.accommodate(t.length),a=new Uint8Array(this.data.buffer,this.write),this.write+=y.binary.raw.decode(a),this;if(e==="utf16")return this.accommodate(t.length*2),a=new Uint16Array(this.data.buffer,this.write),this.write+=y.text.utf16.encode(a),this;throw new Error("Invalid encoding: "+e)}throw Error("Invalid parameter: "+t)};y.DataBuffer.prototype.putBuffer=function(t){return this.putBytes(t),t.clear(),this};y.DataBuffer.prototype.putString=function(t){return this.putBytes(t,"utf16")};y.DataBuffer.prototype.putInt16=function(t){return this.accommodate(2),this.data.setInt16(this.write,t),this.write+=2,this};y.DataBuffer.prototype.putInt24=function(t){return this.accommodate(3),this.data.setInt16(this.write,t>>8&65535),this.data.setInt8(this.write,t>>16&255),this.write+=3,this};y.DataBuffer.prototype.putInt32=function(t){return this.accommodate(4),this.data.setInt32(this.write,t),this.write+=4,this};y.DataBuffer.prototype.putInt16Le=function(t){return this.accommodate(2),this.data.setInt16(this.write,t,!0),this.write+=2,this};y.DataBuffer.prototype.putInt24Le=function(t){return this.accommodate(3),this.data.setInt8(this.write,t>>16&255),this.data.setInt16(this.write,t>>8&65535,!0),this.write+=3,this};y.DataBuffer.prototype.putInt32Le=function(t){return this.accommodate(4),this.data.setInt32(this.write,t,!0),this.write+=4,this};y.DataBuffer.prototype.putInt=function(t,e){dr(e),this.accommodate(e/8);do e-=8,this.data.setInt8(this.write++,t>>e&255);while(e>0);return this};y.DataBuffer.prototype.putSignedInt=function(t,e){return dr(e),this.accommodate(e/8),t<0&&(t+=2<<e-1),this.putInt(t,e)};y.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)};y.DataBuffer.prototype.getInt16=function(){var t=this.data.getInt16(this.read);return this.read+=2,t};y.DataBuffer.prototype.getInt24=function(){var t=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,t};y.DataBuffer.prototype.getInt32=function(){var t=this.data.getInt32(this.read);return this.read+=4,t};y.DataBuffer.prototype.getInt16Le=function(){var t=this.data.getInt16(this.read,!0);return this.read+=2,t};y.DataBuffer.prototype.getInt24Le=function(){var t=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,t};y.DataBuffer.prototype.getInt32Le=function(){var t=this.data.getInt32(this.read,!0);return this.read+=4,t};y.DataBuffer.prototype.getInt=function(t){dr(t);var e=0;do e=(e<<8)+this.data.getInt8(this.read++),t-=8;while(t>0);return e};y.DataBuffer.prototype.getSignedInt=function(t){var e=this.getInt(t),r=2<<t-2;return e>=r&&(e-=r<<1),e};y.DataBuffer.prototype.getBytes=function(t){var e;return t?(t=Math.min(this.length(),t),e=this.data.slice(this.read,this.read+t),this.read+=t):t===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};y.DataBuffer.prototype.bytes=function(t){return typeof t>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+t)};y.DataBuffer.prototype.at=function(t){return this.data.getUint8(this.read+t)};y.DataBuffer.prototype.setAt=function(t,e){return this.data.setUint8(t,e),this};y.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)};y.DataBuffer.prototype.copy=function(){return new y.DataBuffer(this)};y.DataBuffer.prototype.compact=function(){if(this.read>0){var t=new Uint8Array(this.data.buffer,this.read),e=new Uint8Array(t.byteLength);e.set(t),this.data=new DataView(e),this.write-=this.read,this.read=0}return this};y.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this};y.DataBuffer.prototype.truncate=function(t){return this.write=Math.max(0,this.length()-t),this.read=Math.min(this.read,this.write),this};y.DataBuffer.prototype.toHex=function(){for(var t="",e=this.read;e<this.data.byteLength;++e){var r=this.data.getUint8(e);r<16&&(t+="0"),t+=r.toString(16)}return t};y.DataBuffer.prototype.toString=function(t){var e=new Uint8Array(this.data,this.read,this.length());if(t=t||"utf8",t==="binary"||t==="raw")return y.binary.raw.encode(e);if(t==="hex")return y.binary.hex.encode(e);if(t==="base64")return y.binary.base64.encode(e);if(t==="utf8")return y.text.utf8.decode(e);if(t==="utf16")return y.text.utf16.decode(e);throw new Error("Invalid encoding: "+t)};y.createBuffer=function(t,e){return e=e||"raw",t!==void 0&&e==="utf8"&&(t=y.encodeUtf8(t)),new y.ByteBuffer(t)};y.fillString=function(t,e){for(var r="";e>0;)e&1&&(r+=t),e>>>=1,e>0&&(t+=t);return r};y.xorBytes=function(t,e,r){for(var n="",i="",a="",s=0,o=0;r>0;--r,++s)i=t.charCodeAt(s)^e.charCodeAt(s),o>=10&&(n+=a,a="",o=0),a+=String.fromCharCode(i),++o;return n+=a,n};y.hexToBytes=function(t){var e="",r=0;for(t.length&!0&&(r=1,e+=String.fromCharCode(parseInt(t[0],16)));r<t.length;r+=2)e+=String.fromCharCode(parseInt(t.substr(r,2),16));return e};y.bytesToHex=function(t){return y.createBuffer(t).toHex()};y.int32ToBytes=function(t){return String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255)};var pe="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",de=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],La="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";y.encode64=function(t,e){for(var r="",n="",i,a,s,o=0;o<t.length;)i=t.charCodeAt(o++),a=t.charCodeAt(o++),s=t.charCodeAt(o++),r+=pe.charAt(i>>2),r+=pe.charAt((i&3)<<4|a>>4),isNaN(a)?r+="==":(r+=pe.charAt((a&15)<<2|s>>6),r+=isNaN(s)?"=":pe.charAt(s&63)),e&&r.length>e&&(n+=r.substr(0,e)+`\r
`,r=r.substr(e));return n+=r,n};y.decode64=function(t){t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var e="",r,n,i,a,s=0;s<t.length;)r=de[t.charCodeAt(s++)-43],n=de[t.charCodeAt(s++)-43],i=de[t.charCodeAt(s++)-43],a=de[t.charCodeAt(s++)-43],e+=String.fromCharCode(r<<2|n>>4),i!==64&&(e+=String.fromCharCode((n&15)<<4|i>>2),a!==64&&(e+=String.fromCharCode((i&3)<<6|a)));return e};y.encodeUtf8=function(t){return unescape(encodeURIComponent(t))};y.decodeUtf8=function(t){return decodeURIComponent(escape(t))};y.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:Da.encode,decode:Da.decode}};y.binary.raw.encode=function(t){return String.fromCharCode.apply(null,t)};y.binary.raw.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(t.length)),r=r||0;for(var i=r,a=0;a<t.length;++a)n[i++]=t.charCodeAt(a);return e?i-r:n};y.binary.hex.encode=y.bytesToHex;y.binary.hex.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(Math.ceil(t.length/2))),r=r||0;var i=0,a=r;for(t.length&1&&(i=1,n[a++]=parseInt(t[0],16));i<t.length;i+=2)n[a++]=parseInt(t.substr(i,2),16);return e?a-r:n};y.binary.base64.encode=function(t,e){for(var r="",n="",i,a,s,o=0;o<t.byteLength;)i=t[o++],a=t[o++],s=t[o++],r+=pe.charAt(i>>2),r+=pe.charAt((i&3)<<4|a>>4),isNaN(a)?r+="==":(r+=pe.charAt((a&15)<<2|s>>6),r+=isNaN(s)?"=":pe.charAt(s&63)),e&&r.length>e&&(n+=r.substr(0,e)+`\r
`,r=r.substr(e));return n+=r,n};y.binary.base64.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(Math.ceil(t.length/4)*3)),t=t.replace(/[^A-Za-z0-9\+\/\=]/g,""),r=r||0;for(var i,a,s,o,f=0,c=r;f<t.length;)i=de[t.charCodeAt(f++)-43],a=de[t.charCodeAt(f++)-43],s=de[t.charCodeAt(f++)-43],o=de[t.charCodeAt(f++)-43],n[c++]=i<<2|a>>4,s!==64&&(n[c++]=(a&15)<<4|s>>2,o!==64&&(n[c++]=(s&3)<<6|o));return e?c-r:n.subarray(0,c)};y.binary.base58.encode=function(t,e){return y.binary.baseN.encode(t,La,e)};y.binary.base58.decode=function(t,e){return y.binary.baseN.decode(t,La,e)};y.text={utf8:{},utf16:{}};y.text.utf8.encode=function(t,e,r){t=y.encodeUtf8(t);var n=e;n||(n=new Uint8Array(t.length)),r=r||0;for(var i=r,a=0;a<t.length;++a)n[i++]=t.charCodeAt(a);return e?i-r:n};y.text.utf8.decode=function(t){return y.decodeUtf8(String.fromCharCode.apply(null,t))};y.text.utf16.encode=function(t,e,r){var n=e;n||(n=new Uint8Array(t.length*2));var i=new Uint16Array(n.buffer);r=r||0;for(var a=r,s=r,o=0;o<t.length;++o)i[s++]=t.charCodeAt(o),a+=2;return e?a-r:n};y.text.utf16.decode=function(t){return String.fromCharCode.apply(null,new Uint16Array(t.buffer))};y.deflate=function(t,e,r){if(e=y.decode64(t.deflate(y.encode64(e)).rval),r){var n=2,i=e.charCodeAt(1);i&32&&(n=6),e=e.substring(n,e.length-4)}return e};y.inflate=function(t,e,r){var n=t.inflate(y.encode64(e)).rval;return n===null?null:y.decode64(n)};var zn=function(t,e,r){if(!t)throw new Error("WebStorage not available.");var n;if(r===null?n=t.removeItem(e):(r=y.encode64(JSON.stringify(r)),n=t.setItem(e,r)),typeof n<"u"&&n.rval!==!0){var i=new Error(n.error.message);throw i.id=n.error.id,i.name=n.error.name,i}},Hn=function(t,e){if(!t)throw new Error("WebStorage not available.");var r=t.getItem(e);if(t.init)if(r.rval===null){if(r.error){var n=new Error(r.error.message);throw n.id=r.error.id,n.name=r.error.name,n}r=null}else r=r.rval;return r!==null&&(r=JSON.parse(y.decode64(r))),r},Cf=function(t,e,r,n){var i=Hn(t,e);i===null&&(i={}),i[r]=n,zn(t,e,i)},Tf=function(t,e,r){var n=Hn(t,e);return n!==null&&(n=r in n?n[r]:null),n},If=function(t,e,r){var n=Hn(t,e);if(n!==null&&r in n){delete n[r];var i=!0;for(var a in n){i=!1;break}i&&(n=null),zn(t,e,n)}},_f=function(t,e){zn(t,e,null)},Gr=function(t,e,r){var n=null;typeof r>"u"&&(r=["web","flash"]);var i,a=!1,s=null;for(var o in r){i=r[o];try{if(i==="flash"||i==="both"){if(e[0]===null)throw new Error("Flash local storage not available.");n=t.apply(this,e),a=i==="flash"}(i==="web"||i==="both")&&(e[0]=localStorage,n=t.apply(this,e),a=!0)}catch(f){s=f}if(a)break}if(!a)throw s;return n};y.setItem=function(t,e,r,n,i){Gr(Cf,arguments,i)};y.getItem=function(t,e,r,n){return Gr(Tf,arguments,n)};y.removeItem=function(t,e,r,n){Gr(If,arguments,n)};y.clearItems=function(t,e,r){Gr(_f,arguments,r)};y.isEmpty=function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0};y.format=function(t){for(var e=/%./g,r,n,i=0,a=[],s=0;r=e.exec(t);){n=t.substring(s,e.lastIndex-2),n.length>0&&a.push(n),s=e.lastIndex;var o=r[0][1];switch(o){case"s":case"o":i<arguments.length?a.push(arguments[i+++1]):a.push("<?>");break;case"%":a.push("%");break;default:a.push("<%"+o+"?>")}}return a.push(t.substring(s)),a.join("")};y.formatNumber=function(t,e,r,n){var i=t,a=isNaN(e=Math.abs(e))?2:e,s=r===void 0?",":r,o=n===void 0?".":n,f=i<0?"-":"",c=parseInt(i=Math.abs(+i||0).toFixed(a),10)+"",u=c.length>3?c.length%3:0;return f+(u?c.substr(0,u)+o:"")+c.substr(u).replace(/(\d{3})(?=\d)/g,"$1"+o)+(a?s+Math.abs(i-c).toFixed(a).slice(2):"")};y.formatSize=function(t){return t>=1073741824?t=y.formatNumber(t/1073741824,2,".","")+" GiB":t>=1048576?t=y.formatNumber(t/1048576,2,".","")+" MiB":t>=1024?t=y.formatNumber(t/1024,0)+" KiB":t=y.formatNumber(t,0)+" bytes",t};y.bytesFromIP=function(t){return t.indexOf(".")!==-1?y.bytesFromIPv4(t):t.indexOf(":")!==-1?y.bytesFromIPv6(t):null};y.bytesFromIPv4=function(t){if(t=t.split("."),t.length!==4)return null;for(var e=y.createBuffer(),r=0;r<t.length;++r){var n=parseInt(t[r],10);if(isNaN(n))return null;e.putByte(n)}return e.getBytes()};y.bytesFromIPv6=function(t){var e=0;t=t.split(":").filter(function(s){return s.length===0&&++e,!0});for(var r=(8-t.length+e)*2,n=y.createBuffer(),i=0;i<8;++i){if(!t[i]||t[i].length===0){n.fillWithByte(0,r),r=0;continue}var a=y.hexToBytes(t[i]);a.length<2&&n.putByte(0),n.putBytes(a)}return n.getBytes()};y.bytesToIP=function(t){return t.length===4?y.bytesToIPv4(t):t.length===16?y.bytesToIPv6(t):null};y.bytesToIPv4=function(t){if(t.length!==4)return null;for(var e=[],r=0;r<t.length;++r)e.push(t.charCodeAt(r));return e.join(".")};y.bytesToIPv6=function(t){if(t.length!==16)return null;for(var e=[],r=[],n=0,i=0;i<t.length;i+=2){for(var a=y.bytesToHex(t[i]+t[i+1]);a[0]==="0"&&a!=="0";)a=a.substr(1);if(a==="0"){var s=r[r.length-1],o=e.length;!s||o!==s.end+1?r.push({start:o,end:o}):(s.end=o,s.end-s.start>r[n].end-r[n].start&&(n=r.length-1))}e.push(a)}if(r.length>0){var f=r[n];f.end-f.start>0&&(e.splice(f.start,f.end-f.start+1,""),f.start===0&&e.unshift(""),f.end===7&&e.push(""))}return e.join(":")};y.estimateCores=function(t,e){if(typeof t=="function"&&(e=t,t={}),t=t||{},"cores"in y&&!t.update)return e(null,y.cores);if(typeof navigator<"u"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return y.cores=navigator.hardwareConcurrency,e(null,y.cores);if(typeof Worker>"u")return y.cores=1,e(null,y.cores);if(typeof Blob>"u")return y.cores=2,e(null,y.cores);var r=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(s){for(var o=Date.now(),f=o+4;Date.now()<f;);self.postMessage({st:o,et:f})})}.toString(),")()"],{type:"application/javascript"}));n([],5,16);function n(s,o,f){if(o===0){var c=Math.floor(s.reduce(function(u,h){return u+h},0)/s.length);return y.cores=Math.max(1,c),URL.revokeObjectURL(r),e(null,y.cores)}i(f,function(u,h){s.push(a(f,h)),n(s,o-1,f)})}function i(s,o){for(var f=[],c=[],u=0;u<s;++u){var h=new Worker(r);h.addEventListener("message",function(l){if(c.push(l.data),c.length===s){for(var d=0;d<s;++d)f[d].terminate();o(null,c)}}),f.push(h)}for(var u=0;u<s;++u)f[u].postMessage(u)}function a(s,o){for(var f=[],c=0;c<s;++c)for(var u=o[c],h=f[c]=[],l=0;l<s;++l)if(c!==l){var d=o[l];(u.st>d.st&&u.st<d.et||d.st>u.st&&d.st<u.et)&&h.push(l)}return f.reduce(function(p,g){return Math.max(p,g.length)},0)}}});var Wn=F((Cp,Ua)=>{var gt=X();lt();Ua.exports=gt.cipher=gt.cipher||{};gt.cipher.algorithms=gt.cipher.algorithms||{};gt.cipher.createCipher=function(t,e){var r=t;if(typeof r=="string"&&(r=gt.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+t);return new gt.cipher.BlockCipher({algorithm:r,key:e,decrypt:!1})};gt.cipher.createDecipher=function(t,e){var r=t;if(typeof r=="string"&&(r=gt.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+t);return new gt.cipher.BlockCipher({algorithm:r,key:e,decrypt:!0})};gt.cipher.registerAlgorithm=function(t,e){t=t.toUpperCase(),gt.cipher.algorithms[t]=e};gt.cipher.getAlgorithm=function(t){return t=t.toUpperCase(),t in gt.cipher.algorithms?gt.cipher.algorithms[t]:null};var Gn=gt.cipher.BlockCipher=function(t){this.algorithm=t.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=t.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=t.decrypt,this.algorithm.initialize(t)};Gn.prototype.start=function(t){t=t||{};var e={};for(var r in t)e[r]=t[r];e.decrypt=this._decrypt,this._finish=!1,this._input=gt.util.createBuffer(),this.output=t.output||gt.util.createBuffer(),this.mode.start(e)};Gn.prototype.update=function(t){for(t&&this._input.putBuffer(t);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()};Gn.prototype.finish=function(t){t&&(this.mode.name==="ECB"||this.mode.name==="CBC")&&(this.mode.pad=function(r){return t(this.blockSize,r,!1)},this.mode.unpad=function(r){return t(this.blockSize,r,!0)});var e={};return e.decrypt=this._decrypt,e.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,e)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,e))||this.mode.afterFinish&&!this.mode.afterFinish(this.output,e))}});var Yn=F((Tp,Ka)=>{var xt=X();lt();xt.cipher=xt.cipher||{};var O=Ka.exports=xt.cipher.modes=xt.cipher.modes||{};O.ecb=function(t){t=t||{},this.name="ECB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};O.ecb.prototype.start=function(t){};O.ecb.prototype.encrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n])};O.ecb.prototype.decrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n])};O.ecb.prototype.pad=function(t,e){var r=t.length()===this.blockSize?this.blockSize:this.blockSize-t.length();return t.fillWithByte(r,r),!0};O.ecb.prototype.unpad=function(t,e){if(e.overflow>0)return!1;var r=t.length(),n=t.at(r-1);return n>this.blockSize<<2?!1:(t.truncate(n),!0)};O.cbc=function(t){t=t||{},this.name="CBC",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};O.cbc.prototype.start=function(t){if(t.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if("iv"in t)this._iv=Wr(t.iv,this.blockSize),this._prev=this._iv.slice(0);else throw new Error("Invalid IV parameter.")};O.cbc.prototype.encrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=this._prev[n]^t.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n]);this._prev=this._outBlock};O.cbc.prototype.decrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._prev[n]^this._outBlock[n]);this._prev=this._inBlock.slice(0)};O.cbc.prototype.pad=function(t,e){var r=t.length()===this.blockSize?this.blockSize:this.blockSize-t.length();return t.fillWithByte(r,r),!0};O.cbc.prototype.unpad=function(t,e){if(e.overflow>0)return!1;var r=t.length(),n=t.at(r-1);return n>this.blockSize<<2?!1:(t.truncate(n),!0)};O.cfb=function(t){t=t||{},this.name="CFB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=xt.util.createBuffer(),this._partialBytes=0};O.cfb.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=Wr(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};O.cfb.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)this._inBlock[i]=t.getInt32()^this._outBlock[i],e.putInt32(this._inBlock[i]);return}var a=(this.blockSize-n)%this.blockSize;a>0&&(a=this.blockSize-a),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=t.getInt32()^this._outBlock[i],this._partialOutput.putInt32(this._partialBlock[i]);if(a>0)t.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),a>0&&!r)return e.putBytes(this._partialOutput.getBytes(a-this._partialBytes)),this._partialBytes=a,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};O.cfb.prototype.decrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)this._inBlock[i]=t.getInt32(),e.putInt32(this._inBlock[i]^this._outBlock[i]);return}var a=(this.blockSize-n)%this.blockSize;a>0&&(a=this.blockSize-a),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=t.getInt32(),this._partialOutput.putInt32(this._partialBlock[i]^this._outBlock[i]);if(a>0)t.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),a>0&&!r)return e.putBytes(this._partialOutput.getBytes(a-this._partialBytes)),this._partialBytes=a,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};O.ofb=function(t){t=t||{},this.name="OFB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=xt.util.createBuffer(),this._partialBytes=0};O.ofb.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=Wr(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};O.ofb.prototype.encrypt=function(t,e,r){var n=t.length();if(t.length()===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)e.putInt32(t.getInt32()^this._outBlock[i]),this._inBlock[i]=this._outBlock[i];return}var a=(this.blockSize-n)%this.blockSize;a>0&&(a=this.blockSize-a),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(t.getInt32()^this._outBlock[i]);if(a>0)t.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._outBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),a>0&&!r)return e.putBytes(this._partialOutput.getBytes(a-this._partialBytes)),this._partialBytes=a,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};O.ofb.prototype.decrypt=O.ofb.prototype.encrypt;O.ctr=function(t){t=t||{},this.name="CTR",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=xt.util.createBuffer(),this._partialBytes=0};O.ctr.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=Wr(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};O.ctr.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize)for(var i=0;i<this._ints;++i)e.putInt32(t.getInt32()^this._outBlock[i]);else{var a=(this.blockSize-n)%this.blockSize;a>0&&(a=this.blockSize-a),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(t.getInt32()^this._outBlock[i]);if(a>0&&(t.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),a>0&&!r)return e.putBytes(this._partialOutput.getBytes(a-this._partialBytes)),this._partialBytes=a,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}Zr(this._inBlock)};O.ctr.prototype.decrypt=O.ctr.prototype.encrypt;O.gcm=function(t){t=t||{},this.name="GCM",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=xt.util.createBuffer(),this._partialBytes=0,this._R=3774873600};O.gcm.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");var e=xt.util.createBuffer(t.iv);this._cipherLength=0;var r;if("additionalData"in t?r=xt.util.createBuffer(t.additionalData):r=xt.util.createBuffer(),"tagLength"in t?this._tagLength=t.tagLength:this._tagLength=128,this._tag=null,t.decrypt&&(this._tag=xt.util.createBuffer(t.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var n=e.length();if(n===12)this._j0=[e.getInt32(),e.getInt32(),e.getInt32(),1];else{for(this._j0=[0,0,0,0];e.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[e.getInt32(),e.getInt32(),e.getInt32(),e.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(Zn(n*8)))}this._inBlock=this._j0.slice(0),Zr(this._inBlock),this._partialBytes=0,r=xt.util.createBuffer(r),this._aDataLength=Zn(r.length()*8);var i=r.length()%this.blockSize;for(i&&r.fillWithByte(0,this.blockSize-i),this._s=[0,0,0,0];r.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[r.getInt32(),r.getInt32(),r.getInt32(),r.getInt32()])};O.gcm.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i]^=t.getInt32());this._cipherLength+=this.blockSize}else{var a=(this.blockSize-n)%this.blockSize;a>0&&(a=this.blockSize-a),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(t.getInt32()^this._outBlock[i]);if(a<=0||r){if(r){var s=n%this.blockSize;this._cipherLength+=s,this._partialOutput.truncate(this.blockSize-s)}else this._cipherLength+=this.blockSize;for(var i=0;i<this._ints;++i)this._outBlock[i]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),a>0&&!r)return t.read-=this.blockSize,e.putBytes(this._partialOutput.getBytes(a-this._partialBytes)),this._partialBytes=a,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),Zr(this._inBlock)};O.gcm.prototype.decrypt=function(t,e,r){var n=t.length();if(n<this.blockSize&&!(r&&n>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),Zr(this._inBlock),this._hashBlock[0]=t.getInt32(),this._hashBlock[1]=t.getInt32(),this._hashBlock[2]=t.getInt32(),this._hashBlock[3]=t.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i]^this._hashBlock[i]);n<this.blockSize?this._cipherLength+=n%this.blockSize:this._cipherLength+=this.blockSize};O.gcm.prototype.afterFinish=function(t,e){var r=!0;e.decrypt&&e.overflow&&t.truncate(this.blockSize-e.overflow),this.tag=xt.util.createBuffer();var n=this._aDataLength.concat(Zn(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,n);var i=[];this.cipher.encrypt(this._j0,i);for(var a=0;a<this._ints;++a)this.tag.putInt32(this._s[a]^i[a]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),e.decrypt&&this.tag.bytes()!==this._tag&&(r=!1),r};O.gcm.prototype.multiply=function(t,e){for(var r=[0,0,0,0],n=e.slice(0),i=0;i<128;++i){var a=t[i/32|0]&1<<31-i%32;a&&(r[0]^=n[0],r[1]^=n[1],r[2]^=n[2],r[3]^=n[3]),this.pow(n,n)}return r};O.gcm.prototype.pow=function(t,e){for(var r=t[3]&1,n=3;n>0;--n)e[n]=t[n]>>>1|(t[n-1]&1)<<31;e[0]=t[0]>>>1,r&&(e[0]^=this._R)};O.gcm.prototype.tableMultiply=function(t){for(var e=[0,0,0,0],r=0;r<32;++r){var n=r/8|0,i=t[n]>>>(7-r%8)*4&15,a=this._m[r][i];e[0]^=a[0],e[1]^=a[1],e[2]^=a[2],e[3]^=a[3]}return e};O.gcm.prototype.ghash=function(t,e,r){return e[0]^=r[0],e[1]^=r[1],e[2]^=r[2],e[3]^=r[3],this.tableMultiply(e)};O.gcm.prototype.generateHashTable=function(t,e){for(var r=8/e,n=4*r,i=16*r,a=new Array(i),s=0;s<i;++s){var o=[0,0,0,0],f=s/n|0,c=(n-1-s%n)*e;o[f]=1<<e-1<<c,a[s]=this.generateSubHashTable(this.multiply(o,t),e)}return a};O.gcm.prototype.generateSubHashTable=function(t,e){var r=1<<e,n=r>>>1,i=new Array(r);i[n]=t.slice(0);for(var a=n>>>1;a>0;)this.pow(i[2*a],i[a]=[]),a>>=1;for(a=2;a<n;){for(var s=1;s<a;++s){var o=i[a],f=i[s];i[a+s]=[o[0]^f[0],o[1]^f[1],o[2]^f[2],o[3]^f[3]]}a*=2}for(i[0]=[0,0,0,0],a=n+1;a<r;++a){var c=i[a^n];i[a]=[t[0]^c[0],t[1]^c[1],t[2]^c[2],t[3]^c[3]]}return i};function Wr(t,e){if(typeof t=="string"&&(t=xt.util.createBuffer(t)),xt.util.isArray(t)&&t.length>4){var r=t;t=xt.util.createBuffer();for(var n=0;n<r.length;++n)t.putByte(r[n])}if(t.length()<e)throw new Error("Invalid IV length; got "+t.length()+" bytes and expected "+e+" bytes.");if(!xt.util.isArray(t)){for(var i=[],a=e/4,n=0;n<a;++n)i.push(t.getInt32());t=i}return t}function Zr(t){t[t.length-1]=t[t.length-1]+1&4294967295}function Zn(t){return[t/4294967296|0,t&4294967295]}});var $r=F((Ip,Va)=>{var J=X();Wn();Yn();lt();Va.exports=J.aes=J.aes||{};J.aes.startEncrypting=function(t,e,r,n){var i=Yr({key:t,output:r,decrypt:!1,mode:n});return i.start(e),i};J.aes.createEncryptionCipher=function(t,e){return Yr({key:t,output:null,decrypt:!1,mode:e})};J.aes.startDecrypting=function(t,e,r,n){var i=Yr({key:t,output:r,decrypt:!0,mode:n});return i.start(e),i};J.aes.createDecryptionCipher=function(t,e){return Yr({key:t,output:null,decrypt:!0,mode:e})};J.aes.Algorithm=function(t,e){Xn||Oa();var r=this;r.name=t,r.mode=new e({blockSize:16,cipher:{encrypt:function(n,i){return Qn(r._w,n,i,!1)},decrypt:function(n,i){return Qn(r._w,n,i,!0)}}}),r._init=!1};J.aes.Algorithm.prototype.initialize=function(t){if(!this._init){var e=t.key,r;if(typeof e=="string"&&(e.length===16||e.length===24||e.length===32))e=J.util.createBuffer(e);else if(J.util.isArray(e)&&(e.length===16||e.length===24||e.length===32)){r=e,e=J.util.createBuffer();for(var n=0;n<r.length;++n)e.putByte(r[n])}if(!J.util.isArray(e)){r=e,e=[];var i=r.length();if(i===16||i===24||i===32){i=i>>>2;for(var n=0;n<i;++n)e.push(r.getInt32())}}if(!J.util.isArray(e)||!(e.length===4||e.length===6||e.length===8))throw new Error("Invalid key parameter.");var a=this.mode.name,s=["CFB","OFB","CTR","GCM"].indexOf(a)!==-1;this._w=Ma(e,t.decrypt&&!s),this._init=!0}};J.aes._expandKey=function(t,e){return Xn||Oa(),Ma(t,e)};J.aes._updateBlock=Qn;He("AES-ECB",J.cipher.modes.ecb);He("AES-CBC",J.cipher.modes.cbc);He("AES-CFB",J.cipher.modes.cfb);He("AES-OFB",J.cipher.modes.ofb);He("AES-CTR",J.cipher.modes.ctr);He("AES-GCM",J.cipher.modes.gcm);function He(t,e){var r=function(){return new J.aes.Algorithm(t,e)};J.cipher.registerAlgorithm(t,r)}var Xn=!1,ze=4,Bt,$n,Fa,Ie,Ot;function Oa(){Xn=!0,Fa=[0,1,2,4,8,16,32,64,128,27,54];for(var t=new Array(256),e=0;e<128;++e)t[e]=e<<1,t[e+128]=e+128<<1^283;Bt=new Array(256),$n=new Array(256),Ie=new Array(4),Ot=new Array(4);for(var e=0;e<4;++e)Ie[e]=new Array(256),Ot[e]=new Array(256);for(var r=0,n=0,i,a,s,o,f,c,u,e=0;e<256;++e){o=n^n<<1^n<<2^n<<3^n<<4,o=o>>8^o&255^99,Bt[r]=o,$n[o]=r,f=t[o],i=t[r],a=t[i],s=t[a],c=f<<24^o<<16^o<<8^(o^f),u=(i^a^s)<<24^(r^s)<<16^(r^a^s)<<8^(r^i^s);for(var h=0;h<4;++h)Ie[h][r]=c,Ot[h][o]=u,c=c<<24|c>>>8,u=u<<24|u>>>8;r===0?r=n=1:(r=i^t[t[t[i^s]]],n^=t[t[n]])}}function Ma(t,e){for(var r=t.slice(0),n,i=1,a=r.length,s=a+6+1,o=ze*s,f=a;f<o;++f)n=r[f-1],f%a===0?(n=Bt[n>>>16&255]<<24^Bt[n>>>8&255]<<16^Bt[n&255]<<8^Bt[n>>>24]^Fa[i]<<24,i++):a>6&&f%a===4&&(n=Bt[n>>>24]<<24^Bt[n>>>16&255]<<16^Bt[n>>>8&255]<<8^Bt[n&255]),r[f]=r[f-a]^n;if(e){var c,u=Ot[0],h=Ot[1],l=Ot[2],d=Ot[3],p=r.slice(0);o=r.length;for(var f=0,g=o-ze;f<o;f+=ze,g-=ze)if(f===0||f===o-ze)p[f]=r[g],p[f+1]=r[g+3],p[f+2]=r[g+2],p[f+3]=r[g+1];else for(var v=0;v<ze;++v)c=r[g+v],p[f+(3&-v)]=u[Bt[c>>>24]]^h[Bt[c>>>16&255]]^l[Bt[c>>>8&255]]^d[Bt[c&255]];r=p}return r}function Qn(t,e,r,n){var i=t.length/4-1,a,s,o,f,c;n?(a=Ot[0],s=Ot[1],o=Ot[2],f=Ot[3],c=$n):(a=Ie[0],s=Ie[1],o=Ie[2],f=Ie[3],c=Bt);var u,h,l,d,p,g,v;u=e[0]^t[0],h=e[n?3:1]^t[1],l=e[2]^t[2],d=e[n?1:3]^t[3];for(var m=3,S=1;S<i;++S)p=a[u>>>24]^s[h>>>16&255]^o[l>>>8&255]^f[d&255]^t[++m],g=a[h>>>24]^s[l>>>16&255]^o[d>>>8&255]^f[u&255]^t[++m],v=a[l>>>24]^s[d>>>16&255]^o[u>>>8&255]^f[h&255]^t[++m],d=a[d>>>24]^s[u>>>16&255]^o[h>>>8&255]^f[l&255]^t[++m],u=p,h=g,l=v;r[0]=c[u>>>24]<<24^c[h>>>16&255]<<16^c[l>>>8&255]<<8^c[d&255]^t[++m],r[n?3:1]=c[h>>>24]<<24^c[l>>>16&255]<<16^c[d>>>8&255]<<8^c[u&255]^t[++m],r[2]=c[l>>>24]<<24^c[d>>>16&255]<<16^c[u>>>8&255]<<8^c[h&255]^t[++m],r[n?1:3]=c[d>>>24]<<24^c[u>>>16&255]<<16^c[h>>>8&255]<<8^c[l&255]^t[++m]}function Yr(t){t=t||{};var e=(t.mode||"CBC").toUpperCase(),r="AES-"+e,n;t.decrypt?n=J.cipher.createDecipher(r,t.key):n=J.cipher.createCipher(r,t.key);var i=n.start;return n.start=function(a,s){var o=null;s instanceof J.util.ByteBuffer&&(o=s,s={}),s=s||{},s.output=o,s.iv=a,i.call(n,s)},n}});var ds=F((Id,ps)=>{"use strict";ps.exports=Kc;function Kc(t,e){for(var r=new Array(arguments.length-1),n=0,i=2,a=!0;i<arguments.length;)r[n++]=arguments[i++];return new Promise(function(o,f){r[n]=function(u){if(a)if(a=!1,u)f(u);else{for(var h=new Array(arguments.length-1),l=0;l<h.length;)h[l++]=arguments[l];o.apply(null,h)}};try{t.apply(e||null,r)}catch(c){a&&(a=!1,f(c))}})}});var vs=F(xs=>{"use strict";var jr=xs;jr.length=function(e){var r=e.length;if(!r)return 0;for(var n=0;--r%4>1&&e.charAt(r)==="=";)++n;return Math.ceil(e.length*3)/4-n};var Xe=new Array(64),gs=new Array(123);for(Mt=0;Mt<64;)gs[Xe[Mt]=Mt<26?Mt+65:Mt<52?Mt+71:Mt<62?Mt-4:Mt-59|43]=Mt++;var Mt;jr.encode=function(e,r,n){for(var i=null,a=[],s=0,o=0,f;r<n;){var c=e[r++];switch(o){case 0:a[s++]=Xe[c>>2],f=(c&3)<<4,o=1;break;case 1:a[s++]=Xe[f|c>>4],f=(c&15)<<2,o=2;break;case 2:a[s++]=Xe[f|c>>6],a[s++]=Xe[c&63],o=0;break}s>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,a)),s=0)}return o&&(a[s++]=Xe[f],a[s++]=61,o===1&&(a[s++]=61)),i?(s&&i.push(String.fromCharCode.apply(String,a.slice(0,s))),i.join("")):String.fromCharCode.apply(String,a.slice(0,s))};var ys="invalid encoding";jr.decode=function(e,r,n){for(var i=n,a=0,s,o=0;o<e.length;){var f=e.charCodeAt(o++);if(f===61&&a>1)break;if((f=gs[f])===void 0)throw Error(ys);switch(a){case 0:s=f,a=1;break;case 1:r[n++]=s<<2|(f&48)>>4,s=f,a=2;break;case 2:r[n++]=(s&15)<<4|(f&60)>>2,s=f,a=3;break;case 3:r[n++]=(s&3)<<6|f,a=0;break}}if(a===1)throw Error(ys);return n-i};jr.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}});var bs=F((Rd,ms)=>{"use strict";ms.exports=tn;function tn(){this._listeners={}}tn.prototype.on=function(e,r,n){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:r,ctx:n||this}),this};tn.prototype.off=function(e,r){if(e===void 0)this._listeners={};else if(r===void 0)this._listeners[e]=[];else for(var n=this._listeners[e],i=0;i<n.length;)n[i].fn===r?n.splice(i,1):++i;return this};tn.prototype.emit=function(e){var r=this._listeners[e];if(r){for(var n=[],i=1;i<arguments.length;)n.push(arguments[i++]);for(i=0;i<r.length;)r[i].fn.apply(r[i++].ctx,n)}return this}});var Ts=F((kd,Cs)=>{"use strict";Cs.exports=ws(ws);function ws(t){return typeof Float32Array<"u"?function(){var e=new Float32Array([-0]),r=new Uint8Array(e.buffer),n=r[3]===128;function i(f,c,u){e[0]=f,c[u]=r[0],c[u+1]=r[1],c[u+2]=r[2],c[u+3]=r[3]}function a(f,c,u){e[0]=f,c[u]=r[3],c[u+1]=r[2],c[u+2]=r[1],c[u+3]=r[0]}t.writeFloatLE=n?i:a,t.writeFloatBE=n?a:i;function s(f,c){return r[0]=f[c],r[1]=f[c+1],r[2]=f[c+2],r[3]=f[c+3],e[0]}function o(f,c){return r[3]=f[c],r[2]=f[c+1],r[1]=f[c+2],r[0]=f[c+3],e[0]}t.readFloatLE=n?s:o,t.readFloatBE=n?o:s}():function(){function e(n,i,a,s){var o=i<0?1:0;if(o&&(i=-i),i===0)n(1/i>0?0:2147483648,a,s);else if(isNaN(i))n(2143289344,a,s);else if(i>34028234663852886e22)n((o<<31|2139095040)>>>0,a,s);else if(i<11754943508222875e-54)n((o<<31|Math.round(i/1401298464324817e-60))>>>0,a,s);else{var f=Math.floor(Math.log(i)/Math.LN2),c=Math.round(i*Math.pow(2,-f)*8388608)&8388607;n((o<<31|f+127<<23|c)>>>0,a,s)}}t.writeFloatLE=e.bind(null,Ss),t.writeFloatBE=e.bind(null,Es);function r(n,i,a){var s=n(i,a),o=(s>>31)*2+1,f=s>>>23&255,c=s&8388607;return f===255?c?NaN:o*(1/0):f===0?o*1401298464324817e-60*c:o*Math.pow(2,f-150)*(c+8388608)}t.readFloatLE=r.bind(null,Bs),t.readFloatBE=r.bind(null,As)}(),typeof Float64Array<"u"?function(){var e=new Float64Array([-0]),r=new Uint8Array(e.buffer),n=r[7]===128;function i(f,c,u){e[0]=f,c[u]=r[0],c[u+1]=r[1],c[u+2]=r[2],c[u+3]=r[3],c[u+4]=r[4],c[u+5]=r[5],c[u+6]=r[6],c[u+7]=r[7]}function a(f,c,u){e[0]=f,c[u]=r[7],c[u+1]=r[6],c[u+2]=r[5],c[u+3]=r[4],c[u+4]=r[3],c[u+5]=r[2],c[u+6]=r[1],c[u+7]=r[0]}t.writeDoubleLE=n?i:a,t.writeDoubleBE=n?a:i;function s(f,c){return r[0]=f[c],r[1]=f[c+1],r[2]=f[c+2],r[3]=f[c+3],r[4]=f[c+4],r[5]=f[c+5],r[6]=f[c+6],r[7]=f[c+7],e[0]}function o(f,c){return r[7]=f[c],r[6]=f[c+1],r[5]=f[c+2],r[4]=f[c+3],r[3]=f[c+4],r[2]=f[c+5],r[1]=f[c+6],r[0]=f[c+7],e[0]}t.readDoubleLE=n?s:o,t.readDoubleBE=n?o:s}():function(){function e(n,i,a,s,o,f){var c=s<0?1:0;if(c&&(s=-s),s===0)n(0,o,f+i),n(1/s>0?0:2147483648,o,f+a);else if(isNaN(s))n(0,o,f+i),n(2146959360,o,f+a);else if(s>17976931348623157e292)n(0,o,f+i),n((c<<31|2146435072)>>>0,o,f+a);else{var u;if(s<22250738585072014e-324)u=s/5e-324,n(u>>>0,o,f+i),n((c<<31|u/4294967296)>>>0,o,f+a);else{var h=Math.floor(Math.log(s)/Math.LN2);h===1024&&(h=1023),u=s*Math.pow(2,-h),n(u*4503599627370496>>>0,o,f+i),n((c<<31|h+1023<<20|u*1048576&1048575)>>>0,o,f+a)}}}t.writeDoubleLE=e.bind(null,Ss,0,4),t.writeDoubleBE=e.bind(null,Es,4,0);function r(n,i,a,s,o){var f=n(s,o+i),c=n(s,o+a),u=(c>>31)*2+1,h=c>>>20&2047,l=4294967296*(c&1048575)+f;return h===2047?l?NaN:u*(1/0):h===0?u*5e-324*l:u*Math.pow(2,h-1075)*(l+4503599627370496)}t.readDoubleLE=r.bind(null,Bs,0,4),t.readDoubleBE=r.bind(null,As,4,0)}(),t}function Ss(t,e,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24}function Es(t,e,r){e[r]=t>>>24,e[r+1]=t>>>16&255,e[r+2]=t>>>8&255,e[r+3]=t&255}function Bs(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24)>>>0}function As(t,e){return(t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3])>>>0}});var Is=F((exports,module)=>{"use strict";module.exports=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(t){}return null}});var Rs=F(_s=>{"use strict";var Si=_s;Si.length=function(e){for(var r=0,n=0,i=0;i<e.length;++i)n=e.charCodeAt(i),n<128?r+=1:n<2048?r+=2:(n&64512)===55296&&(e.charCodeAt(i+1)&64512)===56320?(++i,r+=4):r+=3;return r};Si.read=function(e,r,n){var i=n-r;if(i<1)return"";for(var a=null,s=[],o=0,f;r<n;)f=e[r++],f<128?s[o++]=f:f>191&&f<224?s[o++]=(f&31)<<6|e[r++]&63:f>239&&f<365?(f=((f&7)<<18|(e[r++]&63)<<12|(e[r++]&63)<<6|e[r++]&63)-65536,s[o++]=55296+(f>>10),s[o++]=56320+(f&1023)):s[o++]=(f&15)<<12|(e[r++]&63)<<6|e[r++]&63,o>8191&&((a||(a=[])).push(String.fromCharCode.apply(String,s)),o=0);return a?(o&&a.push(String.fromCharCode.apply(String,s.slice(0,o))),a.join("")):String.fromCharCode.apply(String,s.slice(0,o))};Si.write=function(e,r,n){for(var i=n,a,s,o=0;o<e.length;++o)a=e.charCodeAt(o),a<128?r[n++]=a:a<2048?(r[n++]=a>>6|192,r[n++]=a&63|128):(a&64512)===55296&&((s=e.charCodeAt(o+1))&64512)===56320?(a=65536+((a&1023)<<10)+(s&1023),++o,r[n++]=a>>18|240,r[n++]=a>>12&63|128,r[n++]=a>>6&63|128,r[n++]=a&63|128):(r[n++]=a>>12|224,r[n++]=a>>6&63|128,r[n++]=a&63|128);return n-i}});var Ns=F((Dd,ks)=>{"use strict";ks.exports=Fc;function Fc(t,e,r){var n=r||8192,i=n>>>1,a=null,s=n;return function(f){if(f<1||f>i)return t(f);s+f>n&&(a=t(n),s=0);var c=e.call(a,s,s+=f);return s&7&&(s=(s|7)+1),c}}});var Ls=F((Ld,Ds)=>{"use strict";Ds.exports=vt;var wr=ke();function vt(t,e){this.lo=t>>>0,this.hi=e>>>0}var Re=vt.zero=new vt(0,0);Re.toNumber=function(){return 0};Re.zzEncode=Re.zzDecode=function(){return this};Re.length=function(){return 1};var Oc=vt.zeroHash="\0\0\0\0\0\0\0\0";vt.fromNumber=function(e){if(e===0)return Re;var r=e<0;r&&(e=-e);var n=e>>>0,i=(e-n)/4294967296>>>0;return r&&(i=~i>>>0,n=~n>>>0,++n>4294967295&&(n=0,++i>4294967295&&(i=0))),new vt(n,i)};vt.from=function(e){if(typeof e=="number")return vt.fromNumber(e);if(wr.isString(e))if(wr.Long)e=wr.Long.fromString(e);else return vt.fromNumber(parseInt(e,10));return e.low||e.high?new vt(e.low>>>0,e.high>>>0):Re};vt.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var r=~this.lo+1>>>0,n=~this.hi>>>0;return r||(n=n+1>>>0),-(r+n*4294967296)}return this.lo+this.hi*4294967296};vt.prototype.toLong=function(e){return wr.Long?new wr.Long(this.lo|0,this.hi|0,!!e):{low:this.lo|0,high:this.hi|0,unsigned:!!e}};var ge=String.prototype.charCodeAt;vt.fromHash=function(e){return e===Oc?Re:new vt((ge.call(e,0)|ge.call(e,1)<<8|ge.call(e,2)<<16|ge.call(e,3)<<24)>>>0,(ge.call(e,4)|ge.call(e,5)<<8|ge.call(e,6)<<16|ge.call(e,7)<<24)>>>0)};vt.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)};vt.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this};vt.prototype.zzDecode=function(){var e=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this};vt.prototype.length=function(){var e=this.lo,r=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return n===0?r===0?e<16384?e<128?1:2:e<2097152?3:4:r<16384?r<128?5:6:r<2097152?7:8:n<128?9:10}});var ke=F(Ei=>{"use strict";var k=Ei;k.asPromise=ds();k.base64=vs();k.EventEmitter=bs();k.float=Ts();k.inquire=Is();k.utf8=Rs();k.pool=Ns();k.LongBits=Ls();k.isNode=!!(typeof globalThis<"u"&&globalThis&&globalThis.process&&globalThis.process.versions&&globalThis.process.versions.node);k.global=k.isNode&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||Ei;k.emptyArray=Object.freeze?Object.freeze([]):[];k.emptyObject=Object.freeze?Object.freeze({}):{};k.isInteger=Number.isInteger||function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e};k.isString=function(e){return typeof e=="string"||e instanceof String};k.isObject=function(e){return e&&typeof e=="object"};k.isset=k.isSet=function(e,r){var n=e[r];return n!=null&&e.hasOwnProperty(r)?typeof n!="object"||(Array.isArray(n)?n.length:Object.keys(n).length)>0:!1};k.Buffer=function(){try{var t=k.inquire("buffer").Buffer;return t.prototype.utf8Write?t:null}catch{return null}}();k._Buffer_from=null;k._Buffer_allocUnsafe=null;k.newBuffer=function(e){return typeof e=="number"?k.Buffer?k._Buffer_allocUnsafe(e):new k.Array(e):k.Buffer?k._Buffer_from(e):typeof Uint8Array>"u"?e:new Uint8Array(e)};k.Array=typeof Uint8Array<"u"?Uint8Array:Array;k.Long=k.global.dcodeIO&&k.global.dcodeIO.Long||k.global.Long||k.inquire("long");k.key2Re=/^true|false|0|1$/;k.key32Re=/^-?(?:0|[1-9][0-9]*)$/;k.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/;k.longToHash=function(e){return e?k.LongBits.from(e).toHash():k.LongBits.zeroHash};k.longFromHash=function(e,r){var n=k.LongBits.fromHash(e);return k.Long?k.Long.fromBits(n.lo,n.hi,r):n.toNumber(!!r)};function Ps(t,e,r){for(var n=Object.keys(e),i=0;i<n.length;++i)(t[n[i]]===void 0||!r)&&(t[n[i]]=e[n[i]]);return t}k.merge=Ps;k.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)};function Us(t){function e(r,n){if(!(this instanceof e))return new e(r,n);Object.defineProperty(this,"message",{get:function(){return r}}),Error.captureStackTrace?Error.captureStackTrace(this,e):Object.defineProperty(this,"stack",{value:new Error().stack||""}),n&&Ps(this,n)}return e.prototype=Object.create(Error.prototype,{constructor:{value:e,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return t},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),e}k.newError=Us;k.ProtocolError=Us("ProtocolError");k.oneOfGetter=function(e){for(var r={},n=0;n<e.length;++n)r[e[n]]=1;return function(){for(var i=Object.keys(this),a=i.length-1;a>-1;--a)if(r[i[a]]===1&&this[i[a]]!==void 0&&this[i[a]]!==null)return i[a]}};k.oneOfSetter=function(e){return function(r){for(var n=0;n<e.length;++n)e[n]!==r&&delete this[e[n]]}};k.toJSONOptions={longs:String,enums:String,bytes:String,json:!0};k._configure=function(){var t=k.Buffer;if(!t){k._Buffer_from=k._Buffer_allocUnsafe=null;return}k._Buffer_from=t.from!==Uint8Array.from&&t.from||function(r,n){return new t(r,n)},k._Buffer_allocUnsafe=t.allocUnsafe||function(r){return new t(r)}}});var Ci=F((Ud,Vs)=>{"use strict";Vs.exports=pt;var $t=ke(),Ai,Os=$t.LongBits,Mc=$t.utf8;function Vt(t,e){return RangeError("index out of range: "+t.pos+" + "+(e||1)+" > "+t.len)}function pt(t){this.buf=t,this.pos=0,this.len=t.length}var Ks=typeof Uint8Array<"u"?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new pt(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new pt(e);throw Error("illegal buffer")},Ms=function(){return $t.Buffer?function(r){return(pt.create=function(i){return $t.Buffer.isBuffer(i)?new Ai(i):Ks(i)})(r)}:Ks};pt.create=Ms();pt.prototype._slice=$t.Array.prototype.subarray||$t.Array.prototype.slice;pt.prototype.uint32=function(){var e=4294967295;return function(){if(e=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(e=(e|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return e;if((this.pos+=5)>this.len)throw this.pos=this.len,Vt(this,10);return e}}();pt.prototype.int32=function(){return this.uint32()|0};pt.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(e&1)|0};function Bi(){var t=new Os(0,0),e=0;if(this.len-this.pos>4){for(;e<4;++e)if(t.lo=(t.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return t;if(t.lo=(t.lo|(this.buf[this.pos]&127)<<28)>>>0,t.hi=(t.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return t;e=0}else{for(;e<3;++e){if(this.pos>=this.len)throw Vt(this);if(t.lo=(t.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return t}return t.lo=(t.lo|(this.buf[this.pos++]&127)<<e*7)>>>0,t}if(this.len-this.pos>4){for(;e<5;++e)if(t.hi=(t.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return t}else for(;e<5;++e){if(this.pos>=this.len)throw Vt(this);if(t.hi=(t.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return t}throw Error("invalid varint encoding")}pt.prototype.bool=function(){return this.uint32()!==0};function en(t,e){return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0}pt.prototype.fixed32=function(){if(this.pos+4>this.len)throw Vt(this,4);return en(this.buf,this.pos+=4)};pt.prototype.sfixed32=function(){if(this.pos+4>this.len)throw Vt(this,4);return en(this.buf,this.pos+=4)|0};function Fs(){if(this.pos+8>this.len)throw Vt(this,8);return new Os(en(this.buf,this.pos+=4),en(this.buf,this.pos+=4))}pt.prototype.float=function(){if(this.pos+4>this.len)throw Vt(this,4);var e=$t.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e};pt.prototype.double=function(){if(this.pos+8>this.len)throw Vt(this,4);var e=$t.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e};pt.prototype.bytes=function(){var e=this.uint32(),r=this.pos,n=this.pos+e;if(n>this.len)throw Vt(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(r,n):r===n?new this.buf.constructor(0):this._slice.call(this.buf,r,n)};pt.prototype.string=function(){var e=this.bytes();return Mc.read(e,0,e.length)};pt.prototype.skip=function(e){if(typeof e=="number"){if(this.pos+e>this.len)throw Vt(this,e);this.pos+=e}else do if(this.pos>=this.len)throw Vt(this);while(this.buf[this.pos++]&128);return this};pt.prototype.skipType=function(t){switch(t){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(t=this.uint32()&7)!==4;)this.skipType(t);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+t+" at offset "+this.pos)}return this};pt._configure=function(t){Ai=t,pt.create=Ms(),Ai._configure();var e=$t.Long?"toLong":"toNumber";$t.merge(pt.prototype,{int64:function(){return Bi.call(this)[e](!1)},uint64:function(){return Bi.call(this)[e](!0)},sint64:function(){return Bi.call(this).zzDecode()[e](!1)},fixed64:function(){return Fs.call(this)[e](!0)},sfixed64:function(){return Fs.call(this)[e](!1)}})}});var Gs=F((Kd,Hs)=>{"use strict";Hs.exports=Ne;var zs=Ci();(Ne.prototype=Object.create(zs.prototype)).constructor=Ne;var qs=ke();function Ne(t){zs.call(this,t)}Ne._configure=function(){qs.Buffer&&(Ne.prototype._slice=qs.Buffer.prototype.slice)};Ne.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))};Ne._configure()});var Di=F((Fd,$s)=>{"use strict";$s.exports=G;var Lt=ke(),Ti,rn=Lt.LongBits,Ws=Lt.base64,Zs=Lt.utf8;function Sr(t,e,r){this.fn=t,this.len=e,this.next=void 0,this.val=r}function _i(){}function Vc(t){this.head=t.head,this.tail=t.tail,this.len=t.len,this.next=t.states}function G(){this.len=0,this.head=new Sr(_i,0,0),this.tail=this.head,this.states=null}var Ys=function(){return Lt.Buffer?function(){return(G.create=function(){return new Ti})()}:function(){return new G}};G.create=Ys();G.alloc=function(e){return new Lt.Array(e)};Lt.Array!==Array&&(G.alloc=Lt.pool(G.alloc,Lt.Array.prototype.subarray));G.prototype._push=function(e,r,n){return this.tail=this.tail.next=new Sr(e,r,n),this.len+=r,this};function Ri(t,e,r){e[r]=t&255}function qc(t,e,r){for(;t>127;)e[r++]=t&127|128,t>>>=7;e[r]=t}function ki(t,e){this.len=t,this.next=void 0,this.val=e}ki.prototype=Object.create(Sr.prototype);ki.prototype.fn=qc;G.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new ki((e=e>>>0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this};G.prototype.int32=function(e){return e<0?this._push(Ni,10,rn.fromNumber(e)):this.uint32(e)};G.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)};function Ni(t,e,r){for(;t.hi;)e[r++]=t.lo&127|128,t.lo=(t.lo>>>7|t.hi<<25)>>>0,t.hi>>>=7;for(;t.lo>127;)e[r++]=t.lo&127|128,t.lo=t.lo>>>7;e[r++]=t.lo}G.prototype.uint64=function(e){var r=rn.from(e);return this._push(Ni,r.length(),r)};G.prototype.int64=G.prototype.uint64;G.prototype.sint64=function(e){var r=rn.from(e).zzEncode();return this._push(Ni,r.length(),r)};G.prototype.bool=function(e){return this._push(Ri,1,e?1:0)};function Ii(t,e,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24}G.prototype.fixed32=function(e){return this._push(Ii,4,e>>>0)};G.prototype.sfixed32=G.prototype.fixed32;G.prototype.fixed64=function(e){var r=rn.from(e);return this._push(Ii,4,r.lo)._push(Ii,4,r.hi)};G.prototype.sfixed64=G.prototype.fixed64;G.prototype.float=function(e){return this._push(Lt.float.writeFloatLE,4,e)};G.prototype.double=function(e){return this._push(Lt.float.writeDoubleLE,8,e)};var zc=Lt.Array.prototype.set?function(e,r,n){r.set(e,n)}:function(e,r,n){for(var i=0;i<e.length;++i)r[n+i]=e[i]};G.prototype.bytes=function(e){var r=e.length>>>0;if(!r)return this._push(Ri,1,0);if(Lt.isString(e)){var n=G.alloc(r=Ws.length(e));Ws.decode(e,n,0),e=n}return this.uint32(r)._push(zc,r,e)};G.prototype.string=function(e){var r=Zs.length(e);return r?this.uint32(r)._push(Zs.write,r,e):this._push(Ri,1,0)};G.prototype.fork=function(){return this.states=new Vc(this),this.head=this.tail=new Sr(_i,0,0),this.len=0,this};G.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Sr(_i,0,0),this.len=0),this};G.prototype.ldelim=function(){var e=this.head,r=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=e.next,this.tail=r,this.len+=n),this};G.prototype.finish=function(){for(var e=this.head.next,r=this.constructor.alloc(this.len),n=0;e;)e.fn(e.val,r,n),n+=e.len,e=e.next;return r};G._configure=function(t){Ti=t,G.create=Ys(),Ti._configure()}});var Js=F((Od,Xs)=>{"use strict";Xs.exports=Qt;var Qs=Di();(Qt.prototype=Object.create(Qs.prototype)).constructor=Qt;var xe=ke();function Qt(){Qs.call(this)}Qt._configure=function(){Qt.alloc=xe._Buffer_allocUnsafe,Qt.writeBytesBuffer=xe.Buffer&&xe.Buffer.prototype instanceof Uint8Array&&xe.Buffer.prototype.set.name==="set"?function(e,r,n){r.set(e,n)}:function(e,r,n){if(e.copy)e.copy(r,n,0,e.length);else for(var i=0;i<e.length;)r[n++]=e[i++]}};Qt.prototype.bytes=function(e){xe.isString(e)&&(e=xe._Buffer_from(e,"base64"));var r=e.length>>>0;return this.uint32(r),r&&this._push(Qt.writeBytesBuffer,r,e),this};function Hc(t,e,r){t.length<40?xe.utf8.write(t,e,r):e.utf8Write?e.utf8Write(t,r):e.write(t,r)}Qt.prototype.string=function(e){var r=xe.Buffer.byteLength(e);return this.uint32(r),r&&this._push(Hc,r,e),this};Qt._configure()});var fn=F((n1,n0)=>{var Er=X();Er.pki=Er.pki||{};var Mi=n0.exports=Er.pki.oids=Er.oids=Er.oids||{};function B(t,e){Mi[t]=e,Mi[e]=t}function Q(t,e){Mi[t]=e}B("1.2.840.113549.1.1.1","rsaEncryption");B("1.2.840.113549.1.1.4","md5WithRSAEncryption");B("1.2.840.113549.1.1.5","sha1WithRSAEncryption");B("1.2.840.113549.1.1.7","RSAES-OAEP");B("1.2.840.113549.1.1.8","mgf1");B("1.2.840.113549.1.1.9","pSpecified");B("1.2.840.113549.1.1.10","RSASSA-PSS");B("1.2.840.113549.1.1.11","sha256WithRSAEncryption");B("1.2.840.113549.1.1.12","sha384WithRSAEncryption");B("1.2.840.113549.1.1.13","sha512WithRSAEncryption");B("1.3.101.112","EdDSA25519");B("1.2.840.10040.4.3","dsa-with-sha1");B("1.3.14.3.2.7","desCBC");B("1.3.14.3.2.26","sha1");B("1.3.14.3.2.29","sha1WithRSASignature");B("2.16.840.1.101.3.4.2.1","sha256");B("2.16.840.1.101.3.4.2.2","sha384");B("2.16.840.1.101.3.4.2.3","sha512");B("2.16.840.1.101.3.4.2.4","sha224");B("2.16.840.1.101.3.4.2.5","sha512-224");B("2.16.840.1.101.3.4.2.6","sha512-256");B("1.2.840.113549.2.2","md2");B("1.2.840.113549.2.5","md5");B("1.2.840.113549.1.7.1","data");B("1.2.840.113549.1.7.2","signedData");B("1.2.840.113549.1.7.3","envelopedData");B("1.2.840.113549.1.7.4","signedAndEnvelopedData");B("1.2.840.113549.1.7.5","digestedData");B("1.2.840.113549.1.7.6","encryptedData");B("1.2.840.113549.1.9.1","emailAddress");B("1.2.840.113549.1.9.2","unstructuredName");B("1.2.840.113549.1.9.3","contentType");B("1.2.840.113549.1.9.4","messageDigest");B("1.2.840.113549.1.9.5","signingTime");B("1.2.840.113549.1.9.6","counterSignature");B("1.2.840.113549.1.9.7","challengePassword");B("1.2.840.113549.1.9.8","unstructuredAddress");B("1.2.840.113549.1.9.14","extensionRequest");B("1.2.840.113549.1.9.20","friendlyName");B("1.2.840.113549.1.9.21","localKeyId");B("1.2.840.113549.1.9.22.1","x509Certificate");B("1.2.840.113549.1.12.10.1.1","keyBag");B("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag");B("1.2.840.113549.1.12.10.1.3","certBag");B("1.2.840.113549.1.12.10.1.4","crlBag");B("1.2.840.113549.1.12.10.1.5","secretBag");B("1.2.840.113549.1.12.10.1.6","safeContentsBag");B("1.2.840.113549.1.5.13","pkcs5PBES2");B("1.2.840.113549.1.5.12","pkcs5PBKDF2");B("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4");B("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4");B("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC");B("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC");B("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC");B("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC");B("1.2.840.113549.2.7","hmacWithSHA1");B("1.2.840.113549.2.8","hmacWithSHA224");B("1.2.840.113549.2.9","hmacWithSHA256");B("1.2.840.113549.2.10","hmacWithSHA384");B("1.2.840.113549.2.11","hmacWithSHA512");B("1.2.840.113549.3.7","des-EDE3-CBC");B("2.16.840.1.101.3.4.1.2","aes128-CBC");B("2.16.840.1.101.3.4.1.22","aes192-CBC");B("2.16.840.1.101.3.4.1.42","aes256-CBC");B("2.5.4.3","commonName");B("2.5.4.4","surname");B("2.5.4.5","serialNumber");B("2.5.4.6","countryName");B("2.5.4.7","localityName");B("2.5.4.8","stateOrProvinceName");B("2.5.4.9","streetAddress");B("2.5.4.10","organizationName");B("2.5.4.11","organizationalUnitName");B("2.5.4.12","title");B("2.5.4.13","description");B("2.5.4.15","businessCategory");B("2.5.4.17","postalCode");B("2.5.4.42","givenName");B("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName");B("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName");B("2.16.840.1.113730.1.1","nsCertType");B("2.16.840.1.113730.1.13","nsComment");Q("2.5.29.1","authorityKeyIdentifier");Q("2.5.29.2","keyAttributes");Q("2.5.29.3","certificatePolicies");Q("2.5.29.4","keyUsageRestriction");Q("2.5.29.5","policyMapping");Q("2.5.29.6","subtreesConstraint");Q("2.5.29.7","subjectAltName");Q("2.5.29.8","issuerAltName");Q("2.5.29.9","subjectDirectoryAttributes");Q("2.5.29.10","basicConstraints");Q("2.5.29.11","nameConstraints");Q("2.5.29.12","policyConstraints");Q("2.5.29.13","basicConstraints");B("2.5.29.14","subjectKeyIdentifier");B("2.5.29.15","keyUsage");Q("2.5.29.16","privateKeyUsagePeriod");B("2.5.29.17","subjectAltName");B("2.5.29.18","issuerAltName");B("2.5.29.19","basicConstraints");Q("2.5.29.20","cRLNumber");Q("2.5.29.21","cRLReason");Q("2.5.29.22","expirationDate");Q("2.5.29.23","instructionCode");Q("2.5.29.24","invalidityDate");Q("2.5.29.25","cRLDistributionPoints");Q("2.5.29.26","issuingDistributionPoint");Q("2.5.29.27","deltaCRLIndicator");Q("2.5.29.28","issuingDistributionPoint");Q("2.5.29.29","certificateIssuer");Q("2.5.29.30","nameConstraints");B("2.5.29.31","cRLDistributionPoints");B("2.5.29.32","certificatePolicies");Q("2.5.29.33","policyMappings");Q("2.5.29.34","policyConstraints");B("2.5.29.35","authorityKeyIdentifier");Q("2.5.29.36","policyConstraints");B("2.5.29.37","extKeyUsage");Q("2.5.29.46","freshestCRL");Q("2.5.29.54","inhibitAnyPolicy");B("1.3.6.1.4.1.11129.2.4.2","timestampList");B("1.3.6.1.5.5.7.1.1","authorityInfoAccess");B("1.3.6.1.5.5.7.3.1","serverAuth");B("1.3.6.1.5.5.7.3.2","clientAuth");B("1.3.6.1.5.5.7.3.3","codeSigning");B("1.3.6.1.5.5.7.3.4","emailProtection");B("1.3.6.1.5.5.7.3.8","timeStamping")});var Ar=F((i1,a0)=>{var tt=X();lt();fn();var C=a0.exports=tt.asn1=tt.asn1||{};C.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192};C.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30};C.create=function(t,e,r,n,i){if(tt.util.isArray(n)){for(var a=[],s=0;s<n.length;++s)n[s]!==void 0&&a.push(n[s]);n=a}var o={tagClass:t,type:e,constructed:r,composed:r||tt.util.isArray(n),value:n};return i&&"bitStringContents"in i&&(o.bitStringContents=i.bitStringContents,o.original=C.copy(o)),o};C.copy=function(t,e){var r;if(tt.util.isArray(t)){r=[];for(var n=0;n<t.length;++n)r.push(C.copy(t[n],e));return r}return typeof t=="string"?t:(r={tagClass:t.tagClass,type:t.type,constructed:t.constructed,composed:t.composed,value:C.copy(t.value,e)},e&&!e.excludeBitStringContents&&(r.bitStringContents=t.bitStringContents),r)};C.equals=function(t,e,r){if(tt.util.isArray(t)){if(!tt.util.isArray(e)||t.length!==e.length)return!1;for(var n=0;n<t.length;++n)if(!C.equals(t[n],e[n]))return!1;return!0}if(typeof t!=typeof e)return!1;if(typeof t=="string")return t===e;var i=t.tagClass===e.tagClass&&t.type===e.type&&t.constructed===e.constructed&&t.composed===e.composed&&C.equals(t.value,e.value);return r&&r.includeBitStringContents&&(i=i&&t.bitStringContents===e.bitStringContents),i};C.getBerValueLength=function(t){var e=t.getByte();if(e!==128){var r,n=e&128;return n?r=t.getInt((e&127)<<3):r=e,r}};function Br(t,e,r){if(r>e){var n=new Error("Too few bytes to parse DER.");throw n.available=t.length(),n.remaining=e,n.requested=r,n}}var Yc=function(t,e){var r=t.getByte();if(e--,r!==128){var n,i=r&128;if(!i)n=r;else{var a=r&127;Br(t,e,a),n=t.getInt(a<<3)}if(n<0)throw new Error("Negative length: "+n);return n}};C.fromDer=function(t,e){e===void 0&&(e={strict:!0,parseAllBytes:!0,decodeBitStrings:!0}),typeof e=="boolean"&&(e={strict:e,parseAllBytes:!0,decodeBitStrings:!0}),"strict"in e||(e.strict=!0),"parseAllBytes"in e||(e.parseAllBytes=!0),"decodeBitStrings"in e||(e.decodeBitStrings=!0),typeof t=="string"&&(t=tt.util.createBuffer(t));var r=t.length(),n=cn(t,t.length(),0,e);if(e.parseAllBytes&&t.length()!==0){var i=new Error("Unparsed DER bytes remain after ASN.1 parsing.");throw i.byteCount=r,i.remaining=t.length(),i}return n};function cn(t,e,r,n){var i;Br(t,e,2);var a=t.getByte();e--;var s=a&192,o=a&31;i=t.length();var f=Yc(t,e);if(e-=i-t.length(),f!==void 0&&f>e){if(n.strict){var c=new Error("Too few bytes to read ASN.1 value.");throw c.available=t.length(),c.remaining=e,c.requested=f,c}f=e}var u,h,l=(a&32)===32;if(l)if(u=[],f===void 0)for(;;){if(Br(t,e,2),t.bytes(2)===String.fromCharCode(0,0)){t.getBytes(2),e-=2;break}i=t.length(),u.push(cn(t,e,r+1,n)),e-=i-t.length()}else for(;f>0;)i=t.length(),u.push(cn(t,f,r+1,n)),e-=i-t.length(),f-=i-t.length();if(u===void 0&&s===C.Class.UNIVERSAL&&o===C.Type.BITSTRING&&(h=t.bytes(f)),u===void 0&&n.decodeBitStrings&&s===C.Class.UNIVERSAL&&o===C.Type.BITSTRING&&f>1){var d=t.read,p=e,g=0;if(o===C.Type.BITSTRING&&(Br(t,e,1),g=t.getByte(),e--),g===0)try{i=t.length();var v={strict:!0,decodeBitStrings:!0},m=cn(t,e,r+1,v),S=i-t.length();e-=S,o==C.Type.BITSTRING&&S++;var A=m.tagClass;S===f&&(A===C.Class.UNIVERSAL||A===C.Class.CONTEXT_SPECIFIC)&&(u=[m])}catch{}u===void 0&&(t.read=d,e=p)}if(u===void 0){if(f===void 0){if(n.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");f=e}if(o===C.Type.BMPSTRING)for(u="";f>0;f-=2)Br(t,e,2),u+=String.fromCharCode(t.getInt16()),e-=2;else u=t.getBytes(f),e-=f}var D=h===void 0?null:{bitStringContents:h};return C.create(s,o,l,u,D)}C.toDer=function(t){var e=tt.util.createBuffer(),r=t.tagClass|t.type,n=tt.util.createBuffer(),i=!1;if("bitStringContents"in t&&(i=!0,t.original&&(i=C.equals(t,t.original))),i)n.putBytes(t.bitStringContents);else if(t.composed){t.constructed?r|=32:n.putByte(0);for(var a=0;a<t.value.length;++a)t.value[a]!==void 0&&n.putBuffer(C.toDer(t.value[a]))}else if(t.type===C.Type.BMPSTRING)for(var a=0;a<t.value.length;++a)n.putInt16(t.value.charCodeAt(a));else t.type===C.Type.INTEGER&&t.value.length>1&&(t.value.charCodeAt(0)===0&&!(t.value.charCodeAt(1)&128)||t.value.charCodeAt(0)===255&&(t.value.charCodeAt(1)&128)===128)?n.putBytes(t.value.substr(1)):n.putBytes(t.value);if(e.putByte(r),n.length()<=127)e.putByte(n.length()&127);else{var s=n.length(),o="";do o+=String.fromCharCode(s&255),s=s>>>8;while(s>0);e.putByte(o.length|128);for(var a=o.length-1;a>=0;--a)e.putByte(o.charCodeAt(a))}return e.putBuffer(n),e};C.oidToDer=function(t){var e=t.split("."),r=tt.util.createBuffer();r.putByte(40*parseInt(e[0],10)+parseInt(e[1],10));for(var n,i,a,s,o=2;o<e.length;++o){n=!0,i=[],a=parseInt(e[o],10);do s=a&127,a=a>>>7,n||(s|=128),i.push(s),n=!1;while(a>0);for(var f=i.length-1;f>=0;--f)r.putByte(i[f])}return r};C.derToOid=function(t){var e;typeof t=="string"&&(t=tt.util.createBuffer(t));var r=t.getByte();e=Math.floor(r/40)+"."+r%40;for(var n=0;t.length()>0;)r=t.getByte(),n=n<<7,r&128?n+=r&127:(e+="."+(n+r),n=0);return e};C.utcTimeToDate=function(t){var e=new Date,r=parseInt(t.substr(0,2),10);r=r>=50?1900+r:2e3+r;var n=parseInt(t.substr(2,2),10)-1,i=parseInt(t.substr(4,2),10),a=parseInt(t.substr(6,2),10),s=parseInt(t.substr(8,2),10),o=0;if(t.length>11){var f=t.charAt(10),c=10;f!=="+"&&f!=="-"&&(o=parseInt(t.substr(10,2),10),c+=2)}if(e.setUTCFullYear(r,n,i),e.setUTCHours(a,s,o,0),c&&(f=t.charAt(c),f==="+"||f==="-")){var u=parseInt(t.substr(c+1,2),10),h=parseInt(t.substr(c+4,2),10),l=u*60+h;l*=6e4,f==="+"?e.setTime(+e-l):e.setTime(+e+l)}return e};C.generalizedTimeToDate=function(t){var e=new Date,r=parseInt(t.substr(0,4),10),n=parseInt(t.substr(4,2),10)-1,i=parseInt(t.substr(6,2),10),a=parseInt(t.substr(8,2),10),s=parseInt(t.substr(10,2),10),o=parseInt(t.substr(12,2),10),f=0,c=0,u=!1;t.charAt(t.length-1)==="Z"&&(u=!0);var h=t.length-5,l=t.charAt(h);if(l==="+"||l==="-"){var d=parseInt(t.substr(h+1,2),10),p=parseInt(t.substr(h+4,2),10);c=d*60+p,c*=6e4,l==="+"&&(c*=-1),u=!0}return t.charAt(14)==="."&&(f=parseFloat(t.substr(14),10)*1e3),u?(e.setUTCFullYear(r,n,i),e.setUTCHours(a,s,o,f),e.setTime(+e+c)):(e.setFullYear(r,n,i),e.setHours(a,s,o,f)),e};C.dateToUtcTime=function(t){if(typeof t=="string")return t;var e="",r=[];r.push((""+t.getUTCFullYear()).substr(2)),r.push(""+(t.getUTCMonth()+1)),r.push(""+t.getUTCDate()),r.push(""+t.getUTCHours()),r.push(""+t.getUTCMinutes()),r.push(""+t.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(e+="0"),e+=r[n];return e+="Z",e};C.dateToGeneralizedTime=function(t){if(typeof t=="string")return t;var e="",r=[];r.push(""+t.getUTCFullYear()),r.push(""+(t.getUTCMonth()+1)),r.push(""+t.getUTCDate()),r.push(""+t.getUTCHours()),r.push(""+t.getUTCMinutes()),r.push(""+t.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(e+="0"),e+=r[n];return e+="Z",e};C.integerToDer=function(t){var e=tt.util.createBuffer();if(t>=-128&&t<128)return e.putSignedInt(t,8);if(t>=-32768&&t<32768)return e.putSignedInt(t,16);if(t>=-8388608&&t<8388608)return e.putSignedInt(t,24);if(t>=-2147483648&&t<2147483648)return e.putSignedInt(t,32);var r=new Error("Integer too large; max is 32-bits.");throw r.integer=t,r};C.derToInteger=function(t){typeof t=="string"&&(t=tt.util.createBuffer(t));var e=t.length()*8;if(e>32)throw new Error("Integer too large; max is 32-bits.");return t.getSignedInt(e)};C.validate=function(t,e,r,n){var i=!1;if((t.tagClass===e.tagClass||typeof e.tagClass>"u")&&(t.type===e.type||typeof e.type>"u"))if(t.constructed===e.constructed||typeof e.constructed>"u"){if(i=!0,e.value&&tt.util.isArray(e.value))for(var a=0,s=0;i&&s<e.value.length;++s)i=e.value[s].optional||!1,t.value[a]&&(i=C.validate(t.value[a],e.value[s],r,n),i?++a:e.value[s].optional&&(i=!0)),!i&&n&&n.push("["+e.name+'] Tag class "'+e.tagClass+'", type "'+e.type+'" expected value length "'+e.value.length+'", got "'+t.value.length+'"');if(i&&r&&(e.capture&&(r[e.capture]=t.value),e.captureAsn1&&(r[e.captureAsn1]=t),e.captureBitStringContents&&"bitStringContents"in t&&(r[e.captureBitStringContents]=t.bitStringContents),e.captureBitStringValue&&"bitStringContents"in t)){var o;if(t.bitStringContents.length<2)r[e.captureBitStringValue]="";else{var f=t.bitStringContents.charCodeAt(0);if(f!==0)throw new Error("captureBitStringValue only supported for zero unused bits");r[e.captureBitStringValue]=t.bitStringContents.slice(1)}}}else n&&n.push("["+e.name+'] Expected constructed "'+e.constructed+'", got "'+t.constructed+'"');else n&&(t.tagClass!==e.tagClass&&n.push("["+e.name+'] Expected tag class "'+e.tagClass+'", got "'+t.tagClass+'"'),t.type!==e.type&&n.push("["+e.name+'] Expected type "'+e.type+'", got "'+t.type+'"'));return i};var i0=/[^\\u0000-\\u00ff]/;C.prettyPrint=function(t,e,r){var n="";e=e||0,r=r||2,e>0&&(n+=`
`);for(var i="",a=0;a<e*r;++a)i+=" ";switch(n+=i+"Tag: ",t.tagClass){case C.Class.UNIVERSAL:n+="Universal:";break;case C.Class.APPLICATION:n+="Application:";break;case C.Class.CONTEXT_SPECIFIC:n+="Context-Specific:";break;case C.Class.PRIVATE:n+="Private:";break}if(t.tagClass===C.Class.UNIVERSAL)switch(n+=t.type,t.type){case C.Type.NONE:n+=" (None)";break;case C.Type.BOOLEAN:n+=" (Boolean)";break;case C.Type.INTEGER:n+=" (Integer)";break;case C.Type.BITSTRING:n+=" (Bit string)";break;case C.Type.OCTETSTRING:n+=" (Octet string)";break;case C.Type.NULL:n+=" (Null)";break;case C.Type.OID:n+=" (Object Identifier)";break;case C.Type.ODESC:n+=" (Object Descriptor)";break;case C.Type.EXTERNAL:n+=" (External or Instance of)";break;case C.Type.REAL:n+=" (Real)";break;case C.Type.ENUMERATED:n+=" (Enumerated)";break;case C.Type.EMBEDDED:n+=" (Embedded PDV)";break;case C.Type.UTF8:n+=" (UTF8)";break;case C.Type.ROID:n+=" (Relative Object Identifier)";break;case C.Type.SEQUENCE:n+=" (Sequence)";break;case C.Type.SET:n+=" (Set)";break;case C.Type.PRINTABLESTRING:n+=" (Printable String)";break;case C.Type.IA5String:n+=" (IA5String (ASCII))";break;case C.Type.UTCTIME:n+=" (UTC time)";break;case C.Type.GENERALIZEDTIME:n+=" (Generalized time)";break;case C.Type.BMPSTRING:n+=" (BMP String)";break}else n+=t.type;if(n+=`
`,n+=i+"Constructed: "+t.constructed+`
`,t.composed){for(var s=0,o="",a=0;a<t.value.length;++a)t.value[a]!==void 0&&(s+=1,o+=C.prettyPrint(t.value[a],e+1,r),a+1<t.value.length&&(o+=","));n+=i+"Sub values: "+s+o}else{if(n+=i+"Value: ",t.type===C.Type.OID){var f=C.derToOid(t.value);n+=f,tt.pki&&tt.pki.oids&&f in tt.pki.oids&&(n+=" ("+tt.pki.oids[f]+") ")}if(t.type===C.Type.INTEGER)try{n+=C.derToInteger(t.value)}catch{n+="0x"+tt.util.bytesToHex(t.value)}else if(t.type===C.Type.BITSTRING){if(t.value.length>1?n+="0x"+tt.util.bytesToHex(t.value.slice(1)):n+="(none)",t.value.length>0){var c=t.value.charCodeAt(0);c==1?n+=" (1 unused bit shown)":c>1&&(n+=" ("+c+" unused bits shown)")}}else if(t.type===C.Type.OCTETSTRING)i0.test(t.value)||(n+="("+t.value+") "),n+="0x"+tt.util.bytesToHex(t.value);else if(t.type===C.Type.UTF8)try{n+=tt.util.decodeUtf8(t.value)}catch(u){if(u.message==="URI malformed")n+="0x"+tt.util.bytesToHex(t.value)+" (malformed UTF8)";else throw u}else t.type===C.Type.PRINTABLESTRING||t.type===C.Type.IA5String?n+=t.value:i0.test(t.value)?n+="0x"+tt.util.bytesToHex(t.value):t.value.length===0?n+="[null]":n+=t.value}return n}});var f0=F((a1,o0)=>{var at=X();Wn();Yn();lt();o0.exports=at.des=at.des||{};at.des.startEncrypting=function(t,e,r,n){var i=un({key:t,output:r,decrypt:!1,mode:n||(e===null?"ECB":"CBC")});return i.start(e),i};at.des.createEncryptionCipher=function(t,e){return un({key:t,output:null,decrypt:!1,mode:e})};at.des.startDecrypting=function(t,e,r,n){var i=un({key:t,output:r,decrypt:!0,mode:n||(e===null?"ECB":"CBC")});return i.start(e),i};at.des.createDecryptionCipher=function(t,e){return un({key:t,output:null,decrypt:!0,mode:e})};at.des.Algorithm=function(t,e){var r=this;r.name=t,r.mode=new e({blockSize:8,cipher:{encrypt:function(n,i){return s0(r._keys,n,i,!1)},decrypt:function(n,i){return s0(r._keys,n,i,!0)}}}),r._init=!1};at.des.Algorithm.prototype.initialize=function(t){if(!this._init){var e=at.util.createBuffer(t.key);if(this.name.indexOf("3DES")===0&&e.length()!==24)throw new Error("Invalid Triple-DES key size: "+e.length()*8);this._keys=nu(e),this._init=!0}};Xt("DES-ECB",at.cipher.modes.ecb);Xt("DES-CBC",at.cipher.modes.cbc);Xt("DES-CFB",at.cipher.modes.cfb);Xt("DES-OFB",at.cipher.modes.ofb);Xt("DES-CTR",at.cipher.modes.ctr);Xt("3DES-ECB",at.cipher.modes.ecb);Xt("3DES-CBC",at.cipher.modes.cbc);Xt("3DES-CFB",at.cipher.modes.cfb);Xt("3DES-OFB",at.cipher.modes.ofb);Xt("3DES-CTR",at.cipher.modes.ctr);function Xt(t,e){var r=function(){return new at.des.Algorithm(t,e)};at.cipher.registerAlgorithm(t,r)}var $c=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],Qc=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],Xc=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],Jc=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],jc=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],tu=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],eu=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],ru=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function nu(t){for(var e=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],r=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],n=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],i=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],a=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],s=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],o=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],f=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],c=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],u=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],h=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],l=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],d=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],p=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],g=t.length()>8?3:1,v=[],m=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],S=0,A,D=0;D<g;D++){var T=t.getInt32(),_=t.getInt32();A=(T>>>4^_)&252645135,_^=A,T^=A<<4,A=(_>>>-16^T)&65535,T^=A,_^=A<<-16,A=(T>>>2^_)&858993459,_^=A,T^=A<<2,A=(_>>>-16^T)&65535,T^=A,_^=A<<-16,A=(T>>>1^_)&1431655765,_^=A,T^=A<<1,A=(_>>>8^T)&16711935,T^=A,_^=A<<8,A=(T>>>1^_)&1431655765,_^=A,T^=A<<1,A=T<<8|_>>>20&240,T=_<<24|_<<8&16711680|_>>>8&65280|_>>>24&240,_=A;for(var V=0;V<m.length;++V){m[V]?(T=T<<2|T>>>26,_=_<<2|_>>>26):(T=T<<1|T>>>27,_=_<<1|_>>>27),T&=-15,_&=-15;var Y=e[T>>>28]|r[T>>>24&15]|n[T>>>20&15]|i[T>>>16&15]|a[T>>>12&15]|s[T>>>8&15]|o[T>>>4&15],wt=f[_>>>28]|c[_>>>24&15]|u[_>>>20&15]|h[_>>>16&15]|l[_>>>12&15]|d[_>>>8&15]|p[_>>>4&15];A=(wt>>>16^Y)&65535,v[S++]=Y^A,v[S++]=wt^A<<16}}return v}function s0(t,e,r,n){var i=t.length===32?3:9,a;i===3?a=n?[30,-2,-2]:[0,32,2]:a=n?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var s,o=e[0],f=e[1];s=(o>>>4^f)&252645135,f^=s,o^=s<<4,s=(o>>>16^f)&65535,f^=s,o^=s<<16,s=(f>>>2^o)&858993459,o^=s,f^=s<<2,s=(f>>>8^o)&16711935,o^=s,f^=s<<8,s=(o>>>1^f)&1431655765,f^=s,o^=s<<1,o=o<<1|o>>>31,f=f<<1|f>>>31;for(var c=0;c<i;c+=3){for(var u=a[c+1],h=a[c+2],l=a[c];l!=u;l+=h){var d=f^t[l],p=(f>>>4|f<<28)^t[l+1];s=o,o=f,f=s^(Qc[d>>>24&63]|Jc[d>>>16&63]|tu[d>>>8&63]|ru[d&63]|$c[p>>>24&63]|Xc[p>>>16&63]|jc[p>>>8&63]|eu[p&63])}s=o,o=f,f=s}o=o>>>1|o<<31,f=f>>>1|f<<31,s=(o>>>1^f)&1431655765,f^=s,o^=s<<1,s=(f>>>8^o)&16711935,o^=s,f^=s<<8,s=(f>>>2^o)&858993459,o^=s,f^=s<<2,s=(o>>>16^f)&65535,f^=s,o^=s<<16,s=(o>>>4^f)&252645135,f^=s,o^=s<<4,r[0]=o,r[1]=f}function un(t){t=t||{};var e=(t.mode||"CBC").toUpperCase(),r="DES-"+e,n;t.decrypt?n=at.cipher.createDecipher(r,t.key):n=at.cipher.createCipher(r,t.key);var i=n.start;return n.start=function(a,s){var o=null;s instanceof at.util.ByteBuffer&&(o=s,s={}),s=s||{},s.output=o,s.iv=a,i.call(n,s)},n}});var De=F((s1,c0)=>{var hn=X();c0.exports=hn.md=hn.md||{};hn.md.algorithms=hn.md.algorithms||{}});var h0=F((o1,u0)=>{var fe=X();De();lt();var iu=u0.exports=fe.hmac=fe.hmac||{};iu.create=function(){var t=null,e=null,r=null,n=null,i={};return i.start=function(a,s){if(a!==null)if(typeof a=="string")if(a=a.toLowerCase(),a in fe.md.algorithms)e=fe.md.algorithms[a].create();else throw new Error('Unknown hash algorithm "'+a+'"');else e=a;if(s===null)s=t;else{if(typeof s=="string")s=fe.util.createBuffer(s);else if(fe.util.isArray(s)){var o=s;s=fe.util.createBuffer();for(var f=0;f<o.length;++f)s.putByte(o[f])}var c=s.length();c>e.blockLength&&(e.start(),e.update(s.bytes()),s=e.digest()),r=fe.util.createBuffer(),n=fe.util.createBuffer(),c=s.length();for(var f=0;f<c;++f){var o=s.at(f);r.putByte(54^o),n.putByte(92^o)}if(c<e.blockLength)for(var o=e.blockLength-c,f=0;f<o;++f)r.putByte(54),n.putByte(92);t=s,r=r.bytes(),n=n.bytes()}e.start(),e.update(r)},i.update=function(a){e.update(a)},i.getMac=function(){var a=e.digest().bytes();return e.start(),e.update(n),e.update(a),e.digest()},i.digest=i.getMac,i}});var tr=F(()=>{});var Vi=F((u1,l0)=>{var At=X();h0();De();lt();var au=At.pkcs5=At.pkcs5||{},ce;At.util.isNodejs&&!At.options.usePureJavaScript&&(ce=tr());l0.exports=At.pbkdf2=au.pbkdf2=function(t,e,r,n,i,a){if(typeof i=="function"&&(a=i,i=null),At.util.isNodejs&&!At.options.usePureJavaScript&&ce.pbkdf2&&(i===null||typeof i!="object")&&(ce.pbkdf2Sync.length>4||!i||i==="sha1"))return typeof i!="string"&&(i="sha1"),t=Buffer.from(t,"binary"),e=Buffer.from(e,"binary"),a?ce.pbkdf2Sync.length===4?ce.pbkdf2(t,e,r,n,function(A,D){if(A)return a(A);a(null,D.toString("binary"))}):ce.pbkdf2(t,e,r,n,i,function(A,D){if(A)return a(A);a(null,D.toString("binary"))}):ce.pbkdf2Sync.length===4?ce.pbkdf2Sync(t,e,r,n).toString("binary"):ce.pbkdf2Sync(t,e,r,n,i).toString("binary");if((typeof i>"u"||i===null)&&(i="sha1"),typeof i=="string"){if(!(i in At.md.algorithms))throw new Error("Unknown hash algorithm: "+i);i=At.md[i].create()}var s=i.digestLength;if(n>4294967295*s){var o=new Error("Derived key is too long.");if(a)return a(o);throw o}var f=Math.ceil(n/s),c=n-(f-1)*s,u=At.hmac.create();u.start(i,t);var h="",l,d,p;if(!a){for(var g=1;g<=f;++g){u.start(null,null),u.update(e),u.update(At.util.int32ToBytes(g)),l=p=u.digest().getBytes();for(var v=2;v<=r;++v)u.start(null,null),u.update(p),d=u.digest().getBytes(),l=At.util.xorBytes(l,d,s),p=d;h+=g<f?l:l.substr(0,c)}return h}var g=1,v;function m(){if(g>f)return a(null,h);u.start(null,null),u.update(e),u.update(At.util.int32ToBytes(g)),l=p=u.digest().getBytes(),v=2,S()}function S(){if(v<=r)return u.start(null,null),u.update(p),d=u.digest().getBytes(),l=At.util.xorBytes(l,d,s),p=d,++v,At.util.setImmediate(S);h+=g<f?l:l.substr(0,c),++g,m()}m()}});var y0=F((h1,d0)=>{var pn=X();lt();var p0=d0.exports=pn.pem=pn.pem||{};p0.encode=function(t,e){e=e||{};var r="-----BEGIN "+t.type+`-----\r
`,n;if(t.procType&&(n={name:"Proc-Type",values:[String(t.procType.version),t.procType.type]},r+=ln(n)),t.contentDomain&&(n={name:"Content-Domain",values:[t.contentDomain]},r+=ln(n)),t.dekInfo&&(n={name:"DEK-Info",values:[t.dekInfo.algorithm]},t.dekInfo.parameters&&n.values.push(t.dekInfo.parameters),r+=ln(n)),t.headers)for(var i=0;i<t.headers.length;++i)r+=ln(t.headers[i]);return t.procType&&(r+=`\r
`),r+=pn.util.encode64(t.body,e.maxline||64)+`\r
`,r+="-----END "+t.type+`-----\r
`,r};p0.decode=function(t){for(var e=[],r=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,n=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,i=/\r?\n/,a;a=r.exec(t),!!a;){var s=a[1];s==="NEW CERTIFICATE REQUEST"&&(s="CERTIFICATE REQUEST");var o={type:s,procType:null,contentDomain:null,dekInfo:null,headers:[],body:pn.util.decode64(a[3])};if(e.push(o),!!a[2]){for(var f=a[2].split(i),c=0;a&&c<f.length;){for(var u=f[c].replace(/\s+$/,""),h=c+1;h<f.length;++h){var l=f[h];if(!/\s/.test(l[0]))break;u+=l,c=h}if(a=u.match(n),a){for(var d={name:a[1],values:[]},p=a[2].split(","),g=0;g<p.length;++g)d.values.push(su(p[g]));if(o.procType)if(!o.contentDomain&&d.name==="Content-Domain")o.contentDomain=p[0]||"";else if(!o.dekInfo&&d.name==="DEK-Info"){if(d.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');o.dekInfo={algorithm:p[0],parameters:p[1]||null}}else o.headers.push(d);else{if(d.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(d.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');o.procType={version:p[0],type:p[1]}}}++c}if(o.procType==="ENCRYPTED"&&!o.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(e.length===0)throw new Error("Invalid PEM formatted message.");return e};function ln(t){for(var e=t.name+": ",r=[],n=function(f,c){return" "+c},i=0;i<t.values.length;++i)r.push(t.values[i].replace(/^(\S+\r\n)/,n));e+=r.join(",")+`\r
`;for(var a=0,s=-1,i=0;i<e.length;++i,++a)if(a>65&&s!==-1){var o=e[s];o===","?(++s,e=e.substr(0,s)+`\r
 `+e.substr(s)):e=e.substr(0,s)+`\r
`+o+e.substr(s+1),a=i-s-1,s=-1,++i}else(e[i]===" "||e[i]==="	"||e[i]===",")&&(s=i);return e}function su(t){return t.replace(/^\s+/,"")}});var w0=F((l1,b0)=>{var Jt=X();De();lt();var x0=b0.exports=Jt.sha256=Jt.sha256||{};Jt.md.sha256=Jt.md.algorithms.sha256=x0;x0.create=function(){v0||ou();var t=null,e=Jt.util.createBuffer(),r=new Array(64),n={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var i=n.messageLengthSize/4,a=0;a<i;++a)n.fullMessageLength.push(0);return e=Jt.util.createBuffer(),t={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},n},n.start(),n.update=function(i,a){a==="utf8"&&(i=Jt.util.encodeUtf8(i));var s=i.length;n.messageLength+=s,s=[s/4294967296>>>0,s>>>0];for(var o=n.fullMessageLength.length-1;o>=0;--o)n.fullMessageLength[o]+=s[1],s[1]=s[0]+(n.fullMessageLength[o]/4294967296>>>0),n.fullMessageLength[o]=n.fullMessageLength[o]>>>0,s[0]=s[1]/4294967296>>>0;return e.putBytes(i),g0(t,r,e),(e.read>2048||e.length()===0)&&e.compact(),n},n.digest=function(){var i=Jt.util.createBuffer();i.putBytes(e.bytes());var a=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,s=a&n.blockLength-1;i.putBytes(qi.substr(0,n.blockLength-s));for(var o,f,c=n.fullMessageLength[0]*8,u=0;u<n.fullMessageLength.length-1;++u)o=n.fullMessageLength[u+1]*8,f=o/4294967296>>>0,c+=f,i.putInt32(c>>>0),c=o>>>0;i.putInt32(c);var h={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3,h4:t.h4,h5:t.h5,h6:t.h6,h7:t.h7};g0(h,r,i);var l=Jt.util.createBuffer();return l.putInt32(h.h0),l.putInt32(h.h1),l.putInt32(h.h2),l.putInt32(h.h3),l.putInt32(h.h4),l.putInt32(h.h5),l.putInt32(h.h6),l.putInt32(h.h7),l},n};var qi=null,v0=!1,m0=null;function ou(){qi=String.fromCharCode(128),qi+=Jt.util.fillString(String.fromCharCode(0),64),m0=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],v0=!0}function g0(t,e,r){for(var n,i,a,s,o,f,c,u,h,l,d,p,g,v,m,S=r.length();S>=64;){for(c=0;c<16;++c)e[c]=r.getInt32();for(;c<64;++c)n=e[c-2],n=(n>>>17|n<<15)^(n>>>19|n<<13)^n>>>10,i=e[c-15],i=(i>>>7|i<<25)^(i>>>18|i<<14)^i>>>3,e[c]=n+e[c-7]+i+e[c-16]|0;for(u=t.h0,h=t.h1,l=t.h2,d=t.h3,p=t.h4,g=t.h5,v=t.h6,m=t.h7,c=0;c<64;++c)s=(p>>>6|p<<26)^(p>>>11|p<<21)^(p>>>25|p<<7),o=v^p&(g^v),a=(u>>>2|u<<30)^(u>>>13|u<<19)^(u>>>22|u<<10),f=u&h|l&(u^h),n=m+s+o+m0[c]+e[c],i=a+f,m=v,v=g,g=p,p=d+n>>>0,d=l,l=h,h=u,u=n+i>>>0;t.h0=t.h0+u|0,t.h1=t.h1+h|0,t.h2=t.h2+l|0,t.h3=t.h3+d|0,t.h4=t.h4+p|0,t.h5=t.h5+g|0,t.h6=t.h6+v|0,t.h7=t.h7+m|0,S-=64}}});var E0=F((p1,S0)=>{var jt=X();lt();var dn=null;jt.util.isNodejs&&!jt.options.usePureJavaScript&&!process.versions["node-webkit"]&&(dn=tr());var fu=S0.exports=jt.prng=jt.prng||{};fu.create=function(t){for(var e={plugin:t,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},r=t.md,n=new Array(32),i=0;i<32;++i)n[i]=r.create();e.pools=n,e.pool=0,e.generate=function(c,u){if(!u)return e.generateSync(c);var h=e.plugin.cipher,l=e.plugin.increment,d=e.plugin.formatKey,p=e.plugin.formatSeed,g=jt.util.createBuffer();e.key=null,v();function v(m){if(m)return u(m);if(g.length()>=c)return u(null,g.getBytes(c));if(e.generated>1048575&&(e.key=null),e.key===null)return jt.util.nextTick(function(){a(v)});var S=h(e.key,e.seed);e.generated+=S.length,g.putBytes(S),e.key=d(h(e.key,l(e.seed))),e.seed=p(h(e.key,e.seed)),jt.util.setImmediate(v)}},e.generateSync=function(c){var u=e.plugin.cipher,h=e.plugin.increment,l=e.plugin.formatKey,d=e.plugin.formatSeed;e.key=null;for(var p=jt.util.createBuffer();p.length()<c;){e.generated>1048575&&(e.key=null),e.key===null&&s();var g=u(e.key,e.seed);e.generated+=g.length,p.putBytes(g),e.key=l(u(e.key,h(e.seed))),e.seed=d(u(e.key,e.seed))}return p.getBytes(c)};function a(c){if(e.pools[0].messageLength>=32)return o(),c();var u=32-e.pools[0].messageLength<<5;e.seedFile(u,function(h,l){if(h)return c(h);e.collect(l),o(),c()})}function s(){if(e.pools[0].messageLength>=32)return o();var c=32-e.pools[0].messageLength<<5;e.collect(e.seedFileSync(c)),o()}function o(){e.reseeds=e.reseeds===4294967295?0:e.reseeds+1;var c=e.plugin.md.create();c.update(e.keyBytes);for(var u=1,h=0;h<32;++h)e.reseeds%u===0&&(c.update(e.pools[h].digest().getBytes()),e.pools[h].start()),u=u<<1;e.keyBytes=c.digest().getBytes(),c.start(),c.update(e.keyBytes);var l=c.digest().getBytes();e.key=e.plugin.formatKey(e.keyBytes),e.seed=e.plugin.formatSeed(l),e.generated=0}function f(c){var u=null,h=jt.util.globalScope,l=h.crypto||h.msCrypto;l&&l.getRandomValues&&(u=function(T){return l.getRandomValues(T)});var d=jt.util.createBuffer();if(u)for(;d.length()<c;){var p=Math.max(1,Math.min(c-d.length(),65536)/4),g=new Uint32Array(Math.floor(p));try{u(g);for(var v=0;v<g.length;++v)d.putInt32(g[v])}catch(T){if(!(typeof QuotaExceededError<"u"&&T instanceof QuotaExceededError))throw T}}if(d.length()<c)for(var m,S,A,D=Math.floor(Math.random()*65536);d.length()<c;){S=16807*(D&65535),m=16807*(D>>16),S+=(m&32767)<<16,S+=m>>15,S=(S&2147483647)+(S>>31),D=S&4294967295;for(var v=0;v<3;++v)A=D>>>(v<<3),A^=Math.floor(Math.random()*256),d.putByte(A&255)}return d.getBytes(c)}return dn?(e.seedFile=function(c,u){dn.randomBytes(c,function(h,l){if(h)return u(h);u(null,l.toString())})},e.seedFileSync=function(c){return dn.randomBytes(c).toString()}):(e.seedFile=function(c,u){try{u(null,f(c))}catch(h){u(h)}},e.seedFileSync=f),e.collect=function(c){for(var u=c.length,h=0;h<u;++h)e.pools[e.pool].update(c.substr(h,1)),e.pool=e.pool===31?0:e.pool+1},e.collectInt=function(c,u){for(var h="",l=0;l<u;l+=8)h+=String.fromCharCode(c>>l&255);e.collect(h)},e.registerWorker=function(c){if(c===self)e.seedFile=function(h,l){function d(p){var g=p.data;g.forge&&g.forge.prng&&(self.removeEventListener("message",d),l(g.forge.prng.err,g.forge.prng.bytes))}self.addEventListener("message",d),self.postMessage({forge:{prng:{needed:h}}})};else{var u=function(h){var l=h.data;l.forge&&l.forge.prng&&e.seedFile(l.forge.prng.needed,function(d,p){c.postMessage({forge:{prng:{err:d,bytes:p}}})})};c.addEventListener("message",u)}},e}});var Cr=F((d1,zi)=>{var mt=X();$r();w0();E0();lt();(function(){if(mt.random&&mt.random.getBytes){zi.exports=mt.random;return}(function(t){var e={},r=new Array(4),n=mt.util.createBuffer();e.formatKey=function(h){var l=mt.util.createBuffer(h);return h=new Array(4),h[0]=l.getInt32(),h[1]=l.getInt32(),h[2]=l.getInt32(),h[3]=l.getInt32(),mt.aes._expandKey(h,!1)},e.formatSeed=function(h){var l=mt.util.createBuffer(h);return h=new Array(4),h[0]=l.getInt32(),h[1]=l.getInt32(),h[2]=l.getInt32(),h[3]=l.getInt32(),h},e.cipher=function(h,l){return mt.aes._updateBlock(h,l,r,!1),n.putInt32(r[0]),n.putInt32(r[1]),n.putInt32(r[2]),n.putInt32(r[3]),n.getBytes()},e.increment=function(h){return++h[3],h},e.md=mt.md.sha256;function i(){var h=mt.prng.create(e);return h.getBytes=function(l,d){return h.generate(l,d)},h.getBytesSync=function(l){return h.generate(l)},h}var a=i(),s=null,o=mt.util.globalScope,f=o.crypto||o.msCrypto;if(f&&f.getRandomValues&&(s=function(h){return f.getRandomValues(h)}),mt.options.usePureJavaScript||!mt.util.isNodejs&&!s){if(typeof window>"u"||window.document,a.collectInt(+new Date,32),typeof navigator<"u"){var c="";for(var u in navigator)try{typeof navigator[u]=="string"&&(c+=navigator[u])}catch{}a.collect(c),c=null}t&&(t().mousemove(function(h){a.collectInt(h.clientX,16),a.collectInt(h.clientY,16)}),t().keypress(function(h){a.collectInt(h.charCode,8)}))}if(!mt.random)mt.random=a;else for(var u in a)mt.random[u]=a[u];mt.random.createInstance=i,zi.exports=mt.random})(typeof jQuery<"u"?jQuery:null)})()});var T0=F((y1,C0)=>{var Tt=X();lt();var Hi=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],B0=[1,2,3,5],cu=function(t,e){return t<<e&65535|(t&65535)>>16-e},uu=function(t,e){return(t&65535)>>e|t<<16-e&65535};C0.exports=Tt.rc2=Tt.rc2||{};Tt.rc2.expandKey=function(t,e){typeof t=="string"&&(t=Tt.util.createBuffer(t)),e=e||128;var r=t,n=t.length(),i=e,a=Math.ceil(i/8),s=255>>(i&7),o;for(o=n;o<128;o++)r.putByte(Hi[r.at(o-1)+r.at(o-n)&255]);for(r.setAt(128-a,Hi[r.at(128-a)&s]),o=127-a;o>=0;o--)r.setAt(o,Hi[r.at(o+1)^r.at(o+a)]);return r};var A0=function(t,e,r){var n=!1,i=null,a=null,s=null,o,f,c,u,h=[];for(t=Tt.rc2.expandKey(t,e),c=0;c<64;c++)h.push(t.getInt16Le());r?(o=function(p){for(c=0;c<4;c++)p[c]+=h[u]+(p[(c+3)%4]&p[(c+2)%4])+(~p[(c+3)%4]&p[(c+1)%4]),p[c]=cu(p[c],B0[c]),u++},f=function(p){for(c=0;c<4;c++)p[c]+=h[p[(c+3)%4]&63]}):(o=function(p){for(c=3;c>=0;c--)p[c]=uu(p[c],B0[c]),p[c]-=h[u]+(p[(c+3)%4]&p[(c+2)%4])+(~p[(c+3)%4]&p[(c+1)%4]),u--},f=function(p){for(c=3;c>=0;c--)p[c]-=h[p[(c+3)%4]&63]});var l=function(p){var g=[];for(c=0;c<4;c++){var v=i.getInt16Le();s!==null&&(r?v^=s.getInt16Le():s.putInt16Le(v)),g.push(v&65535)}u=r?0:63;for(var m=0;m<p.length;m++)for(var S=0;S<p[m][0];S++)p[m][1](g);for(c=0;c<4;c++)s!==null&&(r?s.putInt16Le(g[c]):g[c]^=s.getInt16Le()),a.putInt16Le(g[c])},d=null;return d={start:function(p,g){p&&typeof p=="string"&&(p=Tt.util.createBuffer(p)),n=!1,i=Tt.util.createBuffer(),a=g||new Tt.util.createBuffer,s=p,d.output=a},update:function(p){for(n||i.putBuffer(p);i.length()>=8;)l([[5,o],[1,f],[6,o],[1,f],[5,o]])},finish:function(p){var g=!0;if(r)if(p)g=p(8,i,!r);else{var v=i.length()===8?8:8-i.length();i.fillWithByte(v,v)}if(g&&(n=!0,d.update()),!r&&(g=i.length()===0,g))if(p)g=p(8,a,!r);else{var m=a.length(),S=a.at(m-1);S>m?g=!1:a.truncate(S)}return g}},d};Tt.rc2.startEncrypting=function(t,e,r){var n=Tt.rc2.createEncryptionCipher(t,128);return n.start(e,r),n};Tt.rc2.createEncryptionCipher=function(t,e){return A0(t,e,!0)};Tt.rc2.startDecrypting=function(t,e,r){var n=Tt.rc2.createDecryptionCipher(t,128);return n.start(e,r),n};Tt.rc2.createDecryptionCipher=function(t,e){return A0(t,e,!1)}});var xn=F((g1,P0)=>{var Gi=X();P0.exports=Gi.jsbn=Gi.jsbn||{};var ue,hu=0xdeadbeefcafe,I0=(hu&16777215)==15715070;function w(t,e,r){this.data=[],t!=null&&(typeof t=="number"?this.fromNumber(t,e,r):e==null&&typeof t!="string"?this.fromString(t,256):this.fromString(t,e))}Gi.jsbn.BigInteger=w;function W(){return new w(null)}function lu(t,e,r,n,i,a){for(;--a>=0;){var s=e*this.data[t++]+r.data[n]+i;i=Math.floor(s/67108864),r.data[n++]=s&67108863}return i}function pu(t,e,r,n,i,a){for(var s=e&32767,o=e>>15;--a>=0;){var f=this.data[t]&32767,c=this.data[t++]>>15,u=o*f+c*s;f=s*f+((u&32767)<<15)+r.data[n]+(i&1073741823),i=(f>>>30)+(u>>>15)+o*c+(i>>>30),r.data[n++]=f&1073741823}return i}function _0(t,e,r,n,i,a){for(var s=e&16383,o=e>>14;--a>=0;){var f=this.data[t]&16383,c=this.data[t++]>>14,u=o*f+c*s;f=s*f+((u&16383)<<14)+r.data[n]+i,i=(f>>28)+(u>>14)+o*c,r.data[n++]=f&268435455}return i}typeof navigator>"u"?(w.prototype.am=_0,ue=28):I0&&navigator.appName=="Microsoft Internet Explorer"?(w.prototype.am=pu,ue=30):I0&&navigator.appName!="Netscape"?(w.prototype.am=lu,ue=26):(w.prototype.am=_0,ue=28);w.prototype.DB=ue;w.prototype.DM=(1<<ue)-1;w.prototype.DV=1<<ue;var Wi=52;w.prototype.FV=Math.pow(2,Wi);w.prototype.F1=Wi-ue;w.prototype.F2=2*ue-Wi;var du="0123456789abcdefghijklmnopqrstuvwxyz",yn=new Array,er,Pt;er="0".charCodeAt(0);for(Pt=0;Pt<=9;++Pt)yn[er++]=Pt;er="a".charCodeAt(0);for(Pt=10;Pt<36;++Pt)yn[er++]=Pt;er="A".charCodeAt(0);for(Pt=10;Pt<36;++Pt)yn[er++]=Pt;function R0(t){return du.charAt(t)}function k0(t,e){var r=yn[t.charCodeAt(e)];return r??-1}function yu(t){for(var e=this.t-1;e>=0;--e)t.data[e]=this.data[e];t.t=this.t,t.s=this.s}function gu(t){this.t=1,this.s=t<0?-1:0,t>0?this.data[0]=t:t<-1?this.data[0]=t+this.DV:this.t=0}function ve(t){var e=W();return e.fromInt(t),e}function xu(t,e){var r;if(e==16)r=4;else if(e==8)r=3;else if(e==256)r=8;else if(e==2)r=1;else if(e==32)r=5;else if(e==4)r=2;else{this.fromRadix(t,e);return}this.t=0,this.s=0;for(var n=t.length,i=!1,a=0;--n>=0;){var s=r==8?t[n]&255:k0(t,n);if(s<0){t.charAt(n)=="-"&&(i=!0);continue}i=!1,a==0?this.data[this.t++]=s:a+r>this.DB?(this.data[this.t-1]|=(s&(1<<this.DB-a)-1)<<a,this.data[this.t++]=s>>this.DB-a):this.data[this.t-1]|=s<<a,a+=r,a>=this.DB&&(a-=this.DB)}r==8&&t[0]&128&&(this.s=-1,a>0&&(this.data[this.t-1]|=(1<<this.DB-a)-1<<a)),this.clamp(),i&&w.ZERO.subTo(this,this)}function vu(){for(var t=this.s&this.DM;this.t>0&&this.data[this.t-1]==t;)--this.t}function mu(t){if(this.s<0)return"-"+this.negate().toString(t);var e;if(t==16)e=4;else if(t==8)e=3;else if(t==2)e=1;else if(t==32)e=5;else if(t==4)e=2;else return this.toRadix(t);var r=(1<<e)-1,n,i=!1,a="",s=this.t,o=this.DB-s*this.DB%e;if(s-- >0)for(o<this.DB&&(n=this.data[s]>>o)>0&&(i=!0,a=R0(n));s>=0;)o<e?(n=(this.data[s]&(1<<o)-1)<<e-o,n|=this.data[--s]>>(o+=this.DB-e)):(n=this.data[s]>>(o-=e)&r,o<=0&&(o+=this.DB,--s)),n>0&&(i=!0),i&&(a+=R0(n));return i?a:"0"}function bu(){var t=W();return w.ZERO.subTo(this,t),t}function wu(){return this.s<0?this.negate():this}function Su(t){var e=this.s-t.s;if(e!=0)return e;var r=this.t;if(e=r-t.t,e!=0)return this.s<0?-e:e;for(;--r>=0;)if((e=this.data[r]-t.data[r])!=0)return e;return 0}function gn(t){var e=1,r;return(r=t>>>16)!=0&&(t=r,e+=16),(r=t>>8)!=0&&(t=r,e+=8),(r=t>>4)!=0&&(t=r,e+=4),(r=t>>2)!=0&&(t=r,e+=2),(r=t>>1)!=0&&(t=r,e+=1),e}function Eu(){return this.t<=0?0:this.DB*(this.t-1)+gn(this.data[this.t-1]^this.s&this.DM)}function Bu(t,e){var r;for(r=this.t-1;r>=0;--r)e.data[r+t]=this.data[r];for(r=t-1;r>=0;--r)e.data[r]=0;e.t=this.t+t,e.s=this.s}function Au(t,e){for(var r=t;r<this.t;++r)e.data[r-t]=this.data[r];e.t=Math.max(this.t-t,0),e.s=this.s}function Cu(t,e){var r=t%this.DB,n=this.DB-r,i=(1<<n)-1,a=Math.floor(t/this.DB),s=this.s<<r&this.DM,o;for(o=this.t-1;o>=0;--o)e.data[o+a+1]=this.data[o]>>n|s,s=(this.data[o]&i)<<r;for(o=a-1;o>=0;--o)e.data[o]=0;e.data[a]=s,e.t=this.t+a+1,e.s=this.s,e.clamp()}function Tu(t,e){e.s=this.s;var r=Math.floor(t/this.DB);if(r>=this.t){e.t=0;return}var n=t%this.DB,i=this.DB-n,a=(1<<n)-1;e.data[0]=this.data[r]>>n;for(var s=r+1;s<this.t;++s)e.data[s-r-1]|=(this.data[s]&a)<<i,e.data[s-r]=this.data[s]>>n;n>0&&(e.data[this.t-r-1]|=(this.s&a)<<i),e.t=this.t-r,e.clamp()}function Iu(t,e){for(var r=0,n=0,i=Math.min(t.t,this.t);r<i;)n+=this.data[r]-t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n-=t.s;r<this.t;)n+=this.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n-=t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n-=t.s}e.s=n<0?-1:0,n<-1?e.data[r++]=this.DV+n:n>0&&(e.data[r++]=n),e.t=r,e.clamp()}function _u(t,e){var r=this.abs(),n=t.abs(),i=r.t;for(e.t=i+n.t;--i>=0;)e.data[i]=0;for(i=0;i<n.t;++i)e.data[i+r.t]=r.am(0,n.data[i],e,i,0,r.t);e.s=0,e.clamp(),this.s!=t.s&&w.ZERO.subTo(e,e)}function Ru(t){for(var e=this.abs(),r=t.t=2*e.t;--r>=0;)t.data[r]=0;for(r=0;r<e.t-1;++r){var n=e.am(r,e.data[r],t,2*r,0,1);(t.data[r+e.t]+=e.am(r+1,2*e.data[r],t,2*r+1,n,e.t-r-1))>=e.DV&&(t.data[r+e.t]-=e.DV,t.data[r+e.t+1]=1)}t.t>0&&(t.data[t.t-1]+=e.am(r,e.data[r],t,2*r,0,1)),t.s=0,t.clamp()}function ku(t,e,r){var n=t.abs();if(!(n.t<=0)){var i=this.abs();if(i.t<n.t){e?.fromInt(0),r!=null&&this.copyTo(r);return}r==null&&(r=W());var a=W(),s=this.s,o=t.s,f=this.DB-gn(n.data[n.t-1]);f>0?(n.lShiftTo(f,a),i.lShiftTo(f,r)):(n.copyTo(a),i.copyTo(r));var c=a.t,u=a.data[c-1];if(u!=0){var h=u*(1<<this.F1)+(c>1?a.data[c-2]>>this.F2:0),l=this.FV/h,d=(1<<this.F1)/h,p=1<<this.F2,g=r.t,v=g-c,m=e??W();for(a.dlShiftTo(v,m),r.compareTo(m)>=0&&(r.data[r.t++]=1,r.subTo(m,r)),w.ONE.dlShiftTo(c,m),m.subTo(a,a);a.t<c;)a.data[a.t++]=0;for(;--v>=0;){var S=r.data[--g]==u?this.DM:Math.floor(r.data[g]*l+(r.data[g-1]+p)*d);if((r.data[g]+=a.am(0,S,r,v,0,c))<S)for(a.dlShiftTo(v,m),r.subTo(m,r);r.data[g]<--S;)r.subTo(m,r)}e!=null&&(r.drShiftTo(c,e),s!=o&&w.ZERO.subTo(e,e)),r.t=c,r.clamp(),f>0&&r.rShiftTo(f,r),s<0&&w.ZERO.subTo(r,r)}}}function Nu(t){var e=W();return this.abs().divRemTo(t,null,e),this.s<0&&e.compareTo(w.ZERO)>0&&t.subTo(e,e),e}function Le(t){this.m=t}function Du(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t}function Lu(t){return t}function Pu(t){t.divRemTo(this.m,null,t)}function Uu(t,e,r){t.multiplyTo(e,r),this.reduce(r)}function Ku(t,e){t.squareTo(e),this.reduce(e)}Le.prototype.convert=Du;Le.prototype.revert=Lu;Le.prototype.reduce=Pu;Le.prototype.mulTo=Uu;Le.prototype.sqrTo=Ku;function Fu(){if(this.t<1)return 0;var t=this.data[0];if(!(t&1))return 0;var e=t&3;return e=e*(2-(t&15)*e)&15,e=e*(2-(t&255)*e)&255,e=e*(2-((t&65535)*e&65535))&65535,e=e*(2-t*e%this.DV)%this.DV,e>0?this.DV-e:-e}function Pe(t){this.m=t,this.mp=t.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function Ou(t){var e=W();return t.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),t.s<0&&e.compareTo(w.ZERO)>0&&this.m.subTo(e,e),e}function Mu(t){var e=W();return t.copyTo(e),this.reduce(e),e}function Vu(t){for(;t.t<=this.mt2;)t.data[t.t++]=0;for(var e=0;e<this.m.t;++e){var r=t.data[e]&32767,n=r*this.mpl+((r*this.mph+(t.data[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(r=e+this.m.t,t.data[r]+=this.m.am(0,n,t,e,0,this.m.t);t.data[r]>=t.DV;)t.data[r]-=t.DV,t.data[++r]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)}function qu(t,e){t.squareTo(e),this.reduce(e)}function zu(t,e,r){t.multiplyTo(e,r),this.reduce(r)}Pe.prototype.convert=Ou;Pe.prototype.revert=Mu;Pe.prototype.reduce=Vu;Pe.prototype.mulTo=zu;Pe.prototype.sqrTo=qu;function Hu(){return(this.t>0?this.data[0]&1:this.s)==0}function Gu(t,e){if(t>4294967295||t<1)return w.ONE;var r=W(),n=W(),i=e.convert(this),a=gn(t)-1;for(i.copyTo(r);--a>=0;)if(e.sqrTo(r,n),(t&1<<a)>0)e.mulTo(n,i,r);else{var s=r;r=n,n=s}return e.revert(r)}function Wu(t,e){var r;return t<256||e.isEven()?r=new Le(e):r=new Pe(e),this.exp(t,r)}w.prototype.copyTo=yu;w.prototype.fromInt=gu;w.prototype.fromString=xu;w.prototype.clamp=vu;w.prototype.dlShiftTo=Bu;w.prototype.drShiftTo=Au;w.prototype.lShiftTo=Cu;w.prototype.rShiftTo=Tu;w.prototype.subTo=Iu;w.prototype.multiplyTo=_u;w.prototype.squareTo=Ru;w.prototype.divRemTo=ku;w.prototype.invDigit=Fu;w.prototype.isEven=Hu;w.prototype.exp=Gu;w.prototype.toString=mu;w.prototype.negate=bu;w.prototype.abs=wu;w.prototype.compareTo=Su;w.prototype.bitLength=Eu;w.prototype.mod=Nu;w.prototype.modPowInt=Wu;w.ZERO=ve(0);w.ONE=ve(1);function Zu(){var t=W();return this.copyTo(t),t}function Yu(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this.data[0];if(this.t==0)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function $u(){return this.t==0?this.s:this.data[0]<<24>>24}function Qu(){return this.t==0?this.s:this.data[0]<<16>>16}function Xu(t){return Math.floor(Math.LN2*this.DB/Math.log(t))}function Ju(){return this.s<0?-1:this.t<=0||this.t==1&&this.data[0]<=0?0:1}function ju(t){if(t==null&&(t=10),this.signum()==0||t<2||t>36)return"0";var e=this.chunkSize(t),r=Math.pow(t,e),n=ve(r),i=W(),a=W(),s="";for(this.divRemTo(n,i,a);i.signum()>0;)s=(r+a.intValue()).toString(t).substr(1)+s,i.divRemTo(n,i,a);return a.intValue().toString(t)+s}function th(t,e){this.fromInt(0),e==null&&(e=10);for(var r=this.chunkSize(e),n=Math.pow(e,r),i=!1,a=0,s=0,o=0;o<t.length;++o){var f=k0(t,o);if(f<0){t.charAt(o)=="-"&&this.signum()==0&&(i=!0);continue}s=e*s+f,++a>=r&&(this.dMultiply(n),this.dAddOffset(s,0),a=0,s=0)}a>0&&(this.dMultiply(Math.pow(e,a)),this.dAddOffset(s,0)),i&&w.ZERO.subTo(this,this)}function eh(t,e,r){if(typeof e=="number")if(t<2)this.fromInt(1);else for(this.fromNumber(t,r),this.testBit(t-1)||this.bitwiseTo(w.ONE.shiftLeft(t-1),Zi,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(w.ONE.shiftLeft(t-1),this);else{var n=new Array,i=t&7;n.length=(t>>3)+1,e.nextBytes(n),i>0?n[0]&=(1<<i)-1:n[0]=0,this.fromString(n,256)}}function rh(){var t=this.t,e=new Array;e[0]=this.s;var r=this.DB-t*this.DB%8,n,i=0;if(t-- >0)for(r<this.DB&&(n=this.data[t]>>r)!=(this.s&this.DM)>>r&&(e[i++]=n|this.s<<this.DB-r);t>=0;)r<8?(n=(this.data[t]&(1<<r)-1)<<8-r,n|=this.data[--t]>>(r+=this.DB-8)):(n=this.data[t]>>(r-=8)&255,r<=0&&(r+=this.DB,--t)),n&128&&(n|=-256),i==0&&(this.s&128)!=(n&128)&&++i,(i>0||n!=this.s)&&(e[i++]=n);return e}function nh(t){return this.compareTo(t)==0}function ih(t){return this.compareTo(t)<0?this:t}function ah(t){return this.compareTo(t)>0?this:t}function sh(t,e,r){var n,i,a=Math.min(t.t,this.t);for(n=0;n<a;++n)r.data[n]=e(this.data[n],t.data[n]);if(t.t<this.t){for(i=t.s&this.DM,n=a;n<this.t;++n)r.data[n]=e(this.data[n],i);r.t=this.t}else{for(i=this.s&this.DM,n=a;n<t.t;++n)r.data[n]=e(i,t.data[n]);r.t=t.t}r.s=e(this.s,t.s),r.clamp()}function oh(t,e){return t&e}function fh(t){var e=W();return this.bitwiseTo(t,oh,e),e}function Zi(t,e){return t|e}function ch(t){var e=W();return this.bitwiseTo(t,Zi,e),e}function N0(t,e){return t^e}function uh(t){var e=W();return this.bitwiseTo(t,N0,e),e}function D0(t,e){return t&~e}function hh(t){var e=W();return this.bitwiseTo(t,D0,e),e}function lh(){for(var t=W(),e=0;e<this.t;++e)t.data[e]=this.DM&~this.data[e];return t.t=this.t,t.s=~this.s,t}function ph(t){var e=W();return t<0?this.rShiftTo(-t,e):this.lShiftTo(t,e),e}function dh(t){var e=W();return t<0?this.lShiftTo(-t,e):this.rShiftTo(t,e),e}function yh(t){if(t==0)return-1;var e=0;return t&65535||(t>>=16,e+=16),t&255||(t>>=8,e+=8),t&15||(t>>=4,e+=4),t&3||(t>>=2,e+=2),t&1||++e,e}function gh(){for(var t=0;t<this.t;++t)if(this.data[t]!=0)return t*this.DB+yh(this.data[t]);return this.s<0?this.t*this.DB:-1}function xh(t){for(var e=0;t!=0;)t&=t-1,++e;return e}function vh(){for(var t=0,e=this.s&this.DM,r=0;r<this.t;++r)t+=xh(this.data[r]^e);return t}function mh(t){var e=Math.floor(t/this.DB);return e>=this.t?this.s!=0:(this.data[e]&1<<t%this.DB)!=0}function bh(t,e){var r=w.ONE.shiftLeft(t);return this.bitwiseTo(r,e,r),r}function wh(t){return this.changeBit(t,Zi)}function Sh(t){return this.changeBit(t,D0)}function Eh(t){return this.changeBit(t,N0)}function Bh(t,e){for(var r=0,n=0,i=Math.min(t.t,this.t);r<i;)n+=this.data[r]+t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n+=t.s;r<this.t;)n+=this.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n+=t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=t.s}e.s=n<0?-1:0,n>0?e.data[r++]=n:n<-1&&(e.data[r++]=this.DV+n),e.t=r,e.clamp()}function Ah(t){var e=W();return this.addTo(t,e),e}function Ch(t){var e=W();return this.subTo(t,e),e}function Th(t){var e=W();return this.multiplyTo(t,e),e}function Ih(t){var e=W();return this.divRemTo(t,e,null),e}function _h(t){var e=W();return this.divRemTo(t,null,e),e}function Rh(t){var e=W(),r=W();return this.divRemTo(t,e,r),new Array(e,r)}function kh(t){this.data[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()}function Nh(t,e){if(t!=0){for(;this.t<=e;)this.data[this.t++]=0;for(this.data[e]+=t;this.data[e]>=this.DV;)this.data[e]-=this.DV,++e>=this.t&&(this.data[this.t++]=0),++this.data[e]}}function Tr(){}function L0(t){return t}function Dh(t,e,r){t.multiplyTo(e,r)}function Lh(t,e){t.squareTo(e)}Tr.prototype.convert=L0;Tr.prototype.revert=L0;Tr.prototype.mulTo=Dh;Tr.prototype.sqrTo=Lh;function Ph(t){return this.exp(t,new Tr)}function Uh(t,e,r){var n=Math.min(this.t+t.t,e);for(r.s=0,r.t=n;n>0;)r.data[--n]=0;var i;for(i=r.t-this.t;n<i;++n)r.data[n+this.t]=this.am(0,t.data[n],r,n,0,this.t);for(i=Math.min(t.t,e);n<i;++n)this.am(0,t.data[n],r,n,0,e-n);r.clamp()}function Kh(t,e,r){--e;var n=r.t=this.t+t.t-e;for(r.s=0;--n>=0;)r.data[n]=0;for(n=Math.max(e-this.t,0);n<t.t;++n)r.data[this.t+n-e]=this.am(e-n,t.data[n],r,0,0,this.t+n-e);r.clamp(),r.drShiftTo(1,r)}function rr(t){this.r2=W(),this.q3=W(),w.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}function Fh(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var e=W();return t.copyTo(e),this.reduce(e),e}function Oh(t){return t}function Mh(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);t.compareTo(this.m)>=0;)t.subTo(this.m,t)}function Vh(t,e){t.squareTo(e),this.reduce(e)}function qh(t,e,r){t.multiplyTo(e,r),this.reduce(r)}rr.prototype.convert=Fh;rr.prototype.revert=Oh;rr.prototype.reduce=Mh;rr.prototype.mulTo=qh;rr.prototype.sqrTo=Vh;function zh(t,e){var r=t.bitLength(),n,i=ve(1),a;if(r<=0)return i;r<18?n=1:r<48?n=3:r<144?n=4:r<768?n=5:n=6,r<8?a=new Le(e):e.isEven()?a=new rr(e):a=new Pe(e);var s=new Array,o=3,f=n-1,c=(1<<n)-1;if(s[1]=a.convert(this),n>1){var u=W();for(a.sqrTo(s[1],u);o<=c;)s[o]=W(),a.mulTo(u,s[o-2],s[o]),o+=2}var h=t.t-1,l,d=!0,p=W(),g;for(r=gn(t.data[h])-1;h>=0;){for(r>=f?l=t.data[h]>>r-f&c:(l=(t.data[h]&(1<<r+1)-1)<<f-r,h>0&&(l|=t.data[h-1]>>this.DB+r-f)),o=n;!(l&1);)l>>=1,--o;if((r-=o)<0&&(r+=this.DB,--h),d)s[l].copyTo(i),d=!1;else{for(;o>1;)a.sqrTo(i,p),a.sqrTo(p,i),o-=2;o>0?a.sqrTo(i,p):(g=i,i=p,p=g),a.mulTo(p,s[l],i)}for(;h>=0&&!(t.data[h]&1<<r);)a.sqrTo(i,p),g=i,i=p,p=g,--r<0&&(r=this.DB-1,--h)}return a.revert(i)}function Hh(t){var e=this.s<0?this.negate():this.clone(),r=t.s<0?t.negate():t.clone();if(e.compareTo(r)<0){var n=e;e=r,r=n}var i=e.getLowestSetBit(),a=r.getLowestSetBit();if(a<0)return e;for(i<a&&(a=i),a>0&&(e.rShiftTo(a,e),r.rShiftTo(a,r));e.signum()>0;)(i=e.getLowestSetBit())>0&&e.rShiftTo(i,e),(i=r.getLowestSetBit())>0&&r.rShiftTo(i,r),e.compareTo(r)>=0?(e.subTo(r,e),e.rShiftTo(1,e)):(r.subTo(e,r),r.rShiftTo(1,r));return a>0&&r.lShiftTo(a,r),r}function Gh(t){if(t<=0)return 0;var e=this.DV%t,r=this.s<0?t-1:0;if(this.t>0)if(e==0)r=this.data[0]%t;else for(var n=this.t-1;n>=0;--n)r=(e*r+this.data[n])%t;return r}function Wh(t){var e=t.isEven();if(this.isEven()&&e||t.signum()==0)return w.ZERO;for(var r=t.clone(),n=this.clone(),i=ve(1),a=ve(0),s=ve(0),o=ve(1);r.signum()!=0;){for(;r.isEven();)r.rShiftTo(1,r),e?((!i.isEven()||!a.isEven())&&(i.addTo(this,i),a.subTo(t,a)),i.rShiftTo(1,i)):a.isEven()||a.subTo(t,a),a.rShiftTo(1,a);for(;n.isEven();)n.rShiftTo(1,n),e?((!s.isEven()||!o.isEven())&&(s.addTo(this,s),o.subTo(t,o)),s.rShiftTo(1,s)):o.isEven()||o.subTo(t,o),o.rShiftTo(1,o);r.compareTo(n)>=0?(r.subTo(n,r),e&&i.subTo(s,i),a.subTo(o,a)):(n.subTo(r,n),e&&s.subTo(i,s),o.subTo(a,o))}if(n.compareTo(w.ONE)!=0)return w.ZERO;if(o.compareTo(t)>=0)return o.subtract(t);if(o.signum()<0)o.addTo(t,o);else return o;return o.signum()<0?o.add(t):o}var Ht=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],Zh=(1<<26)/Ht[Ht.length-1];function Yh(t){var e,r=this.abs();if(r.t==1&&r.data[0]<=Ht[Ht.length-1]){for(e=0;e<Ht.length;++e)if(r.data[0]==Ht[e])return!0;return!1}if(r.isEven())return!1;for(e=1;e<Ht.length;){for(var n=Ht[e],i=e+1;i<Ht.length&&n<Zh;)n*=Ht[i++];for(n=r.modInt(n);e<i;)if(n%Ht[e++]==0)return!1}return r.millerRabin(t)}function $h(t){var e=this.subtract(w.ONE),r=e.getLowestSetBit();if(r<=0)return!1;for(var n=e.shiftRight(r),i=Qh(),a,s=0;s<t;++s){do a=new w(this.bitLength(),i);while(a.compareTo(w.ONE)<=0||a.compareTo(e)>=0);var o=a.modPow(n,this);if(o.compareTo(w.ONE)!=0&&o.compareTo(e)!=0){for(var f=1;f++<r&&o.compareTo(e)!=0;)if(o=o.modPowInt(2,this),o.compareTo(w.ONE)==0)return!1;if(o.compareTo(e)!=0)return!1}}return!0}function Qh(){return{nextBytes:function(t){for(var e=0;e<t.length;++e)t[e]=Math.floor(Math.random()*256)}}}w.prototype.chunkSize=Xu;w.prototype.toRadix=ju;w.prototype.fromRadix=th;w.prototype.fromNumber=eh;w.prototype.bitwiseTo=sh;w.prototype.changeBit=bh;w.prototype.addTo=Bh;w.prototype.dMultiply=kh;w.prototype.dAddOffset=Nh;w.prototype.multiplyLowerTo=Uh;w.prototype.multiplyUpperTo=Kh;w.prototype.modInt=Gh;w.prototype.millerRabin=$h;w.prototype.clone=Zu;w.prototype.intValue=Yu;w.prototype.byteValue=$u;w.prototype.shortValue=Qu;w.prototype.signum=Ju;w.prototype.toByteArray=rh;w.prototype.equals=nh;w.prototype.min=ih;w.prototype.max=ah;w.prototype.and=fh;w.prototype.or=ch;w.prototype.xor=uh;w.prototype.andNot=hh;w.prototype.not=lh;w.prototype.shiftLeft=ph;w.prototype.shiftRight=dh;w.prototype.getLowestSetBit=gh;w.prototype.bitCount=vh;w.prototype.testBit=mh;w.prototype.setBit=wh;w.prototype.clearBit=Sh;w.prototype.flipBit=Eh;w.prototype.add=Ah;w.prototype.subtract=Ch;w.prototype.multiply=Th;w.prototype.divide=Ih;w.prototype.remainder=_h;w.prototype.divideAndRemainder=Rh;w.prototype.modPow=zh;w.prototype.modInverse=Wh;w.prototype.pow=Ph;w.prototype.gcd=Hh;w.prototype.isProbablePrime=Yh});var M0=F((x1,O0)=>{var te=X();De();lt();var K0=O0.exports=te.sha1=te.sha1||{};te.md.sha1=te.md.algorithms.sha1=K0;K0.create=function(){F0||Xh();var t=null,e=te.util.createBuffer(),r=new Array(80),n={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var i=n.messageLengthSize/4,a=0;a<i;++a)n.fullMessageLength.push(0);return e=te.util.createBuffer(),t={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},n},n.start(),n.update=function(i,a){a==="utf8"&&(i=te.util.encodeUtf8(i));var s=i.length;n.messageLength+=s,s=[s/4294967296>>>0,s>>>0];for(var o=n.fullMessageLength.length-1;o>=0;--o)n.fullMessageLength[o]+=s[1],s[1]=s[0]+(n.fullMessageLength[o]/4294967296>>>0),n.fullMessageLength[o]=n.fullMessageLength[o]>>>0,s[0]=s[1]/4294967296>>>0;return e.putBytes(i),U0(t,r,e),(e.read>2048||e.length()===0)&&e.compact(),n},n.digest=function(){var i=te.util.createBuffer();i.putBytes(e.bytes());var a=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,s=a&n.blockLength-1;i.putBytes(Yi.substr(0,n.blockLength-s));for(var o,f,c=n.fullMessageLength[0]*8,u=0;u<n.fullMessageLength.length-1;++u)o=n.fullMessageLength[u+1]*8,f=o/4294967296>>>0,c+=f,i.putInt32(c>>>0),c=o>>>0;i.putInt32(c);var h={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3,h4:t.h4};U0(h,r,i);var l=te.util.createBuffer();return l.putInt32(h.h0),l.putInt32(h.h1),l.putInt32(h.h2),l.putInt32(h.h3),l.putInt32(h.h4),l},n};var Yi=null,F0=!1;function Xh(){Yi=String.fromCharCode(128),Yi+=te.util.fillString(String.fromCharCode(0),64),F0=!0}function U0(t,e,r){for(var n,i,a,s,o,f,c,u,h=r.length();h>=64;){for(i=t.h0,a=t.h1,s=t.h2,o=t.h3,f=t.h4,u=0;u<16;++u)n=r.getInt32(),e[u]=n,c=o^a&(s^o),n=(i<<5|i>>>27)+c+f+1518500249+n,f=o,o=s,s=(a<<30|a>>>2)>>>0,a=i,i=n;for(;u<20;++u)n=e[u-3]^e[u-8]^e[u-14]^e[u-16],n=n<<1|n>>>31,e[u]=n,c=o^a&(s^o),n=(i<<5|i>>>27)+c+f+1518500249+n,f=o,o=s,s=(a<<30|a>>>2)>>>0,a=i,i=n;for(;u<32;++u)n=e[u-3]^e[u-8]^e[u-14]^e[u-16],n=n<<1|n>>>31,e[u]=n,c=a^s^o,n=(i<<5|i>>>27)+c+f+1859775393+n,f=o,o=s,s=(a<<30|a>>>2)>>>0,a=i,i=n;for(;u<40;++u)n=e[u-6]^e[u-16]^e[u-28]^e[u-32],n=n<<2|n>>>30,e[u]=n,c=a^s^o,n=(i<<5|i>>>27)+c+f+1859775393+n,f=o,o=s,s=(a<<30|a>>>2)>>>0,a=i,i=n;for(;u<60;++u)n=e[u-6]^e[u-16]^e[u-28]^e[u-32],n=n<<2|n>>>30,e[u]=n,c=a&s|o&(a^s),n=(i<<5|i>>>27)+c+f+2400959708+n,f=o,o=s,s=(a<<30|a>>>2)>>>0,a=i,i=n;for(;u<80;++u)n=e[u-6]^e[u-16]^e[u-28]^e[u-32],n=n<<2|n>>>30,e[u]=n,c=a^s^o,n=(i<<5|i>>>27)+c+f+3395469782+n,f=o,o=s,s=(a<<30|a>>>2)>>>0,a=i,i=n;t.h0=t.h0+i|0,t.h1=t.h1+a|0,t.h2=t.h2+s|0,t.h3=t.h3+o|0,t.h4=t.h4+f|0,h-=64}}});var z0=F((v1,q0)=>{var ee=X();lt();Cr();M0();var V0=q0.exports=ee.pkcs1=ee.pkcs1||{};V0.encode_rsa_oaep=function(t,e,r){var n,i,a,s;typeof r=="string"?(n=r,i=arguments[3]||void 0,a=arguments[4]||void 0):r&&(n=r.label||void 0,i=r.seed||void 0,a=r.md||void 0,r.mgf1&&r.mgf1.md&&(s=r.mgf1.md)),a?a.start():a=ee.md.sha1.create(),s||(s=a);var o=Math.ceil(t.n.bitLength()/8),f=o-2*a.digestLength-2;if(e.length>f){var c=new Error("RSAES-OAEP input message length is too long.");throw c.length=e.length,c.maxLength=f,c}n||(n=""),a.update(n,"raw");for(var u=a.digest(),h="",l=f-e.length,d=0;d<l;d++)h+="\0";var p=u.getBytes()+h+""+e;if(!i)i=ee.random.getBytes(a.digestLength);else if(i.length!==a.digestLength){var c=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw c.seedLength=i.length,c.digestLength=a.digestLength,c}var g=vn(i,o-a.digestLength-1,s),v=ee.util.xorBytes(p,g,p.length),m=vn(v,a.digestLength,s),S=ee.util.xorBytes(i,m,i.length);return"\0"+S+v};V0.decode_rsa_oaep=function(t,e,r){var n,i,a;typeof r=="string"?(n=r,i=arguments[3]||void 0):r&&(n=r.label||void 0,i=r.md||void 0,r.mgf1&&r.mgf1.md&&(a=r.mgf1.md));var s=Math.ceil(t.n.bitLength()/8);if(e.length!==s){var v=new Error("RSAES-OAEP encoded message length is invalid.");throw v.length=e.length,v.expectedLength=s,v}if(i===void 0?i=ee.md.sha1.create():i.start(),a||(a=i),s<2*i.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");n||(n=""),i.update(n,"raw");for(var o=i.digest().getBytes(),f=e.charAt(0),c=e.substring(1,i.digestLength+1),u=e.substring(1+i.digestLength),h=vn(u,i.digestLength,a),l=ee.util.xorBytes(c,h,c.length),d=vn(l,s-i.digestLength-1,a),p=ee.util.xorBytes(u,d,u.length),g=p.substring(0,i.digestLength),v=f!=="\0",m=0;m<i.digestLength;++m)v|=o.charAt(m)!==g.charAt(m);for(var S=1,A=i.digestLength,D=i.digestLength;D<p.length;D++){var T=p.charCodeAt(D),_=T&1^1,V=S?65534:0;v|=T&V,S=S&_,A+=S}if(v||p.charCodeAt(A)!==1)throw new Error("Invalid RSAES-OAEP padding.");return p.substring(A+1)};function vn(t,e,r){r||(r=ee.md.sha1.create());for(var n="",i=Math.ceil(e/r.digestLength),a=0;a<i;++a){var s=String.fromCharCode(a>>24&255,a>>16&255,a>>8&255,a&255);r.start(),r.update(t+s),n+=r.digest().getBytes()}return n.substring(0,e)}});var H0=F((m1,$i)=>{var me=X();lt();xn();Cr();(function(){if(me.prime){$i.exports=me.prime;return}var t=$i.exports=me.prime=me.prime||{},e=me.jsbn.BigInteger,r=[6,4,2,4,2,4,6,2],n=new e(null);n.fromInt(30);var i=function(h,l){return h|l};t.generateProbablePrime=function(h,l,d){typeof l=="function"&&(d=l,l={}),l=l||{};var p=l.algorithm||"PRIMEINC";typeof p=="string"&&(p={name:p}),p.options=p.options||{};var g=l.prng||me.random,v={nextBytes:function(m){for(var S=g.getBytesSync(m.length),A=0;A<m.length;++A)m[A]=S.charCodeAt(A)}};if(p.name==="PRIMEINC")return a(h,v,p.options,d);throw new Error("Invalid prime generation algorithm: "+p.name)};function a(h,l,d,p){return"workers"in d?f(h,l,d,p):s(h,l,d,p)}function s(h,l,d,p){var g=c(h,l),v=0,m=u(g.bitLength());"millerRabinTests"in d&&(m=d.millerRabinTests);var S=10;"maxBlockTime"in d&&(S=d.maxBlockTime),o(g,h,l,v,m,S,p)}function o(h,l,d,p,g,v,m){var S=+new Date;do{if(h.bitLength()>l&&(h=c(l,d)),h.isProbablePrime(g))return m(null,h);h.dAddOffset(r[p++%8],0)}while(v<0||+new Date-S<v);me.util.setImmediate(function(){o(h,l,d,p,g,v,m)})}function f(h,l,d,p){if(typeof Worker>"u")return s(h,l,d,p);var g=c(h,l),v=d.workers,m=d.workLoad||100,S=m*30/8,A=d.workerScript||"forge/prime.worker.js";if(v===-1)return me.util.estimateCores(function(T,_){T&&(_=2),v=_-1,D()});D();function D(){v=Math.max(1,v);for(var T=[],_=0;_<v;++_)T[_]=new Worker(A);for(var V=v,_=0;_<v;++_)T[_].addEventListener("message",wt);var Y=!1;function wt(Ft){if(!Y){--V;var _t=Ft.data;if(_t.found){for(var Et=0;Et<T.length;++Et)T[Et].terminate();return Y=!0,p(null,new e(_t.prime,16))}g.bitLength()>h&&(g=c(h,l));var qe=g.toString(16);Ft.target.postMessage({hex:qe,workLoad:m}),g.dAddOffset(S,0)}}}}function c(h,l){var d=new e(h,l),p=h-1;return d.testBit(p)||d.bitwiseTo(e.ONE.shiftLeft(p),i,d),d.dAddOffset(31-d.mod(n).byteValue(),0),d}function u(h){return h<=100?27:h<=150?18:h<=200?15:h<=250?12:h<=300?9:h<=350?8:h<=400?7:h<=500?6:h<=600?5:h<=800?4:h<=1250?3:2}})()});var bn=F((b1,X0)=>{var N=X();Ar();xn();fn();z0();H0();Cr();lt();typeof q>"u"&&(q=N.jsbn.BigInteger);var q,Qi=N.util.isNodejs?tr():null,x=N.asn1,Ut=N.util;N.pki=N.pki||{};X0.exports=N.pki.rsa=N.rsa=N.rsa||{};var P=N.pki,Jh=[6,4,2,4,2,4,6,2],jh={name:"PrivateKeyInfo",tagClass:x.Class.UNIVERSAL,type:x.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:x.Class.UNIVERSAL,type:x.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:x.Class.UNIVERSAL,type:x.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:x.Class.UNIVERSAL,type:x.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},tl={name:"RSAPrivateKey",tagClass:x.Class.UNIVERSAL,type:x.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},el={name:"RSAPublicKey",tagClass:x.Class.UNIVERSAL,type:x.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},rl=N.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:x.Class.UNIVERSAL,type:x.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:x.Class.UNIVERSAL,type:x.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:x.Class.UNIVERSAL,type:x.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:x.Class.UNIVERSAL,type:x.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:x.Class.UNIVERSAL,type:x.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},nl={name:"DigestInfo",tagClass:x.Class.UNIVERSAL,type:x.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm",tagClass:x.Class.UNIVERSAL,type:x.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm.algorithmIdentifier",tagClass:x.Class.UNIVERSAL,type:x.Type.OID,constructed:!1,capture:"algorithmIdentifier"},{name:"DigestInfo.DigestAlgorithm.parameters",tagClass:x.Class.UNIVERSAL,type:x.Type.NULL,capture:"parameters",optional:!0,constructed:!1}]},{name:"DigestInfo.digest",tagClass:x.Class.UNIVERSAL,type:x.Type.OCTETSTRING,constructed:!1,capture:"digest"}]},il=function(t){var e;if(t.algorithm in P.oids)e=P.oids[t.algorithm];else{var r=new Error("Unknown message digest algorithm.");throw r.algorithm=t.algorithm,r}var n=x.oidToDer(e).getBytes(),i=x.create(x.Class.UNIVERSAL,x.Type.SEQUENCE,!0,[]),a=x.create(x.Class.UNIVERSAL,x.Type.SEQUENCE,!0,[]);a.value.push(x.create(x.Class.UNIVERSAL,x.Type.OID,!1,n)),a.value.push(x.create(x.Class.UNIVERSAL,x.Type.NULL,!1,""));var s=x.create(x.Class.UNIVERSAL,x.Type.OCTETSTRING,!1,t.digest().getBytes());return i.value.push(a),i.value.push(s),x.toDer(i).getBytes()},$0=function(t,e,r){if(r)return t.modPow(e.e,e.n);if(!e.p||!e.q)return t.modPow(e.d,e.n);e.dP||(e.dP=e.d.mod(e.p.subtract(q.ONE))),e.dQ||(e.dQ=e.d.mod(e.q.subtract(q.ONE))),e.qInv||(e.qInv=e.q.modInverse(e.p));var n;do n=new q(N.util.bytesToHex(N.random.getBytes(e.n.bitLength()/8)),16);while(n.compareTo(e.n)>=0||!n.gcd(e.n).equals(q.ONE));t=t.multiply(n.modPow(e.e,e.n)).mod(e.n);for(var i=t.mod(e.p).modPow(e.dP,e.p),a=t.mod(e.q).modPow(e.dQ,e.q);i.compareTo(a)<0;)i=i.add(e.p);var s=i.subtract(a).multiply(e.qInv).mod(e.p).multiply(e.q).add(a);return s=s.multiply(n.modInverse(e.n)).mod(e.n),s};P.rsa.encrypt=function(t,e,r){var n=r,i,a=Math.ceil(e.n.bitLength()/8);r!==!1&&r!==!0?(n=r===2,i=Q0(t,e,r)):(i=N.util.createBuffer(),i.putBytes(t));for(var s=new q(i.toHex(),16),o=$0(s,e,n),f=o.toString(16),c=N.util.createBuffer(),u=a-Math.ceil(f.length/2);u>0;)c.putByte(0),--u;return c.putBytes(N.util.hexToBytes(f)),c.getBytes()};P.rsa.decrypt=function(t,e,r,n){var i=Math.ceil(e.n.bitLength()/8);if(t.length!==i){var a=new Error("Encrypted message length is invalid.");throw a.length=t.length,a.expected=i,a}var s=new q(N.util.createBuffer(t).toHex(),16);if(s.compareTo(e.n)>=0)throw new Error("Encrypted message is invalid.");for(var o=$0(s,e,r),f=o.toString(16),c=N.util.createBuffer(),u=i-Math.ceil(f.length/2);u>0;)c.putByte(0),--u;return c.putBytes(N.util.hexToBytes(f)),n!==!1?mn(c.getBytes(),e,r):c.getBytes()};P.rsa.createKeyPairGenerationState=function(t,e,r){typeof t=="string"&&(t=parseInt(t,10)),t=t||2048,r=r||{};var n=r.prng||N.random,i={nextBytes:function(o){for(var f=n.getBytesSync(o.length),c=0;c<o.length;++c)o[c]=f.charCodeAt(c)}},a=r.algorithm||"PRIMEINC",s;if(a==="PRIMEINC")s={algorithm:a,state:0,bits:t,rng:i,eInt:e||65537,e:new q(null),p:null,q:null,qBits:t>>1,pBits:t-(t>>1),pqState:0,num:null,keys:null},s.e.fromInt(s.eInt);else throw new Error("Invalid key generation algorithm: "+a);return s};P.rsa.stepKeyPairGenerationState=function(t,e){"algorithm"in t||(t.algorithm="PRIMEINC");var r=new q(null);r.fromInt(30);for(var n=0,i=function(h,l){return h|l},a=+new Date,s,o=0;t.keys===null&&(e<=0||o<e);){if(t.state===0){var f=t.p===null?t.pBits:t.qBits,c=f-1;t.pqState===0?(t.num=new q(f,t.rng),t.num.testBit(c)||t.num.bitwiseTo(q.ONE.shiftLeft(c),i,t.num),t.num.dAddOffset(31-t.num.mod(r).byteValue(),0),n=0,++t.pqState):t.pqState===1?t.num.bitLength()>f?t.pqState=0:t.num.isProbablePrime(sl(t.num.bitLength()))?++t.pqState:t.num.dAddOffset(Jh[n++%8],0):t.pqState===2?t.pqState=t.num.subtract(q.ONE).gcd(t.e).compareTo(q.ONE)===0?3:0:t.pqState===3&&(t.pqState=0,t.p===null?t.p=t.num:t.q=t.num,t.p!==null&&t.q!==null&&++t.state,t.num=null)}else if(t.state===1)t.p.compareTo(t.q)<0&&(t.num=t.p,t.p=t.q,t.q=t.num),++t.state;else if(t.state===2)t.p1=t.p.subtract(q.ONE),t.q1=t.q.subtract(q.ONE),t.phi=t.p1.multiply(t.q1),++t.state;else if(t.state===3)t.phi.gcd(t.e).compareTo(q.ONE)===0?++t.state:(t.p=null,t.q=null,t.state=0);else if(t.state===4)t.n=t.p.multiply(t.q),t.n.bitLength()===t.bits?++t.state:(t.q=null,t.state=0);else if(t.state===5){var u=t.e.modInverse(t.phi);t.keys={privateKey:P.rsa.setPrivateKey(t.n,t.e,u,t.p,t.q,u.mod(t.p1),u.mod(t.q1),t.q.modInverse(t.p)),publicKey:P.rsa.setPublicKey(t.n,t.e)}}s=+new Date,o+=s-a,a=s}return t.keys!==null};P.rsa.generateKeyPair=function(t,e,r,n){if(arguments.length===1?typeof t=="object"?(r=t,t=void 0):typeof t=="function"&&(n=t,t=void 0):arguments.length===2?typeof t=="number"?typeof e=="function"?(n=e,e=void 0):typeof e!="number"&&(r=e,e=void 0):(r=t,n=e,t=void 0,e=void 0):arguments.length===3&&(typeof e=="number"?typeof r=="function"&&(n=r,r=void 0):(n=r,r=e,e=void 0)),r=r||{},t===void 0&&(t=r.bits||2048),e===void 0&&(e=r.e||65537),!N.options.usePureJavaScript&&!r.prng&&t>=256&&t<=16384&&(e===65537||e===3)){if(n){if(G0("generateKeyPair"))return Qi.generateKeyPair("rsa",{modulusLength:t,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(o,f,c){if(o)return n(o);n(null,{privateKey:P.privateKeyFromPem(c),publicKey:P.publicKeyFromPem(f)})});if(W0("generateKey")&&W0("exportKey"))return Ut.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:Y0(e),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(o){return Ut.globalScope.crypto.subtle.exportKey("pkcs8",o.privateKey)}).then(void 0,function(o){n(o)}).then(function(o){if(o){var f=P.privateKeyFromAsn1(x.fromDer(N.util.createBuffer(o)));n(null,{privateKey:f,publicKey:P.setRsaPublicKey(f.n,f.e)})}});if(Z0("generateKey")&&Z0("exportKey")){var i=Ut.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:Y0(e),hash:{name:"SHA-256"}},!0,["sign","verify"]);i.oncomplete=function(o){var f=o.target.result,c=Ut.globalScope.msCrypto.subtle.exportKey("pkcs8",f.privateKey);c.oncomplete=function(u){var h=u.target.result,l=P.privateKeyFromAsn1(x.fromDer(N.util.createBuffer(h)));n(null,{privateKey:l,publicKey:P.setRsaPublicKey(l.n,l.e)})},c.onerror=function(u){n(u)}},i.onerror=function(o){n(o)};return}}else if(G0("generateKeyPairSync")){var a=Qi.generateKeyPairSync("rsa",{modulusLength:t,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:P.privateKeyFromPem(a.privateKey),publicKey:P.publicKeyFromPem(a.publicKey)}}}var s=P.rsa.createKeyPairGenerationState(t,e,r);if(!n)return P.rsa.stepKeyPairGenerationState(s,0),s.keys;al(s,r,n)};P.setRsaPublicKey=P.rsa.setPublicKey=function(t,e){var r={n:t,e};return r.encrypt=function(n,i,a){if(typeof i=="string"?i=i.toUpperCase():i===void 0&&(i="RSAES-PKCS1-V1_5"),i==="RSAES-PKCS1-V1_5")i={encode:function(o,f,c){return Q0(o,f,2).getBytes()}};else if(i==="RSA-OAEP"||i==="RSAES-OAEP")i={encode:function(o,f){return N.pkcs1.encode_rsa_oaep(f,o,a)}};else if(["RAW","NONE","NULL",null].indexOf(i)!==-1)i={encode:function(o){return o}};else if(typeof i=="string")throw new Error('Unsupported encryption scheme: "'+i+'".');var s=i.encode(n,r,!0);return P.rsa.encrypt(s,r,!0)},r.verify=function(n,i,a,s){typeof a=="string"?a=a.toUpperCase():a===void 0&&(a="RSASSA-PKCS1-V1_5"),s===void 0&&(s={_parseAllDigestBytes:!0}),"_parseAllDigestBytes"in s||(s._parseAllDigestBytes=!0),a==="RSASSA-PKCS1-V1_5"?a={verify:function(f,c){c=mn(c,r,!0);var u=x.fromDer(c,{parseAllBytes:s._parseAllDigestBytes}),h={},l=[];if(!x.validate(u,nl,h,l)){var d=new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value.");throw d.errors=l,d}var p=x.derToOid(h.algorithmIdentifier);if(!(p===N.oids.md2||p===N.oids.md5||p===N.oids.sha1||p===N.oids.sha224||p===N.oids.sha256||p===N.oids.sha384||p===N.oids.sha512||p===N.oids["sha512-224"]||p===N.oids["sha512-256"])){var d=new Error("Unknown RSASSA-PKCS1-v1_5 DigestAlgorithm identifier.");throw d.oid=p,d}if((p===N.oids.md2||p===N.oids.md5)&&!("parameters"in h))throw new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value. Missing algorithm identifer NULL parameters.");return f===h.digest}}:(a==="NONE"||a==="NULL"||a===null)&&(a={verify:function(f,c){return c=mn(c,r,!0),f===c}});var o=P.rsa.decrypt(i,r,!0,!1);return a.verify(n,o,r.n.bitLength())},r};P.setRsaPrivateKey=P.rsa.setPrivateKey=function(t,e,r,n,i,a,s,o){var f={n:t,e,d:r,p:n,q:i,dP:a,dQ:s,qInv:o};return f.decrypt=function(c,u,h){typeof u=="string"?u=u.toUpperCase():u===void 0&&(u="RSAES-PKCS1-V1_5");var l=P.rsa.decrypt(c,f,!1,!1);if(u==="RSAES-PKCS1-V1_5")u={decode:mn};else if(u==="RSA-OAEP"||u==="RSAES-OAEP")u={decode:function(d,p){return N.pkcs1.decode_rsa_oaep(p,d,h)}};else if(["RAW","NONE","NULL",null].indexOf(u)!==-1)u={decode:function(d){return d}};else throw new Error('Unsupported encryption scheme: "'+u+'".');return u.decode(l,f,!1)},f.sign=function(c,u){var h=!1;typeof u=="string"&&(u=u.toUpperCase()),u===void 0||u==="RSASSA-PKCS1-V1_5"?(u={encode:il},h=1):(u==="NONE"||u==="NULL"||u===null)&&(u={encode:function(){return c}},h=1);var l=u.encode(c,f.n.bitLength());return P.rsa.encrypt(l,f,h)},f};P.wrapRsaPrivateKey=function(t){return x.create(x.Class.UNIVERSAL,x.Type.SEQUENCE,!0,[x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,x.integerToDer(0).getBytes()),x.create(x.Class.UNIVERSAL,x.Type.SEQUENCE,!0,[x.create(x.Class.UNIVERSAL,x.Type.OID,!1,x.oidToDer(P.oids.rsaEncryption).getBytes()),x.create(x.Class.UNIVERSAL,x.Type.NULL,!1,"")]),x.create(x.Class.UNIVERSAL,x.Type.OCTETSTRING,!1,x.toDer(t).getBytes())])};P.privateKeyFromAsn1=function(t){var e={},r=[];if(x.validate(t,jh,e,r)&&(t=x.fromDer(N.util.createBuffer(e.privateKey))),e={},r=[],!x.validate(t,tl,e,r)){var n=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw n.errors=r,n}var i,a,s,o,f,c,u,h;return i=N.util.createBuffer(e.privateKeyModulus).toHex(),a=N.util.createBuffer(e.privateKeyPublicExponent).toHex(),s=N.util.createBuffer(e.privateKeyPrivateExponent).toHex(),o=N.util.createBuffer(e.privateKeyPrime1).toHex(),f=N.util.createBuffer(e.privateKeyPrime2).toHex(),c=N.util.createBuffer(e.privateKeyExponent1).toHex(),u=N.util.createBuffer(e.privateKeyExponent2).toHex(),h=N.util.createBuffer(e.privateKeyCoefficient).toHex(),P.setRsaPrivateKey(new q(i,16),new q(a,16),new q(s,16),new q(o,16),new q(f,16),new q(c,16),new q(u,16),new q(h,16))};P.privateKeyToAsn1=P.privateKeyToRSAPrivateKey=function(t){return x.create(x.Class.UNIVERSAL,x.Type.SEQUENCE,!0,[x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,x.integerToDer(0).getBytes()),x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,re(t.n)),x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,re(t.e)),x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,re(t.d)),x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,re(t.p)),x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,re(t.q)),x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,re(t.dP)),x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,re(t.dQ)),x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,re(t.qInv))])};P.publicKeyFromAsn1=function(t){var e={},r=[];if(x.validate(t,rl,e,r)){var n=x.derToOid(e.publicKeyOid);if(n!==P.oids.rsaEncryption){var i=new Error("Cannot read public key. Unknown OID.");throw i.oid=n,i}t=e.rsaPublicKey}if(r=[],!x.validate(t,el,e,r)){var i=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw i.errors=r,i}var a=N.util.createBuffer(e.publicKeyModulus).toHex(),s=N.util.createBuffer(e.publicKeyExponent).toHex();return P.setRsaPublicKey(new q(a,16),new q(s,16))};P.publicKeyToAsn1=P.publicKeyToSubjectPublicKeyInfo=function(t){return x.create(x.Class.UNIVERSAL,x.Type.SEQUENCE,!0,[x.create(x.Class.UNIVERSAL,x.Type.SEQUENCE,!0,[x.create(x.Class.UNIVERSAL,x.Type.OID,!1,x.oidToDer(P.oids.rsaEncryption).getBytes()),x.create(x.Class.UNIVERSAL,x.Type.NULL,!1,"")]),x.create(x.Class.UNIVERSAL,x.Type.BITSTRING,!1,[P.publicKeyToRSAPublicKey(t)])])};P.publicKeyToRSAPublicKey=function(t){return x.create(x.Class.UNIVERSAL,x.Type.SEQUENCE,!0,[x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,re(t.n)),x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,re(t.e))])};function Q0(t,e,r){var n=N.util.createBuffer(),i=Math.ceil(e.n.bitLength()/8);if(t.length>i-11){var a=new Error("Message is too long for PKCS#1 v1.5 padding.");throw a.length=t.length,a.max=i-11,a}n.putByte(0),n.putByte(r);var s=i-3-t.length,o;if(r===0||r===1){o=r===0?0:255;for(var f=0;f<s;++f)n.putByte(o)}else for(;s>0;){for(var c=0,u=N.random.getBytes(s),f=0;f<s;++f)o=u.charCodeAt(f),o===0?++c:n.putByte(o);s=c}return n.putByte(0),n.putBytes(t),n}function mn(t,e,r,n){var i=Math.ceil(e.n.bitLength()/8),a=N.util.createBuffer(t),s=a.getByte(),o=a.getByte();if(s!==0||r&&o!==0&&o!==1||!r&&o!=2||r&&o===0&&typeof n>"u")throw new Error("Encryption block is invalid.");var f=0;if(o===0){f=i-3-n;for(var c=0;c<f;++c)if(a.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(o===1)for(f=0;a.length()>1;){if(a.getByte()!==255){--a.read;break}++f}else if(o===2)for(f=0;a.length()>1;){if(a.getByte()===0){--a.read;break}++f}var u=a.getByte();if(u!==0||f!==i-3-a.length())throw new Error("Encryption block is invalid.");return a.getBytes()}function al(t,e,r){typeof e=="function"&&(r=e,e={}),e=e||{};var n={algorithm:{name:e.algorithm||"PRIMEINC",options:{workers:e.workers||2,workLoad:e.workLoad||100,workerScript:e.workerScript}}};"prng"in e&&(n.prng=e.prng),i();function i(){a(t.pBits,function(o,f){if(o)return r(o);if(t.p=f,t.q!==null)return s(o,t.q);a(t.qBits,s)})}function a(o,f){N.prime.generateProbablePrime(o,n,f)}function s(o,f){if(o)return r(o);if(t.q=f,t.p.compareTo(t.q)<0){var c=t.p;t.p=t.q,t.q=c}if(t.p.subtract(q.ONE).gcd(t.e).compareTo(q.ONE)!==0){t.p=null,i();return}if(t.q.subtract(q.ONE).gcd(t.e).compareTo(q.ONE)!==0){t.q=null,a(t.qBits,s);return}if(t.p1=t.p.subtract(q.ONE),t.q1=t.q.subtract(q.ONE),t.phi=t.p1.multiply(t.q1),t.phi.gcd(t.e).compareTo(q.ONE)!==0){t.p=t.q=null,i();return}if(t.n=t.p.multiply(t.q),t.n.bitLength()!==t.bits){t.q=null,a(t.qBits,s);return}var u=t.e.modInverse(t.phi);t.keys={privateKey:P.rsa.setPrivateKey(t.n,t.e,u,t.p,t.q,u.mod(t.p1),u.mod(t.q1),t.q.modInverse(t.p)),publicKey:P.rsa.setPublicKey(t.n,t.e)},r(null,t.keys)}}function re(t){var e=t.toString(16);e[0]>="8"&&(e="00"+e);var r=N.util.hexToBytes(e);return r.length>1&&(r.charCodeAt(0)===0&&!(r.charCodeAt(1)&128)||r.charCodeAt(0)===255&&(r.charCodeAt(1)&128)===128)?r.substr(1):r}function sl(t){return t<=100?27:t<=150?18:t<=200?15:t<=250?12:t<=300?9:t<=350?8:t<=400?7:t<=500?6:t<=600?5:t<=800?4:t<=1250?3:2}function G0(t){return N.util.isNodejs&&typeof Qi[t]=="function"}function W0(t){return typeof Ut.globalScope<"u"&&typeof Ut.globalScope.crypto=="object"&&typeof Ut.globalScope.crypto.subtle=="object"&&typeof Ut.globalScope.crypto.subtle[t]=="function"}function Z0(t){return typeof Ut.globalScope<"u"&&typeof Ut.globalScope.msCrypto=="object"&&typeof Ut.globalScope.msCrypto.subtle=="object"&&typeof Ut.globalScope.msCrypto.subtle[t]=="function"}function Y0(t){for(var e=N.util.hexToBytes(t.toString(16)),r=new Uint8Array(e.length),n=0;n<e.length;++n)r[n]=e.charCodeAt(n);return r}});var no=F((w1,ro)=>{var I=X();$r();Ar();f0();De();fn();Vi();y0();Cr();T0();bn();lt();typeof J0>"u"&&(J0=I.jsbn.BigInteger);var J0,b=I.asn1,U=I.pki=I.pki||{};ro.exports=U.pbe=I.pbe=I.pbe||{};var Ue=U.oids,ol={name:"EncryptedPrivateKeyInfo",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:b.Class.UNIVERSAL,type:b.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:b.Class.UNIVERSAL,type:b.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},fl={name:"PBES2Algorithms",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:b.Class.UNIVERSAL,type:b.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:b.Class.UNIVERSAL,type:b.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:b.Class.UNIVERSAL,type:b.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:b.Class.UNIVERSAL,type:b.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:b.Class.UNIVERSAL,type:b.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},cl={name:"pkcs-12PbeParams",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:b.Class.UNIVERSAL,type:b.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"iterations"}]};U.encryptPrivateKeyInfo=function(t,e,r){r=r||{},r.saltSize=r.saltSize||8,r.count=r.count||2048,r.algorithm=r.algorithm||"aes128",r.prfAlgorithm=r.prfAlgorithm||"sha1";var n=I.random.getBytesSync(r.saltSize),i=r.count,a=b.integerToDer(i),s,o,f;if(r.algorithm.indexOf("aes")===0||r.algorithm==="des"){var c,u,h;switch(r.algorithm){case"aes128":s=16,c=16,u=Ue["aes128-CBC"],h=I.aes.createEncryptionCipher;break;case"aes192":s=24,c=16,u=Ue["aes192-CBC"],h=I.aes.createEncryptionCipher;break;case"aes256":s=32,c=16,u=Ue["aes256-CBC"],h=I.aes.createEncryptionCipher;break;case"des":s=8,c=8,u=Ue.desCBC,h=I.des.createEncryptionCipher;break;default:var l=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw l.algorithm=r.algorithm,l}var d="hmacWith"+r.prfAlgorithm.toUpperCase(),p=eo(d),g=I.pkcs5.pbkdf2(e,n,i,s,p),v=I.random.getBytesSync(c),m=h(g);m.start(v),m.update(b.toDer(t)),m.finish(),f=m.output.getBytes();var S=ul(n,a,s,d);o=b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(Ue.pkcs5PBES2).getBytes()),b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(Ue.pkcs5PBKDF2).getBytes()),S]),b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(u).getBytes()),b.create(b.Class.UNIVERSAL,b.Type.OCTETSTRING,!1,v)])])])}else if(r.algorithm==="3des"){s=24;var A=new I.util.ByteBuffer(n),g=U.pbe.generatePkcs12Key(e,A,1,i,s),v=U.pbe.generatePkcs12Key(e,A,2,i,s),m=I.des.createEncryptionCipher(g);m.start(v),m.update(b.toDer(t)),m.finish(),f=m.output.getBytes(),o=b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(Ue["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OCTETSTRING,!1,n),b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,a.getBytes())])])}else{var l=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw l.algorithm=r.algorithm,l}var D=b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[o,b.create(b.Class.UNIVERSAL,b.Type.OCTETSTRING,!1,f)]);return D};U.decryptPrivateKeyInfo=function(t,e){var r=null,n={},i=[];if(!b.validate(t,ol,n,i)){var a=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw a.errors=i,a}var s=b.derToOid(n.encryptionOid),o=U.pbe.getCipher(s,n.encryptionParams,e),f=I.util.createBuffer(n.encryptedData);return o.update(f),o.finish()&&(r=b.fromDer(o.output)),r};U.encryptedPrivateKeyToPem=function(t,e){var r={type:"ENCRYPTED PRIVATE KEY",body:b.toDer(t).getBytes()};return I.pem.encode(r,{maxline:e})};U.encryptedPrivateKeyFromPem=function(t){var e=I.pem.decode(t)[0];if(e.type!=="ENCRYPTED PRIVATE KEY"){var r=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw r.headerType=e.type,r}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return b.fromDer(e.body)};U.encryptRsaPrivateKey=function(t,e,r){if(r=r||{},!r.legacy){var n=U.wrapRsaPrivateKey(U.privateKeyToAsn1(t));return n=U.encryptPrivateKeyInfo(n,e,r),U.encryptedPrivateKeyToPem(n)}var i,a,s,o;switch(r.algorithm){case"aes128":i="AES-128-CBC",s=16,a=I.random.getBytesSync(16),o=I.aes.createEncryptionCipher;break;case"aes192":i="AES-192-CBC",s=24,a=I.random.getBytesSync(16),o=I.aes.createEncryptionCipher;break;case"aes256":i="AES-256-CBC",s=32,a=I.random.getBytesSync(16),o=I.aes.createEncryptionCipher;break;case"3des":i="DES-EDE3-CBC",s=24,a=I.random.getBytesSync(8),o=I.des.createEncryptionCipher;break;case"des":i="DES-CBC",s=8,a=I.random.getBytesSync(8),o=I.des.createEncryptionCipher;break;default:var f=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+r.algorithm+'".');throw f.algorithm=r.algorithm,f}var c=I.pbe.opensslDeriveBytes(e,a.substr(0,8),s),u=o(c);u.start(a),u.update(b.toDer(U.privateKeyToAsn1(t))),u.finish();var h={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:i,parameters:I.util.bytesToHex(a).toUpperCase()},body:u.output.getBytes()};return I.pem.encode(h)};U.decryptRsaPrivateKey=function(t,e){var r=null,n=I.pem.decode(t)[0];if(n.type!=="ENCRYPTED PRIVATE KEY"&&n.type!=="PRIVATE KEY"&&n.type!=="RSA PRIVATE KEY"){var i=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw i.headerType=i,i}if(n.procType&&n.procType.type==="ENCRYPTED"){var a,s;switch(n.dekInfo.algorithm){case"DES-CBC":a=8,s=I.des.createDecryptionCipher;break;case"DES-EDE3-CBC":a=24,s=I.des.createDecryptionCipher;break;case"AES-128-CBC":a=16,s=I.aes.createDecryptionCipher;break;case"AES-192-CBC":a=24,s=I.aes.createDecryptionCipher;break;case"AES-256-CBC":a=32,s=I.aes.createDecryptionCipher;break;case"RC2-40-CBC":a=5,s=function(h){return I.rc2.createDecryptionCipher(h,40)};break;case"RC2-64-CBC":a=8,s=function(h){return I.rc2.createDecryptionCipher(h,64)};break;case"RC2-128-CBC":a=16,s=function(h){return I.rc2.createDecryptionCipher(h,128)};break;default:var i=new Error('Could not decrypt private key; unsupported encryption algorithm "'+n.dekInfo.algorithm+'".');throw i.algorithm=n.dekInfo.algorithm,i}var o=I.util.hexToBytes(n.dekInfo.parameters),f=I.pbe.opensslDeriveBytes(e,o.substr(0,8),a),c=s(f);if(c.start(o),c.update(I.util.createBuffer(n.body)),c.finish())r=c.output.getBytes();else return r}else r=n.body;return n.type==="ENCRYPTED PRIVATE KEY"?r=U.decryptPrivateKeyInfo(b.fromDer(r),e):r=b.fromDer(r),r!==null&&(r=U.privateKeyFromAsn1(r)),r};U.pbe.generatePkcs12Key=function(t,e,r,n,i,a){var s,o;if(typeof a>"u"||a===null){if(!("sha1"in I.md))throw new Error('"sha1" hash algorithm unavailable.');a=I.md.sha1.create()}var f=a.digestLength,c=a.blockLength,u=new I.util.ByteBuffer,h=new I.util.ByteBuffer;if(t!=null){for(o=0;o<t.length;o++)h.putInt16(t.charCodeAt(o));h.putInt16(0)}var l=h.length(),d=e.length(),p=new I.util.ByteBuffer;p.fillWithByte(r,c);var g=c*Math.ceil(d/c),v=new I.util.ByteBuffer;for(o=0;o<g;o++)v.putByte(e.at(o%d));var m=c*Math.ceil(l/c),S=new I.util.ByteBuffer;for(o=0;o<m;o++)S.putByte(h.at(o%l));var A=v;A.putBuffer(S);for(var D=Math.ceil(i/f),T=1;T<=D;T++){var _=new I.util.ByteBuffer;_.putBytes(p.bytes()),_.putBytes(A.bytes());for(var V=0;V<n;V++)a.start(),a.update(_.getBytes()),_=a.digest();var Y=new I.util.ByteBuffer;for(o=0;o<c;o++)Y.putByte(_.at(o%f));var wt=Math.ceil(d/c)+Math.ceil(l/c),Ft=new I.util.ByteBuffer;for(s=0;s<wt;s++){var _t=new I.util.ByteBuffer(A.getBytes(c)),Et=511;for(o=Y.length()-1;o>=0;o--)Et=Et>>8,Et+=Y.at(o)+_t.at(o),_t.setAt(o,Et&255);Ft.putBuffer(_t)}A=Ft,u.putBuffer(_)}return u.truncate(u.length()-i),u};U.pbe.getCipher=function(t,e,r){switch(t){case U.oids.pkcs5PBES2:return U.pbe.getCipherForPBES2(t,e,r);case U.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case U.oids["pbewithSHAAnd40BitRC2-CBC"]:return U.pbe.getCipherForPKCS12PBE(t,e,r);default:var n=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw n.oid=t,n.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],n}};U.pbe.getCipherForPBES2=function(t,e,r){var n={},i=[];if(!b.validate(e,fl,n,i)){var a=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw a.errors=i,a}if(t=b.derToOid(n.kdfOid),t!==U.oids.pkcs5PBKDF2){var a=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw a.oid=t,a.supportedOids=["pkcs5PBKDF2"],a}if(t=b.derToOid(n.encOid),t!==U.oids["aes128-CBC"]&&t!==U.oids["aes192-CBC"]&&t!==U.oids["aes256-CBC"]&&t!==U.oids["des-EDE3-CBC"]&&t!==U.oids.desCBC){var a=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw a.oid=t,a.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],a}var s=n.kdfSalt,o=I.util.createBuffer(n.kdfIterationCount);o=o.getInt(o.length()<<3);var f,c;switch(U.oids[t]){case"aes128-CBC":f=16,c=I.aes.createDecryptionCipher;break;case"aes192-CBC":f=24,c=I.aes.createDecryptionCipher;break;case"aes256-CBC":f=32,c=I.aes.createDecryptionCipher;break;case"des-EDE3-CBC":f=24,c=I.des.createDecryptionCipher;break;case"desCBC":f=8,c=I.des.createDecryptionCipher;break}var u=to(n.prfOid),h=I.pkcs5.pbkdf2(r,s,o,f,u),l=n.encIv,d=c(h);return d.start(l),d};U.pbe.getCipherForPKCS12PBE=function(t,e,r){var n={},i=[];if(!b.validate(e,cl,n,i)){var a=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw a.errors=i,a}var s=I.util.createBuffer(n.salt),o=I.util.createBuffer(n.iterations);o=o.getInt(o.length()<<3);var f,c,u;switch(t){case U.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:f=24,c=8,u=I.des.startDecrypting;break;case U.oids["pbewithSHAAnd40BitRC2-CBC"]:f=5,c=8,u=function(g,v){var m=I.rc2.createDecryptionCipher(g,40);return m.start(v,null),m};break;default:var a=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw a.oid=t,a}var h=to(n.prfOid),l=U.pbe.generatePkcs12Key(r,s,1,o,f,h);h.start();var d=U.pbe.generatePkcs12Key(r,s,2,o,c,h);return u(l,d)};U.pbe.opensslDeriveBytes=function(t,e,r,n){if(typeof n>"u"||n===null){if(!("md5"in I.md))throw new Error('"md5" hash algorithm unavailable.');n=I.md.md5.create()}e===null&&(e="");for(var i=[j0(n,t+e)],a=16,s=1;a<r;++s,a+=16)i.push(j0(n,i[s-1]+t+e));return i.join("").substr(0,r)};function j0(t,e){return t.start().update(e).digest().getBytes()}function to(t){var e;if(!t)e="hmacWithSHA1";else if(e=U.oids[b.derToOid(t)],!e){var r=new Error("Unsupported PRF OID.");throw r.oid=t,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}return eo(e)}function eo(t){var e=I.md;switch(t){case"hmacWithSHA224":e=I.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":t=t.substr(8).toLowerCase();break;default:var r=new Error("Unsupported PRF algorithm.");throw r.algorithm=t,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}if(!e||!(t in e))throw new Error("Unknown hash algorithm: "+t);return e[t].create()}function ul(t,e,r,n){var i=b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OCTETSTRING,!1,t),b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,e.getBytes())]);return n!=="hmacWithSHA1"&&i.value.push(b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,I.util.hexToBytes(r.toString(16))),b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(U.oids[n]).getBytes()),b.create(b.Class.UNIVERSAL,b.Type.NULL,!1,"")])),i}});var mo=F((Q1,vo)=>{var et=X();De();lt();var Ir=vo.exports=et.sha512=et.sha512||{};et.md.sha512=et.md.algorithms.sha512=Ir;var go=et.sha384=et.sha512.sha384=et.sha512.sha384||{};go.create=function(){return Ir.create("SHA-384")};et.md.sha384=et.md.algorithms.sha384=go;et.sha512.sha256=et.sha512.sha256||{create:function(){return Ir.create("SHA-512/256")}};et.md["sha512/256"]=et.md.algorithms["sha512/256"]=et.sha512.sha256;et.sha512.sha224=et.sha512.sha224||{create:function(){return Ir.create("SHA-512/224")}};et.md["sha512/224"]=et.md.algorithms["sha512/224"]=et.sha512.sha224;Ir.create=function(t){if(xo||dl(),typeof t>"u"&&(t="SHA-512"),!(t in Ke))throw new Error("Invalid SHA-512 algorithm: "+t);for(var e=Ke[t],r=null,n=et.util.createBuffer(),i=new Array(80),a=0;a<80;++a)i[a]=new Array(2);var s=64;switch(t){case"SHA-384":s=48;break;case"SHA-512/256":s=32;break;case"SHA-512/224":s=28;break}var o={algorithm:t.replace("-","").toLowerCase(),blockLength:128,digestLength:s,messageLength:0,fullMessageLength:null,messageLengthSize:16};return o.start=function(){o.messageLength=0,o.fullMessageLength=o.messageLength128=[];for(var f=o.messageLengthSize/4,c=0;c<f;++c)o.fullMessageLength.push(0);n=et.util.createBuffer(),r=new Array(e.length);for(var c=0;c<e.length;++c)r[c]=e[c].slice(0);return o},o.start(),o.update=function(f,c){c==="utf8"&&(f=et.util.encodeUtf8(f));var u=f.length;o.messageLength+=u,u=[u/4294967296>>>0,u>>>0];for(var h=o.fullMessageLength.length-1;h>=0;--h)o.fullMessageLength[h]+=u[1],u[1]=u[0]+(o.fullMessageLength[h]/4294967296>>>0),o.fullMessageLength[h]=o.fullMessageLength[h]>>>0,u[0]=u[1]/4294967296>>>0;return n.putBytes(f),yo(r,i,n),(n.read>2048||n.length()===0)&&n.compact(),o},o.digest=function(){var f=et.util.createBuffer();f.putBytes(n.bytes());var c=o.fullMessageLength[o.fullMessageLength.length-1]+o.messageLengthSize,u=c&o.blockLength-1;f.putBytes(Ji.substr(0,o.blockLength-u));for(var h,l,d=o.fullMessageLength[0]*8,p=0;p<o.fullMessageLength.length-1;++p)h=o.fullMessageLength[p+1]*8,l=h/4294967296>>>0,d+=l,f.putInt32(d>>>0),d=h>>>0;f.putInt32(d);for(var g=new Array(r.length),p=0;p<r.length;++p)g[p]=r[p].slice(0);yo(g,i,f);var v=et.util.createBuffer(),m;t==="SHA-512"?m=g.length:t==="SHA-384"?m=g.length-2:m=g.length-4;for(var p=0;p<m;++p)v.putInt32(g[p][0]),(p!==m-1||t!=="SHA-512/224")&&v.putInt32(g[p][1]);return v},o};var Ji=null,xo=!1,ji=null,Ke=null;function dl(){Ji=String.fromCharCode(128),Ji+=et.util.fillString(String.fromCharCode(0),128),ji=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],Ke={},Ke["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],Ke["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],Ke["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],Ke["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],xo=!0}function yo(t,e,r){for(var n,i,a,s,o,f,c,u,h,l,d,p,g,v,m,S,A,D,T,_,V,Y,wt,Ft,_t,Et,qe,qr,dt,Ct,L,Un,Kn,Fn,On,Aa=r.length();Aa>=128;){for(dt=0;dt<16;++dt)e[dt][0]=r.getInt32()>>>0,e[dt][1]=r.getInt32()>>>0;for(;dt<80;++dt)Un=e[dt-2],Ct=Un[0],L=Un[1],n=((Ct>>>19|L<<13)^(L>>>29|Ct<<3)^Ct>>>6)>>>0,i=((Ct<<13|L>>>19)^(L<<3|Ct>>>29)^(Ct<<26|L>>>6))>>>0,Fn=e[dt-15],Ct=Fn[0],L=Fn[1],a=((Ct>>>1|L<<31)^(Ct>>>8|L<<24)^Ct>>>7)>>>0,s=((Ct<<31|L>>>1)^(Ct<<24|L>>>8)^(Ct<<25|L>>>7))>>>0,Kn=e[dt-7],On=e[dt-16],L=i+Kn[1]+s+On[1],e[dt][0]=n+Kn[0]+a+On[0]+(L/4294967296>>>0)>>>0,e[dt][1]=L>>>0;for(g=t[0][0],v=t[0][1],m=t[1][0],S=t[1][1],A=t[2][0],D=t[2][1],T=t[3][0],_=t[3][1],V=t[4][0],Y=t[4][1],wt=t[5][0],Ft=t[5][1],_t=t[6][0],Et=t[6][1],qe=t[7][0],qr=t[7][1],dt=0;dt<80;++dt)c=((V>>>14|Y<<18)^(V>>>18|Y<<14)^(Y>>>9|V<<23))>>>0,u=((V<<18|Y>>>14)^(V<<14|Y>>>18)^(Y<<23|V>>>9))>>>0,h=(_t^V&(wt^_t))>>>0,l=(Et^Y&(Ft^Et))>>>0,o=((g>>>28|v<<4)^(v>>>2|g<<30)^(v>>>7|g<<25))>>>0,f=((g<<4|v>>>28)^(v<<30|g>>>2)^(v<<25|g>>>7))>>>0,d=(g&m|A&(g^m))>>>0,p=(v&S|D&(v^S))>>>0,L=qr+u+l+ji[dt][1]+e[dt][1],n=qe+c+h+ji[dt][0]+e[dt][0]+(L/4294967296>>>0)>>>0,i=L>>>0,L=f+p,a=o+d+(L/4294967296>>>0)>>>0,s=L>>>0,qe=_t,qr=Et,_t=wt,Et=Ft,wt=V,Ft=Y,L=_+i,V=T+n+(L/4294967296>>>0)>>>0,Y=L>>>0,T=A,_=D,A=m,D=S,m=g,S=v,L=i+s,g=n+a+(L/4294967296>>>0)>>>0,v=L>>>0;L=t[0][1]+v,t[0][0]=t[0][0]+g+(L/4294967296>>>0)>>>0,t[0][1]=L>>>0,L=t[1][1]+S,t[1][0]=t[1][0]+m+(L/4294967296>>>0)>>>0,t[1][1]=L>>>0,L=t[2][1]+D,t[2][0]=t[2][0]+A+(L/4294967296>>>0)>>>0,t[2][1]=L>>>0,L=t[3][1]+_,t[3][0]=t[3][0]+T+(L/4294967296>>>0)>>>0,t[3][1]=L>>>0,L=t[4][1]+Y,t[4][0]=t[4][0]+V+(L/4294967296>>>0)>>>0,t[4][1]=L>>>0,L=t[5][1]+Ft,t[5][0]=t[5][0]+wt+(L/4294967296>>>0)>>>0,t[5][1]=L>>>0,L=t[6][1]+Et,t[6][0]=t[6][0]+_t+(L/4294967296>>>0)>>>0,t[6][1]=L>>>0,L=t[7][1]+qr,t[7][0]=t[7][0]+qe+(L/4294967296>>>0)>>>0,t[7][1]=L>>>0,Aa-=128}}});var xp={};ut(xp,{aes:()=>wi,hmac:()=>Hr,keys:()=>Ea,pbkdf2:()=>Ba,randomBytes:()=>cr});var Hr={};ut(Hr,{create:()=>Mn});var ht={get(t=globalThis){let e=t.crypto;if(e==null||e.subtle==null)throw Object.assign(new Error("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p-crypto/blob/master/README.md#web-crypto-api"),{code:"ERR_MISSING_WEB_CRYPTO"});return e}};var Ta={SHA1:20,SHA256:32,SHA512:64};var wf={SHA1:"SHA-1",SHA256:"SHA-256",SHA512:"SHA-512"},Sf=async(t,e)=>{let r=await ht.get().subtle.sign({name:"HMAC"},t,e);return new Uint8Array(r,0,r.byteLength)};async function Mn(t,e){let r=wf[t],n=await ht.get().subtle.importKey("raw",e,{name:"HMAC",hash:{name:r}},!1,["sign"]);return{async digest(i){return await Sf(n,i)},length:Ta[t]}}var wi={};ut(wi,{create:()=>Uc});var wd=it($r(),1),br=it(X(),1);var ri={};ut(ri,{identity:()=>Pf});function Rf(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<t.length;i++){var a=t.charAt(i),s=a.charCodeAt(0);if(r[s]!==255)throw new TypeError(a+" is ambiguous");r[s]=i}var o=t.length,f=t.charAt(0),c=Math.log(o)/Math.log(256),u=Math.log(256)/Math.log(o);function h(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var g=0,v=0,m=0,S=p.length;m!==S&&p[m]===0;)m++,g++;for(var A=(S-m)*u+1>>>0,D=new Uint8Array(A);m!==S;){for(var T=p[m],_=0,V=A-1;(T!==0||_<v)&&V!==-1;V--,_++)T+=256*D[V]>>>0,D[V]=T%o>>>0,T=T/o>>>0;if(T!==0)throw new Error("Non-zero carry");v=_,m++}for(var Y=A-v;Y!==A&&D[Y]===0;)Y++;for(var wt=f.repeat(g);Y<A;++Y)wt+=t.charAt(D[Y]);return wt}function l(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;var g=0;if(p[g]!==" "){for(var v=0,m=0;p[g]===f;)v++,g++;for(var S=(p.length-g)*c+1>>>0,A=new Uint8Array(S);p[g];){var D=r[p.charCodeAt(g)];if(D===255)return;for(var T=0,_=S-1;(D!==0||T<m)&&_!==-1;_--,T++)D+=o*A[_]>>>0,A[_]=D%256>>>0,D=D/256>>>0;if(D!==0)throw new Error("Non-zero carry");m=T,g++}if(p[g]!==" "){for(var V=S-m;V!==S&&A[V]===0;)V++;for(var Y=new Uint8Array(v+(S-V)),wt=v;V!==S;)Y[wt++]=A[V++];return Y}}}function d(p){var g=l(p);if(g)return g;throw new Error(`Non-${e} character`)}return{encode:h,decodeUnsafe:l,decode:d}}var kf=Rf,Nf=kf,qa=Nf;var Rp=new Uint8Array(0);var za=(t,e)=>{if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0},oe=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")};var Ha=t=>new TextEncoder().encode(t),Ga=t=>new TextDecoder().decode(t);var Jn=class{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},jn=class{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return Za(this,e)}},ti=class{constructor(e){this.decoders=e}or(e){return Za(this,e)}decode(e){let r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},Za=(t,e)=>new ti({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}}),ei=class{constructor(e,r,n,i){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=i,this.encoder=new Jn(e,r,n),this.decoder=new jn(e,r,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}},Ge=({name:t,prefix:e,encode:r,decode:n})=>new ei(t,e,r,n),ye=({prefix:t,name:e,alphabet:r})=>{let{encode:n,decode:i}=qa(r,e);return Ge({prefix:t,name:e,encode:n,decode:a=>oe(i(a))})},Df=(t,e,r,n)=>{let i={};for(let u=0;u<e.length;++u)i[e[u]]=u;let a=t.length;for(;t[a-1]==="=";)--a;let s=new Uint8Array(a*r/8|0),o=0,f=0,c=0;for(let u=0;u<a;++u){let h=i[t[u]];if(h===void 0)throw new SyntaxError(`Non-${n} character`);f=f<<r|h,o+=r,o>=8&&(o-=8,s[c++]=255&f>>o)}if(o>=r||255&f<<8-o)throw new SyntaxError("Unexpected end of data");return s},Lf=(t,e,r)=>{let n=e[e.length-1]==="=",i=(1<<r)-1,a="",s=0,o=0;for(let f=0;f<t.length;++f)for(o=o<<8|t[f],s+=8;s>r;)s-=r,a+=e[i&o>>s];if(s&&(a+=e[i&o<<r-s]),n)for(;a.length*r&7;)a+="=";return a},ft=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>Ge({prefix:e,name:t,encode(i){return Lf(i,n,r)},decode(i){return Df(i,n,r,t)}});var Pf=Ge({prefix:"\0",name:"identity",encode:t=>Ga(t),decode:t=>Ha(t)});var ni={};ut(ni,{base2:()=>Uf});var Uf=ft({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var ii={};ut(ii,{base8:()=>Kf});var Kf=ft({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var ai={};ut(ai,{base10:()=>Ff});var Ff=ye({prefix:"9",name:"base10",alphabet:"0123456789"});var si={};ut(si,{base16:()=>Of,base16upper:()=>Mf});var Of=ft({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Mf=ft({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var oi={};ut(oi,{base32:()=>We,base32hex:()=>Hf,base32hexpad:()=>Wf,base32hexpadupper:()=>Zf,base32hexupper:()=>Gf,base32pad:()=>qf,base32padupper:()=>zf,base32upper:()=>Vf,base32z:()=>Yf});var We=ft({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Vf=ft({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),qf=ft({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),zf=ft({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Hf=ft({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Gf=ft({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Wf=ft({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Zf=ft({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Yf=ft({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var fi={};ut(fi,{base36:()=>$f,base36upper:()=>Qf});var $f=ye({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Qf=ye({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var ci={};ut(ci,{base58btc:()=>Dt,base58flickr:()=>Xf});var Dt=ye({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Xf=ye({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var ui={};ut(ui,{base64:()=>yr,base64pad:()=>Jf,base64url:()=>jf,base64urlpad:()=>tc});var yr=ft({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Jf=ft({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),jf=ft({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),tc=ft({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var hi={};ut(hi,{base256emoji:()=>ac});var Ya=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),ec=Ya.reduce((t,e,r)=>(t[r]=e,t),[]),rc=Ya.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function nc(t){return t.reduce((e,r)=>(e+=ec[r],e),"")}function ic(t){let e=[];for(let r of t){let n=rc[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(n)}return new Uint8Array(e)}var ac=Ge({prefix:"\u{1F680}",name:"base256emoji",encode:nc,decode:ic});var yi={};ut(yi,{sha256:()=>Rt,sha512:()=>Bc});var sc=Xa,$a=128,oc=127,fc=~oc,cc=Math.pow(2,31);function Xa(t,e,r){e=e||[],r=r||0;for(var n=r;t>=cc;)e[r++]=t&255|$a,t/=128;for(;t&fc;)e[r++]=t&255|$a,t>>>=7;return e[r]=t|0,Xa.bytes=r-n+1,e}var uc=li,hc=128,Qa=127;function li(t,n){var r=0,n=n||0,i=0,a=n,s,o=t.length;do{if(a>=o)throw li.bytes=0,new RangeError("Could not decode varint");s=t[a++],r+=i<28?(s&Qa)<<i:(s&Qa)*Math.pow(2,i),i+=7}while(s>=hc);return li.bytes=a-n,r}var lc=Math.pow(2,7),pc=Math.pow(2,14),dc=Math.pow(2,21),yc=Math.pow(2,28),gc=Math.pow(2,35),xc=Math.pow(2,42),vc=Math.pow(2,49),mc=Math.pow(2,56),bc=Math.pow(2,63),wc=function(t){return t<lc?1:t<pc?2:t<dc?3:t<yc?4:t<gc?5:t<xc?6:t<vc?7:t<mc?8:t<bc?9:10},Sc={encode:sc,decode:uc,encodingLength:wc},Ec=Sc,gr=Ec;var xr=(t,e=0)=>[gr.decode(t,e),gr.decode.bytes],Ze=(t,e,r=0)=>(gr.encode(t,e,r),e),Ye=t=>gr.encodingLength(t);var _e=(t,e)=>{let r=e.byteLength,n=Ye(t),i=n+Ye(r),a=new Uint8Array(i+r);return Ze(t,a,0),Ze(r,a,n),a.set(e,i),new $e(t,r,e,a)},Ja=t=>{let e=oe(t),[r,n]=xr(e),[i,a]=xr(e.subarray(n)),s=e.subarray(n+a);if(s.byteLength!==i)throw new Error("Incorrect length");return new $e(r,i,s,e)},ja=(t,e)=>{if(t===e)return!0;{let r=e;return t.code===r.code&&t.size===r.size&&r.bytes instanceof Uint8Array&&za(t.bytes,r.bytes)}},$e=class{constructor(e,r,n,i){this.code=e,this.size=r,this.digest=n,this.bytes=i}};var di=({name:t,code:e,encode:r})=>new pi(t,e,r),pi=class{constructor(e,r,n){this.name=e,this.code=r,this.encode=n}digest(e){if(e instanceof Uint8Array){let r=this.encode(e);return r instanceof Uint8Array?_e(this.code,r):r.then(n=>_e(this.code,n))}else throw Error("Unknown type, must be binary type")}};var es=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),Rt=di({name:"sha2-256",code:18,encode:es("SHA-256")}),Bc=di({name:"sha2-512",code:19,encode:es("SHA-512")});var xi={};ut(xi,{identity:()=>gi});var rs=0,Ac="identity",ns=oe,Cc=t=>_e(rs,ns(t)),gi={code:rs,name:Ac,encode:ns,digest:Cc};var Xp=new TextEncoder,Jp=new TextDecoder;var is=(t,e)=>{let{bytes:r,version:n}=t;switch(n){case 0:return Rc(r,vi(t),e||Dt.encoder);default:return kc(r,vi(t),e||We.encoder)}};var as=new WeakMap,vi=t=>{let e=as.get(t);if(e==null){let r=new Map;return as.set(t,r),r}return e},yt=class{constructor(e,r,n,i){this.code=r,this.version=e,this.multihash=n,this.bytes=i,this["/"]=i}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{let{code:e,multihash:r}=this;if(e!==mr)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==Nc)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return yt.createV0(r)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{let{code:e,digest:r}=this.multihash,n=_e(e,r);return yt.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return yt.equals(this,e)}static equals(e,r){let n=r;return n&&e.code===n.code&&e.version===n.version&&ja(e.multihash,n.multihash)}toString(e){return is(this,e)}toJSON(){return{"/":is(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(e==null)return null;let r=e;if(r instanceof yt)return r;if(r["/"]!=null&&r["/"]===r.bytes||r.asCID===r){let{version:n,code:i,multihash:a,bytes:s}=r;return new yt(n,i,a,s||ss(n,i,a.bytes))}else if(r[Dc]===!0){let{version:n,multihash:i,code:a}=r,s=Ja(i);return yt.create(n,a,s)}else return null}static create(e,r,n){if(typeof r!="number")throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:{if(r!==mr)throw new Error(`Version 0 CID must use dag-pb (code: ${mr}) block encoding`);return new yt(e,r,n,n.bytes)}case 1:{let i=ss(e,r,n.bytes);return new yt(e,r,n,i)}default:throw new Error("Invalid version")}}static createV0(e){return yt.create(0,mr,e)}static createV1(e,r){return yt.create(1,e,r)}static decode(e){let[r,n]=yt.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return r}static decodeFirst(e){let r=yt.inspectBytes(e),n=r.size-r.multihashSize,i=oe(e.subarray(n,n+r.multihashSize));if(i.byteLength!==r.multihashSize)throw new Error("Incorrect length");let a=i.subarray(r.multihashSize-r.digestSize),s=new $e(r.multihashCode,r.digestSize,a,i);return[r.version===0?yt.createV0(s):yt.createV1(r.codec,s),e.subarray(r.size)]}static inspectBytes(e){let r=0,n=()=>{let[h,l]=xr(e.subarray(r));return r+=l,h},i=n(),a=mr;if(i===18?(i=0,r=0):a=n(),i!==0&&i!==1)throw new RangeError(`Invalid CID version ${i}`);let s=r,o=n(),f=n(),c=r+f,u=c-s;return{version:i,codec:a,multihashCode:o,digestSize:f,multihashSize:u,size:c}}static parse(e,r){let[n,i]=_c(e,r),a=yt.decode(i);if(a.version===0&&e[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return vi(a).set(n,e),a}},_c=(t,e)=>{switch(t[0]){case"Q":{let r=e||Dt;return[Dt.prefix,r.decode(`${Dt.prefix}${t}`)]}case Dt.prefix:{let r=e||Dt;return[Dt.prefix,r.decode(t)]}case We.prefix:{let r=e||We;return[We.prefix,r.decode(t)]}default:{if(e==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[t[0],e.decode(t)]}}},Rc=(t,e,r)=>{let{prefix:n}=r;if(n!==Dt.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);let i=e.get(n);if(i==null){let a=r.encode(t).slice(1);return e.set(n,a),a}else return i},kc=(t,e,r)=>{let{prefix:n}=r,i=e.get(n);if(i==null){let a=r.encode(t);return e.set(n,a),a}else return i},mr=112,Nc=18,ss=(t,e,r)=>{let n=Ye(t),i=n+Ye(e),a=new Uint8Array(i+r.byteLength);return Ze(t,a,0),Ze(e,a,n),a.set(r,i),a},Dc=Symbol.for("@ipld/js-cid/CID");var mi={...ri,...ni,...ii,...ai,...si,...oi,...fi,...ci,...ui,...hi},fd={...yi,...xi};function Qe(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function Xr(t=0){return globalThis.Buffer?.allocUnsafe!=null?Qe(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function fs(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}var os=fs("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),bi=fs("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);let e=Xr(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),Lc={utf8:os,"utf-8":os,hex:mi.base16,latin1:bi,ascii:bi,binary:bi,...mi},Jr=Lc;function ot(t,e="utf8"){let r=Jr[e];if(r==null)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):r.encoder.encode(t).substring(1)}function St(t,e="utf8"){let r=Jr[e];if(r==null)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Qe(globalThis.Buffer.from(t,"utf-8")):r.decoder.decode(`${r.prefix}${t}`)}function cs(t,e,r){let n=br.default.cipher.createCipher("AES-CTR",ot(e,"ascii"));return n.start({iv:ot(r,"ascii")}),{update:i=>(n.update(br.default.util.createBuffer(ot(i,"ascii"))),St(n.output.getBytes(),"ascii"))}}function us(t,e,r){let n=br.default.cipher.createDecipher("AES-CTR",ot(e,"ascii"));return n.start({iv:ot(r,"ascii")}),{update:i=>(n.update(br.default.util.createBuffer(ot(i,"ascii"))),St(n.output.getBytes(),"ascii"))}}var K=class extends Error{constructor(e,r,n){super(e),this.code=r,this.name=n?.name??"CodeError",this.props=n??{}}};var hs={16:"aes-128-ctr",32:"aes-256-ctr"};function ls(t){if(t.length===16||t.length===32)return hs[t.length];let e=Object.entries(hs).map(([r,n])=>`${r} (${n})`).join(" / ");throw new K(`Invalid key length ${t.length} bytes. Must be ${e}`,"ERR_INVALID_KEY_LENGTH")}async function Uc(t,e){let r=ls(t),n=cs(r,t,e),i=us(r,t,e);return{async encrypt(s){return n.update(s)},async decrypt(s){return i.update(s)}}}var Ea={};ut(Ea,{generateEphemeralKeyPair:()=>ho,generateKeyPair:()=>hp,generateKeyPairFromSeed:()=>lp,importKey:()=>gp,keyStretcher:()=>ao,keysPBM:()=>je,marshalPrivateKey:()=>yp,marshalPublicKey:()=>dp,supportedKeys:()=>se,unmarshalPrivateKey:()=>hf,unmarshalPublicKey:()=>pp});var je={};ut(je,{KeyType:()=>j,PrivateKey:()=>zt,PublicKey:()=>qt});var Li=it(Ci(),1),js=it(Gs(),1),t0=it(ke(),1),Pi=it(Di(),1),e0=it(Js(),1);function Gc(){t0.default._configure(),Li.default._configure(js.default),Pi.default._configure(e0.default)}Gc();var r0=["uint64","int64","sint64","fixed64","sfixed64"];function Wc(t){for(let e of r0){if(t[e]==null)continue;let r=t[e];t[e]=function(){return BigInt(r.call(this).toString())}}return t}function Ui(t){return Wc(new Li.default(t))}function Zc(t){for(let e of r0){if(t[e]==null)continue;let r=t[e];t[e]=function(n){return r.call(this,n.toString())}}return t}function Ki(){return Zc(Pi.default.create())}function nn(t,e){let r=Ui(t instanceof Uint8Array?t:t.subarray());return e.decode(r)}function an(t,e){let r=Ki();return e.encode(t,r,{lengthDelimited:!1}),r.finish()}var Je;(function(t){t[t.VARINT=0]="VARINT",t[t.BIT64=1]="BIT64",t[t.LENGTH_DELIMITED=2]="LENGTH_DELIMITED",t[t.START_GROUP=3]="START_GROUP",t[t.END_GROUP=4]="END_GROUP",t[t.BIT32=5]="BIT32"})(Je||(Je={}));function sn(t,e,r,n){return{name:t,type:e,encode:r,decode:n}}function Fi(t){function e(i){if(t[i.toString()]==null)throw new Error("Invalid enum value");return t[i]}let r=function(a,s){let o=e(a);s.int32(o)},n=function(a){let s=a.int32();return e(s)};return sn("enum",Je.VARINT,r,n)}function on(t,e){return sn("message",Je.LENGTH_DELIMITED,t,e)}var j;(function(t){t.RSA="RSA",t.Ed25519="Ed25519",t.Secp256k1="Secp256k1"})(j||(j={}));var Oi;(function(t){t[t.RSA=0]="RSA",t[t.Ed25519=1]="Ed25519",t[t.Secp256k1=2]="Secp256k1"})(Oi||(Oi={}));(function(t){t.codec=()=>Fi(Oi)})(j||(j={}));var qt;(function(t){let e;t.codec=()=>(e==null&&(e=on((r,n,i={})=>{i.lengthDelimited!==!1&&n.fork(),r.Type!=null&&(n.uint32(8),j.codec().encode(r.Type,n)),r.Data!=null&&(n.uint32(18),n.bytes(r.Data)),i.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let i={},a=n==null?r.len:r.pos+n;for(;r.pos<a;){let s=r.uint32();switch(s>>>3){case 1:i.Type=j.codec().decode(r);break;case 2:i.Data=r.bytes();break;default:r.skipType(s&7);break}}return i})),e),t.encode=r=>an(r,t.codec()),t.decode=r=>nn(r,t.codec())})(qt||(qt={}));var zt;(function(t){let e;t.codec=()=>(e==null&&(e=on((r,n,i={})=>{i.lengthDelimited!==!1&&n.fork(),r.Type!=null&&(n.uint32(8),j.codec().encode(r.Type,n)),r.Data!=null&&(n.uint32(18),n.bytes(r.Data)),i.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let i={},a=n==null?r.len:r.pos+n;for(;r.pos<a;){let s=r.uint32();switch(s>>>3){case 1:i.Type=j.codec().decode(r);break;case 2:i.Data=r.bytes();break;default:r.skipType(s&7);break}}return i})),e),t.encode=r=>an(r,t.codec()),t.decode=r=>nn(r,t.codec())})(zt||(zt={}));var Ky=it(Ar(),1),Fy=it(no(),1),Pn=it(X(),1);function ne(t,e){e==null&&(e=t.reduce((i,a)=>i+a.length,0));let r=Xr(e),n=0;for(let i of t)r.set(i,n),n+=i.length;return Qe(r)}var io={"AES-128":{ivSize:16,keySize:16},"AES-256":{ivSize:16,keySize:32},Blowfish:{ivSize:8,keySize:32}};async function ao(t,e,r){let n=io[t];if(n==null){let S=Object.keys(io).join(" / ");throw new K(`unknown cipher type '${t}'. Must be ${S}`,"ERR_INVALID_CIPHER_TYPE")}if(e==null)throw new K("missing hash type","ERR_MISSING_HASH_TYPE");let i=n.keySize,a=n.ivSize,s=20,o=St("key expansion"),f=2*(a+i+s),c=await Mn(e,r),u=await c.digest(o),h=[],l=0;for(;l<f;){let S=await c.digest(ne([u,o])),A=S.length;l+A>f&&(A=f-l),h.push(S),l+=A,u=await c.digest(u)}let d=f/2,p=ne(h),g=p.subarray(0,d),v=p.subarray(d,f),m=S=>({iv:S.subarray(0,a),cipherKey:S.subarray(a,a+i),macKey:S.subarray(a+i)});return{k1:m(g),k2:m(v)}}var _1=it(lt(),1),R1=it(xn(),1),so=it(X(),1);function Gt(t,e){let r=Uint8Array.from(t.abs().toByteArray());if(r=r[0]===0?r.subarray(1):r,e!=null){if(r.length>e)throw new Error("byte array longer than desired length");r=ne([new Uint8Array(e-r.length),r])}return ot(r,"base64url")}function kt(t){let e=wn(t);return new so.default.jsbn.BigInteger(ot(e,"base16"),16)}function wn(t,e){let r=St(t,"base64urlpad");if(e!=null){if(r.length>e)throw new Error("byte array longer than desired length");r=ne([new Uint8Array(e-r.length),r])}return r}function Wt(t,e){if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0}var oo={"P-256":256,"P-384":384,"P-521":521},hl=Object.keys(oo),Xi=hl.join(" / ");async function fo(t){if(t!=="P-256"&&t!=="P-384"&&t!=="P-521")throw new K(`Unknown curve: ${t}. Must be ${Xi}`,"ERR_INVALID_CURVE");let e=await ht.get().subtle.generateKey({name:"ECDH",namedCurve:t},!0,["deriveBits"]),r=async(a,s)=>{let o;s!=null?o=await ht.get().subtle.importKey("jwk",pl(t,s),{name:"ECDH",namedCurve:t},!1,["deriveBits"]):o=e.privateKey;let f=await ht.get().subtle.importKey("jwk",uo(t,a),{name:"ECDH",namedCurve:t},!1,[]),c=await ht.get().subtle.deriveBits({name:"ECDH",namedCurve:t,public:f},o,oo[t]);return new Uint8Array(c,0,c.byteLength)},n=await ht.get().subtle.exportKey("jwk",e.publicKey);return{key:ll(n),genSharedKey:r}}var co={"P-256":32,"P-384":48,"P-521":66};function ll(t){if(t.crv==null||t.x==null||t.y==null)throw new K("JWK was missing components","ERR_INVALID_PARAMETERS");if(t.crv!=="P-256"&&t.crv!=="P-384"&&t.crv!=="P-521")throw new K(`Unknown curve: ${t.crv}. Must be ${Xi}`,"ERR_INVALID_CURVE");let e=co[t.crv];return ne([Uint8Array.from([4]),wn(t.x,e),wn(t.y,e)],1+e*2)}function uo(t,e){if(t!=="P-256"&&t!=="P-384"&&t!=="P-521")throw new K(`Unknown curve: ${t}. Must be ${Xi}`,"ERR_INVALID_CURVE");let r=co[t];if(!Wt(e.subarray(0,1),Uint8Array.from([4])))throw new K("Cannot unmarshal public key - invalid key format","ERR_INVALID_KEY_FORMAT");return{kty:"EC",crv:t,x:ot(e.subarray(1,r+1),"base64url"),y:ot(e.subarray(1+r),"base64url"),ext:!0}}var pl=(t,e)=>({...uo(t,e.public),d:ot(e.private,"base64url")});var ho=fo;function Sn(t){let e=t?.algorithm??"AES-GCM",r=t?.keyLength??16,n=t?.nonceLength??12,i=t?.digest??"SHA-256",a=t?.saltLength??16,s=t?.iterations??32767,o=ht.get();r*=8;async function f(h,l){let d=o.getRandomValues(new Uint8Array(a)),p=o.getRandomValues(new Uint8Array(n)),g={name:e,iv:p};typeof l=="string"&&(l=St(l));let v={name:"PBKDF2",salt:d,iterations:s,hash:{name:i}},m=await o.subtle.importKey("raw",l,{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),S=await o.subtle.deriveKey(v,m,{name:e,length:r},!0,["encrypt"]),A=await o.subtle.encrypt(g,S,h);return ne([d,g.iv,new Uint8Array(A)])}async function c(h,l){let d=h.subarray(0,a),p=h.subarray(a,a+n),g=h.subarray(a+n),v={name:e,iv:p};typeof l=="string"&&(l=St(l));let m={name:"PBKDF2",salt:d,iterations:s,hash:{name:i}},S=await o.subtle.importKey("raw",l,{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),A=await o.subtle.deriveKey(m,S,{name:e,length:r},!0,["decrypt"]),D=await o.subtle.decrypt(v,A,g);return new Uint8Array(D)}return{encrypt:f,decrypt:c}}async function po(t,e){let r=yr.decode(t);return await Sn().decrypt(r,e)}var fa={};ut(fa,{RsaPrivateKey:()=>hr,RsaPublicKey:()=>Lr,fromJwk:()=>Fl,generateKeyPair:()=>Ol,unmarshalRsaPrivateKey:()=>Ul,unmarshalRsaPublicKey:()=>Kl});var wy=it(mo(),1),Dr=it(X(),1);var yl=it(tr(),1);var z=BigInt(0),rt=BigInt(1),we=BigInt(2),Rr=BigInt(3),bo=BigInt(8),ct=Object.freeze({a:z,b:BigInt(7),P:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),n:BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h:rt,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee")}),wo=(t,e)=>(t+e/we)/e,En={beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar(t){let{n:e}=ct,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-rt*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),a=r,s=BigInt("0x100000000000000000000000000000000"),o=wo(a*t,e),f=wo(-n*t,e),c=R(t-o*r-f*i,e),u=R(-o*n-f*a,e),h=c>s,l=u>s;if(h&&(c=e-c),l&&(u=e-u),c>s||u>s)throw new Error("splitScalarEndo: Endomorphism failed, k="+t);return{k1neg:h,k1:c,k2neg:l,k2:u}}},Zt=32,ar=32,gl=32,So=Zt+1,Eo=2*Zt+1;function Bo(t){let{a:e,b:r}=ct,n=R(t*t),i=R(n*t);return R(i+e*t+r)}var Bn=ct.a===z,Tn=class extends Error{constructor(e){super(e)}};function Ao(t){if(!(t instanceof Z))throw new TypeError("JacobianPoint expected")}var Z=class{constructor(e,r,n){this.x=e,this.y=r,this.z=n}static fromAffine(e){if(!(e instanceof $))throw new TypeError("JacobianPoint#fromAffine: expected Point");return e.equals($.ZERO)?Z.ZERO:new Z(e.x,e.y,rt)}static toAffineBatch(e){let r=wl(e.map(n=>n.z));return e.map((n,i)=>n.toAffine(r[i]))}static normalizeZ(e){return Z.toAffineBatch(e).map(Z.fromAffine)}equals(e){Ao(e);let{x:r,y:n,z:i}=this,{x:a,y:s,z:o}=e,f=R(i*i),c=R(o*o),u=R(r*c),h=R(a*f),l=R(R(n*o)*c),d=R(R(s*i)*f);return u===h&&l===d}negate(){return new Z(this.x,R(-this.y),this.z)}double(){let{x:e,y:r,z:n}=this,i=R(e*e),a=R(r*r),s=R(a*a),o=e+a,f=R(we*(R(o*o)-i-s)),c=R(Rr*i),u=R(c*c),h=R(u-we*f),l=R(c*(f-h)-bo*s),d=R(we*r*n);return new Z(h,l,d)}add(e){Ao(e);let{x:r,y:n,z:i}=this,{x:a,y:s,z:o}=e;if(a===z||s===z)return this;if(r===z||n===z)return e;let f=R(i*i),c=R(o*o),u=R(r*c),h=R(a*f),l=R(R(n*o)*c),d=R(R(s*i)*f),p=R(h-u),g=R(d-l);if(p===z)return g===z?this.double():Z.ZERO;let v=R(p*p),m=R(p*v),S=R(u*v),A=R(g*g-m-we*S),D=R(g*(S-A)-l*m),T=R(i*o*p);return new Z(A,D,T)}subtract(e){return this.add(e.negate())}multiplyUnsafe(e){let r=Z.ZERO;if(typeof e=="bigint"&&e===z)return r;let n=Io(e);if(n===rt)return this;if(!Bn){let h=r,l=this;for(;n>z;)n&rt&&(h=h.add(l)),l=l.double(),n>>=rt;return h}let{k1neg:i,k1:a,k2neg:s,k2:o}=En.splitScalar(n),f=r,c=r,u=this;for(;a>z||o>z;)a&rt&&(f=f.add(u)),o&rt&&(c=c.add(u)),u=u.double(),a>>=rt,o>>=rt;return i&&(f=f.negate()),s&&(c=c.negate()),c=new Z(R(c.x*En.beta),c.y,c.z),f.add(c)}precomputeWindow(e){let r=Bn?128/e+1:256/e+1,n=[],i=this,a=i;for(let s=0;s<r;s++){a=i,n.push(a);for(let o=1;o<2**(e-1);o++)a=a.add(i),n.push(a);i=a.double()}return n}wNAF(e,r){!r&&this.equals(Z.BASE)&&(r=$.BASE);let n=r&&r._WINDOW_SIZE||1;if(256%n)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let i=r&&ea.get(r);i||(i=this.precomputeWindow(n),r&&n!==1&&(i=Z.normalizeZ(i),ea.set(r,i)));let a=Z.ZERO,s=Z.BASE,o=1+(Bn?128/n:256/n),f=2**(n-1),c=BigInt(2**n-1),u=2**n,h=BigInt(n);for(let l=0;l<o;l++){let d=l*f,p=Number(e&c);e>>=h,p>f&&(p-=u,e+=rt);let g=d,v=d+Math.abs(p)-1,m=l%2!==0,S=p<0;p===0?s=s.add(An(m,i[g])):a=a.add(An(S,i[v]))}return{p:a,f:s}}multiply(e,r){let n=Io(e),i,a;if(Bn){let{k1neg:s,k1:o,k2neg:f,k2:c}=En.splitScalar(n),{p:u,f:h}=this.wNAF(o,r),{p:l,f:d}=this.wNAF(c,r);u=An(s,u),l=An(f,l),l=new Z(R(l.x*En.beta),l.y,l.z),i=u.add(l),a=h.add(d)}else{let{p:s,f:o}=this.wNAF(n,r);i=s,a=o}return Z.normalizeZ([i,a])[0]}toAffine(e){let{x:r,y:n,z:i}=this,a=this.equals(Z.ZERO);e==null&&(e=a?bo:fr(i));let s=e,o=R(s*s),f=R(o*s),c=R(r*o),u=R(n*f),h=R(i*s);if(a)return $.ZERO;if(h!==rt)throw new Error("invZ was invalid");return new $(c,u)}};Z.BASE=new Z(ct.Gx,ct.Gy,rt);Z.ZERO=new Z(z,rt,z);function An(t,e){let r=e.negate();return t?r:e}var ea=new WeakMap,$=class{constructor(e,r){this.x=e,this.y=r}_setWindowSize(e){this._WINDOW_SIZE=e,ea.delete(this)}hasEvenY(){return this.y%we===z}static fromCompressedHex(e){let r=e.length===32,n=Se(r?e:e.subarray(1));if(!ta(n))throw new Error("Point is not on curve");let i=Bo(n),a=bl(i),s=(a&rt)===rt;r?s&&(a=R(-a)):(e[0]&1)===1!==s&&(a=R(-a));let o=new $(n,a);return o.assertValidity(),o}static fromUncompressedHex(e){let r=Se(e.subarray(1,Zt+1)),n=Se(e.subarray(Zt+1,Zt*2+1)),i=new $(r,n);return i.assertValidity(),i}static fromHex(e){let r=or(e),n=r.length,i=r[0];if(n===Zt)return this.fromCompressedHex(r);if(n===So&&(i===2||i===3))return this.fromCompressedHex(r);if(n===Eo&&i===4)return this.fromUncompressedHex(r);throw new Error(`Point.fromHex: received invalid point. Expected 32-${So} compressed bytes or ${Eo} uncompressed bytes, not ${n}`)}static fromPrivateKey(e){return $.BASE.multiply(_n(e))}static fromSignature(e,r,n){let{r:i,s:a}=_o(r);if(![0,1,2,3].includes(n))throw new Error("Cannot recover: invalid recovery bit");let s=ia(or(e)),{n:o}=ct,f=n===2||n===3?i+o:i,c=fr(f,o),u=R(-s*c,o),h=R(a*c,o),l=n&1?"03":"02",d=$.fromHex(l+nr(f)),p=$.BASE.multiplyAndAddUnsafe(d,u,h);if(!p)throw new Error("Cannot recover signature: point at infinify");return p.assertValidity(),p}toRawBytes(e=!1){return Fe(this.toHex(e))}toHex(e=!1){let r=nr(this.x);return e?`${this.hasEvenY()?"02":"03"}${r}`:`04${r}${nr(this.y)}`}toHexX(){return this.toHex(!0).slice(2)}toRawX(){return this.toRawBytes(!0).slice(1)}assertValidity(){let e="Point is not on elliptic curve",{x:r,y:n}=this;if(!ta(r)||!ta(n))throw new Error(e);let i=R(n*n),a=Bo(r);if(R(i-a)!==z)throw new Error(e)}equals(e){return this.x===e.x&&this.y===e.y}negate(){return new $(this.x,R(-this.y))}double(){return Z.fromAffine(this).double().toAffine()}add(e){return Z.fromAffine(this).add(Z.fromAffine(e)).toAffine()}subtract(e){return this.add(e.negate())}multiply(e){return Z.fromAffine(this).multiply(e,this).toAffine()}multiplyAndAddUnsafe(e,r,n){let i=Z.fromAffine(this),a=r===z||r===rt||this!==$.BASE?i.multiplyUnsafe(r):i.multiply(r),s=Z.fromAffine(e).multiplyUnsafe(n),o=a.add(s);return o.equals(Z.ZERO)?void 0:o.toAffine()}};$.BASE=new $(ct.Gx,ct.Gy);$.ZERO=new $(z,z);function Co(t){return Number.parseInt(t[0],16)>=8?"00"+t:t}function To(t){if(t.length<2||t[0]!==2)throw new Error(`Invalid signature integer tag: ${sr(t)}`);let e=t[1],r=t.subarray(2,e+2);if(!e||r.length!==e)throw new Error("Invalid signature integer: wrong length");if(r[0]===0&&r[1]<=127)throw new Error("Invalid signature integer: trailing length");return{data:Se(r),left:t.subarray(e+2)}}function xl(t){if(t.length<2||t[0]!=48)throw new Error(`Invalid signature tag: ${sr(t)}`);if(t[1]!==t.length-2)throw new Error("Invalid signature: incorrect length");let{data:e,left:r}=To(t.subarray(2)),{data:n,left:i}=To(r);if(i.length)throw new Error(`Invalid signature: left bytes after parsing: ${sr(i)}`);return{r:e,s:n}}var ie=class{constructor(e,r){this.r=e,this.s=r,this.assertValidity()}static fromCompact(e){let r=e instanceof Uint8Array,n="Signature.fromCompact";if(typeof e!="string"&&!r)throw new TypeError(`${n}: Expected string or Uint8Array`);let i=r?sr(e):e;if(i.length!==128)throw new Error(`${n}: Expected 64-byte hex`);return new ie(In(i.slice(0,64)),In(i.slice(64,128)))}static fromDER(e){let r=e instanceof Uint8Array;if(typeof e!="string"&&!r)throw new TypeError("Signature.fromDER: Expected string or Uint8Array");let{r:n,s:i}=xl(r?e:Fe(e));return new ie(n,i)}static fromHex(e){return this.fromDER(e)}assertValidity(){let{r:e,s:r}=this;if(!Nr(e))throw new Error("Invalid Signature: r must be 0 < r < n");if(!Nr(r))throw new Error("Invalid Signature: s must be 0 < s < n")}hasHighS(){let e=ct.n>>rt;return this.s>e}normalizeS(){return this.hasHighS()?new ie(this.r,R(-this.s,ct.n)):this}toDERRawBytes(){return Fe(this.toDERHex())}toDERHex(){let e=Co(_r(this.s)),r=Co(_r(this.r)),n=e.length/2,i=r.length/2,a=_r(n),s=_r(i);return`30${_r(i+n+4)}02${s}${r}02${a}${e}`}toRawBytes(){return this.toDERRawBytes()}toHex(){return this.toDERHex()}toCompactRawBytes(){return Fe(this.toCompactHex())}toCompactHex(){return nr(this.r)+nr(this.s)}};function be(...t){if(!t.every(n=>n instanceof Uint8Array))throw new Error("Uint8Array list expected");if(t.length===1)return t[0];let e=t.reduce((n,i)=>n+i.length,0),r=new Uint8Array(e);for(let n=0,i=0;n<t.length;n++){let a=t[n];r.set(a,i),i+=a.length}return r}var vl=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function sr(t){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");let e="";for(let r=0;r<t.length;r++)e+=vl[t[r]];return e}var ml=BigInt("0x10000000000000000000000000000000000000000000000000000000000000000");function nr(t){if(typeof t!="bigint")throw new Error("Expected bigint");if(!(z<=t&&t<ml))throw new Error("Expected number 0 <= n < 2^256");return t.toString(16).padStart(64,"0")}function ra(t){let e=Fe(nr(t));if(e.length!==32)throw new Error("Error: expected 32 bytes");return e}function _r(t){let e=t.toString(16);return e.length&1?`0${e}`:e}function In(t){if(typeof t!="string")throw new TypeError("hexToNumber: expected string, got "+typeof t);return BigInt(`0x${t}`)}function Fe(t){if(typeof t!="string")throw new TypeError("hexToBytes: expected string, got "+typeof t);if(t.length%2)throw new Error("hexToBytes: received invalid unpadded hex"+t.length);let e=new Uint8Array(t.length/2);for(let r=0;r<e.length;r++){let n=r*2,i=t.slice(n,n+2),a=Number.parseInt(i,16);if(Number.isNaN(a)||a<0)throw new Error("Invalid byte sequence");e[r]=a}return e}function Se(t){return In(sr(t))}function or(t){return t instanceof Uint8Array?Uint8Array.from(t):Fe(t)}function Io(t){if(typeof t=="number"&&Number.isSafeInteger(t)&&t>0)return BigInt(t);if(typeof t=="bigint"&&Nr(t))return t;throw new TypeError("Expected valid private scalar: 0 < scalar < curve.n")}function R(t,e=ct.P){let r=t%e;return r>=z?r:e+r}function Kt(t,e){let{P:r}=ct,n=t;for(;e-- >z;)n*=n,n%=r;return n}function bl(t){let{P:e}=ct,r=BigInt(6),n=BigInt(11),i=BigInt(22),a=BigInt(23),s=BigInt(44),o=BigInt(88),f=t*t*t%e,c=f*f*t%e,u=Kt(c,Rr)*c%e,h=Kt(u,Rr)*c%e,l=Kt(h,we)*f%e,d=Kt(l,n)*l%e,p=Kt(d,i)*d%e,g=Kt(p,s)*p%e,v=Kt(g,o)*g%e,m=Kt(v,s)*p%e,S=Kt(m,Rr)*c%e,A=Kt(S,a)*d%e,D=Kt(A,r)*f%e,T=Kt(D,we);if(T*T%e!==t)throw new Error("Cannot find square root");return T}function fr(t,e=ct.P){if(t===z||e<=z)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let r=R(t,e),n=e,i=z,a=rt,s=rt,o=z;for(;r!==z;){let c=n/r,u=n%r,h=i-s*c,l=a-o*c;n=r,r=u,i=s,a=o,s=h,o=l}if(n!==rt)throw new Error("invert: does not exist");return R(i,e)}function wl(t,e=ct.P){let r=new Array(t.length),n=t.reduce((a,s,o)=>s===z?a:(r[o]=a,R(a*s,e)),rt),i=fr(n,e);return t.reduceRight((a,s,o)=>s===z?a:(r[o]=R(a*r[o],e),R(a*s,e)),i),r}function Sl(t){let e=t.length*8-ar*8,r=Se(t);return e>0?r>>BigInt(e):r}function ia(t,e=!1){let r=Sl(t);if(e)return r;let{n}=ct;return r>=n?r-n:r}var ir,kr,na=class{constructor(e,r){if(this.hashLen=e,this.qByteLen=r,typeof e!="number"||e<2)throw new Error("hashLen must be a number");if(typeof r!="number"||r<2)throw new Error("qByteLen must be a number");this.v=new Uint8Array(e).fill(1),this.k=new Uint8Array(e).fill(0),this.counter=0}hmac(...e){return Yt.hmacSha256(this.k,...e)}hmacSync(...e){return kr(this.k,...e)}checkSync(){if(typeof kr!="function")throw new Tn("hmacSha256Sync needs to be set")}incr(){if(this.counter>=1e3)throw new Error("Tried 1,000 k values for sign(), all were invalid");this.counter+=1}async reseed(e=new Uint8Array){this.k=await this.hmac(this.v,Uint8Array.from([0]),e),this.v=await this.hmac(this.v),e.length!==0&&(this.k=await this.hmac(this.v,Uint8Array.from([1]),e),this.v=await this.hmac(this.v))}reseedSync(e=new Uint8Array){this.checkSync(),this.k=this.hmacSync(this.v,Uint8Array.from([0]),e),this.v=this.hmacSync(this.v),e.length!==0&&(this.k=this.hmacSync(this.v,Uint8Array.from([1]),e),this.v=this.hmacSync(this.v))}async generate(){this.incr();let e=0,r=[];for(;e<this.qByteLen;){this.v=await this.hmac(this.v);let n=this.v.slice();r.push(n),e+=this.v.length}return be(...r)}generateSync(){this.checkSync(),this.incr();let e=0,r=[];for(;e<this.qByteLen;){this.v=this.hmacSync(this.v);let n=this.v.slice();r.push(n),e+=this.v.length}return be(...r)}};function Nr(t){return z<t&&t<ct.n}function ta(t){return z<t&&t<ct.P}function El(t,e,r,n=!0){let{n:i}=ct,a=ia(t,!0);if(!Nr(a))return;let s=fr(a,i),o=$.BASE.multiply(a),f=R(o.x,i);if(f===z)return;let c=R(s*R(e+r*f,i),i);if(c===z)return;let u=new ie(f,c),h=(o.x===u.r?0:2)|Number(o.y&rt);return n&&u.hasHighS()&&(u=u.normalizeS(),h^=1),{sig:u,recovery:h}}function _n(t){let e;if(typeof t=="bigint")e=t;else if(typeof t=="number"&&Number.isSafeInteger(t)&&t>0)e=BigInt(t);else if(typeof t=="string"){if(t.length!==2*ar)throw new Error("Expected 32 bytes of private key");e=In(t)}else if(t instanceof Uint8Array){if(t.length!==ar)throw new Error("Expected 32 bytes of private key");e=Se(t)}else throw new TypeError("Expected valid private key");if(!Nr(e))throw new Error("Expected private key: 0 < key < n");return e}function Bl(t){return t instanceof $?(t.assertValidity(),t):$.fromHex(t)}function _o(t){if(t instanceof ie)return t.assertValidity(),t;try{return ie.fromDER(t)}catch{return ie.fromCompact(t)}}function aa(t,e=!1){return $.fromPrivateKey(t).toRawBytes(e)}function Ro(t){let e=t.length>Zt?t.slice(0,Zt):t;return Se(e)}function Al(t){let e=Ro(t),r=R(e,ct.n);return ko(r<z?e:r)}function ko(t){return ra(t)}function Cl(t,e,r){if(t==null)throw new Error(`sign: expected valid message hash, not "${t}"`);let n=or(t),i=_n(e),a=[ko(i),Al(n)];if(r!=null){r===!0&&(r=Yt.randomBytes(Zt));let f=or(r);if(f.length!==Zt)throw new Error(`sign: Expected ${Zt} bytes of extra data`);a.push(f)}let s=be(...a),o=Ro(n);return{seed:s,m:o,d:i}}function Tl(t,e){let{sig:r,recovery:n}=t,{der:i,recovered:a}=Object.assign({canonical:!0,der:!0},e),s=i?r.toDERRawBytes():r.toCompactRawBytes();return a?[s,n]:s}async function No(t,e,r={}){let{seed:n,m:i,d:a}=Cl(t,e,r.extraEntropy),s=new na(gl,ar);await s.reseed(n);let o;for(;!(o=El(await s.generate(),i,a,r.canonical));)await s.reseed();return Tl(o,r)}var Il={strict:!0};function Do(t,e,r,n=Il){let i;try{i=_o(t),e=or(e)}catch{return!1}let{r:a,s}=i;if(n.strict&&i.hasHighS())return!1;let o=ia(e),f;try{f=Bl(r)}catch{return!1}let{n:c}=ct,u=fr(s,c),h=R(o*u,c),l=R(a*u,c),d=$.BASE.multiplyAndAddUnsafe(f,h,l);return d?R(d.x,c)===a:!1}$.BASE._setWindowSize(8);var Nt={node:yl,web:typeof self=="object"&&"crypto"in self?self.crypto:void 0};var Cn={},Yt={bytesToHex:sr,hexToBytes:Fe,concatBytes:be,mod:R,invert:fr,isValidPrivateKey(t){try{return _n(t),!0}catch{return!1}},_bigintTo32Bytes:ra,_normalizePrivateKey:_n,hashToPrivateKey:t=>{t=or(t);let e=ar+8;if(t.length<e||t.length>1024)throw new Error("Expected valid bytes of private key as per FIPS 186");let r=R(Se(t),ct.n-rt)+rt;return ra(r)},randomBytes:(t=32)=>{if(Nt.web)return Nt.web.getRandomValues(new Uint8Array(t));if(Nt.node){let{randomBytes:e}=Nt.node;return Uint8Array.from(e(t))}else throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>Yt.hashToPrivateKey(Yt.randomBytes(ar+8)),precompute(t=8,e=$.BASE){let r=e===$.BASE?e:new $(e.x,e.y);return r._setWindowSize(t),r.multiply(Rr),r},sha256:async(...t)=>{if(Nt.web){let e=await Nt.web.subtle.digest("SHA-256",be(...t));return new Uint8Array(e)}else if(Nt.node){let{createHash:e}=Nt.node,r=e("sha256");return t.forEach(n=>r.update(n)),Uint8Array.from(r.digest())}else throw new Error("The environment doesn't have sha256 function")},hmacSha256:async(t,...e)=>{if(Nt.web){let r=await Nt.web.subtle.importKey("raw",t,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),n=be(...e),i=await Nt.web.subtle.sign("HMAC",r,n);return new Uint8Array(i)}else if(Nt.node){let{createHmac:r}=Nt.node,n=r("sha256",t);return e.forEach(i=>n.update(i)),Uint8Array.from(n.digest())}else throw new Error("The environment doesn't have hmac-sha256 function")},sha256Sync:void 0,hmacSha256Sync:void 0,taggedHash:async(t,...e)=>{let r=Cn[t];if(r===void 0){let n=await Yt.sha256(Uint8Array.from(t,i=>i.charCodeAt(0)));r=be(n,n),Cn[t]=r}return Yt.sha256(r,...e)},taggedHashSync:(t,...e)=>{if(typeof ir!="function")throw new Tn("sha256Sync is undefined, you need to set it");let r=Cn[t];if(r===void 0){let n=ir(Uint8Array.from(t,i=>i.charCodeAt(0)));r=be(n,n),Cn[t]=r}return ir(r,...e)},_JacobianPoint:Z};Object.defineProperties(Yt,{sha256Sync:{configurable:!1,get(){return ir},set(t){ir||(ir=t)}},hmacSha256Sync:{configurable:!1,get(){return kr},set(t){kr||(kr=t)}}});function cr(t){if(isNaN(t)||t<=0)throw new K("random bytes length must be a Number bigger than 0","ERR_INVALID_LENGTH");return Yt.randomBytes(t)}var Oe={};ut(Oe,{jwkToPkcs1:()=>kl,jwkToPkix:()=>Dl,pkcs1ToJwk:()=>Rl,pkixToJwk:()=>Nl});var ty=it(Ar(),1),ey=it(bn(),1),he=it(X(),1);function Rl(t){let e=he.default.asn1.fromDer(ot(t,"ascii")),r=he.default.pki.privateKeyFromAsn1(e);return{kty:"RSA",n:Gt(r.n),e:Gt(r.e),d:Gt(r.d),p:Gt(r.p),q:Gt(r.q),dp:Gt(r.dP),dq:Gt(r.dQ),qi:Gt(r.qInv),alg:"RS256"}}function kl(t){if(t.n==null||t.e==null||t.d==null||t.p==null||t.q==null||t.dp==null||t.dq==null||t.qi==null)throw new K("JWK was missing components","ERR_INVALID_PARAMETERS");let e=he.default.pki.privateKeyToAsn1({n:kt(t.n),e:kt(t.e),d:kt(t.d),p:kt(t.p),q:kt(t.q),dP:kt(t.dp),dQ:kt(t.dq),qInv:kt(t.qi)});return St(he.default.asn1.toDer(e).getBytes(),"ascii")}function Nl(t){let e=he.default.asn1.fromDer(ot(t,"ascii")),r=he.default.pki.publicKeyFromAsn1(e);return{kty:"RSA",n:Gt(r.n),e:Gt(r.e)}}function Dl(t){if(t.n==null||t.e==null)throw new K("JWK was missing components","ERR_INVALID_PARAMETERS");let e=he.default.pki.publicKeyToAsn1({n:kt(t.n),e:kt(t.e)});return St(he.default.asn1.toDer(e).getBytes(),"ascii")}var sy=it(bn(),1),sa=it(X(),1);function Lo(t,e){return e.map(r=>kt(t[r]))}function Po(t){return sa.default.pki.setRsaPrivateKey(...Lo(t,["n","e","d","p","q","dp","dq","qi"]))}function Uo(t){return sa.default.pki.setRsaPublicKey(...Lo(t,["n","e"]))}async function Ko(t){let e=await ht.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),r=await Mo(e);return{privateKey:r[0],publicKey:r[1]}}async function oa(t){let r=[await ht.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["sign"]),await Ll(t)],n=await Mo({privateKey:r[0],publicKey:r[1]});return{privateKey:n[0],publicKey:n[1]}}async function Fo(t,e){let r=await ht.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),n=await ht.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},r,Uint8Array.from(e));return new Uint8Array(n,0,n.byteLength)}async function Oo(t,e,r){let n=await ht.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return await ht.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},n,e,r)}async function Mo(t){if(t.privateKey==null||t.publicKey==null)throw new K("Private and public key are required","ERR_INVALID_PARAMETERS");return await Promise.all([ht.get().subtle.exportKey("jwk",t.privateKey),ht.get().subtle.exportKey("jwk",t.publicKey)])}async function Ll(t){return await ht.get().subtle.importKey("jwk",{kty:t.kty,n:t.n,e:t.e},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["verify"])}function Vo(t,e,r,n){let i=e?Uo(t):Po(t),a=ot(Uint8Array.from(r),"ascii"),s=n(a,i);return St(s,"ascii")}function qo(t,e){return Vo(t,!0,e,(r,n)=>n.encrypt(r))}function zo(t,e){return Vo(t,!1,e,(r,n)=>n.decrypt(r))}async function ur(t,e){let n=await Sn().encrypt(t,e);return yr.encode(n)}var Lr=class{constructor(e){this._key=e}async verify(e,r){return await Oo(this._key,r,e)}marshal(){return Oe.jwkToPkix(this._key)}get bytes(){return qt.encode({Type:j.RSA,Data:this.marshal()}).subarray()}encrypt(e){return qo(this._key,e)}equals(e){return Wt(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Rt.digest(this.bytes);return e}},hr=class{constructor(e,r){this._key=e,this._publicKey=r}genSecret(){return cr(16)}async sign(e){return await Fo(this._key,e)}get public(){if(this._publicKey==null)throw new K("public key not provided","ERR_PUBKEY_NOT_PROVIDED");return new Lr(this._publicKey)}decrypt(e){return zo(this._key,e)}marshal(){return Oe.jwkToPkcs1(this._key)}get bytes(){return zt.encode({Type:j.RSA,Data:this.marshal()}).subarray()}equals(e){return Wt(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Rt.digest(this.bytes);return e}async id(){let e=await this.public.hash();return ot(e,"base58btc")}async export(e,r="pkcs-8"){if(r==="pkcs-8"){let n=new Dr.default.util.ByteBuffer(this.marshal()),i=Dr.default.asn1.fromDer(n),a=Dr.default.pki.privateKeyFromAsn1(i),s={algorithm:"aes256",count:1e4,saltSize:128/8,prfAlgorithm:"sha512"};return Dr.default.pki.encryptRsaPrivateKey(a,e,s)}else{if(r==="libp2p-key")return await ur(this.bytes,e);throw new K(`export format '${r}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}}};async function Ul(t){let e=Oe.pkcs1ToJwk(t),r=await oa(e);return new hr(r.privateKey,r.publicKey)}function Kl(t){let e=Oe.pkixToJwk(t);return new Lr(e)}async function Fl(t){let e=await oa(t);return new hr(e.privateKey,e.publicKey)}async function Ol(t){let e=await Ko(t);return new hr(e.privateKey,e.publicKey)}var va={};ut(va,{Ed25519PrivateKey:()=>Ve,Ed25519PublicKey:()=>Or,generateKeyPair:()=>sp,generateKeyPairFromSeed:()=>xa,unmarshalEd25519PrivateKey:()=>ip,unmarshalEd25519PublicKey:()=>ap});var Ml=it(tr(),1);var bt=BigInt(0),H=BigInt(1),Ae=BigInt(2),Vl=BigInt(8),Ho=BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),nt=Object.freeze({a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),P:BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),l:Ho,n:Ho,h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960")});var $o=BigInt("0x10000000000000000000000000000000000000000000000000000000000000000"),Pr=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),Ey=BigInt("6853475219497561581579357271197624642482790079785650197046958215289687604742"),ql=BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),zl=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),Hl=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),Gl=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952"),M=class{constructor(e,r,n,i){this.x=e,this.y=r,this.z=n,this.t=i}static fromAffine(e){if(!(e instanceof st))throw new TypeError("ExtendedPoint#fromAffine: expected Point");return e.equals(st.ZERO)?M.ZERO:new M(e.x,e.y,H,E(e.x*e.y))}static toAffineBatch(e){let r=Yl(e.map(n=>n.z));return e.map((n,i)=>n.toAffine(r[i]))}static normalizeZ(e){return this.toAffineBatch(e).map(this.fromAffine)}equals(e){Wo(e);let{x:r,y:n,z:i}=this,{x:a,y:s,z:o}=e,f=E(r*o),c=E(a*i),u=E(n*o),h=E(s*i);return f===c&&u===h}negate(){return new M(E(-this.x),this.y,this.z,E(-this.t))}double(){let{x:e,y:r,z:n}=this,{a:i}=nt,a=E(e*e),s=E(r*r),o=E(Ae*E(n*n)),f=E(i*a),c=e+r,u=E(E(c*c)-a-s),h=f+s,l=h-o,d=f-s,p=E(u*l),g=E(h*d),v=E(u*d),m=E(l*h);return new M(p,g,m,v)}add(e){Wo(e);let{x:r,y:n,z:i,t:a}=this,{x:s,y:o,z:f,t:c}=e,u=E((n-r)*(o+s)),h=E((n+r)*(o-s)),l=E(h-u);if(l===bt)return this.double();let d=E(i*Ae*c),p=E(a*Ae*f),g=p+d,v=h+u,m=p-d,S=E(g*l),A=E(v*m),D=E(g*m),T=E(l*v);return new M(S,A,T,D)}subtract(e){return this.add(e.negate())}precomputeWindow(e){let r=1+256/e,n=[],i=this,a=i;for(let s=0;s<r;s++){a=i,n.push(a);for(let o=1;o<2**(e-1);o++)a=a.add(i),n.push(a);i=a.double()}return n}wNAF(e,r){!r&&this.equals(M.BASE)&&(r=st.BASE);let n=r&&r._WINDOW_SIZE||1;if(256%n)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let i=r&&pa.get(r);i||(i=this.precomputeWindow(n),r&&n!==1&&(i=M.normalizeZ(i),pa.set(r,i)));let a=M.ZERO,s=M.BASE,o=1+256/n,f=2**(n-1),c=BigInt(2**n-1),u=2**n,h=BigInt(n);for(let l=0;l<o;l++){let d=l*f,p=Number(e&c);e>>=h,p>f&&(p-=u,e+=H);let g=d,v=d+Math.abs(p)-1,m=l%2!==0,S=p<0;p===0?s=s.add(Go(m,i[g])):a=a.add(Go(S,i[v]))}return M.normalizeZ([a,s])[0]}multiply(e,r){return this.wNAF(kn(e,nt.l),r)}multiplyUnsafe(e){let r=kn(e,nt.l,!1),n=M.BASE,i=M.ZERO;if(r===bt)return i;if(this.equals(i)||r===H)return this;if(this.equals(n))return this.wNAF(r);let a=i,s=this;for(;r>bt;)r&H&&(a=a.add(s)),s=s.double(),r>>=H;return a}isSmallOrder(){return this.multiplyUnsafe(nt.h).equals(M.ZERO)}isTorsionFree(){let e=this.multiplyUnsafe(nt.l/Ae).double();return nt.l%Ae&&(e=e.add(this)),e.equals(M.ZERO)}toAffine(e){let{x:r,y:n,z:i}=this,a=this.equals(M.ZERO);e==null&&(e=a?Vl:Nn(i));let s=E(r*e),o=E(n*e),f=E(i*e);if(a)return st.ZERO;if(f!==H)throw new Error("invZ was invalid");return new st(s,o)}fromRistrettoBytes(){ua()}toRistrettoBytes(){ua()}fromRistrettoHash(){ua()}};M.BASE=new M(nt.Gx,nt.Gy,H,E(nt.Gx*nt.Gy));M.ZERO=new M(bt,H,H,bt);function Go(t,e){let r=e.negate();return t?r:e}function Wo(t){if(!(t instanceof M))throw new TypeError("ExtendedPoint expected")}function ca(t){if(!(t instanceof It))throw new TypeError("RistrettoPoint expected")}function ua(){throw new Error("Legacy method: switch to RistrettoPoint")}var It=class{constructor(e){this.ep=e}static calcElligatorRistrettoMap(e){let{d:r}=nt,n=E(Pr*e*e),i=E((n+H)*Hl),a=BigInt(-1),s=E((a-r*n)*E(n+r)),{isValid:o,value:f}=ya(i,s),c=E(f*e);Be(c)||(c=E(-c)),o||(f=c),o||(a=n);let u=E(a*(n-H)*Gl-s),h=f*f,l=E((f+f)*s),d=E(u*ql),p=E(H-h),g=E(H+h);return new M(E(l*g),E(p*d),E(d*g),E(l*p))}static hashToCurve(e){e=Ce(e,64);let r=ha(e.slice(0,32)),n=this.calcElligatorRistrettoMap(r),i=ha(e.slice(32,64)),a=this.calcElligatorRistrettoMap(i);return new It(n.add(a))}static fromHex(e){e=Ce(e,32);let{a:r,d:n}=nt,i="RistrettoPoint.fromHex: the hex is not valid encoding of RistrettoPoint",a=ha(e);if(!Ql(Ur(a),e)||Be(a))throw new Error(i);let s=E(a*a),o=E(H+r*s),f=E(H-r*s),c=E(o*o),u=E(f*f),h=E(r*n*c-u),{isValid:l,value:d}=Yo(E(h*u)),p=E(d*f),g=E(d*p*h),v=E((a+a)*p);Be(v)&&(v=E(-v));let m=E(o*g),S=E(v*m);if(!l||Be(S)||m===bt)throw new Error(i);return new It(new M(v,m,H,S))}toRawBytes(){let{x:e,y:r,z:n,t:i}=this.ep,a=E(E(n+r)*E(n-r)),s=E(e*r),o=E(s*s),{value:f}=Yo(E(a*o)),c=E(f*a),u=E(f*s),h=E(c*u*i),l;if(Be(i*h)){let p=E(r*Pr),g=E(e*Pr);e=p,r=g,l=E(c*zl)}else l=u;Be(e*h)&&(r=E(-r));let d=E((n-r)*l);return Be(d)&&(d=E(-d)),Ur(d)}toHex(){return Kr(this.toRawBytes())}toString(){return this.toHex()}equals(e){ca(e);let r=this.ep,n=e.ep,i=E(r.x*n.y)===E(r.y*n.x),a=E(r.y*n.y)===E(r.x*n.x);return i||a}add(e){return ca(e),new It(this.ep.add(e.ep))}subtract(e){return ca(e),new It(this.ep.subtract(e.ep))}multiply(e){return new It(this.ep.multiply(e))}multiplyUnsafe(e){return new It(this.ep.multiplyUnsafe(e))}};It.BASE=new It(M.BASE);It.ZERO=new It(M.ZERO);var pa=new WeakMap,st=class{constructor(e,r){this.x=e,this.y=r}_setWindowSize(e){this._WINDOW_SIZE=e,pa.delete(this)}static fromHex(e,r=!0){let{d:n,P:i}=nt;e=Ce(e,32);let a=e.slice();a[31]=e[31]&-129;let s=Fr(a);if(r&&s>=i)throw new Error("Expected 0 < hex < P");if(!r&&s>=$o)throw new Error("Expected 0 < hex < 2**256");let o=E(s*s),f=E(o-H),c=E(n*o+H),{isValid:u,value:h}=ya(f,c);if(!u)throw new Error("Point.fromHex: invalid y coordinate");let l=(h&H)===H;return(e[31]&128)!==0!==l&&(h=E(-h)),new st(h,s)}static async fromPrivateKey(e){return(await Dn(e)).point}toRawBytes(){let e=Ur(this.y);return e[31]|=this.x&H?128:0,e}toHex(){return Kr(this.toRawBytes())}toX25519(){let{y:e}=this,r=E((H+e)*Nn(H-e));return Ur(r)}isTorsionFree(){return M.fromAffine(this).isTorsionFree()}equals(e){return this.x===e.x&&this.y===e.y}negate(){return new st(E(-this.x),this.y)}add(e){return M.fromAffine(this).add(M.fromAffine(e)).toAffine()}subtract(e){return this.add(e.negate())}multiply(e){return M.fromAffine(this).multiply(e,this).toAffine()}};st.BASE=new st(nt.Gx,nt.Gy);st.ZERO=new st(bt,H);var Me=class{constructor(e,r){this.r=e,this.s=r,this.assertValidity()}static fromHex(e){let r=Ce(e,64),n=st.fromHex(r.slice(0,32),!1),i=Fr(r.slice(32,64));return new Me(n,i)}assertValidity(){let{r:e,s:r}=this;if(!(e instanceof st))throw new Error("Expected Point instance");return kn(r,nt.l,!1),this}toRawBytes(){let e=new Uint8Array(64);return e.set(this.r.toRawBytes()),e.set(Ur(this.s),32),e}toHex(){return Kr(this.toRawBytes())}};function Zo(...t){if(!t.every(n=>n instanceof Uint8Array))throw new Error("Expected Uint8Array list");if(t.length===1)return t[0];let e=t.reduce((n,i)=>n+i.length,0),r=new Uint8Array(e);for(let n=0,i=0;n<t.length;n++){let a=t[n];r.set(a,i),i+=a.length}return r}var Wl=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function Kr(t){if(!(t instanceof Uint8Array))throw new Error("Uint8Array expected");let e="";for(let r=0;r<t.length;r++)e+=Wl[t[r]];return e}function da(t){if(typeof t!="string")throw new TypeError("hexToBytes: expected string, got "+typeof t);if(t.length%2)throw new Error("hexToBytes: received invalid unpadded hex");let e=new Uint8Array(t.length/2);for(let r=0;r<e.length;r++){let n=r*2,i=t.slice(n,n+2),a=Number.parseInt(i,16);if(Number.isNaN(a)||a<0)throw new Error("Invalid byte sequence");e[r]=a}return e}function Qo(t){let r=t.toString(16).padStart(64,"0");return da(r)}function Ur(t){return Qo(t).reverse()}function Be(t){return(E(t)&H)===H}function Fr(t){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");return BigInt("0x"+Kr(Uint8Array.from(t).reverse()))}var Zl=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");function ha(t){return E(Fr(t)&Zl)}function E(t,e=nt.P){let r=t%e;return r>=bt?r:e+r}function Nn(t,e=nt.P){if(t===bt||e<=bt)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let r=E(t,e),n=e,i=bt,a=H,s=H,o=bt;for(;r!==bt;){let c=n/r,u=n%r,h=i-s*c,l=a-o*c;n=r,r=u,i=s,a=o,s=h,o=l}if(n!==H)throw new Error("invert: does not exist");return E(i,e)}function Yl(t,e=nt.P){let r=new Array(t.length),n=t.reduce((a,s,o)=>s===bt?a:(r[o]=a,E(a*s,e)),H),i=Nn(n,e);return t.reduceRight((a,s,o)=>s===bt?a:(r[o]=E(a*r[o],e),E(a*s,e)),i),r}function ae(t,e){let{P:r}=nt,n=t;for(;e-- >bt;)n*=n,n%=r;return n}function $l(t){let{P:e}=nt,r=BigInt(5),n=BigInt(10),i=BigInt(20),a=BigInt(40),s=BigInt(80),f=t*t%e*t%e,c=ae(f,Ae)*f%e,u=ae(c,H)*t%e,h=ae(u,r)*u%e,l=ae(h,n)*h%e,d=ae(l,i)*l%e,p=ae(d,a)*d%e,g=ae(p,s)*p%e,v=ae(g,s)*p%e,m=ae(v,n)*h%e;return{pow_p_5_8:ae(m,Ae)*t%e,b2:f}}function ya(t,e){let r=E(e*e*e),n=E(r*r*e),i=$l(t*n).pow_p_5_8,a=E(t*r*i),s=E(e*a*a),o=a,f=E(a*Pr),c=s===t,u=s===E(-t),h=s===E(-t*Pr);return c&&(a=o),(u||h)&&(a=f),Be(a)&&(a=E(-a)),{isValid:c||u,value:a}}function Yo(t){return ya(H,t)}function Rn(t){return E(Fr(t),nt.l)}function Ql(t,e){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}function Ce(t,e){let r=t instanceof Uint8Array?Uint8Array.from(t):da(t);if(typeof e=="number"&&r.length!==e)throw new Error(`Expected ${e} bytes`);return r}function kn(t,e,r=!0){if(!e)throw new TypeError("Specify max value");if(typeof t=="number"&&Number.isSafeInteger(t)&&(t=BigInt(t)),typeof t=="bigint"&&t<e){if(r){if(bt<t)return t}else if(bt<=t)return t}throw new TypeError("Expected valid scalar: 0 < scalar < max")}function Xl(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}function Jl(t){if(t=typeof t=="bigint"||typeof t=="number"?Qo(kn(t,$o)):Ce(t),t.length!==32)throw new Error("Expected 32 bytes");return t}function jl(t){let e=Xl(t.slice(0,32)),r=t.slice(32,64),n=Rn(e),i=st.BASE.multiply(n),a=i.toRawBytes();return{head:e,prefix:r,scalar:n,point:i,pointBytes:a}}var la;async function Dn(t){return jl(await Te.sha512(Jl(t)))}async function ga(t){return(await Dn(t)).pointBytes}async function Xo(t,e){t=Ce(t);let{prefix:r,scalar:n,pointBytes:i}=await Dn(e),a=Rn(await Te.sha512(r,t)),s=st.BASE.multiply(a),o=Rn(await Te.sha512(s.toRawBytes(),i,t)),f=E(a+o*n,nt.l);return new Me(s,f).toRawBytes()}function tp(t,e,r){e=Ce(e),r instanceof st||(r=st.fromHex(r,!1));let{r:n,s:i}=t instanceof Me?t.assertValidity():Me.fromHex(t),a=M.BASE.multiplyUnsafe(i);return{r:n,s:i,SB:a,pub:r,msg:e}}function ep(t,e,r,n){let i=Rn(n),a=M.fromAffine(t).multiplyUnsafe(i);return M.fromAffine(e).add(a).subtract(r).multiplyUnsafe(nt.h).equals(M.ZERO)}async function Jo(t,e,r){let{r:n,SB:i,msg:a,pub:s}=tp(t,e,r),o=await Te.sha512(n.toRawBytes(),s.toRawBytes(),a);return ep(s,n,i,o)}st.BASE._setWindowSize(8);var Ee={node:Ml,web:typeof self=="object"&&"crypto"in self?self.crypto:void 0},Te={bytesToHex:Kr,hexToBytes:da,concatBytes:Zo,getExtendedPublicKey:Dn,mod:E,invert:Nn,TORSION_SUBGROUP:["0100000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac037a","0000000000000000000000000000000000000000000000000000000000000080","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc05","ecffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff7f","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc85","0000000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac03fa"],hashToPrivateScalar:t=>{if(t=Ce(t),t.length<40||t.length>1024)throw new Error("Expected 40-1024 bytes of private key as per FIPS 186");return E(Fr(t),nt.l-H)+H},randomBytes:(t=32)=>{if(Ee.web)return Ee.web.getRandomValues(new Uint8Array(t));if(Ee.node){let{randomBytes:e}=Ee.node;return new Uint8Array(e(t).buffer)}else throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>Te.randomBytes(32),sha512:async(...t)=>{let e=Zo(...t);if(Ee.web){let r=await Ee.web.subtle.digest("SHA-512",e.buffer);return new Uint8Array(r)}else{if(Ee.node)return Uint8Array.from(Ee.node.createHash("sha512").update(e).digest());throw new Error("The environment doesn't have sha512 function")}},precompute(t=8,e=st.BASE){let r=e.equals(st.BASE)?e:new st(e.x,e.y);return r._setWindowSize(t),r.multiply(Ae),r},sha512Sync:void 0};Object.defineProperties(Te,{sha512Sync:{configurable:!1,get(){return la},set(t){la||(la=t)}}});var lr=32,le=64,Ln=32;async function jo(){let t=Te.randomPrivateKey(),e=await ga(t);return{privateKey:nf(t,e),publicKey:e}}async function tf(t){if(t.length!==Ln)throw new TypeError('"seed" must be 32 bytes in length.');if(!(t instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, or Uint8Array.');let e=t,r=await ga(e);return{privateKey:nf(e,r),publicKey:r}}async function ef(t,e){let r=t.subarray(0,Ln);return await Xo(e,r)}async function rf(t,e,r){return await Jo(e,r,t)}function nf(t,e){let r=new Uint8Array(le);for(let n=0;n<Ln;n++)r[n]=t[n],r[Ln+n]=e[n];return r}var Or=class{constructor(e){this._key=pr(e,lr)}async verify(e,r){return await rf(this._key,r,e)}marshal(){return this._key}get bytes(){return qt.encode({Type:j.Ed25519,Data:this.marshal()}).subarray()}equals(e){return Wt(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Rt.digest(this.bytes);return e}},Ve=class{constructor(e,r){this._key=pr(e,le),this._publicKey=pr(r,lr)}async sign(e){return await ef(this._key,e)}get public(){return new Or(this._publicKey)}marshal(){return this._key}get bytes(){return zt.encode({Type:j.Ed25519,Data:this.marshal()}).subarray()}equals(e){return Wt(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Rt.digest(this.bytes);return e}async id(){let e=gi.digest(this.public.bytes);return Dt.encode(e.bytes).substring(1)}async export(e,r="libp2p-key"){if(r==="libp2p-key")return await ur(this.bytes,e);throw new K(`export format '${r}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}};function ip(t){if(t.length>le){t=pr(t,le+lr);let n=t.subarray(0,le),i=t.subarray(le,t.length);return new Ve(n,i)}t=pr(t,le);let e=t.subarray(0,le),r=t.subarray(lr);return new Ve(e,r)}function ap(t){return t=pr(t,lr),new Or(t)}async function sp(){let{privateKey:t,publicKey:e}=await jo();return new Ve(t,e)}async function xa(t){let{privateKey:e,publicKey:r}=await tf(t);return new Ve(e,r)}function pr(t,e){if(t=Uint8Array.from(t??[]),t.length!==e)throw new K(`Key must be a Uint8Array of length ${e}, got ${t.length}`,"ERR_INVALID_KEY_TYPE");return t}var ba={};ut(ba,{Secp256k1PrivateKey:()=>Vr,Secp256k1PublicKey:()=>Mr,generateKeyPair:()=>up,unmarshalSecp256k1PrivateKey:()=>fp,unmarshalSecp256k1PublicKey:()=>cp});function af(){return Yt.randomPrivateKey()}async function sf(t,e){let{digest:r}=await Rt.digest(e);try{return await No(r,t)}catch(n){throw new K(String(n),"ERR_INVALID_INPUT")}}async function of(t,e,r){try{let{digest:n}=await Rt.digest(r);return Do(e,n,t)}catch(n){throw new K(String(n),"ERR_INVALID_INPUT")}}function ff(t){return $.fromHex(t).toRawBytes(!0)}function cf(t){try{aa(t,!0)}catch(e){throw new K(String(e),"ERR_INVALID_PRIVATE_KEY")}}function ma(t){try{$.fromHex(t)}catch(e){throw new K(String(e),"ERR_INVALID_PUBLIC_KEY")}}function uf(t){try{return aa(t,!0)}catch(e){throw new K(String(e),"ERR_INVALID_PRIVATE_KEY")}}var Mr=class{constructor(e){ma(e),this._key=e}async verify(e,r){return await of(this._key,r,e)}marshal(){return ff(this._key)}get bytes(){return qt.encode({Type:j.Secp256k1,Data:this.marshal()}).subarray()}equals(e){return Wt(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Rt.digest(this.bytes);return e}},Vr=class{constructor(e,r){this._key=e,this._publicKey=r??uf(e),cf(this._key),ma(this._publicKey)}async sign(e){return await sf(this._key,e)}get public(){return new Mr(this._publicKey)}marshal(){return this._key}get bytes(){return zt.encode({Type:j.Secp256k1,Data:this.marshal()}).subarray()}equals(e){return Wt(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Rt.digest(this.bytes);return e}async id(){let e=await this.public.hash();return ot(e,"base58btc")}async export(e,r="libp2p-key"){if(r==="libp2p-key")return await ur(this.bytes,e);throw new K(`export format '${r}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}};function fp(t){return new Vr(t)}function cp(t){return new Mr(t)}async function up(){let t=af();return new Vr(t)}var se={rsa:fa,ed25519:va,secp256k1:ba};function wa(t){let e=Object.keys(se).join(" / ");return new K(`invalid or unsupported key type ${t}. Must be ${e}`,"ERR_UNSUPPORTED_KEY_TYPE")}function Sa(t){if(t=t.toLowerCase(),t==="rsa"||t==="ed25519"||t==="secp256k1")return se[t];throw wa(t)}async function hp(t,e){return await Sa(t).generateKeyPair(e??2048)}async function lp(t,e,r){if(t.toLowerCase()!=="ed25519")throw new K("Seed key derivation is unimplemented for RSA or secp256k1","ERR_UNSUPPORTED_KEY_DERIVATION_TYPE");return await xa(e)}function pp(t){let e=qt.decode(t),r=e.Data??new Uint8Array;switch(e.Type){case j.RSA:return se.rsa.unmarshalRsaPublicKey(r);case j.Ed25519:return se.ed25519.unmarshalEd25519PublicKey(r);case j.Secp256k1:return se.secp256k1.unmarshalSecp256k1PublicKey(r);default:throw wa(e.Type??"RSA")}}function dp(t,e){return e=(e??"rsa").toLowerCase(),Sa(e),t.bytes}async function hf(t){let e=zt.decode(t),r=e.Data??new Uint8Array;switch(e.Type){case j.RSA:return await se.rsa.unmarshalRsaPrivateKey(r);case j.Ed25519:return se.ed25519.unmarshalEd25519PrivateKey(r);case j.Secp256k1:return se.secp256k1.unmarshalSecp256k1PrivateKey(r);default:throw wa(e.Type??"RSA")}}function yp(t,e){return e=(e??"rsa").toLowerCase(),Sa(e),t.bytes}async function gp(t,e){try{let i=await po(t,e);return await hf(i)}catch{}let r=Pn.default.pki.decryptRsaPrivateKey(t,e);if(r===null)throw new K("Cannot read the key, most likely the password is wrong or not a RSA key","ERR_CANNOT_DECRYPT_PEM");let n=Pn.default.asn1.toDer(Pn.default.pki.privateKeyToAsn1(r));return n=St(n.getBytes(),"ascii"),await se.rsa.unmarshalRsaPrivateKey(n)}var pf=it(Vi(),1),df=it(lt(),1);var lf={sha1:"sha1","sha2-256":"sha256","sha2-512":"sha512"};function Ba(t,e,r,n,i){if(i!=="sha1"&&i!=="sha2-256"&&i!=="sha2-512"){let o=Object.keys(lf).join(" / ");throw new K(`Hash '${i}' is unknown or not supported. Must be ${o}`,"ERR_UNSUPPORTED_HASH_TYPE")}let a=lf[i],s=(0,pf.default)(t,e,r,n,a);return df.default.encode64(s,null)}return bf(xp);})();
/*! Bundled license information:

@noble/secp256k1/lib/esm/index.js:
  (*! noble-secp256k1 - MIT License (c) 2019 Paul Miller (paulmillr.com) *)

@noble/ed25519/lib/esm/index.js:
  (*! noble-ed25519 - MIT License (c) 2019 Paul Miller (paulmillr.com) *)
*/
return Libp2PCrypto}));
